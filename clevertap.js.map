<<<<<<< HEAD
{"version":3,"file":"clevertap.js","sources":["src/options.js","src/modules/account.js","src/util/constants.js","src/util/datatypes.js","src/util/datetime.js","src/util/storage.js","src/util/lruCache.js","src/modules/api.js","src/modules/device.js","src/util/messages.js","src/util/validator.js","src/modules/event.js","src/util/url.js","src/util/encoder.js","src/util/requestDispatcher.js","src/util/clevertap.js","src/modules/profile.js","src/modules/userLogin.js","src/util/web-personalisation/banner.js","src/util/web-personalisation/carousel.js","src/util/web-popupImageonly/popupImageonly.js","src/modules/web-inbox/Message.js","src/modules/web-inbox/inboxStyles.js","src/modules/web-inbox/WebInbox.js","src/modules/web-inbox/helper.js","src/util/tr.js","src/modules/user.js","src/modules/logger.js","src/modules/session.js","src/modules/request.js","src/modules/privacy.js","src/modules/notification.js","src/clevertap.js","src/main.js"],"sourcesContent":["export const TARGET_DOMAIN = 'clevertap-prod.com'\nexport const TARGET_PROTOCOL = 'https:'\nexport const DEFAULT_REGION = 'eu1'\n","import { DEFAULT_REGION, TARGET_DOMAIN, TARGET_PROTOCOL } from '../options'\n\nexport default class Account {\n  #accountId\n  #region = ''\n  #targetDomain = TARGET_DOMAIN\n  #dcSdkversion = ''\n\n  constructor ({ id } = {}, region = '', targetDomain = TARGET_DOMAIN) {\n    this.id = id\n    if (region) {\n      this.region = region\n    }\n    if (targetDomain) {\n      this.targetDomain = targetDomain\n    }\n  }\n\n  get id () {\n    return this.#accountId\n  }\n\n  set id (accountId) {\n    this.#accountId = accountId\n  }\n\n  get region () {\n    return this.#region\n  }\n\n  set region (region) {\n    this.#region = region\n  }\n\n  get dcSDKVersion () {\n    return this.#dcSdkversion\n  }\n\n  set dcSDKVersion (dcSDKVersion) {\n    this.#dcSdkversion = dcSDKVersion\n  }\n\n  get targetDomain () {\n    return this.#targetDomain\n  }\n\n  set targetDomain (targetDomain) {\n    this.#targetDomain = targetDomain\n  }\n\n  get finalTargetDomain () {\n    if (this.region) {\n      return `${this.region}.${this.targetDomain}`\n    } else {\n      if (this.targetDomain === TARGET_DOMAIN) {\n        return `${DEFAULT_REGION}.${this.targetDomain}`\n      }\n      return this.targetDomain\n    }\n  }\n\n  get dataPostURL () {\n    return `${TARGET_PROTOCOL}//${this.finalTargetDomain}/a?t=96`\n  }\n\n  get recorderURL () {\n    return `${TARGET_PROTOCOL}//${this.finalTargetDomain}/r?r=1`\n  }\n\n  get emailURL () {\n    return `${TARGET_PROTOCOL}//${this.finalTargetDomain}/e?r=1`\n  }\n}\n","export const unsupportedKeyCharRegex = new RegExp('^\\\\s+|\\\\\\.|\\:|\\\\\\$|\\'|\\\"|\\\\\\\\|\\\\s+$', 'g')\nexport const unsupportedValueCharRegex = new RegExp(\"^\\\\s+|\\'|\\\"|\\\\\\\\|\\\\s+$\", 'g')\nexport const doubleQuoteRegex = new RegExp('\\\"', 'g')\nexport const singleQuoteRegex = new RegExp('\\'', 'g')\nexport const CLEAR = 'clear'\nexport const CHARGED_ID = 'Charged ID'\nexport const CHARGEDID_COOKIE_NAME = 'WZRK_CHARGED_ID'\nexport const GCOOKIE_NAME = 'WZRK_G'\nexport const KCOOKIE_NAME = 'WZRK_K'\nexport const CAMP_COOKIE_NAME = 'WZRK_CAMP'\nexport const CAMP_COOKIE_G = 'WZRK_CAMP_G'// cookie for storing campaign details against guid\nexport const SCOOKIE_PREFIX = 'WZRK_S'\nexport const SCOOKIE_EXP_TIME_IN_SECS = 60 * 20 // 20 mins\nexport const EV_COOKIE = 'WZRK_EV'\nexport const META_COOKIE = 'WZRK_META'\nexport const PR_COOKIE = 'WZRK_PR'\nexport const ARP_COOKIE = 'WZRK_ARP'\nexport const LCOOKIE_NAME = 'WZRK_L'\nexport const NOTIF_COOKIE_NAME = 'WZRK_N'\nexport const GLOBAL = 'global'\nexport const TOTAL_COUNT = 'tc'\nexport const DISPLAY = 'display'\nexport const UNDEFINED = 'undefined'\nexport const WEBPUSH_LS_KEY = 'WZRK_WPR'\nexport const OPTOUT_KEY = 'optOut'\nexport const CT_OPTOUT_KEY = 'ct_optout'\nexport const OPTOUT_COOKIE_ENDSWITH = ':OO'\nexport const USEIP_KEY = 'useIP'\nexport const LRU_CACHE = 'WZRK_X'\nexport const LRU_CACHE_SIZE = 100\nexport const IS_OUL = 'isOUL'\nexport const EVT_PUSH = 'push'\nexport const EVT_PING = 'ping'\nexport const COOKIE_EXPIRY = 86400 * 365 // 1 Year in seconds\nexport const MAX_TRIES = 200 // API tries\nexport const FIRST_PING_FREQ_IN_MILLIS = 2 * 60 * 1000 // 2 mins\nexport const CONTINUOUS_PING_FREQ_IN_MILLIS = 5 * 60 * 1000 // 5 mins\nexport const GROUP_SUBSCRIPTION_REQUEST_ID = '2'\nexport const categoryLongKey = 'cUsY'\nexport const WZRK_PREFIX = 'wzrk_'\nexport const WZRK_ID = 'wzrk_id'\nexport const NOTIFICATION_VIEWED = 'Notification Viewed'\nexport const NOTIFICATION_CLICKED = 'Notification Clicked'\nexport const FIRE_PUSH_UNREGISTERED = 'WZRK_FPU'\nexport const PUSH_SUBSCRIPTION_DATA = 'WZRK_PSD' // PUSH SUBSCRIPTION DATA FOR REGISTER/UNREGISTER TOKEN\nexport const COMMAND_INCREMENT = '$incr'\nexport const COMMAND_DECREMENT = '$decr'\nexport const COMMAND_SET = '$set'\nexport const COMMAND_ADD = '$add'\nexport const COMMAND_REMOVE = '$remove'\nexport const COMMAND_DELETE = '$delete'\nexport const WEBINBOX_CONFIG = 'WZRK_INBOX_CONFIG'\nexport const WEBINBOX = 'WZRK_INBOX'\nexport const MAX_INBOX_MSG = 15\n\nexport const SYSTEM_EVENTS = [\n  'Stayed',\n  'UTM Visited',\n  'App Launched',\n  'Notification Sent',\n  NOTIFICATION_VIEWED,\n  NOTIFICATION_CLICKED\n]\n","import {\n  unsupportedKeyCharRegex,\n  unsupportedValueCharRegex\n} from './constants'\n\nexport const isString = (input) => {\n  return (typeof input === 'string' || input instanceof String)\n}\n\nexport const isObject = (input) => {\n  // TODO: refine\n  return Object.prototype.toString.call(input) === '[object Object]'\n}\n\nexport const isDateObject = (input) => {\n  return typeof (input) === 'object' && (input instanceof Date)\n}\n\nexport const isObjectEmpty = (obj) => {\n  for (const prop in obj) {\n    if (obj.hasOwnProperty(prop)) { return false }\n  }\n  return true\n}\n\nexport const isConvertibleToNumber = (n) => {\n  return !isNaN(parseFloat(n)) && isFinite(n)\n}\n\nexport const isNumber = (n) => {\n  return /^-?[\\d.]+(?:e-?\\d+)?$/.test(n) && typeof n === 'number'\n}\n\nexport const isValueValid = (value) => {\n  if (value === null || value === undefined || value === 'undefined') {\n    return false\n  }\n  return true\n}\n\nexport const arrayContains = (arr, obj) => {\n  var i = arr.length\n  while (i--) {\n    if (arr[i] === obj) {\n      return true\n    }\n  }\n  return false\n}\n\nexport const removeUnsupportedChars = (o, logger) => {\n  // keys can't be greater than 1024 chars, values can't be greater than 1024 chars\n  if (typeof o === 'object') {\n    for (const key in o) {\n      if (o.hasOwnProperty(key)) {\n        const sanitizedVal = removeUnsupportedChars(o[key], logger)\n        let sanitizedKey\n        sanitizedKey = sanitize(key, unsupportedKeyCharRegex)\n        if (sanitizedKey.length > 1024) {\n          sanitizedKey = sanitizedKey.substring(0, 1024)\n          logger.reportError(520, sanitizedKey + '... length exceeded 1024 chars. Trimmed.')\n        }\n        delete o[key]\n        o[sanitizedKey] = sanitizedVal\n      }\n    }\n  } else {\n    let val\n\n    if (isString(o)) {\n      val = sanitize(o, unsupportedValueCharRegex)\n      if (val.length > 1024) {\n        val = val.substring(0, 1024)\n        logger.reportError(521, val + '... length exceeded 1024 chars. Trimmed.')\n      }\n    } else {\n      val = o\n    }\n    return val\n  }\n  return o\n}\n\nexport const sanitize = (input, regex) => {\n  return input.replace(regex, '')\n}\n","export const getToday = () => {\n  const today = new Date()\n  return today.getFullYear() + '' + today.getMonth() + '' + today.getDay()\n}\n\nexport const getNow = () => {\n  return Math.floor((new Date()).getTime() / 1000)\n}\n\nexport const convertToWZRKDate = (dateObj) => {\n  return ('$D_' + Math.round(dateObj.getTime() / 1000))\n}\n\nexport const setDate = (dt) => {\n  // expecting  yyyymmdd format either as a number or a string\n  if (isDateValid(dt)) {\n    return '$D_' + dt\n  }\n}\n\nexport const isDateValid = (date) => {\n  const matches = /^(\\d{4})(\\d{2})(\\d{2})$/.exec(date)\n  if (matches == null) return false\n  const d = matches[3]\n  const m = matches[2] - 1\n  const y = matches[1]\n  const composedDate = new Date(y, m, d)\n  // eslint-disable-next-line eqeqeq\n  return composedDate.getDate() == d && composedDate.getMonth() == m && composedDate.getFullYear() == y\n}\n","import {\n  GCOOKIE_NAME,\n  META_COOKIE,\n  KCOOKIE_NAME,\n  LCOOKIE_NAME\n} from './constants'\nexport class StorageManager {\n  static save (key, value) {\n    if (!key || !value) {\n      return false\n    }\n    if (this._isLocalStorageSupported()) {\n      localStorage.setItem(key, typeof value === 'string' ? value : JSON.stringify(value))\n      return true\n    }\n  }\n\n  static read (key) {\n    if (!key) {\n      return false\n    }\n    let data = null\n    if (this._isLocalStorageSupported()) {\n      data = localStorage.getItem(key)\n    }\n    if (data != null) {\n      try {\n        data = JSON.parse(data)\n      } catch (e) {}\n    }\n    return data\n  }\n\n  static remove (key) {\n    if (!key) {\n      return false\n    }\n    if (this._isLocalStorageSupported()) {\n      localStorage.removeItem(key)\n      return true\n    }\n  }\n\n  static removeCookie (name, domain) {\n    let cookieStr = name + '=; expires=Thu, 01 Jan 1970 00:00:01 GMT;'\n\n    if (domain) {\n      cookieStr = cookieStr + ' domain=' + domain + '; path=/'\n    }\n\n    document.cookie = cookieStr\n  }\n\n  static createCookie (name, value, seconds, domain) {\n    let expires = ''\n    let domainStr = ''\n    if (seconds) {\n      const date = new Date()\n      date.setTime(date.getTime() + (seconds * 1000))\n\n      expires = '; expires=' + date.toGMTString()\n    }\n\n    if (domain) {\n      domainStr = '; domain=' + domain\n    }\n\n    value = encodeURIComponent(value)\n\n    document.cookie = name + '=' + value + expires + domainStr + '; path=/'\n  }\n\n  static readCookie (name) {\n    const nameEQ = name + '='\n    const ca = document.cookie.split(';')\n    for (let idx = 0; idx < ca.length; idx++) {\n      let c = ca[idx]\n      while (c.charAt(0) === ' ') {\n        c = c.substring(1, c.length)\n      }\n      // eslint-disable-next-line eqeqeq\n      if (c.indexOf(nameEQ) == 0) {\n        return decodeURIComponent(c.substring(nameEQ.length, c.length))\n      }\n    }\n    return null\n  }\n\n  static _isLocalStorageSupported () {\n    return 'localStorage' in window && window.localStorage !== null && typeof window.localStorage.setItem === 'function'\n  }\n\n  static saveToLSorCookie (property, value) {\n    if (value == null) {\n      return\n    }\n    try {\n      if (this._isLocalStorageSupported()) {\n        this.save(property, encodeURIComponent(JSON.stringify(value)))\n      } else {\n        if (property === GCOOKIE_NAME) {\n          this.createCookie(property, encodeURIComponent(value), 0, window.location.hostname)\n        } else {\n          this.createCookie(property, encodeURIComponent(JSON.stringify(value)), 0, window.location.hostname)\n        }\n      }\n      $ct.globalCache[property] = value\n    } catch (e) {}\n  }\n\n  static readFromLSorCookie (property) {\n    let data\n    if ($ct.globalCache.hasOwnProperty(property)) {\n      return $ct.globalCache[property]\n    }\n    if (this._isLocalStorageSupported()) {\n      data = this.read(property)\n    } else {\n      data = this.readCookie(property)\n    }\n\n    if (data !== null && data !== undefined && !(typeof data.trim === 'function' && data.trim() === '')) {\n      let value\n      try {\n        value = JSON.parse(decodeURIComponent(data))\n      } catch (err) {\n        value = decodeURIComponent(data)\n      }\n      $ct.globalCache[property] = value\n      return value\n    }\n  }\n\n  static createBroadCookie (name, value, seconds, domain) {\n    // sets cookie on the base domain. e.g. if domain is baz.foo.bar.com, set cookie on \".bar.com\"\n    // To update an existing \"broad domain\" cookie, we need to know what domain it was actually set on.\n    // since a retrieved cookie never tells which domain it was set on, we need to set another test cookie\n    // to find out which \"broadest\" domain the cookie was set on. Then delete the test cookie, and use that domain\n    // for updating the actual cookie.\n\n    if (domain) {\n      let broadDomain = $ct.broadDomain\n      if (broadDomain == null) { // if we don't know the broadDomain yet, then find out\n        const domainParts = domain.split('.')\n        let testBroadDomain = ''\n        for (let idx = domainParts.length - 1; idx >= 0; idx--) {\n          if (idx === 0) {\n            testBroadDomain = domainParts[idx] + testBroadDomain\n          } else {\n            testBroadDomain = '.' + domainParts[idx] + testBroadDomain\n          }\n\n          // only needed if the cookie already exists and needs to be updated. See note above.\n          if (this.readCookie(name)) {\n            // no guarantee that browser will delete cookie, hence create short lived cookies\n            var testCookieName = 'test_' + name + idx\n            this.createCookie(testCookieName, value, 10, testBroadDomain) // self-destruct after 10 seconds\n            if (!this.readCookie(testCookieName)) { // if test cookie not set, then the actual cookie wouldn't have been set on this domain either.\n              continue\n            } else { // else if cookie set, then delete the test and the original cookie\n              this.removeCookie(testCookieName, testBroadDomain)\n            }\n          }\n\n          this.createCookie(name, value, seconds, testBroadDomain)\n          const tempCookie = this.readCookie(name)\n          // eslint-disable-next-line eqeqeq\n          if (tempCookie == value) {\n            broadDomain = testBroadDomain\n            $ct.broadDomain = broadDomain\n            break\n          }\n        }\n      } else {\n        this.createCookie(name, value, seconds, broadDomain)\n      }\n    } else {\n      this.createCookie(name, value, seconds, domain)\n    }\n  }\n\n  static getMetaProp (property) {\n    const metaObj = this.readFromLSorCookie(META_COOKIE)\n    if (metaObj != null) {\n      return metaObj[property]\n    }\n  }\n\n  static setMetaProp (property, value) {\n    if (this._isLocalStorageSupported()) {\n      let wzrkMetaObj = this.readFromLSorCookie(META_COOKIE)\n      if (wzrkMetaObj == null) {\n        wzrkMetaObj = {}\n      }\n      if (value === undefined) {\n        delete wzrkMetaObj[property]\n      } else {\n        wzrkMetaObj[property] = value\n      }\n      this.saveToLSorCookie(META_COOKIE, wzrkMetaObj)\n    }\n  }\n\n  static getAndClearMetaProp (property) {\n    const value = this.getMetaProp(property)\n    this.setMetaProp(property, undefined)\n    return value\n  }\n\n  static setInstantDeleteFlagInK () {\n    let k = this.readFromLSorCookie(KCOOKIE_NAME)\n    if (k == null) {\n      k = {}\n    }\n    k.flag = true\n    this.saveToLSorCookie(KCOOKIE_NAME, k)\n  }\n\n  static backupEvent (data, reqNo, logger) {\n    let backupArr = this.readFromLSorCookie(LCOOKIE_NAME)\n    if (typeof backupArr === 'undefined') {\n      backupArr = {}\n    }\n    backupArr[reqNo] = { q: data }\n    this.saveToLSorCookie(LCOOKIE_NAME, backupArr)\n    logger.debug(`stored in ${LCOOKIE_NAME} reqNo : ${reqNo} -> ${data}`)\n  }\n\n  static removeBackup (respNo, logger) {\n    const backupMap = this.readFromLSorCookie(LCOOKIE_NAME)\n    if (typeof backupMap !== 'undefined' && backupMap !== null && typeof backupMap[respNo] !== 'undefined') {\n      logger.debug(`del event: ${respNo} data-> ${backupMap[respNo].q}`)\n      delete backupMap[respNo]\n      this.saveToLSorCookie(LCOOKIE_NAME, backupMap)\n    }\n  }\n}\n\nexport const $ct = {\n  globalCache: {\n    gcookie: null,\n    REQ_N: 0,\n    RESP_N: 0\n  },\n  LRU_CACHE: null,\n  globalProfileMap: undefined,\n  globalEventsMap: undefined,\n  blockRequest: false,\n  isOptInRequest: false,\n  broadDomain: null,\n  webPushEnabled: null,\n  campaignDivMap: {},\n  currentSessionId: null,\n  wiz_counter: 0, // to keep track of number of times we load the body\n  notifApi: {\n    notifEnabledFromApi: false\n  }, // helper variable to handle race condition and check when notifications were called\n  unsubGroups: [],\n  updatedCategoryLong: null,\n  inbox: null,\n  isPrivacyArrPushed: false,\n  privacyArray: [],\n  offline: false,\n  location: null\n  // domain: window.location.hostname, url -> getHostName()\n  // gcookie: -> device\n}\n","import { StorageManager } from './storage'\nimport { LRU_CACHE } from './constants'\n\nexport default class LRUCache {\n  #keyOrder\n\n  constructor (max) {\n    this.max = max\n    let lruCache = StorageManager.readFromLSorCookie(LRU_CACHE)\n    if (lruCache) {\n      const tempLruCache = {}\n      this.#keyOrder = []\n      lruCache = lruCache.cache\n      for (const entry in lruCache) {\n        if (lruCache.hasOwnProperty(entry)) {\n          tempLruCache[lruCache[entry][0]] = lruCache[entry][1]\n          this.#keyOrder.push(lruCache[entry][0])\n        }\n      }\n      this.cache = tempLruCache\n    } else {\n      this.cache = {}\n      this.#keyOrder = []\n    }\n  }\n\n  get (key) {\n    const item = this.cache[key]\n    if (item) {\n      this.cache = this.#deleteFromObject(key, this.cache)\n      this.cache[key] = item\n      this.#keyOrder.push(key)\n    }\n    this.saveCacheToLS(this.cache)\n    return item\n  }\n\n  set (key, value) {\n    const item = this.cache[key]\n    const allKeys = this.#keyOrder\n    if (item != null) {\n      this.cache = this.#deleteFromObject(key, this.cache)\n    } else if (allKeys.length === this.max) {\n      this.cache = this.#deleteFromObject(allKeys[0], this.cache)\n    }\n    this.cache[key] = value\n    if (this.#keyOrder[this.#keyOrder - 1] !== key) {\n      this.#keyOrder.push(key)\n    }\n    this.saveCacheToLS(this.cache)\n  }\n\n  saveCacheToLS (cache) {\n    const objToArray = []\n    const allKeys = this.#keyOrder\n    for (const index in allKeys) {\n      if (allKeys.hasOwnProperty(index)) {\n        const temp = []\n        temp.push(allKeys[index])\n        temp.push(cache[allKeys[index]])\n        objToArray.push(temp)\n      }\n    }\n    StorageManager.saveToLSorCookie(LRU_CACHE, { cache: objToArray })\n  }\n\n  getKey (value) {\n    if (value === null) {\n      return null\n    }\n    const allKeys = this.#keyOrder\n    for (const index in allKeys) {\n      if (allKeys.hasOwnProperty(index)) {\n        if (this.cache[allKeys[index]] === value) {\n          return allKeys[index]\n        }\n      }\n    }\n    return null\n  }\n\n  getSecondLastKey () {\n    const keysArr = this.#keyOrder\n    if (keysArr != null && keysArr.length > 1) {\n      return keysArr[keysArr.length - 2]\n    }\n    return -1\n  }\n\n  getLastKey () {\n    const keysLength = this.#keyOrder.length\n    if (keysLength) {\n      return this.#keyOrder[keysLength - 1]\n    }\n  }\n\n  #deleteFromObject (key, obj) {\n    const allKeys = JSON.parse(JSON.stringify(this.#keyOrder))\n    const newCache = {}\n    let indexToDelete\n    for (const index in allKeys) {\n      if (allKeys.hasOwnProperty(index)) {\n        if (allKeys[index] !== key) {\n          newCache[allKeys[index]] = obj[allKeys[index]]\n        } else {\n          indexToDelete = index\n        }\n      }\n    }\n    allKeys.splice(indexToDelete, 1)\n    this.#keyOrder = JSON.parse(JSON.stringify(allKeys))\n    return newCache\n  }\n}\n","import { COOKIE_EXPIRY, FIRE_PUSH_UNREGISTERED, GCOOKIE_NAME, KCOOKIE_NAME, LRU_CACHE_SIZE, USEIP_KEY } from '../util/constants'\nimport { isValueValid } from '../util/datatypes'\nimport { getNow } from '../util/datetime'\nimport LRUCache from '../util/lruCache'\nimport { StorageManager, $ct } from '../util/storage'\n\nexport default class CleverTapAPI {\n  #logger\n  #request\n  #device\n  #session\n\n  constructor ({ logger, request, device, session }) {\n    this.#logger = logger\n    this.#request = request\n    this.#device = device\n    this.#session = session\n  }\n\n  /**\n   *\n   * @param {string} global gcookie\n   * @param {string} session\n   * @param {boolean} resume sent true in case of an OUL request from client side, which is returned as it is by server\n   * @param {number} respNumber the index of the request in backupmanager\n   * @param {boolean} optOutResponse\n   * @returns\n   */\n\n  s (global, session, resume, respNumber, optOutResponse) {\n    let oulReq = false\n    let newGuid = false\n\n    // for a scenario when OUL request is true from client side\n    // but resume is returned as false from server end\n    // we maintan a OulReqN var in the window object\n    // and compare with respNumber to determine the response of an OUL request\n    if (window.isOULInProgress) {\n      if (resume || (respNumber !== 'undefined' && respNumber === window.oulReqN)) {\n        window.isOULInProgress = false\n        oulReq = true\n      }\n    }\n\n    // call back function used to store global and session ids for the user\n    if (typeof respNumber === 'undefined') {\n      respNumber = 0\n    }\n\n    StorageManager.removeBackup(respNumber, this.#logger)\n\n    if (respNumber > $ct.globalCache.REQ_N) {\n      // request for some other user so ignore\n      return\n    }\n\n    if (!isValueValid(this.#device.gcookie)) {\n      if (global) {\n        newGuid = true\n      }\n    }\n\n    if (!isValueValid(this.#device.gcookie) || resume || typeof optOutResponse === 'boolean') {\n      const sessionObj = this.#session.getSessionCookieObject()\n\n      /*  If the received session is less than the session in the cookie,\n          then don't update guid as it will be response for old request\n      */\n      if (window.isOULInProgress || (sessionObj.s && (session < sessionObj.s))) {\n        return\n      }\n      this.#logger.debug(`Cookie was ${this.#device.gcookie} set to ${global}`)\n      this.#device.gcookie = global\n      if (!isValueValid(this.#device.gcookie)) {\n        // clear useIP meta prop\n        StorageManager.getAndClearMetaProp(USEIP_KEY)\n      }\n      if (global && StorageManager._isLocalStorageSupported()) {\n        if ($ct.LRU_CACHE == null) {\n          $ct.LRU_CACHE = new LRUCache(LRU_CACHE_SIZE)\n        }\n\n        const kIdFromLS = StorageManager.readFromLSorCookie(KCOOKIE_NAME)\n        let guidFromLRUCache\n        if (kIdFromLS != null && kIdFromLS.id) {\n          guidFromLRUCache = $ct.LRU_CACHE.cache[kIdFromLS.id]\n          if (resume) {\n            if (!guidFromLRUCache) {\n              StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, true)\n              // replace login identity in OUL request\n              // with the gcookie returned in exchange\n              $ct.LRU_CACHE.set(kIdFromLS.id, global)\n            }\n          }\n        }\n\n        StorageManager.saveToLSorCookie(GCOOKIE_NAME, global)\n        // lastk provides the guid\n        const lastK = $ct.LRU_CACHE.getSecondLastKey()\n        if (StorageManager.readFromLSorCookie(FIRE_PUSH_UNREGISTERED) && lastK !== -1) {\n          const lastGUID = $ct.LRU_CACHE.cache[lastK]\n          // fire the request directly via fireRequest to unregister the token\n          // then other requests with the updated guid should follow\n          this.#request.unregisterTokenForGuid(lastGUID)\n        }\n      }\n      StorageManager.createBroadCookie(GCOOKIE_NAME, global, COOKIE_EXPIRY, window.location.hostname)\n      StorageManager.saveToLSorCookie(GCOOKIE_NAME, global)\n    }\n\n    if (StorageManager._isLocalStorageSupported()) {\n      this.#session.manageSession(session)\n    }\n\n    // session cookie\n    const obj = this.#session.getSessionCookieObject()\n\n    // for the race-condition where two responses come back with different session ids. don't write the older session id.\n    if (typeof obj.s === 'undefined' || obj.s <= session) {\n      obj.s = session\n      obj.t = getNow() // time of last response from server\n      this.#session.setSessionCookieObject(obj)\n    }\n\n    // set blockRequest to false only if the device has a valid gcookie\n    if (isValueValid(this.#device.gcookie)) {\n      $ct.blockRequest = false\n    }\n\n    // only process the backup events after an OUL request or a new guid is recieved\n    if ((oulReq || newGuid) && !this.#request.processingBackup) {\n      this.#request.processBackupEvents()\n    }\n\n    $ct.globalCache.RESP_N = respNumber\n  }\n}\n","import { isValueValid } from '../util/datatypes'\nimport { StorageManager } from '../util/storage'\nimport { GCOOKIE_NAME, COOKIE_EXPIRY } from '../util/constants'\n\nexport default class DeviceManager {\n  #logger\n  gcookie\n\n  constructor ({ logger }) {\n    this.#logger = logger\n    this.gcookie = this.getGuid()\n  }\n\n  getGuid () {\n    let guid = null\n    if (isValueValid(this.gcookie)) {\n      return this.gcookie\n    }\n    if (StorageManager._isLocalStorageSupported()) {\n      const value = StorageManager.read(GCOOKIE_NAME)\n      if (isValueValid(value)) {\n        try {\n          guid = JSON.parse(decodeURIComponent(value))\n        } catch (e) {\n          this.#logger.debug('Cannot parse Gcookie from localstorage - must be encoded ' + value)\n          // assumming guids are of size 32. supporting both formats.\n          // guid can have encodedURIComponent or be without it.\n          // 1.56e4078ed15749928c042479ec2b4d47 - breaks on JSON.parse(decodeURIComponent())\n          // 2.%2256e4078ed15749928c042479ec2b4d47%22\n          if (value.length === 32) {\n            guid = value\n            StorageManager.saveToLSorCookie(GCOOKIE_NAME, value)\n          } else {\n            this.#logger.error('Illegal guid ' + value)\n          }\n        }\n\n        // Persist to cookie storage if not present there.\n        if (isValueValid(guid)) {\n          StorageManager.createBroadCookie(GCOOKIE_NAME, guid, COOKIE_EXPIRY, window.location.hostname)\n        }\n      }\n    }\n\n    if (!isValueValid(guid)) {\n      guid = StorageManager.readCookie(GCOOKIE_NAME)\n      if (isValueValid(guid) && (guid.indexOf('%') === 0 || guid.indexOf('\\'') === 0 || guid.indexOf('\"') === 0)) {\n        guid = null\n      }\n      if (isValueValid(guid)) {\n        StorageManager.saveToLSorCookie(GCOOKIE_NAME, guid)\n      }\n    }\n\n    return guid\n  }\n}\n","export const DATA_NOT_SENT_TEXT = 'This property has been ignored.'\nexport const INVALID_ACCOUNT = 'Invalid account ID'\nexport const INVALID_EVENT = 'Event structure not valid. Unable to process event'\nexport const CLEVERTAP_ERROR_PREFIX = 'CleverTap error:' // Formerly wzrk_error_txt\nexport const EMBED_ERROR = `${CLEVERTAP_ERROR_PREFIX} Incorrect embed script.`\nexport const EVENT_ERROR = `${CLEVERTAP_ERROR_PREFIX} Event structure not valid. ${DATA_NOT_SENT_TEXT}`\nexport const GENDER_ERROR = `${CLEVERTAP_ERROR_PREFIX} Gender value should be either M or F. ${DATA_NOT_SENT_TEXT}`\nexport const EMPLOYED_ERROR = `${CLEVERTAP_ERROR_PREFIX} Employed value should be either Y or N. ${DATA_NOT_SENT_TEXT}`\nexport const MARRIED_ERROR = `${CLEVERTAP_ERROR_PREFIX} Married value should be either Y or N. ${DATA_NOT_SENT_TEXT}`\nexport const EDUCATION_ERROR = `${CLEVERTAP_ERROR_PREFIX} Education value should be either School, College or Graduate. ${DATA_NOT_SENT_TEXT}`\nexport const AGE_ERROR = `${CLEVERTAP_ERROR_PREFIX} Age value should be a number. ${DATA_NOT_SENT_TEXT}`\nexport const DOB_ERROR = `${CLEVERTAP_ERROR_PREFIX} DOB value should be a Date Object`\nexport const OBJECT_ARRAY_ERROR = `${CLEVERTAP_ERROR_PREFIX} Expecting Object array in profile`\nexport const DATE_FORMAT_ERROR = `${CLEVERTAP_ERROR_PREFIX} setDate(number). number should be formatted as yyyymmdd`\nexport const ENUM_FORMAT_ERROR = `${CLEVERTAP_ERROR_PREFIX} setEnum(value). value should be a string or a number`\nexport const PHONE_FORMAT_ERROR = `${CLEVERTAP_ERROR_PREFIX} Phone number should be formatted as +[country code][number]`\n","import { isObject, isDateObject, isString, isNumber } from './datatypes'\nimport { convertToWZRKDate } from './datetime'\nimport { CHARGED_ID, CHARGEDID_COOKIE_NAME } from './constants'\nimport { StorageManager } from './storage'\n\nlet _globalChargedId\n\nexport const isEventStructureFlat = (eventObj) => {\n  // Events cannot have nested structure or Arrays\n  if (isObject(eventObj)) {\n    for (var key in eventObj) {\n      if (eventObj.hasOwnProperty(key)) {\n        if (isObject(eventObj[key]) || Array.isArray(eventObj[key])) {\n          return false\n        } else if (isDateObject(eventObj[key])) {\n          eventObj[key] = convertToWZRKDate(eventObj[key])\n        }\n      }\n    }\n    return true\n  }\n  return false\n}\n\nexport const isChargedEventStructureValid = (chargedObj, logger) => {\n  if (isObject(chargedObj)) {\n    for (var key in chargedObj) {\n      if (chargedObj.hasOwnProperty(key)) {\n        if (key === 'Items') {\n          if (!Array.isArray(chargedObj[key])) {\n            return false\n          }\n\n          if (chargedObj[key].length > 50) {\n            logger.reportError(522, 'Charged Items exceed 50 limit. Actual count: ' + chargedObj[key].length)\n          }\n\n          for (var itemKey in chargedObj[key]) {\n            if (chargedObj[key].hasOwnProperty(itemKey)) { // since default array implementation could be overridden - e.g. Teabox site\n              if (!isObject(chargedObj[key][itemKey]) || !isEventStructureFlat(chargedObj[key][itemKey])) {\n                return false\n              }\n            }\n          }\n        } else {\n          if (isObject(chargedObj[key]) || Array.isArray(chargedObj[key])) {\n            return false\n          } else if (isDateObject(chargedObj[key])) {\n            chargedObj[key] = convertToWZRKDate(chargedObj[key])\n          }\n        }\n      }\n    }\n\n    if (isString(chargedObj[CHARGED_ID]) || isNumber(chargedObj[CHARGED_ID])) {\n      // save charged Id\n      const chargedId = chargedObj[CHARGED_ID] + '' // casting chargedId to string\n\n      if (typeof _globalChargedId === 'undefined') {\n        _globalChargedId = StorageManager.readFromLSorCookie(CHARGEDID_COOKIE_NAME)\n      }\n      if (typeof _globalChargedId !== 'undefined' && _globalChargedId.trim() === chargedId.trim()) {\n        // drop event- duplicate charged id\n        logger.error('Duplicate charged Id - Dropped' + chargedObj)\n        return false\n      }\n      _globalChargedId = chargedId\n      StorageManager.saveToLSorCookie(CHARGEDID_COOKIE_NAME, chargedId)\n    }\n    return true\n  } // if object (chargedObject)\n  return false\n}\n","import { isString, isObject, sanitize } from '../util/datatypes'\nimport { EVENT_ERROR } from '../util/messages'\nimport { EV_COOKIE, SYSTEM_EVENTS, unsupportedKeyCharRegex } from '../util/constants'\nimport { isChargedEventStructureValid, isEventStructureFlat } from '../util/validator'\nimport { StorageManager, $ct } from '../util/storage'\n\nexport default class EventHandler extends Array {\n  #logger\n  #oldValues\n  #request\n  #isPersonalisationActive\n\n  constructor ({ logger, request, isPersonalisationActive }, values) {\n    super()\n    this.#logger = logger\n    this.#oldValues = values\n    this.#request = request\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  push (...eventsArr) {\n    this.#processEventArray(eventsArr)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processEventArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  #processEventArray (eventsArr) {\n    if (Array.isArray(eventsArr)) {\n      while (eventsArr.length > 0) {\n        var eventName = eventsArr.shift()\n        if (!isString(eventName)) {\n          this.#logger.error(EVENT_ERROR)\n          continue\n        }\n\n        if (eventName.length > 1024) {\n          eventName = eventName.substring(0, 1024)\n          this.#logger.reportError(510, eventName + '... length exceeded 1024 chars. Trimmed.')\n        }\n\n        if (SYSTEM_EVENTS.includes(eventName)) {\n          this.#logger.reportError(513, eventName + ' is a restricted system event. It cannot be used as an event name.')\n          continue\n        }\n\n        const data = {}\n        data.type = 'event'\n        data.evtName = sanitize(eventName, unsupportedKeyCharRegex)\n\n        if (eventsArr.length !== 0) {\n          const eventObj = eventsArr.shift()\n          if (!isObject(eventObj)) {\n            // put it back if it is not an object\n            eventsArr.unshift(eventObj)\n          } else {\n            // check Charged Event vs. other events.\n            if (eventName === 'Charged') {\n              if (!isChargedEventStructureValid(eventObj, this.#logger)) {\n                this.#logger.reportError(511, 'Charged event structure invalid. Not sent.')\n                continue\n              }\n            } else {\n              if (!isEventStructureFlat(eventObj)) {\n                this.#logger.reportError(512, eventName + ' event structure invalid. Not sent.')\n                continue\n              }\n            }\n            data.evtData = eventObj\n          }\n        }\n\n        this.#request.processEvent(data)\n      }\n    }\n  }\n\n  getDetails (evtName) {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    if (typeof $ct.globalEventsMap === 'undefined') {\n      $ct.globalEventsMap = StorageManager.readFromLSorCookie(EV_COOKIE)\n    }\n    if (typeof $ct.globalEventsMap === 'undefined') {\n      return\n    }\n    const evtObj = $ct.globalEventsMap[evtName]\n    const respObj = {}\n    if (typeof evtObj !== 'undefined') {\n      respObj.firstTime = new Date(evtObj[1] * 1000)\n      respObj.lastTime = new Date(evtObj[2] * 1000)\n      respObj.count = evtObj[0]\n      return respObj\n    }\n  }\n}\n","export const getURLParams = (url) => {\n  const urlParams = {}\n  const idx = url.indexOf('?')\n\n  if (idx > 1) {\n    const uri = url.substring(idx + 1)\n    let match\n    const pl = /\\+/g // Regex for replacing addition symbol with a space\n    const search = /([^&=]+)=?([^&]*)/g\n    const decode = function (s) {\n      let replacement = s.replace(pl, ' ')\n      try {\n        replacement = decodeURIComponent(replacement)\n      } catch (e) {\n        // eat\n      }\n      return replacement\n    }\n    match = search.exec(uri)\n    while (match) {\n      urlParams[decode(match[1])] = decode(match[2])\n      match = search.exec(uri)\n    }\n  }\n  return urlParams\n}\n\nexport const getDomain = (url) => {\n  if (url === '') return ''\n  var a = document.createElement('a')\n  a.href = url\n  return a.hostname\n}\n\nexport const addToURL = (url, k, v) => {\n  return url + '&' + k + '=' + encodeURIComponent(v)\n}\n\nexport const getHostName = () => {\n  return window.location.hostname\n}\n","/* eslint-disable */\nexport const urlBase64ToUint8Array = (base64String) => {\n  let padding = '='.repeat((4 - base64String.length % 4) % 4)\n  let base64 = (base64String + padding)\n      .replace(/\\-/g, '+')\n      .replace(/_/g, '/')\n\n  let rawData = window.atob(base64)\n  let processedData = []\n  for (let i=0; i<rawData.length; i++) {\n    processedData.push(rawData.charCodeAt(i))\n  }\n  return new Uint8Array(processedData)\n}\n\nexport const compressData = (dataObject, logger) => {\n  logger && typeof logger.debug === 'function' && logger.debug('dobj:' + dataObject)\n  return compressToBase64(dataObject)\n}\n\nexport const compress = (uncompressed) => {\n  if (uncompressed == null) return ''\n  let i, value,\n      context_dictionary = {},\n      context_dictionaryToCreate = {},\n      context_c = '',\n      context_wc = '',\n      context_w = '',\n      context_enlargeIn = 2, // Compensate for the first entry which should not count\n      context_dictSize = 3,\n      context_numBits = 2,\n      context_data_string = '',\n      context_data_val = 0,\n      context_data_position = 0,\n      ii,\n      f = String.fromCharCode\n\n  for (ii = 0; ii < uncompressed.length; ii += 1) {\n    context_c = uncompressed.charAt(ii)\n    if (!Object.prototype.hasOwnProperty.call(context_dictionary, context_c)) {\n      context_dictionary[context_c] = context_dictSize++\n      context_dictionaryToCreate[context_c] = true\n    }\n\n    context_wc = context_w + context_c\n    if (Object.prototype.hasOwnProperty.call(context_dictionary, context_wc)) {\n      context_w = context_wc\n    } else {\n      if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate, context_w)) {\n        if (context_w.charCodeAt(0) < 256) {\n          for (i = 0; i < context_numBits; i++) {\n            context_data_val = (context_data_val << 1)\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n          }\n          value = context_w.charCodeAt(0)\n          for (i = 0; i < 8; i++) {\n            context_data_val = (context_data_val << 1) | (value & 1)\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n            value = value >> 1\n          }\n        } else {\n          value = 1\n          for (i = 0; i < context_numBits; i++) {\n            context_data_val = (context_data_val << 1) | value\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n            value = 0\n          }\n          value = context_w.charCodeAt(0)\n          for (i = 0; i < 16; i++) {\n            context_data_val = (context_data_val << 1) | (value & 1)\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n            value = value >> 1\n          }\n        }\n        context_enlargeIn--\n        if (context_enlargeIn == 0) {\n          context_enlargeIn = Math.pow(2, context_numBits)\n          context_numBits++\n        }\n        delete context_dictionaryToCreate[context_w]\n      } else {\n        value = context_dictionary[context_w];\n        for (i = 0; i < context_numBits; i++) {\n          context_data_val = (context_data_val << 1) | (value & 1)\n          if (context_data_position == 15) {\n            context_data_position = 0;\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = value >> 1\n        }\n\n\n      }\n      context_enlargeIn--\n      if (context_enlargeIn == 0) {\n        context_enlargeIn = Math.pow(2, context_numBits)\n        context_numBits++\n      }\n      // Add wc to the dictionary.\n      context_dictionary[context_wc] = context_dictSize++\n      context_w = String(context_c)\n    }\n  }\n\n  // Output the code for w.\n  if (context_w !== '') {\n    if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate, context_w)) {\n      if (context_w.charCodeAt(0) < 256) {\n        for (i = 0; i < context_numBits; i++) {\n          context_data_val = (context_data_val << 1)\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n        }\n        value = context_w.charCodeAt(0)\n        for (i = 0; i < 8; i++) {\n          context_data_val = (context_data_val << 1) | (value & 1)\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = value >> 1\n        }\n      } else {\n        value = 1\n        for (i = 0; i < context_numBits; i++) {\n          context_data_val = (context_data_val << 1) | value\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = 0\n        }\n        value = context_w.charCodeAt(0);\n        for (i = 0; i < 16; i++) {\n          context_data_val = (context_data_val << 1) | (value & 1)\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = value >> 1\n        }\n      }\n      context_enlargeIn--\n      if (context_enlargeIn == 0) {\n        context_enlargeIn = Math.pow(2, context_numBits)\n        context_numBits++\n      }\n      delete context_dictionaryToCreate[context_w]\n    } else {\n      value = context_dictionary[context_w]\n      for (i = 0; i < context_numBits; i++) {\n        context_data_val = (context_data_val << 1) | (value & 1)\n        if (context_data_position == 15) {\n          context_data_position = 0\n          context_data_string += f(context_data_val)\n          context_data_val = 0\n        } else {\n          context_data_position++\n        }\n        value = value >> 1\n      }\n\n\n    }\n    context_enlargeIn--\n    if (context_enlargeIn == 0) {\n      context_enlargeIn = Math.pow(2, context_numBits)\n      context_numBits++\n    }\n  }\n\n  // Mark the end of the stream\n  value = 2\n  for (i = 0; i < context_numBits; i++) {\n    context_data_val = (context_data_val << 1) | (value & 1)\n    if (context_data_position == 15) {\n      context_data_position = 0\n      context_data_string += f(context_data_val)\n      context_data_val = 0\n    } else {\n      context_data_position++\n    }\n    value = value >> 1\n  }\n\n  // Flush the last char\n  while (true) {\n    context_data_val = (context_data_val << 1)\n    if (context_data_position == 15) {\n      context_data_string += f(context_data_val)\n      break\n    } else context_data_position++\n  }\n  return context_data_string\n}\n\nexport const getKeyStr = () => {\n  let key = ''\n  let i = 0\n\n  for (i = 0; i <= 25; i++) {\n    key = key + String.fromCharCode(i + 65)\n  }\n\n  for (i = 0; i <= 25; i++) {\n    key = key + String.fromCharCode(i + 97)\n  }\n\n  for (i = 0; i < 10; i++) {\n    key = key + i\n  }\n\n  return key + '+/='\n}\n\nconst _keyStr = getKeyStr()\n\nexport const convertToFormattedHex = (byte_arr) => {\n  let hex_str = '',\n      i,\n      len,\n      tmp_hex\n\n  if (!Array.isArray(byte_arr)) {\n    return false\n  }\n\n  len = byte_arr.length\n\n  for (i = 0; i < len; ++i) {\n    if (byte_arr[i] < 0) {\n      byte_arr[i] = byte_arr[i] + 256\n    }\n    if (byte_arr[i] === undefined) {\n      byte_arr[i] = 0\n    }\n    tmp_hex = byte_arr[i].toString(16)\n\n    if (tmp_hex.length == 1) tmp_hex = '0' + tmp_hex // Add leading zero.\n\n    //        beautification - needed if you're printing this in the console, else keep commented\n    //        if ((i + 1) % 16 === 0) {\n    //          tmp_hex += \"\\n\";\n    //        } else {\n    //          tmp_hex += \" \";\n    //        }\n\n    hex_str += tmp_hex\n  }\n\n  return hex_str.trim()\n}\n\nexport const convertStringToHex = (s) => {\n  let byte_arr = []\n  for (let i = 0; i < s.length; i++) {\n    let value = s.charCodeAt(i)\n    byte_arr.push(value & 255)\n    byte_arr.push((value >> 8) & 255)\n  }\n  return convertToFormattedHex(byte_arr)\n}\n\nexport const compressToBase64 = (input) => {\n  if (input == null) return ''\n  var output = ''\n  var chr1, chr2, chr3, enc1, enc2, enc3, enc4\n  var i = 0\n\n  input = compress(input)\n\n  while (i < input.length * 2) {\n\n    if (i % 2 == 0) {\n      chr1 = input.charCodeAt(i / 2) >> 8\n      chr2 = input.charCodeAt(i / 2) & 255\n      if (i / 2 + 1 < input.length)\n        chr3 = input.charCodeAt(i / 2 + 1) >> 8\n      else\n        chr3 = NaN\n    } else {\n      chr1 = input.charCodeAt((i - 1) / 2) & 255\n      if ((i + 1) / 2 < input.length) {\n        chr2 = input.charCodeAt((i + 1) / 2) >> 8\n        chr3 = input.charCodeAt((i + 1) / 2) & 255\n      } else\n        chr2 = chr3 = NaN\n    }\n    i += 3\n\n    enc1 = chr1 >> 2;\n    enc2 = ((chr1 & 3) << 4) | (chr2 >> 4)\n    enc3 = ((chr2 & 15) << 2) | (chr3 >> 6)\n    enc4 = chr3 & 63\n\n    if (isNaN(chr2)) {\n      enc3 = enc4 = 64\n    } else if (isNaN(chr3)) {\n      enc4 = 64\n    }\n\n    output = output +\n      _keyStr.charAt(enc1) + _keyStr.charAt(enc2) +\n      _keyStr.charAt(enc3) + _keyStr.charAt(enc4)\n\n  }\n\n  return output\n}\n","\nimport { ARP_COOKIE, MAX_TRIES, OPTOUT_COOKIE_ENDSWITH, USEIP_KEY } from './constants'\nimport { isString, isValueValid } from './datatypes'\nimport { compressData } from './encoder'\nimport { StorageManager, $ct } from './storage'\nimport { addToURL } from './url'\n\nexport default class RequestDispatcher {\n  static logger\n  static device\n\n  // ANCHOR - Requests get fired from here\n  static #fireRequest (url, tries, skipARP, sendOULFlag) {\n    if (this.#dropRequestDueToOptOut()) {\n      this.logger.debug('req dropped due to optout cookie: ' + this.device.gcookie)\n      return\n    }\n\n    // set a request in progress\n    // so that if gcookie is not present, no other request can be made asynchronusly\n    if (!isValueValid(this.device.gcookie)) {\n      $ct.blockRequest = true\n    }\n    /**\n     * if the gcookie is null\n     * and the request is not the first request\n     * and the tries are less than max tries\n     * keep retrying\n     */\n    if (!isValueValid(this.device.gcookie) &&\n      ($ct.globalCache.RESP_N < $ct.globalCache.REQ_N - 1) &&\n      tries < MAX_TRIES) {\n      // if ongoing First Request is in progress, initiate retry\n      setTimeout(() => {\n        this.logger.debug(`retrying fire request for url: ${url}, tries: ${tries}`)\n        this.#fireRequest(url, tries + 1, skipARP, sendOULFlag)\n      }, 50)\n      return\n    }\n\n    // set isOULInProgress to true\n    // when sendOULFlag is set to true\n    if (!sendOULFlag) {\n      if (isValueValid(this.device.gcookie)) {\n        // add gcookie to url\n        url = addToURL(url, 'gc', this.device.gcookie)\n      }\n      url = this.#addARPToRequest(url, skipARP)\n    } else {\n      window.isOULInProgress = true\n    }\n\n    url = addToURL(url, 'tries', tries) // Add tries to URL\n\n    url = this.#addUseIPToRequest(url)\n    url = addToURL(url, 'r', new Date().getTime()) // add epoch to beat caching of the URL\n    // TODO: Figure out a better way to handle plugin check\n    if (window.clevertap?.hasOwnProperty('plugin') || window.wizrocket?.hasOwnProperty('plugin')) {\n      // used to add plugin name in request parameter\n      const plugin = window.clevertap.plugin || window.wizrocket.plugin\n      url = addToURL(url, 'ct_pl', plugin)\n    }\n    if (url.indexOf('chrome-extension:') !== -1) {\n      url = url.replace('chrome-extension:', 'https:')\n    }\n    // TODO: Try using Function constructor instead of appending script.\n    var ctCbScripts = document.getElementsByClassName('ct-jp-cb')\n    while (ctCbScripts[0] && ctCbScripts[0].parentNode) {\n      ctCbScripts[0].parentNode.removeChild(ctCbScripts[0])\n    }\n    const s = document.createElement('script')\n    s.setAttribute('type', 'text/javascript')\n    s.setAttribute('src', url)\n    s.setAttribute('class', 'ct-jp-cb')\n    s.setAttribute('rel', 'nofollow')\n    s.async = true\n    document.getElementsByTagName('head')[0].appendChild(s)\n    this.logger.debug('req snt -> url: ' + url)\n  }\n\n  /**\n   *\n   * @param {string} url\n   * @param {*} skipARP\n   * @param {boolean} sendOULFlag\n   */\n  static fireRequest (url, skipARP, sendOULFlag) {\n    this.#fireRequest(url, 1, skipARP, sendOULFlag)\n  }\n\n  static #dropRequestDueToOptOut () {\n    if ($ct.isOptInRequest || !isValueValid(this.device.gcookie) || !isString(this.device.gcookie)) {\n      $ct.isOptInRequest = false\n      return false\n    }\n    return this.device.gcookie.slice(-3) === OPTOUT_COOKIE_ENDSWITH\n  }\n\n  static #addUseIPToRequest (pageLoadUrl) {\n    var useIP = StorageManager.getMetaProp(USEIP_KEY)\n    if (typeof useIP !== 'boolean') {\n      useIP = false\n    }\n    return addToURL(pageLoadUrl, USEIP_KEY, useIP ? 'true' : 'false')\n  };\n\n  static #addARPToRequest (url, skipResARP) {\n    if (skipResARP === true) {\n      const _arp = {}\n      _arp.skipResARP = true\n      return addToURL(url, 'arp', compressData(JSON.stringify(_arp), this.logger))\n    }\n    if (StorageManager._isLocalStorageSupported() && typeof localStorage.getItem(ARP_COOKIE) !== 'undefined' && localStorage.getItem(ARP_COOKIE) !== null) {\n      return addToURL(url, 'arp', compressData(JSON.stringify(StorageManager.readFromLSorCookie(ARP_COOKIE)), this.logger))\n    }\n    return url\n  }\n}\n","// CleverTap specific utilities\n\nimport {\n  StorageManager,\n  $ct\n} from './storage'\nimport {\n  CAMP_COOKIE_NAME,\n  singleQuoteRegex,\n  PR_COOKIE,\n  ARP_COOKIE,\n  GCOOKIE_NAME,\n  IS_OUL,\n  categoryLongKey,\n  CAMP_COOKIE_G\n} from './constants'\nimport {\n  GENDER_ERROR,\n  EMPLOYED_ERROR,\n  MARRIED_ERROR,\n  EDUCATION_ERROR,\n  AGE_ERROR,\n  DOB_ERROR,\n  PHONE_FORMAT_ERROR,\n  ENUM_FORMAT_ERROR\n} from './messages'\nimport {\n  getToday,\n  convertToWZRKDate,\n  setDate,\n  getNow\n} from './datetime'\nimport {\n  isObject,\n  isDateObject,\n  isConvertibleToNumber,\n  isObjectEmpty,\n  isString,\n  isNumber,\n  isValueValid\n} from './datatypes'\n\nimport { addToURL, getURLParams } from './url'\nimport { compressData } from './encoder'\nimport RequestDispatcher from './requestDispatcher'\n\nexport const getCampaignObject = () => {\n  let finalcampObj = {}\n  if (StorageManager._isLocalStorageSupported()) {\n    let campObj = StorageManager.read(CAMP_COOKIE_NAME)\n    if (campObj != null) {\n      campObj = JSON.parse(decodeURIComponent(campObj).replace(singleQuoteRegex, '\\\"'))\n      if (campObj.hasOwnProperty('global')) {\n        finalcampObj.wp = campObj\n      } else {\n        finalcampObj = campObj\n      }\n    } else {\n      finalcampObj = {}\n    }\n  }\n  return finalcampObj\n}\n\nexport const saveCampaignObject = (campaignObj) => {\n  if (StorageManager._isLocalStorageSupported()) {\n    const newObj = { ...getCampaignObject(), ...campaignObj }\n    const campObj = JSON.stringify(newObj)\n    StorageManager.save(CAMP_COOKIE_NAME, encodeURIComponent(campObj))\n    // Update the CAMP_COOKIE_G to be in sync with CAMP_COOKIE_NAME\n    setCampaignObjectForGuid()\n  }\n}\n\n// set Campaign Object against the guid, with daily count and total count details\nexport const setCampaignObjectForGuid = () => {\n  if (StorageManager._isLocalStorageSupported()) {\n    let guid = StorageManager.read(GCOOKIE_NAME)\n    if (isValueValid(guid)) {\n      try {\n        guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n        const guidCampObj = StorageManager.read(CAMP_COOKIE_G) ? JSON.parse(decodeURIComponent(StorageManager.read(CAMP_COOKIE_G))) : {}\n        if (guid && StorageManager._isLocalStorageSupported()) {\n          var finalCampObj = {}\n          var campObj = getCampaignObject()\n          Object.keys(campObj).forEach(key => {\n            const campKeyObj = (guid in guidCampObj && Object.keys(guidCampObj[guid]).length && guidCampObj[guid][key]) ? guidCampObj[guid][key] : {}\n            const globalObj = campObj[key].global\n            const today = getToday()\n            const dailyObj = campObj[key][today]\n            if (typeof globalObj !== 'undefined') {\n              const campaignIdArray = Object.keys(globalObj)\n              for (const index in campaignIdArray) {\n                let resultObj = []\n                if (campaignIdArray.hasOwnProperty(index)) {\n                  let dailyC = 0\n                  let totalC = 0\n                  const campaignId = campaignIdArray[index]\n                  if (campaignId === 'tc') {\n                    continue\n                  }\n                  if (typeof dailyObj !== 'undefined' && typeof dailyObj[campaignId] !== 'undefined') {\n                    dailyC = dailyObj[campaignId]\n                  }\n                  if (typeof globalObj !== 'undefined' && typeof globalObj[campaignId] !== 'undefined') {\n                    totalC = globalObj[campaignId]\n                  }\n                  resultObj = [campaignId, dailyC, totalC]\n                  campKeyObj[campaignId] = resultObj\n                }\n              }\n            }\n            finalCampObj = { ...finalCampObj, [key]: campKeyObj }\n          })\n          guidCampObj[guid] = finalCampObj\n          StorageManager.save(CAMP_COOKIE_G, encodeURIComponent(JSON.stringify(guidCampObj)))\n        }\n      } catch (e) {\n        console.error('Invalid clevertap Id ' + e)\n      }\n    }\n  }\n}\nexport const getCampaignObjForLc = () => {\n  // before preparing data to send to LC , check if the entry for the guid is already there in CAMP_COOKIE_G\n  const guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n\n  let campObj = {}\n  if (StorageManager._isLocalStorageSupported()) {\n    let resultObj = {}\n    campObj = getCampaignObject()\n    const storageValue = StorageManager.read(CAMP_COOKIE_G)\n    const decodedValue = storageValue ? decodeURIComponent(storageValue) : null\n    const parsedValue = decodedValue ? JSON.parse(decodedValue) : null\n\n    const resultObjWP = (!!guid &&\n                        storageValue !== undefined && storageValue !== null &&\n                        parsedValue && parsedValue[guid] && parsedValue[guid].wp)\n      ? Object.values(parsedValue[guid].wp)\n      : []\n\n    const resultObjWI = (!!guid &&\n                        storageValue !== undefined && storageValue !== null &&\n                        parsedValue && parsedValue[guid] && parsedValue[guid].wi)\n      ? Object.values(parsedValue[guid].wi)\n      : []\n\n    const today = getToday()\n    let todayCwp = 0\n    let todayCwi = 0\n    if (campObj.wp && campObj.wp[today] && campObj.wp[today].tc !== 'undefined') {\n      todayCwp = campObj.wp[today].tc\n    }\n    if (campObj.wi && campObj.wi[today] && campObj.wi[today].tc !== 'undefined') {\n      todayCwi = campObj.wi[today].tc\n    }\n    resultObj = {\n      wmp: todayCwp,\n      wimp: todayCwi,\n      tlc: resultObjWP,\n      witlc: resultObjWI\n    }\n    return resultObj\n  }\n}\n\nexport const isProfileValid = (profileObj, { logger }) => {\n  let valid = false\n  if (isObject(profileObj)) {\n    for (const profileKey in profileObj) {\n      if (profileObj.hasOwnProperty(profileKey)) {\n        valid = true\n        let profileVal = profileObj[profileKey]\n\n        if (profileVal == null) {\n          delete profileObj[profileKey]\n          continue\n        }\n        if (profileKey === 'Gender' && !profileVal.match(/^M$|^F$/)) {\n          valid = false\n          logger.error(GENDER_ERROR)\n        }\n\n        if (profileKey === 'Employed' && !profileVal.match(/^Y$|^N$/)) {\n          valid = false\n          logger.error(EMPLOYED_ERROR)\n        }\n\n        if (profileKey === 'Married' && !profileVal.match(/^Y$|^N$/)) {\n          valid = false\n          logger.error(MARRIED_ERROR)\n        }\n\n        if (profileKey === 'Education' && !profileVal.match(/^School$|^College$|^Graduate$/)) {\n          valid = false\n          logger.error(EDUCATION_ERROR)\n        }\n\n        if (profileKey === 'Age' && profileVal != null) {\n          if (isConvertibleToNumber(profileVal)) {\n            profileObj.Age = +profileVal\n          } else {\n            valid = false\n            logger.error(AGE_ERROR)\n          }\n        }\n        // dob will come in like this - $dt_19470815 or dateObject\n        if (profileKey === 'DOB') {\n          if (((!(/^\\$D_/).test(profileVal) || (profileVal + '').length !== 11)) && !isDateObject(profileVal)) {\n            valid = false\n            logger.error(DOB_ERROR)\n          }\n\n          if (isDateObject(profileVal)) {\n            profileObj[profileKey] = convertToWZRKDate(profileVal)\n          }\n        } else if (isDateObject(profileVal)) {\n          profileObj[profileKey] = convertToWZRKDate(profileVal)\n        }\n\n        if (profileKey === 'Phone' && !isObjectEmpty(profileVal)) {\n          if (profileVal.length > 8 && (profileVal.charAt(0) === '+')) { // valid phone number\n            profileVal = profileVal.substring(1, profileVal.length)\n            if (isConvertibleToNumber(profileVal)) {\n              profileObj.Phone = +profileVal\n            } else {\n              valid = false\n              logger.error(PHONE_FORMAT_ERROR + '. Removed.')\n            }\n          } else {\n            valid = false\n            logger.error(PHONE_FORMAT_ERROR + '. Removed.')\n          }\n        }\n\n        if (!valid) {\n          delete profileObj[profileKey]\n        }\n      }\n    }\n  }\n  return valid\n}\n\nexport const processFBUserObj = (user) => {\n  const profileData = {}\n  profileData.Name = user.name\n  if (user.id != null) {\n    profileData.FBID = user.id + ''\n  }\n  // Feb 2014 - FB announced over 58 gender options, hence we specifically look for male or female. Rest we don't care.\n  if (user.gender === 'male') {\n    profileData.Gender = 'M'\n  } else if (user.gender === 'female') {\n    profileData.Gender = 'F'\n  } else {\n    profileData.Gender = 'O'\n  }\n\n  const getHighestEducation = function (eduArr) {\n    if (eduArr != null) {\n      let college = ''\n      let highschool = ''\n\n      for (let i = 0; i < eduArr.length; i++) {\n        const edu = eduArr[i]\n        if (edu.type != null) {\n          const type = edu.type\n          if (type === 'Graduate School') {\n            return 'Graduate'\n          } else if (type === 'College') {\n            college = '1'\n          } else if (type === 'High School') {\n            highschool = '1'\n          }\n        }\n      }\n\n      if (college === '1') {\n        return 'College'\n      } else if (highschool === '1') {\n        return 'School'\n      }\n    }\n  }\n\n  if (user.relationship_status != null) {\n    profileData.Married = 'N'\n    if (user.relationship_status === 'Married') {\n      profileData.Married = 'Y'\n    }\n  }\n\n  const edu = getHighestEducation(user.education)\n  if (edu != null) {\n    profileData.Education = edu\n  }\n\n  const work = (user.work != null) ? user.work.length : 0\n  if (work > 0) {\n    profileData.Employed = 'Y'\n  } else {\n    profileData.Employed = 'N'\n  }\n\n  if (user.email != null) {\n    profileData.Email = user.email\n  }\n\n  if (user.birthday != null) {\n    const mmddyy = user.birthday.split('/') // comes in as \"08/15/1947\"\n    profileData.DOB = setDate(mmddyy[2] + mmddyy[0] + mmddyy[1])\n  }\n  return profileData\n}\n\nexport const processGPlusUserObj = (user, { logger }) => {\n  const profileData = {}\n  if (user.displayName != null) {\n    profileData.Name = user.displayName\n  }\n  if (user.id != null) {\n    profileData.GPID = user.id + ''\n  }\n\n  if (user.gender != null) {\n    if (user.gender === 'male') {\n      profileData.Gender = 'M'\n    } else if (user.gender === 'female') {\n      profileData.Gender = 'F'\n    } else if (user.gender === 'other') {\n      profileData.Gender = 'O'\n    }\n  }\n\n  if (user.image != null) {\n    if (user.image.isDefault === false) {\n      profileData.Photo = user.image.url.split('?sz')[0]\n    }\n  }\n\n  if (user.emails != null) {\n    for (let emailIdx = 0; emailIdx < user.emails.length; emailIdx++) {\n      const emailObj = user.emails[emailIdx]\n      if (emailObj.type === 'account') {\n        profileData.Email = emailObj.value\n      }\n    }\n  }\n\n  if (user.organizations != null) {\n    profileData.Employed = 'N'\n    for (let i = 0; i < user.organizations.length; i++) {\n      const orgObj = user.organizations[i]\n      if (orgObj.type === 'work') {\n        profileData.Employed = 'Y'\n      }\n    }\n  }\n\n  if (user.birthday != null) {\n    const yyyymmdd = user.birthday.split('-') // comes in as \"1976-07-27\"\n    profileData.DOB = setDate(yyyymmdd[0] + yyyymmdd[1] + yyyymmdd[2])\n  }\n\n  if (user.relationshipStatus != null) {\n    profileData.Married = 'N'\n    if (user.relationshipStatus === 'married') {\n      profileData.Married = 'Y'\n    }\n  }\n  logger.debug('gplus usr profile ' + JSON.stringify(profileData))\n\n  return profileData\n}\n\nexport const addToLocalProfileMap = (profileObj, override) => {\n  if (StorageManager._isLocalStorageSupported()) {\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n      if ($ct.globalProfileMap == null) {\n        $ct.globalProfileMap = {}\n      }\n    }\n\n    // Move props from custom bucket to outside.\n    if (profileObj._custom != null) {\n      const keys = profileObj._custom\n      for (const key in keys) {\n        if (keys.hasOwnProperty(key)) {\n          profileObj[key] = keys[key]\n        }\n      }\n      delete profileObj._custom\n    }\n\n    for (const prop in profileObj) {\n      if (profileObj.hasOwnProperty(prop)) {\n        if ($ct.globalProfileMap.hasOwnProperty(prop) && !override) {\n          continue\n        }\n        $ct.globalProfileMap[prop] = profileObj[prop]\n      }\n    }\n    if ($ct.globalProfileMap._custom != null) {\n      delete $ct.globalProfileMap._custom\n    }\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n  }\n}\n\nexport const closeIframe = (campaignId, divIdIgnored, currentSessionId) => {\n  if (campaignId != null && campaignId !== '-1') {\n    if (StorageManager._isLocalStorageSupported()) {\n      const campaignObj = getCampaignObject()\n\n      let sessionCampaignObj = campaignObj.wp[currentSessionId]\n      if (sessionCampaignObj == null) {\n        sessionCampaignObj = {}\n        campaignObj[currentSessionId] = sessionCampaignObj\n      }\n      sessionCampaignObj[campaignId] = 'dnd'\n      saveCampaignObject(campaignObj)\n    }\n  }\n  if ($ct.campaignDivMap != null) {\n    const divId = $ct.campaignDivMap[campaignId]\n    if (divId != null) {\n      document.getElementById(divId).style.display = 'none'\n      if (divId === 'intentPreview') {\n        if (document.getElementById('intentOpacityDiv') != null) {\n          document.getElementById('intentOpacityDiv').style.display = 'none'\n        }\n      }\n    }\n  }\n}\n\nexport const arp = (jsonMap) => {\n  // For unregister calls dont set arp in LS\n  if (jsonMap.skipResARP != null && jsonMap.skipResARP) {\n    console.debug('Update ARP Request rejected', jsonMap)\n    return null\n  }\n\n  const isOULARP = jsonMap[IS_OUL] === true\n\n  if (StorageManager._isLocalStorageSupported()) {\n    // Update arp only if it is null or an oul request\n    try {\n      let arpFromStorage = StorageManager.readFromLSorCookie(ARP_COOKIE)\n      if (arpFromStorage == null || isOULARP) {\n        arpFromStorage = {}\n        for (const key in jsonMap) {\n          if (jsonMap.hasOwnProperty(key)) {\n            if (jsonMap[key] === -1) {\n              delete arpFromStorage[key]\n            } else {\n              arpFromStorage[key] = jsonMap[key]\n            }\n          }\n        }\n        StorageManager.saveToLSorCookie(ARP_COOKIE, arpFromStorage)\n      }\n    } catch (e) {\n      console.error('Unable to parse ARP JSON: ' + e)\n    }\n  }\n}\n\nexport const getWrappedLink = (link, targetId, type, request, account, logger) => {\n  let data = {}\n  data.sendTo = link\n  data.targetId = targetId\n  data.epoch = getNow()\n\n  if (type != null) {\n    data.type = type\n  } else {\n    data.type = 'view'\n  }\n\n  data = request.addSystemDataToObject(data, undefined)\n  return addToURL(account.recorderURL, 'd', compressData(JSON.stringify(data), logger))\n}\n\nexport const getMessageTemplate = () => {\n  return `<div class=\"notice-message\">\n    <a href=\"[RECORDER_HREF]\" class=\"box\">\n      <div class=\"avatar\"><span class=\"fa [ICON] fa-4x fa-fw\"></span></div>\n      <div class=\"info\">\n        <div class=\"title\">[TITLE]</div>\n        <div class=\"clearfix\"></div>\n        <div class=\"text\">[TEXT]</div>\n      </div>\n      <div class=\"clearfix\"></div>\n    </a>\n  </div>\n  <div class=\"clearfix\"></div>`\n}\n\nexport const getMessageHeadTemplate = () => {\n  return `<head>\n    <base target=\"_parent\" />\n    <link rel=\"stylesheet\" href=\"http://static.clevertap.com/fa/font-awesome.css\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <style>\n    [STYLE]\n    </style>\n  </head>`\n}\n\nexport const setEnum = (enumVal, logger) => {\n  if (isString(enumVal) || isNumber(enumVal)) {\n    return '$E_' + enumVal\n  }\n  logger.error(ENUM_FORMAT_ERROR)\n}\nexport const handleEmailSubscription = (subscription, reEncoded, fetchGroups, account, logger) => {\n  const urlParamsAsIs = getURLParams(location.href) // can't use url_params as it is in lowercase above\n  const encodedEmailId = urlParamsAsIs.e\n  const encodedProfileProps = urlParamsAsIs.p\n\n  if (typeof encodedEmailId !== 'undefined') {\n    const data = {}\n    data.id = account.id // accountId\n    data.unsubGroups = $ct.unsubGroups // unsubscribe groups\n\n    if ($ct.updatedCategoryLong) {\n      data[categoryLongKey] = $ct.updatedCategoryLong\n    }\n\n    let url = account.emailURL\n    if (fetchGroups) {\n      url = addToURL(url, 'fetchGroups', fetchGroups)\n    }\n    if (reEncoded) {\n      url = addToURL(url, 'encoded', reEncoded)\n    }\n    url = addToURL(url, 'e', encodedEmailId)\n    url = addToURL(url, 'd', compressData(JSON.stringify(data), logger))\n    if (encodedProfileProps) {\n      url = addToURL(url, 'p', encodedProfileProps)\n    }\n\n    if (subscription !== '-1') {\n      url = addToURL(url, 'sub', subscription)\n    }\n    RequestDispatcher.fireRequest(url)\n  }\n}\n","import {\n  isObjectEmpty\n} from '../util/datatypes'\nimport {\n  isProfileValid,\n  processFBUserObj,\n  processGPlusUserObj,\n  addToLocalProfileMap\n} from '../util/clevertap'\nimport {\n  COMMAND_DELETE,\n  COMMAND_INCREMENT,\n  EVT_PUSH,\n  PR_COOKIE\n} from '../util/constants'\nimport {\n  addToURL\n} from '../util/url'\nimport {\n  StorageManager,\n  $ct\n} from '../util/storage'\nimport { compressData } from '../util/encoder'\nexport default class ProfileHandler extends Array {\n  #logger\n  #request\n  #account\n  #oldValues\n  #isPersonalisationActive\n\n  constructor ({\n    logger,\n    request,\n    account,\n    isPersonalisationActive\n  }, values) {\n    super()\n    this.#logger = logger\n    this.#request = request\n    this.#account = account\n    this.#oldValues = values\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  push (...profilesArr) {\n    this.#processProfileArray(profilesArr)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processProfileArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  getAttribute (propName) {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n    }\n    if ($ct.globalProfileMap != null) {\n      return $ct.globalProfileMap[propName]\n    }\n  }\n\n  #processProfileArray (profileArr) {\n    if (Array.isArray(profileArr) && profileArr.length > 0) {\n      for (const index in profileArr) {\n        if (profileArr.hasOwnProperty(index)) {\n          const outerObj = profileArr[index]\n          let data = {}\n          let profileObj\n          if (outerObj.Site != null) { // organic data from the site\n            profileObj = outerObj.Site\n            if (isObjectEmpty(profileObj) || !isProfileValid(profileObj, {\n              logger: this.#logger\n            })) {\n              return\n            }\n          } else if (outerObj.Facebook != null) { // fb connect data\n            const FbProfileObj = outerObj.Facebook\n            // make sure that the object contains any data at all\n\n            if (!isObjectEmpty(FbProfileObj) && (!FbProfileObj.error)) {\n              profileObj = processFBUserObj(FbProfileObj)\n            }\n          } else if (outerObj['Google Plus'] != null) {\n            const GPlusProfileObj = outerObj['Google Plus']\n            if (!isObjectEmpty(GPlusProfileObj) && (!GPlusProfileObj.error)) {\n              profileObj = processGPlusUserObj(GPlusProfileObj, { logger: this.#logger })\n            }\n          }\n          if (profileObj != null && (!isObjectEmpty(profileObj))) { // profile got set from above\n            data.type = 'profile'\n            if (profileObj.tz == null) {\n              // try to auto capture user timezone if not present\n              profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n            }\n\n            data.profile = profileObj\n            addToLocalProfileMap(profileObj, true)\n            data = this.#request.addSystemDataToObject(data, undefined)\n\n            this.#request.addFlags(data)\n            const compressedData = compressData(JSON.stringify(data), this.#logger)\n\n            let pageLoadUrl = this.#account.dataPostURL\n            pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n            pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n            this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   *\n   * @param {any} key\n   * @param {number} value\n   * @param {string} command\n   * increases or decreases value of the number type properties in profile object\n   */\n  _handleIncrementDecrementValue (key, value, command) {\n    // Check if the value is greater than 0\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n    }\n    if ($ct.globalProfileMap == null && !$ct.globalProfileMap?.hasOwnProperty(key)) {\n      // Check if the profile map already has the propery defined\n      console.error('Kindly create profile with required proprty to increment/decrement.')\n    } else if (!value || typeof value !== 'number' || value <= 0) {\n      console.error('Value should be a number greater than 0')\n    } else {\n      // Update the profile property in local storage\n      if (command === COMMAND_INCREMENT) {\n        $ct.globalProfileMap[key] = $ct.globalProfileMap[key] + value\n      } else {\n        $ct.globalProfileMap[key] = $ct.globalProfileMap[key] - value\n      }\n      StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n\n      // Send the updated value to LC\n      let data = {}\n      const profileObj = {}\n      data.type = 'profile'\n      profileObj[key] = { [command]: value }\n      if (profileObj.tz == null) {\n        // try to auto capture user timezone if not present\n        profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n      }\n      data.profile = profileObj\n      data = this.#request.addSystemDataToProfileObject(data, undefined)\n\n      this.#request.addFlags(data)\n      const compressedData = compressData(JSON.stringify(data), this.#logger)\n      let pageLoadUrl = this.#account.dataPostURL\n      pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n      pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n      this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n    }\n  }\n\n  /**\n   *\n   * @param {any} key\n   * @param {array} arrayVal\n   * @param {string} command\n   * overwrites/sets new value(s) against a key/property in profile object\n   */\n  _handleMultiValueSet (key, arrayVal, command) {\n    const array = []\n    for (let i = 0; i < arrayVal.length; i++) {\n      if (typeof arrayVal[i] === 'number' && !array.includes(arrayVal[i])) {\n        array.push(arrayVal[i])\n      } else if (typeof arrayVal[i] === 'string' && !array.includes(arrayVal[i].toLowerCase())) {\n        array.push(arrayVal[i].toLowerCase())\n      } else {\n        console.error('array supports only string or number type values')\n      }\n    }\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE) ?? {}\n    }\n    $ct.globalProfileMap[key] = array\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n    this.sendMultiValueData(key, arrayVal, command)\n  }\n\n  /**\n   *\n   * @param {any} propKey - the property name to be added in the profile object\n   * @param {string, number, array} propVal - the property value to be added against the @propkey key\n   * @param {string} command\n   * Adds array or single value against a key/property in profile object\n   */\n  _handleMultiValueAdd (propKey, propVal, command) {\n    var array = []\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE) ?? {}\n    }\n    // if the value to be set is either string or number\n    if (typeof propVal === 'string' || typeof propVal === 'number') {\n      if ($ct.globalProfileMap.hasOwnProperty(propKey)) {\n        array = $ct.globalProfileMap[propKey]\n        typeof propVal === 'number' ? array.push(propVal) : array.push(propVal.toLowerCase())\n      } else {\n        $ct.globalProfileMap[propKey] = propVal\n      }\n      // if propVal is an array\n    } else {\n      if ($ct.globalProfileMap.hasOwnProperty(propKey)) {\n        array = $ct.globalProfileMap[propKey]\n      }\n      /**\n       * checks for case sensitive inputs and filters the same ones\n       */\n      for (var i = 0; i < propVal.length; i++) {\n        if (typeof propVal[i] === 'number' && !array.includes(propVal[i])) {\n          array.push(propVal[i])\n        } else if (typeof propVal[i] === 'string' && !array.includes(propVal[i].toLowerCase())) {\n          array.push(propVal[i].toLowerCase())\n        } else if ((typeof propVal[i] === 'number' && array.includes(propVal[i])) || (typeof propVal[i] === 'string' && array.includes(propVal[i].toLowerCase()))) {\n          console.error('Values already included')\n        } else {\n          console.error('array supports only string or number type values')\n        }\n      }\n      $ct.globalProfileMap[propKey] = array\n    }\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n    this.sendMultiValueData(propKey, propVal, command)\n  }\n\n  /**\n   *\n   * @param {any} propKey\n   * @param {string, number, array} propVal\n   * @param {string} command\n   * removes value(s) against a key/property in profile object\n   */\n  _handleMultiValueRemove (propKey, propVal, command) {\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n    }\n    if (!$ct?.globalProfileMap?.hasOwnProperty(propKey)) {\n      console.error(`The property ${propKey} does not exist.`)\n    } else {\n      if (typeof propVal === 'string' || typeof propVal === 'number') {\n        var index = $ct.globalProfileMap[propKey].indexOf(propVal)\n        if (index !== -1) {\n          $ct.globalProfileMap[propKey].splice(index, 1)\n        }\n      } else {\n        for (var k = 0; k < propVal.length; k++) {\n          var idx = $ct.globalProfileMap[propKey].indexOf(propVal[k])\n          if (idx !== -1) {\n            $ct.globalProfileMap[propKey].splice(idx, 1)\n          }\n        }\n      }\n    }\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n    this.sendMultiValueData(propKey, propVal, command)\n  }\n\n  /**\n   *\n   * @param {any} propKey\n   * @param {string} command\n   * deletes a key value pair from the profile object\n   */\n  _handleMultiValueDelete (propKey, command) {\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n    }\n    if (!$ct?.globalProfileMap?.hasOwnProperty(propKey)) {\n      console.error(`The property ${propKey} does not exist.`)\n    } else {\n      delete $ct.globalProfileMap[propKey]\n    }\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n    this.sendMultiValueData(propKey, null, command)\n  }\n\n  sendMultiValueData (propKey, propVal, command) {\n    // Send the updated value to LC\n    let data = {}\n    const profileObj = {}\n    data.type = 'profile'\n\n    // this removes the property at backend\n    profileObj[propKey] = { [command]: command === COMMAND_DELETE ? true : propVal }\n    if (profileObj.tz == null) {\n      profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n    }\n    data.profile = profileObj\n    data = this.#request.addSystemDataToProfileObject(data, undefined)\n    this.#request.addFlags(data)\n    const compressedData = compressData(JSON.stringify(data), this.#logger)\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n    this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n  }\n}\n","import {\n  isObject,\n  isObjectEmpty\n} from '../util/datatypes'\nimport {\n  KCOOKIE_NAME,\n  GCOOKIE_NAME,\n  EVT_PUSH,\n  LRU_CACHE_SIZE,\n  IS_OUL,\n  CAMP_COOKIE_NAME,\n  CHARGEDID_COOKIE_NAME,\n  PR_COOKIE,\n  EV_COOKIE,\n  ARP_COOKIE,\n  CLEAR,\n  META_COOKIE,\n  FIRE_PUSH_UNREGISTERED\n} from '../util/constants'\nimport {\n  StorageManager,\n  $ct\n} from '../util/storage'\nimport LRUCache from '../util/lruCache'\nimport {\n  compressData\n} from '../util/encoder'\nimport {\n  addToURL,\n  getHostName\n} from '../util/url'\nimport {\n  isProfileValid,\n  processFBUserObj,\n  processGPlusUserObj,\n  addToLocalProfileMap\n} from '../util/clevertap'\n\nexport default class UserLoginHandler extends Array {\n  #request\n  #logger\n  #account\n  #session\n  #oldValues\n  #device\n\n  constructor ({\n    request,\n    account,\n    session,\n    logger,\n    device\n  },\n  values) {\n    super()\n    this.#request = request\n    this.#account = account\n    this.#session = session\n    this.#logger = logger\n    this.#oldValues = values\n    this.#device = device\n  }\n\n  // On User Login\n  #processOUL (profileArr) {\n    let sendOULFlag = true\n    StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, sendOULFlag)\n    const addToK = (ids) => {\n      let k = StorageManager.readFromLSorCookie(KCOOKIE_NAME)\n      const g = StorageManager.readFromLSorCookie(GCOOKIE_NAME)\n      let kId\n      if (k == null) {\n        k = {}\n        kId = ids\n      } else {\n        /* check if already exists */\n        kId = k.id\n        let anonymousUser = false\n        let foundInCache = false\n        if (kId == null) {\n          kId = ids[0]\n          anonymousUser = true\n        }\n        if ($ct.LRU_CACHE == null && StorageManager._isLocalStorageSupported()) {\n          $ct.LRU_CACHE = new LRUCache(LRU_CACHE_SIZE)\n        }\n\n        if (anonymousUser) {\n          if ((g) != null) {\n            // if have gcookie\n            $ct.LRU_CACHE.set(kId, g)\n            $ct.blockRequest = false\n          }\n        } else {\n          // check if the id is present in the cache\n          // set foundInCache to true\n          for (const idx in ids) {\n            if (ids.hasOwnProperty(idx)) {\n              const id = ids[idx]\n              if ($ct.LRU_CACHE.cache[id]) {\n                kId = id\n                foundInCache = true\n                break\n              }\n            }\n          }\n        }\n\n        if (foundInCache) {\n          if (kId !== $ct.LRU_CACHE.getLastKey()) {\n            // New User found\n            // remove the entire cache\n            this.#handleCookieFromCache()\n          } else {\n            sendOULFlag = false\n            StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, sendOULFlag)\n          }\n          const gFromCache = $ct.LRU_CACHE.get(kId)\n          $ct.LRU_CACHE.set(kId, gFromCache)\n          StorageManager.saveToLSorCookie(GCOOKIE_NAME, gFromCache)\n          this.#device.gcookie = gFromCache\n\n          const lastK = $ct.LRU_CACHE.getSecondLastKey()\n          if (StorageManager.readFromLSorCookie(FIRE_PUSH_UNREGISTERED) && lastK !== -1) {\n            // CACHED OLD USER FOUND. TRANSFER PUSH TOKEN TO THIS USER\n            const lastGUID = $ct.LRU_CACHE.cache[lastK]\n            this.#request.unregisterTokenForGuid(lastGUID)\n          }\n        } else {\n          if (!anonymousUser) {\n            this.clear()\n          } else {\n            if ((g) != null) {\n              this.#device.gcookie = g\n              StorageManager.saveToLSorCookie(GCOOKIE_NAME, g)\n              sendOULFlag = false\n            }\n          }\n          StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, false)\n          kId = ids[0]\n        }\n      }\n      k.id = kId\n      StorageManager.saveToLSorCookie(KCOOKIE_NAME, k)\n    }\n\n    if (Array.isArray(profileArr) && profileArr.length > 0) {\n      for (const index in profileArr) {\n        if (profileArr.hasOwnProperty(index)) {\n          const outerObj = profileArr[index]\n          let data = {}\n          let profileObj\n          if (outerObj.Site != null) { // organic data from the site\n            profileObj = outerObj.Site\n            if (isObjectEmpty(profileObj) || !isProfileValid(profileObj, {\n              logger: this.#logger\n            })) {\n              return\n            }\n          } else if (outerObj.Facebook != null) { // fb connect data\n            const FbProfileObj = outerObj.Facebook\n            // make sure that the object contains any data at all\n\n            if (!isObjectEmpty(FbProfileObj) && (!FbProfileObj.error)) {\n              profileObj = processFBUserObj(FbProfileObj)\n            }\n          } else if (outerObj['Google Plus'] != null) {\n            const GPlusProfileObj = outerObj['Google Plus']\n            if (isObjectEmpty(GPlusProfileObj) && (!GPlusProfileObj.error)) {\n              profileObj = processGPlusUserObj(GPlusProfileObj, { logger: this.#logger })\n            }\n          }\n          if (profileObj != null && (!isObjectEmpty(profileObj))) { // profile got set from above\n            data.type = 'profile'\n            if (profileObj.tz == null) {\n              // try to auto capture user timezone if not present\n              profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n            }\n\n            data.profile = profileObj\n            const ids = []\n            if (StorageManager._isLocalStorageSupported()) {\n              if (profileObj.Identity) {\n                ids.push(profileObj.Identity)\n              }\n              if (profileObj.Email) {\n                ids.push(profileObj.Email)\n              }\n              if (profileObj.GPID) {\n                ids.push('GP:' + profileObj.GPID)\n              }\n              if (profileObj.FBID) {\n                ids.push('FB:' + profileObj.FBID)\n              }\n              if (ids.length > 0) {\n                addToK(ids)\n              }\n            }\n            addToLocalProfileMap(profileObj, true)\n            data = this.#request.addSystemDataToObject(data, undefined)\n\n            this.#request.addFlags(data)\n            // Adding 'isOUL' flag in true for OUL cases which.\n            // This flag tells LC to create a new arp object.\n            // Also we will receive the same flag in response arp which tells to delete existing arp object.\n            if (sendOULFlag) {\n              data[IS_OUL] = true\n            }\n            const compressedData = compressData(JSON.stringify(data), this.#logger)\n            let pageLoadUrl = this.#account.dataPostURL\n            pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n            pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n            // Whenever sendOULFlag is true then dont send arp and gcookie (guid in memory in the request)\n            // Also when this flag is set we will get another flag from LC in arp which tells us to delete arp\n            // stored in the cache and replace it with the response arp.\n\n            this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest, sendOULFlag)\n          }\n        }\n      }\n    }\n  }\n\n  clear () {\n    this.#logger.debug('clear called. Reset flag has been set.')\n    this.#deleteUser()\n    StorageManager.setMetaProp(CLEAR, true)\n  }\n\n  #handleCookieFromCache () {\n    $ct.blockRequest = false\n    console.debug('Block request is false')\n    if (StorageManager._isLocalStorageSupported()) {\n      delete localStorage[PR_COOKIE]\n      delete localStorage[EV_COOKIE]\n      delete localStorage[META_COOKIE]\n      delete localStorage[ARP_COOKIE]\n      delete localStorage[CAMP_COOKIE_NAME]\n      delete localStorage[CHARGEDID_COOKIE_NAME]\n    }\n    StorageManager.removeCookie(CAMP_COOKIE_NAME, getHostName())\n    StorageManager.removeCookie(this.#session.cookieName, $ct.broadDomain)\n    StorageManager.removeCookie(ARP_COOKIE, $ct.broadDomain)\n    this.#session.setSessionCookieObject('')\n  }\n\n  #deleteUser () {\n    $ct.blockRequest = true\n    this.#logger.debug('Block request is true')\n    $ct.globalCache = {\n      gcookie: null,\n      REQ_N: 0,\n      RESP_N: 0\n    }\n    if (StorageManager._isLocalStorageSupported()) {\n      delete localStorage[GCOOKIE_NAME]\n      delete localStorage[KCOOKIE_NAME]\n      delete localStorage[PR_COOKIE]\n      delete localStorage[EV_COOKIE]\n      delete localStorage[META_COOKIE]\n      delete localStorage[ARP_COOKIE]\n      delete localStorage[CAMP_COOKIE_NAME]\n      delete localStorage[CHARGEDID_COOKIE_NAME]\n    }\n    StorageManager.removeCookie(GCOOKIE_NAME, $ct.broadDomain)\n    StorageManager.removeCookie(CAMP_COOKIE_NAME, getHostName())\n    StorageManager.removeCookie(KCOOKIE_NAME, getHostName())\n    StorageManager.removeCookie(this.#session.cookieName, $ct.broadDomain)\n    StorageManager.removeCookie(ARP_COOKIE, $ct.broadDomain)\n    this.#device.gcookie = null\n    this.#session.setSessionCookieObject('')\n  }\n\n  #processLoginArray (loginArr) {\n    if (Array.isArray(loginArr) && loginArr.length > 0) {\n      const profileObj = loginArr.pop()\n      const processProfile = profileObj != null && isObject(profileObj) &&\n          ((profileObj.Site != null && Object.keys(profileObj.Site).length > 0) ||\n              (profileObj.Facebook != null && Object.keys(profileObj.Facebook).length > 0) ||\n              (profileObj['Google Plus'] != null && Object.keys(profileObj['Google Plus']).length > 0))\n      if (processProfile) {\n        StorageManager.setInstantDeleteFlagInK()\n        try {\n          this.#processOUL([profileObj])\n        } catch (e) {\n          this.#logger.debug(e)\n        }\n      } else {\n        this.#logger.error('Profile object is in incorrect format')\n      }\n    }\n  }\n\n  push (...profilesArr) {\n    this.#processLoginArray(profilesArr)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processLoginArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n}\n","export class CTWebPersonalisationBanner extends HTMLElement {\n  constructor () {\n    super()\n    this.shadow = this.attachShadow({ mode: 'open' })\n  }\n\n  _details = null\n  shadow = null\n\n  get details () {\n    return this._details || ''\n  }\n\n  set details (val) {\n    if (this._details === null) {\n      this._details = val\n      this.renderBanner()\n    }\n  }\n\n  renderBanner () {\n    this.shadow.innerHTML = this.getBannerContent()\n    if (this.trackClick !== false) {\n      this.addEventListener('click', () => {\n        const onClickUrl = this.details.onClick\n        if (onClickUrl) {\n          this.details.window ? window.open(onClickUrl, '_blank') : window.parent.location.href = onClickUrl\n        }\n        window.clevertap.renderNotificationClicked({ msgId: this.msgId, pivotId: this.pivotId })\n      })\n    }\n    window.clevertap.renderNotificationViewed({ msgId: this.msgId, pivotId: this.pivotId })\n  }\n\n  getBannerContent () {\n    return `\n      <style type=\"text/css\">\n        .banner {\n          position: relative;\n          cursor: ${this.details.onClick ? 'pointer' : ''}\n        }\n        img {\n          height: ${this.divHeight ? this.divHeight : 'auto'};\n          width: 100%;\n        }\n        .wrapper:is(.left, .right, .center) {\n          display: flex;\n          justify-content: center;\n          flex-direction: column;\n          align-items: center;\n          position: absolute;\n          width: 100%;\n          height: 100%;\n          overflow: auto;\n          top: 0;\n        }\n        ${this.details.css ? this.details.css : ''}\n      </style>\n      <div class=\"banner\">\n        <picture>\n          <source media=\"(min-width:480px)\" srcset=\"${this.details.desktopImageURL}\">\n          <source srcset=\"${this.details.mobileImageURL}\">\n          <img src=\"${this.details.desktopImageURL}\" alt=\"Please upload a picture\" style=\"width:100%;\" part=\"banner__img\">\n        </picture>\n        ${this.details.html ? this.details.html : ''}\n      </div>\n    `\n  }\n}\n","import { CTWebPersonalisationBanner } from './banner'\nexport class CTWebPersonalisationCarousel extends HTMLElement {\n  constructor () {\n    super()\n    this.shadow = this.attachShadow({ mode: 'open' })\n    if (customElements.get('ct-web-personalisation-banner') === undefined) {\n      customElements.define('ct-web-personalisation-banner', CTWebPersonalisationBanner)\n    }\n  }\n\n  _target = null\n  _carousel = null\n  shadow = null\n  slides = 0\n  previouslySelectedItem = -1\n  selectedItem = 1\n  autoSlide = null\n  stopAutoSlideTimeout = null\n\n  get target () {\n    return this._target || ''\n  }\n\n  set target (val) {\n    if (this._target === null) {\n      this._target = val\n      this.renderCarousel()\n    }\n  }\n\n  get details () {\n    return this.target.display.details\n  }\n\n  get display () {\n    return this.target.display\n  }\n\n  renderCarousel () {\n    this.slides = this.details.length\n    this.shadow.innerHTML = this.getStyles()\n    const carousel = this.getCarouselContent()\n    if (this.display.showNavBtns) {\n      carousel.insertAdjacentHTML('beforeend', this.display.navBtnsHtml)\n    }\n    if (this.display.showNavArrows) {\n      carousel.insertAdjacentHTML('beforeend', this.display.leftNavArrowHtml)\n      carousel.insertAdjacentHTML('beforeend', this.display.rightNavArrowHtml)\n    }\n    this._carousel = carousel\n    this.shadow.appendChild(carousel)\n    this.setupClick()\n    this.updateSelectedItem()\n    // TODO: enable conditionally\n    this.startAutoSlide()\n    this.setupOnHover()\n    window.clevertap.renderNotificationViewed({ msgId: this.target.wzrk_id, pivotId: this.target.wzrk_pivot })\n  }\n\n  setupClick () {\n    this._carousel.addEventListener('click', (event) => {\n      const eventID = event.target.id\n      if (eventID.startsWith('carousel__button')) {\n        const selected = +eventID.split('-')[1]\n        if (selected !== this.selectedItem) {\n          this.previouslySelectedItem = this.selectedItem\n          this.selectedItem = selected\n          this.updateSelectedItem()\n          this.startAutoSlide()\n        }\n      } else if (eventID.startsWith('carousel__arrow')) {\n        eventID.endsWith('right') ? this.goToNext() : this.goToPrev()\n        this.startAutoSlide()\n      } else if (eventID.indexOf('-') > -1) {\n        const item = +eventID.split('-')[1]\n        const index = item - 1\n        if (window.parent.clevertap) {\n          // console.log('Raise notification clicked event for ', item)\n          window.clevertap.renderNotificationClicked({ msgId: this.target.wzrk_id, pivotId: this.target.wzrk_pivot, wzrk_slideNo: item })\n        }\n        const url = this.details[index].onClick\n        if (url !== '') {\n          this.details[index].window ? window.open(url, '_blank') : window.location.href = url\n        }\n      }\n    })\n  }\n\n  setupOnHover () {\n    this._carousel.addEventListener('mouseenter', (event) => {\n      this.stopAutoSlideTimeout = setTimeout(() => {\n        this.autoSlide = clearInterval(this.autoSlide)\n      }, 500)\n    })\n\n    this._carousel.addEventListener('mouseleave', (event) => {\n      clearTimeout(this.stopAutoSlideTimeout)\n      if (this.autoSlide === undefined) {\n        this.startAutoSlide()\n      }\n    })\n  }\n\n  getCarouselContent () {\n    const carousel = document.createElement('div')\n    carousel.setAttribute('class', 'carousel')\n\n    this.details.forEach((detail, i) => {\n      const banner = document.createElement('ct-web-personalisation-banner')\n      banner.classList.add('carousel__item')\n      banner.trackClick = false\n      banner.setAttribute('id', `carousel__item-${i + 1}`)\n      banner.details = detail\n      carousel.appendChild(banner)\n    })\n\n    return carousel\n  }\n\n  getStyles () {\n    return `\n      <style>\n      .carousel {\n        position: relative;\n      }\n\n      .carousel__item {\n        background-color: grey;\n        display: none;\n        background-repeat: no-repeat;\n        background-size: cover;\n      }\n\n      ct-web-personalisation-banner::part(banner__img) {\n        height: ${this?.target?.display?.divHeight ? this.target.display.divHeight : 'auto'};\n        width: 100%;\n        transition: 2s;\n      }\n\n      .carousel__item--selected {\n        display: block;\n      }\n      ${this.display.navBtnsCss}\n      ${this.display.navArrowsCss}\n      </style>\n  `\n  }\n\n  updateSelectedItem () {\n    if (this.previouslySelectedItem !== -1) {\n      const prevItem = this.shadow.getElementById(`carousel__item-${this.previouslySelectedItem}`)\n      const prevButton = this.shadow.getElementById(`carousel__button-${this.previouslySelectedItem}`)\n      prevItem.classList.remove('carousel__item--selected')\n      prevButton.classList.remove('carousel__button--selected')\n    }\n    const item = this.shadow.getElementById(`carousel__item-${this.selectedItem}`)\n    const button = this.shadow.getElementById(`carousel__button-${this.selectedItem}`)\n    item.classList.add('carousel__item--selected')\n    button.classList.add('carousel__button--selected')\n  }\n\n  startAutoSlide () {\n    clearInterval(this.autoSlide)\n    this.autoSlide = setInterval(() => {\n      this.goToNext()\n    }, this.display.sliderTime ? this.display.sliderTime * 1000 : 3000)\n  }\n\n  goToNext () {\n    this.goTo(this.selectedItem, (this.selectedItem + 1) % this.slides)\n  }\n\n  goToPrev () {\n    this.goTo(this.selectedItem, this.selectedItem - 1)\n  }\n\n  goTo (prev, cur) {\n    this.previouslySelectedItem = prev\n    this.selectedItem = cur\n    if (cur === 0) {\n      this.selectedItem = this.slides\n    }\n    this.updateSelectedItem()\n  }\n}\n","import {\n  getCampaignObject,\n  saveCampaignObject\n} from '../clevertap'\nimport { StorageManager } from '../storage'\n\nexport class CTWebPopupImageOnly extends HTMLElement {\n  constructor () {\n    super()\n    this.shadow = this.attachShadow({ mode: 'open' })\n  }\n\n    _target = null\n    _session = null\n    shadow = null\n    popup = null\n    container = null\n\n    get target () {\n      return this._target || ''\n    }\n\n    set target (val) {\n      if (this._target === null) {\n        this._target = val\n        this.renderImageOnlyPopup()\n      }\n    }\n\n    get session () {\n      return this._session || ''\n    }\n\n    set session (val) {\n      this._session = val\n    }\n\n    get msgId () {\n      return this.target.wzrk_id\n    }\n\n    get pivotId () {\n      return this.target.wzrk_pivot\n    }\n\n    get onClickUrl () {\n      return this.target.display.onClickUrl\n    }\n\n    renderImageOnlyPopup () {\n      const campaignId = this.target.wzrk_id.split('_')[0]\n      const currentSessionId = this.session.sessionId\n\n      this.shadow.innerHTML = this.getImageOnlyPopupContent()\n      this.popup = this.shadowRoot.getElementById('imageOnlyPopup')\n      this.container = this.shadowRoot.getElementById('container')\n      this.closeIcon = this.shadowRoot.getElementById('close')\n\n      this.popup.addEventListener('load', this.updateImageAndContainerWidth())\n\n      this.closeIcon.addEventListener('click', () => {\n        document.getElementById('wzrkImageOnlyDiv').style.display = 'none'\n        this.remove()\n        if (campaignId != null && campaignId !== '-1') {\n          if (StorageManager._isLocalStorageSupported()) {\n            const campaignObj = getCampaignObject()\n\n            let sessionCampaignObj = campaignObj.wp[currentSessionId]\n            if (sessionCampaignObj == null) {\n              sessionCampaignObj = {}\n              campaignObj[currentSessionId] = sessionCampaignObj\n            }\n            sessionCampaignObj[campaignId] = 'dnd'\n            saveCampaignObject(campaignObj)\n          }\n        }\n      })\n\n      window.clevertap.renderNotificationViewed({ msgId: this.msgId, pivotId: this.pivotId })\n\n      if (this.onClickUrl) {\n        this.popup.addEventListener('click', () => {\n          this.target.display.window ? window.open(this.onClickUrl, '_blank') : window.parent.location.href = this.onClickUrl\n          window.clevertap.renderNotificationClicked({ msgId: this.msgId, pivotId: this.pivotId })\n        })\n      }\n    }\n\n    getImageOnlyPopupContent () {\n      return `\n        ${this.target.msgContent.css}\n        ${this.target.msgContent.html}\n      `\n    }\n\n    updateImageAndContainerWidth () {\n      return () => {\n        const width = this.getRenderedImageWidth(this.popup)\n        this.popup.style.setProperty('width', `${width}px`)\n        this.container.style.setProperty('width', `${width}px`)\n        this.container.style.setProperty('height', 'auto')\n        this.container.style.setProperty('position', 'fixed')\n        this.popup.style.setProperty('visibility', 'visible')\n        this.closeIcon.style.setProperty('visibility', 'visible')\n        document.getElementById('wzrkImageOnlyDiv').style.visibility = 'visible'\n      }\n    }\n\n    getRenderedImageWidth (img) {\n      const ratio = img.naturalWidth / img.naturalHeight\n      return img.height * ratio\n    }\n}\n","import { determineTimeStampText, greenTickSvg } from './helper'\nexport class Message extends HTMLElement {\n  constructor (config, message) {\n    super()\n    this.shadow = this.attachShadow({ mode: 'open' })\n    this.config = config\n    this.message = message\n    this.renderMessage(message)\n  }\n\n  wrapper = null\n  snackBar = null\n\n  get pivotId () {\n    return this.message.wzrk_pivot\n  }\n\n  get campaignId () {\n    return this.message.wzrk_id\n  }\n\n  createEl (type, id, part) {\n    const _el = document.createElement(type)\n    _el.setAttribute('id', id)\n    _el.setAttribute('part', part || id)\n    return _el\n  }\n\n  renderMessage (msg) {\n    this.wrapper = this.createEl('div', 'messageWrapper')\n\n    switch (msg.templateType) {\n      case 'text-only':\n      case 'text-with-icon':\n      case 'text-with-icon-and-image': {\n        const message = this.prepareBasicMessage(msg.msg[0])\n        this.wrapper.appendChild(message)\n      }\n    }\n\n    const timeStamp = this.createEl('div', 'timeStamp')\n    timeStamp.innerHTML = `<span>${determineTimeStampText(msg.id.split('_')[1])}<span>`\n    if (!msg.viewed) {\n      const unreadMarker = this.createEl('span', 'unreadMarker')\n      timeStamp.appendChild(unreadMarker)\n    }\n\n    this.wrapper.appendChild(timeStamp)\n    this.shadow.appendChild(this.wrapper)\n  }\n\n  prepareBasicMessage (msg) {\n    const message = this.createEl('div', 'message')\n\n    if (msg.imageUrl) {\n      const imageContainer = this.addImage(msg.imageUrl, 'mainImg')\n      message.appendChild(imageContainer)\n    }\n    const iconTitleDescWrapper = this.createEl('div', 'iconTitleDescWrapper')\n    if (msg.iconUrl) {\n      const iconContainer = this.addImage(msg.iconUrl, 'iconImg')\n      iconTitleDescWrapper.appendChild(iconContainer)\n    }\n    const titleDescWrapper = this.createEl('div', 'titleDescWrapper')\n    if (msg.title) {\n      const title = this.createEl('div', 'title')\n      title.innerText = msg.title\n      titleDescWrapper.appendChild(title)\n    }\n    if (msg.description) {\n      const description = this.createEl('div', 'description')\n      description.innerText = msg.description\n      titleDescWrapper.appendChild(description)\n    }\n    if (msg.title || msg.description) {\n      iconTitleDescWrapper.appendChild(titleDescWrapper)\n    }\n\n    if (msg.iconUrl || msg.title || msg.description) {\n      message.appendChild(iconTitleDescWrapper)\n    }\n    if (msg.buttons && msg.buttons.length) {\n      const buttonsContainer = this.addButtons(msg.buttons)\n      message.appendChild(buttonsContainer)\n    }\n    return message\n  }\n\n  addButtons (buttons = []) {\n    const buttonsContainer = this.createEl('div', 'buttonsContainer')\n    let hasCopyAction = false\n    buttons.forEach((b, i) => {\n      const button = this.createEl('button', `button-${i}`, 'button')\n      button.innerText = b.text\n      if (i > 0) {\n        button.style.cssText += 'margin-left: 2px;'\n      }\n      if (b.action === 'copy') {\n        hasCopyAction = true\n      }\n      buttonsContainer.appendChild(button)\n    })\n    if (hasCopyAction) {\n      this.addSnackbar(buttonsContainer)\n    }\n    return buttonsContainer\n  }\n\n  addSnackbar (buttonsContainer) {\n    this.snackBar = this.createEl('div', `snackbar-${this.campaignId}`, 'snackbar')\n    this.snackBar.innerHTML = greenTickSvg\n    const clipboardMsg = this.createEl('span', `snackbar-msg-${this.campaignId}`, 'snackbar-msg')\n    clipboardMsg.innerText = 'Copied to clipboard'\n    this.snackBar.appendChild(clipboardMsg)\n    buttonsContainer.appendChild(this.snackBar)\n  }\n\n  addImage (url, type) {\n    const imageContainer = this.createEl('div', `${type}Container`)\n    const image = this.createEl('img', type)\n    image.setAttribute('src', url)\n    // images will be fetched as and when the element comes into the viewport\n    image.setAttribute('loading', 'lazy')\n    imageContainer.appendChild(image)\n    return imageContainer\n  }\n\n  raiseClickedEvent (path, isPreview) {\n    switch (this.message.templateType) {\n      case 'text-only':\n      case 'text-with-icon':\n      case 'text-with-icon-and-image': {\n        this.raiseClickedForBasicTemplates(path, isPreview)\n      }\n    }\n  }\n\n  raiseClickedForBasicTemplates (path, isPreview) {\n    const msg = this.message.msg[0]\n    const payload = { msgId: this.campaignId, pivotId: this.pivotId }\n    if (path.tagName === 'BUTTON') {\n      const id = path.id.split('-')[1]\n      const button = msg.buttons[id]\n      payload.kv = {\n        wzrk_c2a: button.text\n      }\n      if (button.action === 'url') {\n        button.openUrlInNewTab ? window.open(button.url, '_blank') : (window.location = button.url)\n      } else if (button.action === 'copy') {\n        window.focus()\n        navigator.clipboard.writeText(button.clipboardText)\n        this.snackBar.style.setProperty('display', 'flex', 'important')\n        setTimeout(() => {\n          this.snackBar.style.setProperty('display', 'none', 'important')\n        }, 2000)\n      }\n    } else if (path.tagName === 'CT-INBOX-MESSAGE' && msg.onClickUrl) {\n      msg.openUrlInNewTab ? window.open(msg.onClickUrl, '_blank') : (window.location = msg.onClickUrl)\n    }\n    if (isPreview) {\n      console.log('Notifiction clicked event will be raised at run time with payload ::', payload)\n    } else {\n      window.clevertap.renderNotificationClicked(payload)\n    }\n  }\n}\n","export const messageStyles = ({ backgroundColor, borderColor, titleColor, descriptionColor, buttonColor, buttonTextColor, unreadMarkerColor }) => {\n  return `\n    <style id=\"messageStyles\">\n      ct-inbox-message::part(messageWrapper) {\n        margin-bottom: 16px; \n      }\n      ct-inbox-message::part(message) {\n        background-color: ${backgroundColor}; \n        border: 1px solid ${borderColor};\n        border-radius: 4px; \n        overflow: hidden;\n        min-height: 40px;\n      }\n      ct-inbox-message::part(message):hover {\n        box-shadow: 0px 4px 8px rgb(0 0 0 / 10%);\n        cursor: pointer;\n      }\n      ct-inbox-message::part(iconTitleDescWrapper) {\n        display: flex; \n        padding: 16px;\n      }\n      ct-inbox-message::part(titleDescWrapper) {\n        display: flex; \n        flex-direction: column;\n      }\n      ct-inbox-message::part(iconImgContainer) {\n        display: flex; \n        margin-right: 16px;\n      }\n      ct-inbox-message::part(mainImgContainer) {\n        line-height: 0;\n      }\n      ct-inbox-message::part(mainImg) {\n        width: 100%; \n        background: #b2b1ae;\n      }\n      ct-inbox-message::part(iconImg) {\n        height: 40px; \n        width: 40px;\n      }\n      ct-inbox-message::part(title) {\n        font-size: 14px !important; \n        line-height: 20px; \n        font-weight: 600; \n        color: ${titleColor}\n      }\n      ct-inbox-message::part(description) {\n        font-size: 14px !important; \n        line-height: 20px; \n        font-weight: 400; \n        color: ${descriptionColor}\n      }\n      ct-inbox-message::part(button) {\n        background-color: ${buttonColor}; \n        color: ${buttonTextColor}; \n        padding: 8px 16px; \n        font-size: 12px; \n        line-height: 16px; \n        font-weight: 600; \n        flex: 1; \n        border-radius: 0px; \n        text-transform: capitalize; \n        cursor: pointer; \n        border: none;\n      }\n      ct-inbox-message::part(buttonsContainer) {\n        display: flex;\n        position: relative;\n      }\n      ct-inbox-message::part(snackbar) {\n        position: absolute;\n        top: calc(-100% - 12px);\n        left: 50%;\n        transform: translate(-50%, 0px);\n        font-size: 14px;\n        font-weight: 400;\n        background: #FFFFFF;\n        border: 1px solid #ECEDF2;\n        box-shadow: 0px 4px 8px rgb(0 0 0 / 6%), 0px 0px 2px rgb(0 0 0 / 4%);\n        border-radius: 4px;\n        z-index: 2;\n        display: none;\n        width: max-content;\n        align-items: center;\n        padding: 8px 16px;\n        justify-content: center;\n      }\n\n      ct-inbox-message::part(snackbar-msg) {\n        color: black;\n        margin-left: 8px;\n      }\n\n      ct-inbox-message::part(timeStamp) {\n        display: flex; \n        justify-content: end; \n        align-items: center; \n        margin-top: 4px; \n        font-size: 12px !important; \n        line-height: 16px; \n        color: black;\n      }\n      ct-inbox-message::part(unreadMarker) {\n        height: 8px; \n        width: 8px; \n        border-radius: 50%; \n        background-color: ${unreadMarkerColor}; \n        margin-left: 8px;\n      }\n      @media only screen and (min-width: 420px) {\n        ct-inbox-message::part(mainImg) {\n          height: 180px;\n        }\n      }\n    </style>\n  `\n}\n\nexport const inboxContainerStyles = ({\n  panelBackgroundColor,\n  panelBorderColor,\n  headerBackgroundColor,\n  headerTitleColor,\n  closeIconColor,\n  categoriesTabColor,\n  categoriesTitleColor,\n  categoriesBorderColor,\n  selectedCategoryTabColor,\n  selectedCategoryTitleColor,\n  selectedCategoryBorderColor,\n  headerCategoryAndPoweredByCTHeight\n}) => {\n  return `\n      <style id=\"webInboxStyles\">\n        #inbox {\n          width: 100%;\n          position: fixed;\n          background-color: #fff; \n          display: none; \n          box-shadow: 0px 2px 10px 0px #d7d7d791;\n          background-color: ${panelBackgroundColor}; \n          border: 1px solid ${panelBorderColor};\n          top: 0;\n          left: 0;\n          height: 100%;\n          overflow: auto;\n          z-index: 1;\n          box-sizing: content-box;\n          border-radius: 4px;\n        }\n  \n        #emptyInboxMsg {\n          display: block;\n          padding: 10px;\n          text-align: center;\n          color: black;\n        }\n  \n        #header {\n          height: 36px; \n          width: 100%; \n          display: flex; \n          justify-content: center; \n          align-items: center; \n          background-color: ${headerBackgroundColor}; \n          background-color: var(--card-bg, ${headerBackgroundColor});\n          color: ${headerTitleColor}\n        }\n  \n        #closeInbox {\n          font-size: 20px; \n          margin-right: 12px; \n          color: ${closeIconColor}; \n          cursor: pointer;\n        }\n  \n        #headerTitle {\n          font-size: 14px; \n          line-height: 20px; \n          flex-grow: 1; \n          font-weight: 700; \n          text-align: center;\n          flex-grow: 1;\n          text-align: center;\n        }\n  \n        #categoriesContainer {\n          padding: 16px 16px 0 16px; \n          height: 32px; \n          display: flex;\n          scroll-behavior: smooth;\n          position: relative;\n        }\n\n        #categoriesWrapper {\n          height: 32px; \n          overflow-x: scroll;\n          display: flex;\n          white-space: nowrap;\n          scrollbar-width: none;\n        }\n\n        #categoriesWrapper::-webkit-scrollbar {\n          display: none;\n        }\n  \n        #leftArrow, #rightArrow {\n          height: 32px;\n          align-items: center;\n          font-weight: 700;\n          position: absolute;\n          z-index: 2;\n          pointer-events: auto;\n          cursor: pointer;\n          display: none;\n        }\n\n        #leftArrow {\n          left: 0;\n          padding-left: 4px;\n          padding-right: 16px;\n          background: linear-gradient(90deg, ${panelBackgroundColor} 0%, ${panelBackgroundColor}99 80%, ${panelBackgroundColor}0d 100%);\n        }\n\n        #rightArrow {\n          right: 0;\n          padding-right: 4px;\n          padding-left: 16px;\n          background: linear-gradient(-90deg, ${panelBackgroundColor} 0%, ${panelBackgroundColor}99 80%, ${panelBackgroundColor}0d 100%);\n        }\n\n        [id^=\"category-\"] {\n          display: flex; \n          flex: 1 1 0; \n          justify-content: center; \n          align-items: center; \n          font-size: 14px; \n          line-height: 20px; \n          background-color: ${categoriesTabColor}; \n          color: ${categoriesTitleColor}; \n          cursor: pointer;\n          padding: 6px 24px;\n          margin: 0 3px;\n          border-radius: 16px;\n          border: ${categoriesBorderColor ? '1px solid ' + categoriesBorderColor : 'none'};\n        }\n\n        [id^=\"category-\"][selected=\"true\"] {\n          background-color: ${selectedCategoryTabColor}; \n          color: ${selectedCategoryTitleColor}; \n          border: ${selectedCategoryBorderColor ? '1px solid ' + selectedCategoryBorderColor : 'none'}\n        }\n  \n        #inboxCard {\n          padding: 0 16px 0 16px;\n          overflow-y: auto;\n          box-sizing: border-box;\n          margin-top: 16px;\n        }\n\n        #poweredByCT {\n          display: block;\n          height: 16px;\n          padding: 8px 0px;\n          margin: auto;\n        }\n  \n        @media only screen and (min-width: 420px) {\n          #inbox {\n            width: var(--inbox-width, 392px);\n            height: var(--inbox-height, 546px);\n            position: var(--inbox-position, fixed);\n            right: var(--inbox-right, unset);\n            bottom: var(--inbox-bottom, unset);\n            top: var(--inbox-top, unset);\n            left: var(--inbox-left, unset);\n          }\n  \n          #inboxCard {\n            height: calc(var(--inbox-height, 546px) - ${headerCategoryAndPoweredByCTHeight}px); \n          }\n  \n        }\n      </style>\n      `\n}\n","import { StorageManager, $ct } from '../../util/storage'\nimport { Message } from './Message'\nimport { inboxContainerStyles, messageStyles } from './inboxStyles'\nimport { getInboxPosition, determineTimeStampText, arrowSvg, getInboxMessages, saveInboxMessages } from './helper'\nimport { WEBINBOX_CONFIG, MAX_INBOX_MSG } from '../../util/constants'\n\nexport class Inbox extends HTMLElement {\n  constructor (logger) {\n    super()\n    this.logger = logger\n    this.shadow = this.attachShadow({ mode: 'open' })\n  }\n\n  isInboxOpen = false\n  selectedCategory = null\n  unviewedMessages = {}\n  unviewedCounter = 0\n  isPreview = false\n  inboxConfigForPreview = {}\n\n  // dom references\n  inboxSelector = null\n  inbox = null\n  emptyInboxMsg = null\n  inboxCard = null\n  unviewedBadge = null\n  observer = null\n  selectedCategoryRef = null\n\n  get incomingMessages () {\n    return []\n  }\n\n  set incomingMessages (msgs = []) {\n    if (msgs.length > 0 && this.inbox) {\n      this.updateInboxMessages(msgs)\n    }\n  }\n\n  get incomingMessagesForPreview () {\n    return []\n  }\n\n  set incomingMessagesForPreview (msgs = []) {\n    if (msgs.length > 0 && this.inbox) {\n      this.isPreview = true\n      this.unviewedCounter = 0\n      msgs.forEach((m) => {\n        m.id = `${m.wzrk_id.split('_')[0]}_${Date.now()}`\n        this.unviewedMessages[m.id] = m\n        this.unviewedCounter++\n      })\n      this.buildUIForMessages(msgs)\n      this.updateUnviewedBadgeCounter()\n    }\n  }\n\n  connectedCallback () {\n    this.init()\n  }\n\n  init () {\n    this.config = this.isPreview ? this.inboxConfigForPreview : StorageManager.readFromLSorCookie(WEBINBOX_CONFIG) || {}\n    if (Object.keys(this.config).length === 0) {\n      return\n    }\n    this.inboxSelector = document.getElementById(this.config.inboxSelector)\n    if (this.inboxSelector === null) {\n      return\n    }\n\n    if (this.config.styles.notificationsBadge) {\n      this.addUnviewedBadge()\n    } else if (this.unviewedBadge) {\n      this.unviewedBadge.remove()\n    }\n\n    this.createinbox()\n\n    /**\n     * We need to remove the listener as there could be a scenario where init would be called when\n     * we get updated web inbox settings from LC after the inbox has been initialised.\n     * It can so happen that the inbox-selector would have changed.\n     */\n    document.removeEventListener('click', this.addClickListenerOnDocument)\n    document.addEventListener('click', this.addClickListenerOnDocument)\n    this.config.categories.length && this.updateActiveCategory(this.selectedCategoryRef.innerText)\n\n    this.shadow.innerHTML = this.getInboxStyles()\n    this.shadow.appendChild(this.inbox)\n  }\n\n  addMsgsToInboxFromLS () {\n    const messages = this.deleteExpiredAndGetUnexpiredMsgs(false)\n    const msgIds = messages ? Object.keys(messages) : []\n    if (msgIds.length === 0) {\n      return\n    }\n    msgIds.forEach((m) => {\n      if (!messages[m].viewed) {\n        this.unviewedMessages[m] = messages[m]\n        this.unviewedCounter++\n      }\n    })\n    this.buildUIForMessages(messages)\n    this.updateUnviewedBadgeCounter()\n  }\n\n  /**\n   * @param {*} deleteMsgsFromUI - If this param is true, then we'll have to check the UI and delete expired messages from the DOM\n   * It'll be false when you are building the inbox layout for the very first time.\n   *\n   * This method reads the inbox messages from LS,\n   * based on the deleteMsgsFromUI flag deletes the expired messages from UI and decrements the unviewed counter if the message was not viewed,\n   * sorts the messages based on the date,\n   * saves the unexpired messages to LS\n   * and returns the sorted unexpired messages\n   *\n   * Scenarios when we encounter expired messages -\n   * 1. building ui for the 1st time, no need to decrement the unviewed counter as the correct count will be set at the time of rendering\n   * 2. UI is already built (deleteMsgsFromUI = true) and you open the inbox\n   *    a. You'll find the expired msg in inbox\n   *    b. You'll not find the expired msg in inbox.\n   *       This happens when we receive new messages from LC, increment unviewed counter, save it in LS. (We build the UI only when the user opens inbox.)\n   *  In both the above scenarios, we'll still have to decrement the unviewed counter if the message was not viewed.\n   */\n  deleteExpiredAndGetUnexpiredMsgs (deleteMsgsFromUI = true) {\n    let messages = getInboxMessages()\n\n    const now = Math.floor(Date.now() / 1000)\n    for (const msg in messages) {\n      if (messages[msg].wzrk_ttl && messages[msg].wzrk_ttl > 0 && messages[msg].wzrk_ttl < now) {\n        if (deleteMsgsFromUI) {\n          const el = this.shadowRoot.getElementById(messages[msg].id)\n          el && el.remove()\n          if (!messages[msg].viewed) {\n            this.unviewedCounter--\n            this.updateUnviewedBadgeCounter()\n          }\n        }\n        delete messages[msg]\n      }\n    }\n    if (messages && messages.length > 0) {\n      messages = Object.values(messages).sort((a, b) => b.date - a.date).reduce((acc, m) => { acc[m.id] = m; return acc }, {})\n    }\n    saveInboxMessages(messages)\n    return messages\n  }\n\n  updateInboxMessages (msgs = []) {\n    const inboxMsgs = this.deleteExpiredAndGetUnexpiredMsgs()\n    const date = Date.now()\n    const incomingMsgs = {}\n    msgs.forEach((m, i) => {\n      const key = `${m.wzrk_id.split('_')[0]}_${Date.now()}`\n      m.id = key\n      // We are doing this to preserve the order of the messages\n      m.date = date - i\n      m.viewed = 0\n      inboxMsgs[key] = m\n      incomingMsgs[key] = m\n      this.unviewedMessages[key] = m\n      this.unviewedCounter++\n    })\n    saveInboxMessages(inboxMsgs)\n    this.buildUIForMessages(incomingMsgs)\n    this.updateUnviewedBadgeCounter()\n  }\n\n  createEl (type, id, part) {\n    const _el = document.createElement(type)\n    _el.setAttribute('id', id)\n    _el.setAttribute('part', part || id)\n    return _el\n  }\n\n  addUnviewedBadge () {\n    if (!this.unviewedBadge) {\n      this.unviewedBadge = this.createEl('div', 'unviewedBadge')\n      // As this unviewedBadge element will be directly added to the DOM, we are defining inline styles\n      this.unviewedBadge.style.cssText = `display: none; position: absolute; height: 16px; width: 26px; border-radius: 8px; background-color: ${this.config.styles.notificationsBadge.backgroundColor}; font-size: 12px; color: ${this.config.styles.notificationsBadge.textColor}; font-weight: bold; align-items: center; justify-content: center;`\n      document.body.appendChild(this.unviewedBadge)\n    }\n    this.updateUnviewedBadgePosition()\n\n    // called when user switches b/w portrait and landscape mode.\n    window.addEventListener('resize', () => {\n      this.updateUnviewedBadgePosition()\n    })\n  }\n\n  updateUnviewedBadgePosition () {\n    const { top, right } = this.inboxSelector.getBoundingClientRect()\n    this.unviewedBadge.style.top = `${top - 8}px`\n    this.unviewedBadge.style.left = `${right - 8}px`\n  }\n\n  createinbox () {\n    this.inbox = this.createEl('div', 'inbox')\n    const header = this.createEl('div', 'header')\n\n    const headerTitle = this.createEl('div', 'headerTitle')\n    headerTitle.innerText = this.config.title\n\n    const closeIcon = this.createEl('div', 'closeInbox')\n    closeIcon.innerHTML = '&times'\n\n    header.appendChild(headerTitle)\n    header.appendChild(closeIcon)\n    this.inbox.appendChild(header)\n    if (this.config.categories.length) {\n      const categories = this.createCategories()\n      this.inbox.appendChild(categories)\n    }\n    this.inboxCard = this.createEl('div', 'inboxCard')\n    this.inbox.appendChild(this.inboxCard)\n\n    this.emptyInboxMsg = this.createEl('div', 'emptyInboxMsg')\n    this.emptyInboxMsg.innerText = 'All messages will be displayed here.'\n    this.inboxCard.appendChild(this.emptyInboxMsg)\n\n    if (this.config.hidePoweredByCT === false) {\n      const poweredByText = this.createEl('img', 'poweredByCT')\n      poweredByText.src = 'https://d2r1yp2w7bby2u.cloudfront.net/js/PB_CT_new.png'\n      this.inbox.appendChild(poweredByText)\n    }\n\n    // Intersection observer for notification viewed\n    const options = {\n      root: this.inboxCard,\n      rootMargin: '0px',\n      threshold: 0.5\n    }\n    this.observer = new IntersectionObserver((entries, observer) => { this.handleMessageViewed(entries) }, options)\n\n    this.addMsgsToInboxFromLS()\n  }\n\n  createCategories () {\n    const categoriesContainer = this.createEl('div', 'categoriesContainer')\n\n    const leftArrow = this.createEl('div', 'leftArrow')\n    leftArrow.innerHTML = arrowSvg\n    leftArrow.children[0].style = 'transform: rotate(180deg)'\n    leftArrow.addEventListener('click', () => {\n      this.shadowRoot.getElementById('categoriesWrapper').scrollBy(-70, 0)\n    })\n    categoriesContainer.appendChild(leftArrow)\n\n    const categoriesWrapper = this.createEl('div', 'categoriesWrapper')\n    const _categories = ['All', ...this.config.categories]\n    _categories.forEach((c, i) => {\n      const category = this.createEl('div', `category-${i}`, 'category')\n      category.innerText = c\n      if (i === 0) {\n        this.selectedCategoryRef = category\n      }\n      categoriesWrapper.appendChild(category)\n    })\n    categoriesContainer.appendChild(categoriesWrapper)\n\n    const rightArrow = this.createEl('div', 'rightArrow')\n    rightArrow.innerHTML = arrowSvg\n    rightArrow.addEventListener('click', () => {\n      this.shadowRoot.getElementById('categoriesWrapper').scrollBy(70, 0)\n    })\n    categoriesContainer.appendChild(rightArrow)\n\n    const options = { root: categoriesContainer, threshold: 0.9 }\n    const firstCategory = categoriesWrapper.children[0]\n    const lastCategory = categoriesWrapper.children[this.config.categories.length]\n\n    const firstCategoryObserver = new IntersectionObserver((e) => {\n      this.categoryObserverCb(leftArrow, e[0].intersectionRatio >= 0.9)\n    }, options)\n    firstCategoryObserver.observe(firstCategory)\n\n    const lastCategoryObserver = new IntersectionObserver((e) => {\n      this.categoryObserverCb(rightArrow, e[0].intersectionRatio >= 0.9)\n    }, options)\n    lastCategoryObserver.observe(lastCategory)\n\n    return categoriesContainer\n  }\n\n  categoryObserverCb (el, hide) {\n    if (!el) {\n      return\n    }\n    el.style.display = hide ? 'none' : 'flex'\n  }\n\n  updateActiveCategory (activeCategory) {\n    this.selectedCategory = activeCategory\n\n    this.inboxCard.scrollTop = 0\n    let counter = 0\n\n    this.prevCategoryRef && this.prevCategoryRef.setAttribute('selected', 'false')\n    this.selectedCategoryRef.setAttribute('selected', 'true')\n\n    this.inboxCard.childNodes.forEach(c => {\n      if (c.getAttribute('id') !== 'emptyInboxMsg') {\n        c.style.display = (this.selectedCategory === 'All' || c.getAttribute('category') === this.selectedCategory) ? 'block' : 'none'\n        if (c.style.display === 'block') {\n          counter++\n        }\n      }\n    })\n    if (counter === 0) {\n      this.emptyInboxMsg.innerText = `${activeCategory} messages will be displayed here.`\n      this.emptyInboxMsg.style.display = 'block'\n    } else {\n      this.emptyInboxMsg.style.display = 'none'\n    }\n  }\n\n  buildUIForMessages (messages = {}) {\n    !this.isPreview && this.updateTSForRenderedMsgs()\n    this.inboxCard.scrollTop = 0\n    const maxMsgsInInbox = this.config.maxMsgsInInbox ?? MAX_INBOX_MSG\n    const firstChild = this.inboxCard.firstChild\n\n    for (const m in messages) {\n      const item = new Message(this.config, messages[m])\n      item.setAttribute('id', messages[m].id)\n      item.setAttribute('pivot', messages[m].wzrk_pivot)\n      item.setAttribute('part', 'ct-inbox-message')\n      if (this.config.categories.length > 0) {\n        item.setAttribute('category', messages[m].tags[0] || '')\n        item.style.display = (this.selectedCategory === 'All' || messages[m].category === this.selectedCategory) ? 'block' : 'none'\n      } else {\n        item.style.display = 'block'\n      }\n      this.inboxCard.insertBefore(item, firstChild)\n      this.observer.observe(item)\n    }\n\n    let msgTotalCount = this.inboxCard.querySelectorAll('ct-inbox-message').length\n    while (msgTotalCount > maxMsgsInInbox) {\n      const ctInboxMsgs = this.inboxCard.querySelectorAll('ct-inbox-message')\n      if (ctInboxMsgs.length > 0) { ctInboxMsgs[ctInboxMsgs.length - 1].remove() }\n      msgTotalCount--\n    }\n    const hasMessages = this.inboxCard.querySelectorAll('ct-inbox-message[style*=\"display: block\"]').length\n    this.emptyInboxMsg.style.display = hasMessages ? 'none' : 'block'\n  }\n\n  /**\n   * Adds a click listener on the document. For every click we check\n   * 1. if the click has happenned within the inbox\n   *    - on close button, we close the inbox\n   *    - on any of the category, we set that as the activeCategory\n   *    - on any of the message, we mark raise notification clicked event. To identify the clicks on a button, we have p.id.startsWith('button-')\n   * 2. if the user has clicked on the inboxSelector, we toggle inbox\n   * 3. if the click is anywhere else on the UI and the inbox is open, we simply close it\n   */\n\n  addClickListenerOnDocument = (() => {\n    return (e) => {\n      if (e.composedPath().includes(this.inbox)) {\n        // path is not supported on FF. So we fallback to e.composedPath\n        const path = e.path || (e.composedPath && e.composedPath())\n        if (path.length) {\n          const id = path[0].id\n          if (id === 'closeInbox') {\n            this.toggleInbox()\n          } else if (id.startsWith('category-')) {\n            this.prevCategoryRef = this.selectedCategoryRef\n            this.selectedCategoryRef = path[0]\n            this.updateActiveCategory(path[0].innerText)\n          } else {\n            const _path = path.filter((p) => p.id?.startsWith('button-') || p.tagName === 'CT-INBOX-MESSAGE')\n            if (_path.length) {\n              const messageEl = _path[_path.length - 1]\n              messageEl.raiseClickedEvent(_path[0], this.isPreview)\n            }\n          }\n        }\n      } else if (this.inboxSelector.contains(e.target) || this.isInboxOpen) {\n        this.toggleInbox(e)\n      }\n    }\n  })()\n\n  /**\n   * This function will be called every time when a message comes into the inbox viewport and it's visibility increases to 50% or drops below 50%\n   * If a msg is 50% visible in the UI, we need to mark the message as viewed in LS and raise notification viewed event\n   */\n  handleMessageViewed (entries) {\n    const raiseViewedEvent = !this.isPreview\n    if (this.isInboxOpen) {\n      entries.forEach((e) => {\n        if (e.isIntersecting && this.unviewedMessages.hasOwnProperty(e.target.id) && e.target.message.viewed === 0) {\n          e.target.message.viewed = 1\n          if (raiseViewedEvent) {\n            window.clevertap.renderNotificationViewed({ msgId: e.target.campaignId, pivotId: e.target.pivotId })\n            this.updateMessageInLS(e.target.id, { ...e.target.message, viewed: 1 })\n            setTimeout(() => {\n              e.target.shadowRoot.getElementById('unreadMarker').style.display = 'none'\n            }, 1000)\n          } else {\n            console.log('Notifiction viewed event will be raised at run time with payload ::', { msgId: e.target.campaignId, pivotId: e.target.pivotId })\n          }\n          this.unviewedCounter--\n          this.updateUnviewedBadgeCounter()\n          delete this.unviewedMessages[e.target.id]\n        }\n      })\n    }\n  }\n\n  updateMessageInLS (key, value) {\n    if (!this.isPreview) {\n      const messages = getInboxMessages()\n      messages[key] = value\n      saveInboxMessages(messages)\n    }\n  }\n\n  // create a separte fn fro refactoring\n  toggleInbox (e) {\n    this.isInboxOpen = !this.isInboxOpen\n    if (this.isInboxOpen) {\n      this.inboxCard.scrollTop = 0\n      !this.isPreview && this.deleteExpiredAndGetUnexpiredMsgs()\n      this.inbox.style.display = 'block'\n      this.inbox.style.zIndex = '2147483647' // zIndex should be max for the inbox to be rendered on top of all elements\n      if (this.config.categories.length) {\n        this.selectedCategoryRef.setAttribute('selected', 'false')\n        this.selectedCategoryRef = this.shadowRoot.getElementById('category-0')\n        this.updateActiveCategory(this.selectedCategoryRef.innerText)\n        this.shadowRoot.getElementById('categoriesWrapper').scrollLeft -= this.shadowRoot.getElementById('categoriesWrapper').scrollWidth\n      }\n      this.setInboxPosition(e)\n    } else {\n      this.inbox.style.display = 'none'\n    }\n  }\n\n  setInboxPosition (e) {\n    const windowWidth = window.outerWidth\n    const customInboxStyles = getComputedStyle($ct.inbox)\n    const top = customInboxStyles.getPropertyValue('--inbox-top')\n    const bottom = customInboxStyles.getPropertyValue('--inbox-bottom')\n    const left = customInboxStyles.getPropertyValue('--inbox-left')\n    const right = customInboxStyles.getPropertyValue('--inbox-right')\n    const hasPositionDefined = top || bottom || left || right\n    if (windowWidth > 481 && !hasPositionDefined) {\n      const res = getInboxPosition(e, this.inbox.clientHeight, this.inbox.clientWidth)\n      const xPos = res.xPos\n      const yPos = res.yPos\n      this.inbox.style.top = yPos + 'px'\n      this.inbox.style.left = xPos + 'px'\n    }\n  }\n\n  /**\n   * Updates the UI with the number of unviewed messages\n   * If there are more than 9 unviewed messages, we show the count as 9+\n   */\n\n  setBadgeStyle = (msgCount) => {\n    if (this.unviewedBadge !== null) {\n      this.unviewedBadge.innerText = msgCount > 9 ? '9+' : msgCount\n      this.unviewedBadge.style.display = msgCount > 0 ? 'flex' : 'none'\n    }\n  }\n\n  updateUnviewedBadgeCounter () {\n    if (this.isPreview) {\n      this.setBadgeStyle(this.unviewedCounter)\n      return\n    }\n    let counter = 0\n    this.inboxCard.querySelectorAll('ct-inbox-message').forEach((m) => {\n      const messages = getInboxMessages()\n      if (messages[m.id] && messages[m.id].viewed === 0) {\n        counter++\n      }\n    })\n    this.setBadgeStyle(counter)\n  }\n\n  updateTSForRenderedMsgs () {\n    this.inboxCard.querySelectorAll('ct-inbox-message').forEach((m) => {\n      const ts = m.id.split('_')[1]\n      m.shadow.getElementById('timeStamp').firstChild.innerText = determineTimeStampText(ts)\n    })\n  }\n\n  getInboxStyles () {\n    const headerHeight = 36\n    const categoriesHeight = this.config.categories.length ? 64 : 16\n    const hidePoweredByCTHeight = this.config.hidePoweredByCT === false ? 32 : 0\n\n    const styles = {\n      panelBackgroundColor: this.config.styles.panelBackgroundColor,\n      panelBorderColor: this.config.styles.panelBorderColor,\n      headerBackgroundColor: this.config.styles.header.backgroundColor,\n      headerTitleColor: this.config.styles.header.titleColor,\n      closeIconColor: this.config.styles.closeIconColor,\n      categoriesTabColor: this.config.styles.categories.tabColor,\n      categoriesTitleColor: this.config.styles.categories.titleColor,\n      selectedCategoryTabColor: this.config.styles.categories.selectedTab.tabColor,\n      selectedCategoryTitleColor: this.config.styles.categories.selectedTab.titleColor,\n      headerCategoryAndPoweredByCTHeight: headerHeight + categoriesHeight + hidePoweredByCTHeight\n    }\n    if (this.config.styles.categories.borderColor) {\n      styles.categoriesBorderColor = this.config.styles.categories.borderColor\n    }\n    if (this.config.styles.categories.selectedTab.borderColor) {\n      styles.selectedCategoryBorderColor = this.config.styles.categories.selectedTab.borderColor\n    }\n\n    const inboxStyles = inboxContainerStyles(styles)\n\n    const cardStyles = this.config.styles.cards\n    const msgStyles = messageStyles({\n      backgroundColor: cardStyles.backgroundColor,\n      borderColor: cardStyles.borderColor,\n      titleColor: cardStyles.titleColor,\n      descriptionColor: cardStyles.descriptionColor,\n      buttonColor: cardStyles.buttonColor,\n      buttonTextColor: cardStyles.buttonTextColor,\n      unreadMarkerColor: cardStyles.unreadMarkerColor\n    })\n\n    return inboxStyles + msgStyles\n  }\n}\n","import { StorageManager, $ct } from '../../util/storage'\nimport { Inbox } from './WebInbox'\nimport { Message } from './Message'\nimport { WEBINBOX_CONFIG, GCOOKIE_NAME, WEBINBOX } from '../../util/constants'\nimport { isValueValid } from '../../util/datatypes'\n\nexport const processWebInboxSettings = (webInboxSetting, isPreview = false) => {\n  const _settings = StorageManager.readFromLSorCookie(WEBINBOX_CONFIG) || {}\n  if (isPreview) {\n    $ct.inbox.inboxConfigForPreview = webInboxSetting\n    $ct.inbox.isPreview = true\n    $ct.inbox && $ct.inbox.init()\n  } else if (JSON.stringify(_settings) !== JSON.stringify(webInboxSetting)) {\n    StorageManager.saveToLSorCookie(WEBINBOX_CONFIG, webInboxSetting)\n    $ct.inbox && $ct.inbox.init()\n  }\n}\n\nexport const processInboxNotifs = (msg) => {\n  if (msg.inbox_preview) {\n    $ct.inbox.incomingMessagesForPreview = msg.inbox_notifs\n  } else {\n    $ct.inbox.incomingMessages = msg\n  }\n}\n\nexport const processWebInboxResponse = (msg) => {\n  if (msg.webInboxSetting) {\n    processWebInboxSettings(msg.webInboxSetting, msg.inbox_preview)\n  }\n  if (msg.inbox_notifs != null) {\n    processInboxNotifs(msg)\n  }\n}\n\nexport const addWebInbox = (logger) => {\n  checkAndRegisterWebInboxElements()\n  $ct.inbox = new Inbox({ logger })\n  document.body.appendChild($ct.inbox)\n}\n\nconst getAndMigrateInboxMessages = (guid) => {\n  const messages = StorageManager.readFromLSorCookie(WEBINBOX) || {}\n  // Doing this to migrate message to guid level\n  if (Object.keys(messages).length > 0 && Object.keys(messages)[0].includes('_')) {\n    const gudInboxObj = {}\n    gudInboxObj[guid] = messages\n    StorageManager.saveToLSorCookie(WEBINBOX, gudInboxObj)\n    return gudInboxObj\n  }\n  return messages\n}\n\nexport const getInboxMessages = () => {\n  const guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n  if (!isValueValid(guid)) { return {} }\n  const messages = getAndMigrateInboxMessages(guid)\n\n  return messages.hasOwnProperty(guid) ? messages[guid] : {}\n}\n\nexport const saveInboxMessages = (messages) => {\n  const guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n  if (!isValueValid(guid)) { return }\n  const storedInboxObj = getAndMigrateInboxMessages(guid)\n\n  const newObj = { ...storedInboxObj, [guid]: messages }\n  StorageManager.saveToLSorCookie(WEBINBOX, newObj)\n}\n\nexport const initializeWebInbox = (logger) => {\n  return new Promise((resolve, reject) => {\n    if (document.readyState === 'complete') {\n      addWebInbox(logger)\n      resolve()\n    } else {\n      const config = StorageManager.readFromLSorCookie(WEBINBOX_CONFIG) || {}\n      const onLoaded = () => {\n        /**\n         * We need this null check here because $ct.inbox could be initialised via init method too on document load.\n         * In that case we don't need to call addWebInbox method\n         */\n        if ($ct.inbox === null) {\n          addWebInbox(logger)\n        }\n        resolve()\n      }\n      window.addEventListener('load', () => {\n        /**\n         * Scripts can be loaded layzily, we may not get element from dom as it may not be mounted yet\n         * We will to check element for 10 seconds and give up\n         */\n        if (document.getElementById(config.inboxSelector)) {\n          onLoaded()\n        } else {\n          // check for element for next 10 seconds\n          let count = 0\n          if (count < 20) {\n            const t = setInterval(() => {\n              if (document.getElementById(config.inboxSelector)) {\n                onLoaded()\n                clearInterval(t)\n                resolve()\n              } else if (count >= 20) {\n                clearInterval(t)\n                logger.debug('Failed to add inbox')\n              }\n              count++\n            }, 500)\n          }\n        }\n      })\n    }\n  })\n}\n\nexport const checkAndRegisterWebInboxElements = () => {\n  if (customElements.get('ct-web-inbox') === undefined) {\n    customElements.define('ct-web-inbox', Inbox)\n    customElements.define('ct-inbox-message', Message)\n  }\n}\n\nexport const getInboxPosition = (e, inboxHeight, inboxWidth) => {\n  const horizontalScroll = document.scrollingElement.scrollLeft\n  const verticalScroll = document.scrollingElement.scrollTop\n  const windowWidth = window.innerWidth + horizontalScroll\n  const windowHeight = window.innerHeight + verticalScroll\n  const selectorRect = e.target.getBoundingClientRect()\n  const selectorX = selectorRect.x + horizontalScroll\n  const selectorY = selectorRect.y + verticalScroll\n  const selectorLeft = selectorRect.left + horizontalScroll\n  const selectorRight = selectorRect.right + horizontalScroll\n  const selectorTop = selectorRect.top + verticalScroll\n  const selectorBottom = selectorRect.bottom + verticalScroll\n  const selectorHeight = selectorRect.height\n  const selectorWidth = selectorRect.width\n  const selectorCenter = {\n    x: selectorX + (selectorWidth / 2),\n    y: selectorY + (selectorHeight / 2)\n  }\n  const halfOfInboxHeight = (inboxHeight / 2)\n  const halfOfInboxWidth = (inboxWidth / 2)\n  let inboxOnSide = false\n\n  let xPos, yPos\n\n  const padding = 16\n\n  /**\n   * y co-ordinates:\n   * Try to push the card downwards\n   * if that's not possible, push it upwards\n   * if that too is not possible, then the card will be placed on the side. Add some padding.\n   *\n   * x co-ordinates:\n   * If the card is on the side,\n   *    try to place it to the right. If it's not possible,\n   *    place it to the left\n   * If the card is either on top/ bottom, set the x co-ordinate such that the selector center and the inbox card center become the same\n   * Now,\n   *  if the left of the inbox card is < 0,\n   *    try to get the left aligned to the selectorLeft.\n   *    if that's not possible, simply set left to 0\n   *  if the right of the inbox card > windowWidth,\n   *    try to get the right of rhe inbox card aligned with the selectorRight\n   *    if that's not possible, simply set the inbox right to the window Right\n   */\n  if (selectorBottom + inboxHeight <= windowHeight) { // try to place the card down\n    const availableHeight = windowHeight - (selectorBottom + inboxHeight)\n    yPos = availableHeight >= padding ? selectorBottom + padding : selectorBottom + availableHeight\n  } else if (selectorTop - inboxHeight >= verticalScroll) { // try to place the card up\n    const availableHeight = selectorTop - inboxHeight\n    yPos = availableHeight >= padding ? selectorTop - inboxHeight - padding : selectorTop - inboxHeight - availableHeight\n  } else {\n    inboxOnSide = true\n    yPos = selectorCenter.y - halfOfInboxHeight // with this the y co-ordinate of the selector center and the inbox card center become the same\n    if (yPos < verticalScroll) {\n      yPos = verticalScroll\n    } else if (yPos + inboxHeight > windowHeight) {\n      yPos = windowHeight - inboxHeight\n    }\n  }\n\n  if (inboxOnSide) {\n    // See if we can place the card to the right of the selector\n    const inboxRight = selectorRight + inboxWidth\n    if (inboxRight <= windowWidth) {\n      const availableWidth = inboxRight + padding <= windowWidth ? padding : windowWidth - inboxRight\n      xPos = selectorRight + availableWidth\n    } else {\n      const inboxLeft = selectorLeft - inboxWidth\n      const availableWidth = inboxLeft - padding >= horizontalScroll ? padding : inboxLeft - horizontalScroll\n      xPos = inboxLeft - availableWidth\n    }\n  } else {\n    xPos = selectorCenter.x - halfOfInboxWidth\n    if (xPos < horizontalScroll) {\n      if (selectorLeft + inboxWidth <= windowWidth) {\n        xPos = selectorLeft\n      } else {\n        xPos = horizontalScroll\n      }\n    } else if (xPos + inboxWidth > windowWidth) {\n      if (selectorRight - inboxWidth >= horizontalScroll) {\n        xPos = selectorRight - inboxWidth\n      } else {\n        xPos = windowWidth - inboxWidth\n      }\n    }\n  }\n\n  return { xPos, yPos }\n}\n\nexport const determineTimeStampText = (ts) => {\n  const now = Date.now()\n  let diff = Math.floor((now - ts) / 60000)\n  if (diff < 5) {\n    return 'Just now'\n  }\n  if (diff < 60) {\n    return `${diff} minute${diff > 1 ? 's' : ''} ago`\n  }\n  diff = Math.floor(diff / 60)\n  if (diff < 24) {\n    return `${diff} hour${diff > 1 ? 's' : ''} ago`\n  }\n  diff = Math.floor(diff / 24)\n  return `${diff} day${diff > 1 ? 's' : ''} ago`\n}\n\nexport const hasWebInboxSettingsInLS = () => {\n  return Object.keys(StorageManager.readFromLSorCookie(WEBINBOX_CONFIG) || {}).length > 0\n}\n\nexport const arrowSvg = `<svg width=\"6\" height=\"10\" viewBox=\"0 0 6 10\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M0.258435 9.74751C-0.0478584 9.44825 -0.081891 8.98373 0.156337 8.64775L0.258435 8.52836L3.87106 5L0.258435 1.47164C-0.0478588 1.17239 -0.0818914 0.707867 0.156337 0.371887L0.258435 0.252494C0.564728 -0.0467585 1.04018 -0.0800085 1.38407 0.152743L1.50627 0.252494L5.74156 4.39042C6.04786 4.68968 6.08189 5.1542 5.84366 5.49018L5.74156 5.60957L1.50627 9.74751C1.16169 10.0842 0.603015 10.0842 0.258435 9.74751Z\" fill=\"#63698F\"/>\n</svg>\n`\nexport const greenTickSvg = `<svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16C12.4183 16 16 12.4183 16 8ZM9.6839 5.93602C9.97083 5.55698 10.503 5.48833 10.8725 5.78269C11.2135 6.0544 11.2968 6.54044 11.0819 6.91173L11.0219 7.00198L8.09831 10.864C7.80581 11.2504 7.26654 11.3086 6.90323 11.0122L6.82822 10.9433L5.04597 9.10191C4.71635 8.76136 4.71826 8.21117 5.05023 7.87303C5.35666 7.5609 5.83722 7.53855 6.16859 7.80482L6.24814 7.87739L7.35133 9.01717L9.6839 5.93602Z\" fill=\"#03A387\"/>\n</svg>\n`\n","import {\n  addToLocalProfileMap,\n  arp,\n  getCampaignObject,\n  saveCampaignObject,\n  closeIframe\n} from './clevertap'\n\nimport {\n  CAMP_COOKIE_NAME,\n  DISPLAY,\n  GLOBAL,\n  EV_COOKIE,\n  NOTIFICATION_VIEWED,\n  NOTIFICATION_CLICKED,\n  WZRK_PREFIX,\n  WZRK_ID,\n  CAMP_COOKIE_G,\n  GCOOKIE_NAME\n} from './constants'\n\nimport {\n  getNow,\n  getToday\n} from './datetime'\n\nimport {\n  compressToBase64\n} from './encoder'\n\nimport { StorageManager, $ct } from './storage'\nimport RequestDispatcher from './requestDispatcher'\nimport { CTWebPersonalisationBanner } from './web-personalisation/banner'\nimport { CTWebPersonalisationCarousel } from './web-personalisation/carousel'\nimport { CTWebPopupImageOnly } from './web-popupImageonly/popupImageonly'\nimport { checkAndRegisterWebInboxElements, initializeWebInbox, processWebInboxSettings, hasWebInboxSettingsInLS, processInboxNotifs } from '../modules/web-inbox/helper'\n\nconst _tr = (msg, {\n  device,\n  session,\n  request,\n  logger,\n  isWebPopUpSpamControlDisabled\n}) => {\n  const _device = device\n  const _session = session\n  const _request = request\n  const _logger = logger\n  let _wizCounter = 0\n\n  // Campaign House keeping\n  const doCampHouseKeeping = (targetingMsgJson) => {\n    const campaignId = targetingMsgJson.wzrk_id.split('_')[0]\n    const today = getToday()\n\n    const incrCount = (obj, campaignId, excludeFromFreqCaps) => {\n      let currentCount = 0\n      let totalCount = 0\n      if (obj[campaignId] != null) {\n        currentCount = obj[campaignId]\n      }\n      currentCount++\n      if (obj.tc != null) {\n        totalCount = obj.tc\n      }\n      // if exclude from caps then dont add to total counts\n      if (excludeFromFreqCaps < 0) {\n        totalCount++\n      }\n\n      obj.tc = totalCount\n      obj[campaignId] = currentCount\n    }\n\n    if (StorageManager._isLocalStorageSupported()) {\n      delete sessionStorage[CAMP_COOKIE_NAME]\n      var campTypeObj = {}\n      const campObj = getCampaignObject()\n      if (targetingMsgJson.display.wtarget_type === 3 && campObj.hasOwnProperty('wi')) {\n        campTypeObj = campObj.wi\n      } else if ((targetingMsgJson.display.wtarget_type === 0 || targetingMsgJson.display.wtarget_type === 1) && campObj.hasOwnProperty('wp')) {\n        campTypeObj = campObj.wp\n      } else {\n        campTypeObj = {}\n      }\n      if (campObj.hasOwnProperty('global')) {\n        campTypeObj.wp = campObj\n      }\n      // global session limit. default is 1\n      if (targetingMsgJson[DISPLAY].wmc == null) {\n        targetingMsgJson[DISPLAY].wmc = 1\n      }\n\n      // global session limit for web inbox. default is 1\n      if (targetingMsgJson[DISPLAY].wimc == null) {\n        targetingMsgJson[DISPLAY].wimc = 1\n      }\n\n      var excludeFromFreqCaps = -1 // efc - Exclude from frequency caps\n      let campaignSessionLimit = -1 // mdc - Once per session\n      let campaignDailyLimit = -1 // tdc - Once per day\n      let campaignTotalLimit = -1 // tlc - Once per user for the duration of campaign\n      let totalDailyLimit = -1\n      let totalSessionLimit = -1 // wmc - Web Popup Global Session Limit\n      let totalInboxSessionLimit = -1 // wimc - Web Inbox Global Session Limit\n\n      if (targetingMsgJson[DISPLAY].efc != null) { // exclude from frequency cap\n        excludeFromFreqCaps = parseInt(targetingMsgJson[DISPLAY].efc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].mdc != null) { // Campaign Session Limit\n        campaignSessionLimit = parseInt(targetingMsgJson[DISPLAY].mdc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].tdc != null) { // No of web popups in a day per campaign\n        campaignDailyLimit = parseInt(targetingMsgJson[DISPLAY].tdc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].tlc != null) { // Total lifetime count\n        campaignTotalLimit = parseInt(targetingMsgJson[DISPLAY].tlc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].wmp != null) { // No of campaigns per day\n        totalDailyLimit = parseInt(targetingMsgJson[DISPLAY].wmp, 10)\n      }\n      if (targetingMsgJson[DISPLAY].wmc != null) { // No of campaigns per session\n        totalSessionLimit = parseInt(targetingMsgJson[DISPLAY].wmc, 10)\n      }\n\n      if (targetingMsgJson[DISPLAY].wimc != null) { // No of inbox campaigns per session\n        totalInboxSessionLimit = parseInt(targetingMsgJson[DISPLAY].wimc, 10)\n      }\n      // session level capping\n      var sessionObj = campTypeObj[_session.sessionId]\n      if (sessionObj) {\n        const campaignSessionCount = sessionObj[campaignId]\n        const totalSessionCount = sessionObj.tc\n        // dnd\n        if (campaignSessionCount === 'dnd' && !isWebPopUpSpamControlDisabled) {\n          return false\n        }\n\n        if (targetingMsgJson[DISPLAY].wtarget_type === 3) {\n          // Inbox session\n          if (totalInboxSessionLimit > 0 && totalSessionCount >= totalInboxSessionLimit && excludeFromFreqCaps < 0) {\n            return false\n          }\n        } else {\n          // session\n          if (totalSessionLimit > 0 && totalSessionCount >= totalSessionLimit && excludeFromFreqCaps < 0) {\n            return false\n          }\n        }\n\n        // campaign session\n        if (campaignSessionLimit > 0 && campaignSessionCount >= campaignSessionLimit) {\n          return false\n        }\n      } else {\n        sessionObj = {}\n        campTypeObj[_session.sessionId] = sessionObj\n      }\n\n      // daily level capping\n      var dailyObj = campTypeObj[today]\n      if (dailyObj != null) {\n        const campaignDailyCount = dailyObj[campaignId]\n        const totalDailyCount = dailyObj.tc\n        // daily\n        if (totalDailyLimit > 0 && totalDailyCount >= totalDailyLimit && excludeFromFreqCaps < 0) {\n          return false\n        }\n        // campaign daily\n        if (campaignDailyLimit > 0 && campaignDailyCount >= campaignDailyLimit) {\n          return false\n        }\n      } else {\n        dailyObj = {}\n        campTypeObj[today] = dailyObj\n      }\n\n      var globalObj = campTypeObj[GLOBAL]\n      if (globalObj != null) {\n        const campaignTotalCount = globalObj[campaignId]\n        // campaign total\n        if (campaignTotalLimit > 0 && campaignTotalCount >= campaignTotalLimit) {\n          return false\n        }\n      } else {\n        globalObj = {}\n        campTypeObj[GLOBAL] = globalObj\n      }\n    }\n    // delay\n    if (targetingMsgJson[DISPLAY].delay != null && targetingMsgJson[DISPLAY].delay > 0) {\n      const delay = targetingMsgJson[DISPLAY].delay\n      targetingMsgJson[DISPLAY].delay = 0\n      setTimeout(_tr, delay * 1000, msg, {\n        device: _device,\n        session: _session,\n        request: _request,\n        logger: _logger\n      })\n      return false\n    }\n\n    incrCount(sessionObj, campaignId, excludeFromFreqCaps)\n    incrCount(dailyObj, campaignId, excludeFromFreqCaps)\n    incrCount(globalObj, campaignId, excludeFromFreqCaps)\n\n    let campKey = 'wp'\n    if (targetingMsgJson[DISPLAY].wtarget_type === 3) {\n      campKey = 'wi'\n    }\n    // get ride of stale sessions and day entries\n    const newCampObj = {}\n    newCampObj[_session.sessionId] = sessionObj\n    newCampObj[today] = dailyObj\n    newCampObj[GLOBAL] = globalObj\n    saveCampaignObject({ [campKey]: newCampObj })\n  }\n\n  const getCookieParams = () => {\n    const gcookie = _device.getGuid()\n    const scookieObj = _session.getSessionCookieObject()\n    return '&t=wc&d=' + encodeURIComponent(compressToBase64(gcookie + '|' + scookieObj.p + '|' + scookieObj.s))\n  }\n\n  const setupClickEvent = (onClick, targetingMsgJson, contentDiv, divId, isLegacy) => {\n    if (onClick !== '' && onClick != null) {\n      let ctaElement\n      let jsCTAElements\n      if (isLegacy) {\n        ctaElement = contentDiv\n      } else if (contentDiv !== null) {\n        jsCTAElements = contentDiv.getElementsByClassName('jsCT_CTA')\n        if (jsCTAElements != null && jsCTAElements.length === 1) {\n          ctaElement = jsCTAElements[0]\n        }\n      }\n      const jsFunc = targetingMsgJson.display.jsFunc\n      const isPreview = targetingMsgJson.display.preview\n      if (isPreview == null) {\n        onClick += getCookieParams()\n      }\n\n      if (ctaElement != null) {\n        ctaElement.onclick = () => {\n          // invoke js function call\n          if (jsFunc != null) {\n            // track notification clicked event\n            if (isPreview == null) {\n              RequestDispatcher.fireRequest(onClick)\n            }\n            invokeExternalJs(jsFunc, targetingMsgJson)\n            // close iframe. using -1 for no campaignId\n            closeIframe('-1', divId, _session.sessionId)\n            return\n          }\n          // pass on the gcookie|page|scookieId for capturing the click event\n          if (targetingMsgJson.display.window === 1) {\n            window.open(onClick, '_blank')\n          } else {\n            window.location = onClick\n          }\n        }\n      }\n    }\n  }\n\n  const invokeExternalJs = (jsFunc, targetingMsgJson) => {\n    const func = window.parent[jsFunc]\n    if (typeof func === 'function') {\n      if (targetingMsgJson.display.kv != null) {\n        func(targetingMsgJson.display.kv)\n      } else {\n        func()\n      }\n    }\n  }\n\n  const setupClickUrl = (onClick, targetingMsgJson, contentDiv, divId, isLegacy) => {\n    incrementImpression(targetingMsgJson)\n    setupClickEvent(onClick, targetingMsgJson, contentDiv, divId, isLegacy)\n  }\n\n  const incrementImpression = (targetingMsgJson) => {\n    const data = {}\n    data.type = 'event'\n    data.evtName = NOTIFICATION_VIEWED\n    data.evtData = { [WZRK_ID]: targetingMsgJson.wzrk_id }\n    if (targetingMsgJson.wzrk_pivot) {\n      data.evtData = { ...data.evtData, wzrk_pivot: targetingMsgJson.wzrk_pivot }\n    }\n    _request.processEvent(data)\n  }\n\n  const renderPersonalisationBanner = (targetingMsgJson) => {\n    if (customElements.get('ct-web-personalisation-banner') === undefined) {\n      customElements.define('ct-web-personalisation-banner', CTWebPersonalisationBanner)\n    }\n    const divId = targetingMsgJson.display.divId ?? targetingMsgJson.display.divSelector\n    const bannerEl = document.createElement('ct-web-personalisation-banner')\n    bannerEl.msgId = targetingMsgJson.wzrk_id\n    bannerEl.pivotId = targetingMsgJson.wzrk_pivot\n    bannerEl.divHeight = targetingMsgJson.display.divHeight\n    bannerEl.details = targetingMsgJson.display.details[0]\n    const containerEl = targetingMsgJson.display.divId ? document.getElementById(divId) : document.querySelector(divId)\n    containerEl.innerHTML = ''\n    containerEl.appendChild(bannerEl)\n  }\n\n  const renderPersonalisationCarousel = (targetingMsgJson) => {\n    if (customElements.get('ct-web-personalisation-carousel') === undefined) {\n      customElements.define('ct-web-personalisation-carousel', CTWebPersonalisationCarousel)\n    }\n    const divId = targetingMsgJson.display.divId ?? targetingMsgJson.display.divSelector\n    const carousel = document.createElement('ct-web-personalisation-carousel')\n    carousel.target = targetingMsgJson\n    const container = targetingMsgJson.display.divId ? document.getElementById(divId) : document.querySelector(divId)\n    container.innerHTML = ''\n    container.appendChild(carousel)\n  }\n\n  const renderPopUpImageOnly = (targetingMsgJson) => {\n    const divId = 'wzrkImageOnlyDiv'\n    const popupImageOnly = document.createElement('ct-web-popup-imageonly')\n    popupImageOnly.session = _session\n    popupImageOnly.target = targetingMsgJson\n    const containerEl = document.getElementById(divId)\n    containerEl.innerHTML = ''\n    containerEl.style.visibility = 'hidden'\n    containerEl.appendChild(popupImageOnly)\n  }\n\n  const renderFooterNotification = (targetingMsgJson) => {\n    const campaignId = targetingMsgJson.wzrk_id.split('_')[0]\n    const displayObj = targetingMsgJson.display\n\n    if (displayObj.wtarget_type === 2) { // Handling Web Native display\n      // Logic for kv pair data\n      if (targetingMsgJson.msgContent.type === 1) {\n        const inaObj = {}\n\n        inaObj.msgId = targetingMsgJson.wzrk_id\n        if (targetingMsgJson.wzrk_pivot) {\n          inaObj.pivotId = targetingMsgJson.wzrk_pivot\n        }\n        if (targetingMsgJson.msgContent.kv != null) {\n          inaObj.kv = targetingMsgJson.msgContent.kv\n        }\n        const kvPairsEvent = new CustomEvent('CT_web_native_display', { detail: inaObj })\n        document.dispatchEvent(kvPairsEvent)\n        return\n      }\n    }\n    if (displayObj.layout === 1) { // Handling Web Exit Intent\n      return showExitIntent(undefined, targetingMsgJson)\n    }\n    if (displayObj.layout === 3) { // Handling Web Popup Image Only\n      const divId = 'wzrkImageOnlyDiv'\n      if (doCampHouseKeeping(targetingMsgJson) === false) {\n        return\n      }\n      if (isWebPopUpSpamControlDisabled && document.getElementById(divId) != null) {\n        const element = document.getElementById(divId)\n        element.remove()\n      }\n      if (document.getElementById(divId) != null) {\n        return\n      }\n      const msgDiv = document.createElement('div')\n      msgDiv.id = divId\n      document.body.appendChild(msgDiv)\n      if (customElements.get('ct-web-popup-imageonly') === undefined) {\n        customElements.define('ct-web-popup-imageonly', CTWebPopupImageOnly)\n      }\n      return renderPopUpImageOnly(targetingMsgJson)\n    }\n\n    if (doCampHouseKeeping(targetingMsgJson) === false) {\n      return\n    }\n\n    const divId = 'wizParDiv' + displayObj.layout\n\n    if (isWebPopUpSpamControlDisabled && document.getElementById(divId) != null) {\n      const element = document.getElementById(divId)\n      element.remove()\n    }\n    if (document.getElementById(divId) != null) {\n      return\n    }\n    $ct.campaignDivMap[campaignId] = divId\n    const isBanner = displayObj.layout === 2\n    const msgDiv = document.createElement('div')\n    msgDiv.id = divId\n    const viewHeight = window.innerHeight\n    const viewWidth = window.innerWidth\n    let legacy = false\n\n    if (!isBanner) {\n      const marginBottom = viewHeight * 5 / 100\n      var contentHeight = 10\n      let right = viewWidth * 5 / 100\n      let bottomPosition = contentHeight + marginBottom\n      let width = viewWidth * 30 / 100 + 20\n      let widthPerct = 'width:30%;'\n      // for small devices  - mobile phones\n      if ((/mobile/i.test(navigator.userAgent) || (/mini/i.test(navigator.userAgent))) && /iPad/i.test(navigator.userAgent) === false) {\n        width = viewWidth * 85 / 100 + 20\n        right = viewWidth * 5 / 100\n        bottomPosition = viewHeight * 5 / 100\n        widthPerct = 'width:80%;'\n        // medium devices - tablets\n      } else if ('ontouchstart' in window || (/tablet/i.test(navigator.userAgent))) {\n        width = viewWidth * 50 / 100 + 20\n        right = viewWidth * 5 / 100\n        bottomPosition = viewHeight * 5 / 100\n        widthPerct = 'width:50%;'\n      }\n      // legacy footer notif\n      if (displayObj.proto == null) {\n        legacy = true\n        msgDiv.setAttribute('style', 'display:block;overflow:hidden; bottom:' + bottomPosition + 'px !important;width:' + width + 'px !important;right:' + right + 'px !important;position:fixed;z-index:2147483647;')\n      } else {\n        msgDiv.setAttribute('style', widthPerct + displayObj.iFrameStyle)\n      }\n    } else {\n      msgDiv.setAttribute('style', displayObj.iFrameStyle)\n    }\n    document.body.appendChild(msgDiv)\n    const iframe = document.createElement('iframe')\n\n    const borderRadius = displayObj.br === false ? '0' : '8'\n\n    iframe.frameborder = '0px'\n    iframe.marginheight = '0px'\n    iframe.marginwidth = '0px'\n    iframe.scrolling = 'no'\n    iframe.id = 'wiz-iframe'\n    const onClick = targetingMsgJson.display.onClick\n    let pointerCss = ''\n    if (onClick !== '' && onClick != null) {\n      pointerCss = 'cursor:pointer;'\n    }\n\n    let html\n    // direct html\n    if (targetingMsgJson.msgContent.type === 1) {\n      html = targetingMsgJson.msgContent.html\n      html = html.replace(/##campaignId##/g, campaignId)\n      html = html.replace(/##campaignId_batchId##/g, targetingMsgJson.wzrk_id)\n    } else {\n      const css = '' +\n        '<style type=\"text/css\">' +\n        'body{margin:0;padding:0;}' +\n        '#contentDiv.wzrk{overflow:hidden;padding:0;text-align:center;' + pointerCss + '}' +\n        '#contentDiv.wzrk td{padding:15px 10px;}' +\n        '.wzrkPPtitle{font-weight: bold;font-size: 16px;font-family:arial;padding-bottom:10px;word-break: break-word;}' +\n        '.wzrkPPdscr{font-size: 14px;font-family:arial;line-height:16px;word-break: break-word;display:inline-block;}' +\n        '.PL15{padding-left:15px;}' +\n        '.wzrkPPwarp{margin:20px 20px 0 5px;padding:0px;border-radius: ' + borderRadius + 'px;box-shadow: 1px 1px 5px #888888;}' +\n        'a.wzrkClose{cursor:pointer;position: absolute;top: 11px;right: 11px;z-index: 2147483647;font-size:19px;font-family:arial;font-weight:bold;text-decoration: none;width: 25px;/*height: 25px;*/text-align: center; -webkit-appearance: none; line-height: 25px;' +\n        'background: #353535;border: #fff 2px solid;border-radius: 100%;box-shadow: #777 2px 2px 2px;color:#fff;}' +\n        'a:hover.wzrkClose{background-color:#d1914a !important;color:#fff !important; -webkit-appearance: none;}' +\n        'td{vertical-align:top;}' +\n        'td.imgTd{border-top-left-radius:8px;border-bottom-left-radius:8px;}' +\n        '</style>'\n\n      let bgColor, textColor, btnBg, leftTd, btColor\n      if (targetingMsgJson.display.theme === 'dark') {\n        bgColor = '#2d2d2e'\n        textColor = '#eaeaea'\n        btnBg = '#353535'\n        leftTd = '#353535'\n        btColor = '#ffffff'\n      } else {\n        bgColor = '#ffffff'\n        textColor = '#000000'\n        leftTd = '#f4f4f4'\n        btnBg = '#a5a6a6'\n        btColor = '#ffffff'\n      }\n      const titleText = targetingMsgJson.msgContent.title\n      const descriptionText = targetingMsgJson.msgContent.description\n      let imageTd = ''\n      if (targetingMsgJson.msgContent.imageUrl != null && targetingMsgJson.msgContent.imageUrl !== '') {\n        imageTd = \"<td class='imgTd' style='background-color:\" + leftTd + \"'><img src='\" + targetingMsgJson.msgContent.imageUrl + \"' height='60' width='60'></td>\"\n      }\n      const onClickStr = 'parent.$WZRK_WR.closeIframe(' + campaignId + \",'\" + divId + \"');\"\n      const title = \"<div class='wzrkPPwarp' style='color:\" + textColor + ';background-color:' + bgColor + \";'>\" +\n        \"<a href='javascript:void(0);' onclick=\" + onClickStr + \" class='wzrkClose' style='background-color:\" + btnBg + ';color:' + btColor + \"'>&times;</a>\" +\n        \"<div id='contentDiv' class='wzrk'>\" +\n        \"<table cellpadding='0' cellspacing='0' border='0'>\" +\n        // \"<tr><td colspan='2'></td></tr>\"+\n        '<tr>' + imageTd + \"<td style='vertical-align:top;'>\" +\n        \"<div class='wzrkPPtitle' style='color:\" + textColor + \"'>\" + titleText + '</div>'\n      const body = \"<div class='wzrkPPdscr' style='color:\" + textColor + \"'>\" + descriptionText + '<div></td></tr></table></div>'\n      html = css + title + body\n    }\n\n    iframe.setAttribute('style', 'z-index: 2147483647; display:block; width: 100% !important; border:0px !important; border-color:none !important;')\n    msgDiv.appendChild(iframe)\n    const ifrm = (iframe.contentWindow) ? iframe.contentWindow : (iframe.contentDocument.document) ? iframe.contentDocument.document : iframe.contentDocument\n    const doc = ifrm.document\n\n    doc.open()\n    doc.write(html)\n\n    if (displayObj['custom-editor']) {\n      appendScriptForCustomEvent(targetingMsgJson, doc)\n    }\n    doc.close()\n\n    const adjustIFrameHeight = () => {\n      // adjust iframe and body height of html inside correctly\n      contentHeight = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv').scrollHeight\n      if (displayObj['custom-editor'] !== true && !isBanner) {\n        contentHeight += 25\n      }\n      document.getElementById('wiz-iframe').contentDocument.body.style.margin = '0px'\n      document.getElementById('wiz-iframe').style.height = contentHeight + 'px'\n    }\n\n    const ua = navigator.userAgent.toLowerCase()\n    if (ua.indexOf('safari') !== -1) {\n      if (ua.indexOf('chrome') > -1) {\n        iframe.onload = () => {\n          adjustIFrameHeight()\n          const contentDiv = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv')\n          setupClickUrl(onClick, targetingMsgJson, contentDiv, divId, legacy)\n        }\n      } else {\n        let inDoc = iframe.contentDocument || iframe.contentWindow\n        if (inDoc.document) inDoc = inDoc.document\n        // safari iphone 7+ needs this.\n        adjustIFrameHeight()\n        const _timer = setInterval(() => {\n          if (inDoc.readyState === 'complete') {\n            clearInterval(_timer)\n            // adjust iframe and body height of html inside correctly\n            adjustIFrameHeight()\n            const contentDiv = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv')\n            setupClickUrl(onClick, targetingMsgJson, contentDiv, divId, legacy)\n          }\n        }, 10)\n      }\n    } else {\n      iframe.onload = () => {\n        // adjust iframe and body height of html inside correctly\n        adjustIFrameHeight()\n        const contentDiv = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv')\n        setupClickUrl(onClick, targetingMsgJson, contentDiv, divId, legacy)\n      }\n    }\n  }\n\n  const appendScriptForCustomEvent = (targetingMsgJson, doc) => {\n    const script = doc.createElement('script')\n    script.innerHTML = `\n      const ct__camapignId = '${targetingMsgJson.wzrk_id}';\n      const ct__formatVal = (v) => {\n          return v && v.trim().substring(0, 20);\n      }\n      const ct__parentOrigin =  window.parent.origin;\n      document.body.addEventListener('click', (event) => {\n        const elem = event.target.closest?.('a[wzrk_c2a], button[wzrk_c2a]');\n        if (elem) {\n            const {innerText, id, name, value, href} = elem;\n            const clickAttr = elem.getAttribute('onclick') || elem.getAttribute('click');\n            const onclickURL = clickAttr?.match(/(window.open)[(\\](\\\"|')(.*)(\\\"|',)/)?.[3] || clickAttr?.match(/(location.href *= *)(\\\"|')(.*)(\\\"|')/)?.[3];\n            const props = {innerText, id, name, value};\n            let msgCTkv = Object.keys(props).reduce((acc, c) => {\n                const formattedVal = ct__formatVal(props[c]);\n                formattedVal && (acc['wzrk_click_' + c] = formattedVal);\n                return acc;\n            }, {});\n            if(onclickURL) { msgCTkv['wzrk_click_' + 'url'] = onclickURL; }\n            if(href) { msgCTkv['wzrk_click_' + 'c2a'] = href; }\n            const notifData = { msgId: ct__camapignId, msgCTkv, pivotId: '${targetingMsgJson.wzrk_pivot}' };\n            window.parent.clevertap.renderNotificationClicked(notifData);\n        }\n      });\n    `\n    doc.body.appendChild(script)\n  }\n\n  let _callBackCalled = false\n\n  const showFooterNotification = (targetingMsgJson) => {\n    let onClick = targetingMsgJson.display.onClick\n\n    // TODO: Needs wizrocket as a global variable\n    if (window.clevertap.hasOwnProperty('notificationCallback') &&\n      typeof window.clevertap.notificationCallback !== 'undefined' &&\n      typeof window.clevertap.notificationCallback === 'function') {\n      const notificationCallback = window.clevertap.notificationCallback\n\n      if (!_callBackCalled) {\n        const inaObj = {}\n        inaObj.msgContent = targetingMsgJson.msgContent\n        inaObj.msgId = targetingMsgJson.wzrk_id\n        if (targetingMsgJson.wzrk_pivot) {\n          inaObj.pivotId = targetingMsgJson.wzrk_pivot\n        }\n        if (targetingMsgJson.display.kv != null) {\n          inaObj.kv = targetingMsgJson.display.kv\n        }\n\n        window.clevertap.raiseNotificationClicked = () => {\n          if (onClick !== '' && onClick != null) {\n            const jsFunc = targetingMsgJson.display.jsFunc\n            onClick += getCookieParams()\n\n            // invoke js function call\n            if (jsFunc != null) {\n              // track notification clicked event\n              RequestDispatcher.fireRequest(onClick)\n              invokeExternalJs(jsFunc, targetingMsgJson)\n              return\n            }\n            // pass on the gcookie|page|scookieId for capturing the click event\n            if (targetingMsgJson.display.window === 1) {\n              window.open(onClick, '_blank')\n            } else {\n              window.location = onClick\n            }\n          }\n        }\n        window.clevertap.raiseNotificationViewed = () => {\n          incrementImpression(targetingMsgJson)\n        }\n        notificationCallback(inaObj)\n        _callBackCalled = true\n      }\n    } else {\n      window.clevertap.popupCurrentWzrkId = targetingMsgJson.wzrk_id\n      renderFooterNotification(targetingMsgJson)\n\n      if (window.clevertap.hasOwnProperty('popupCallbacks') &&\n        typeof window.clevertap.popupCallbacks !== 'undefined' &&\n        typeof window.clevertap.popupCallbacks[targetingMsgJson.wzrk_id] === 'function') {\n        const popupCallback = window.clevertap.popupCallbacks[targetingMsgJson.wzrk_id]\n\n        const inaObj = {}\n        inaObj.msgContent = targetingMsgJson.msgContent\n        inaObj.msgId = targetingMsgJson.wzrk_id\n\n        if (targetingMsgJson.wzrk_pivot) {\n          inaObj.pivotId = targetingMsgJson.wzrk_pivot\n        }\n\n        var msgCTkv = []\n        for (var wzrkPrefixKey in targetingMsgJson) {\n          // ADD WZRK PREFIX KEY VALUE PAIRS\n          if (wzrkPrefixKey.startsWith(WZRK_PREFIX) && wzrkPrefixKey !== WZRK_ID) {\n            const wzrkJson = { [wzrkPrefixKey]: targetingMsgJson[wzrkPrefixKey] }\n            msgCTkv.push(wzrkJson)\n          }\n        }\n\n        if (msgCTkv.length > 0) {\n          inaObj.msgCTkv = msgCTkv\n        }\n        if (targetingMsgJson.display.kv != null) {\n          inaObj.kv = targetingMsgJson.display.kv\n        }\n\n        // PUBLIC API TO RECORD CLICKED EVENT\n        window.clevertap.raisePopupNotificationClicked = (notificationData) => {\n          if (!notificationData || !notificationData.msgId) { return }\n\n          const eventData = {}\n          eventData.type = 'event'\n          eventData.evtName = NOTIFICATION_CLICKED\n          eventData.evtData = { [WZRK_ID]: notificationData.msgId }\n          if (targetingMsgJson.wzrk_pivot) {\n            eventData.evtData = { ...eventData.evtData, wzrk_pivot: notificationData.pivotId }\n          }\n\n          // WZRK PREFIX KEY VALUE PAIRS\n          if (notificationData.msgCTkv) {\n            for (var wzrkPrefixObj of notificationData.msgCTkv) {\n              eventData.evtData = { ...eventData.evtData, ...wzrkPrefixObj }\n            }\n          }\n\n          _request.processEvent(eventData)\n        }\n        popupCallback(inaObj)\n      }\n    }\n  }\n\n  let exitintentObj\n  const showExitIntent = (event, targetObj) => {\n    let targetingMsgJson\n    if (event != null && event.clientY > 0) {\n      return\n    }\n    if (targetObj == null) {\n      targetingMsgJson = exitintentObj\n    } else {\n      targetingMsgJson = targetObj\n    }\n\n    if (isWebPopUpSpamControlDisabled && targetingMsgJson.display.wtarget_type === 0 && document.getElementById('intentPreview') != null && document.getElementById('intentOpacityDiv') != null) {\n      const element = document.getElementById('intentPreview')\n      element.remove()\n      document.getElementById('intentOpacityDiv').remove()\n    }\n\n    if (document.getElementById('intentPreview') != null) {\n      return\n    }\n    // dont show exit intent on tablet/mobile - only on desktop\n    if (targetingMsgJson.display.layout == null &&\n      ((/mobile/i.test(navigator.userAgent)) || (/mini/i.test(navigator.userAgent)) || (/iPad/i.test(navigator.userAgent)) ||\n        ('ontouchstart' in window) || (/tablet/i.test(navigator.userAgent)))) {\n      return\n    }\n\n    if (doCampHouseKeeping(targetingMsgJson) === false) {\n      return\n    }\n    const campaignId = targetingMsgJson.wzrk_id.split('_')[0]\n    $ct.campaignDivMap[campaignId] = 'intentPreview'\n    let legacy = false\n    const opacityDiv = document.createElement('div')\n    opacityDiv.id = 'intentOpacityDiv'\n    opacityDiv.setAttribute('style', 'position: fixed;top: 0;bottom: 0;left: 0;width: 100%;height: 100%;z-index: 2147483646;background: rgba(0,0,0,0.7);')\n    document.body.appendChild(opacityDiv)\n\n    const msgDiv = document.createElement('div')\n    msgDiv.id = 'intentPreview'\n\n    if (targetingMsgJson.display.proto == null) {\n      legacy = true\n      msgDiv.setAttribute('style', 'display:block;overflow:hidden;top:55% !important;left:50% !important;position:fixed;z-index:2147483647;width:600px !important;height:600px !important;margin:-300px 0 0 -300px !important;')\n    } else {\n      msgDiv.setAttribute('style', targetingMsgJson.display.iFrameStyle)\n    }\n    document.body.appendChild(msgDiv)\n    const iframe = document.createElement('iframe')\n    const borderRadius = targetingMsgJson.display.br === false ? '0' : '8'\n    iframe.frameborder = '0px'\n    iframe.marginheight = '0px'\n    iframe.marginwidth = '0px'\n    iframe.scrolling = 'no'\n    iframe.id = 'wiz-iframe-intent'\n    const onClick = targetingMsgJson.display.onClick\n    let pointerCss = ''\n    if (onClick !== '' && onClick != null) {\n      pointerCss = 'cursor:pointer;'\n    }\n    let html\n    // direct html\n    if (targetingMsgJson.msgContent.type === 1) {\n      html = targetingMsgJson.msgContent.html\n      html = html.replace(/##campaignId##/g, campaignId)\n      html = html.replace(/##campaignId_batchId##/g, targetingMsgJson.wzrk_id)\n    } else {\n      const css = '' +\n        '<style type=\"text/css\">' +\n        'body{margin:0;padding:0;}' +\n        '#contentDiv.wzrk{overflow:hidden;padding:0 0 20px 0;text-align:center;' + pointerCss + '}' +\n        '#contentDiv.wzrk td{padding:15px 10px;}' +\n        '.wzrkPPtitle{font-weight: bold;font-size: 24px;font-family:arial;word-break: break-word;padding-top:20px;}' +\n        '.wzrkPPdscr{font-size: 14px;font-family:arial;line-height:16px;word-break: break-word;display:inline-block;padding:20px 20px 0 20px;line-height:20px;}' +\n        '.PL15{padding-left:15px;}' +\n        '.wzrkPPwarp{margin:20px 20px 0 5px;padding:0px;border-radius: ' + borderRadius + 'px;box-shadow: 1px 1px 5px #888888;}' +\n        'a.wzrkClose{cursor:pointer;position: absolute;top: 11px;right: 11px;z-index: 2147483647;font-size:19px;font-family:arial;font-weight:bold;text-decoration: none;width: 25px;/*height: 25px;*/text-align: center; -webkit-appearance: none; line-height: 25px;' +\n        'background: #353535;border: #fff 2px solid;border-radius: 100%;box-shadow: #777 2px 2px 2px;color:#fff;}' +\n        'a:hover.wzrkClose{background-color:#d1914a !important;color:#fff !important; -webkit-appearance: none;}' +\n        '#contentDiv .button{padding-top:20px;}' +\n        '#contentDiv .button a{font-size: 14px;font-weight:bold;font-family:arial;text-align:center;display:inline-block;text-decoration:none;padding:0 30px;height:40px;line-height:40px;background:#ea693b;color:#fff;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;}' +\n        '</style>'\n\n      let bgColor, textColor, btnBg, btColor\n      if (targetingMsgJson.display.theme === 'dark') {\n        bgColor = '#2d2d2e'\n        textColor = '#eaeaea'\n        btnBg = '#353535'\n        btColor = '#ffffff'\n      } else {\n        bgColor = '#ffffff'\n        textColor = '#000000'\n        btnBg = '#a5a6a6'\n        btColor = '#ffffff'\n      }\n      const titleText = targetingMsgJson.msgContent.title\n      const descriptionText = targetingMsgJson.msgContent.description\n      let ctaText = ''\n      if (targetingMsgJson.msgContent.ctaText != null && targetingMsgJson.msgContent.ctaText !== '') {\n        ctaText = \"<div class='button'><a href='#'>\" + targetingMsgJson.msgContent.ctaText + '</a></div>'\n      }\n\n      let imageTd = ''\n      if (targetingMsgJson.msgContent.imageUrl != null && targetingMsgJson.msgContent.imageUrl !== '') {\n        imageTd = \"<div style='padding-top:20px;'><img src='\" + targetingMsgJson.msgContent.imageUrl + \"' width='500' alt=\" + titleText + ' /></div>'\n      }\n      const onClickStr = 'parent.$WZRK_WR.closeIframe(' + campaignId + \",'intentPreview');\"\n      const title = \"<div class='wzrkPPwarp' style='color:\" + textColor + ';background-color:' + bgColor + \";'>\" +\n        \"<a href='javascript:void(0);' onclick=\" + onClickStr + \" class='wzrkClose' style='background-color:\" + btnBg + ';color:' + btColor + \"'>&times;</a>\" +\n        \"<div id='contentDiv' class='wzrk'>\" +\n        \"<div class='wzrkPPtitle' style='color:\" + textColor + \"'>\" + titleText + '</div>'\n      const body = \"<div class='wzrkPPdscr' style='color:\" + textColor + \"'>\" + descriptionText + '</div>' + imageTd + ctaText +\n        '</div></div>'\n      html = css + title + body\n    }\n    iframe.setAttribute('style', 'z-index: 2147483647; display:block; height: 100% !important; width: 100% !important;min-height:80px !important;border:0px !important; border-color:none !important;')\n    msgDiv.appendChild(iframe)\n    const ifrm = (iframe.contentWindow) ? iframe.contentWindow : (iframe.contentDocument.document) ? iframe.contentDocument.document : iframe.contentDocument\n    const doc = ifrm.document\n\n    doc.open()\n    doc.write(html)\n    if (targetingMsgJson.display['custom-editor']) {\n      appendScriptForCustomEvent(targetingMsgJson, doc)\n    }\n    doc.close()\n\n    const contentDiv = document.getElementById('wiz-iframe-intent').contentDocument.getElementById('contentDiv')\n    setupClickUrl(onClick, targetingMsgJson, contentDiv, 'intentPreview', legacy)\n  }\n\n  if (!document.body) {\n    if (_wizCounter < 6) {\n      _wizCounter++\n      setTimeout(_tr, 1000, msg, {\n        device: _device,\n        session: _session,\n        request: _request,\n        logger: _logger\n      })\n    }\n    return\n  }\n  const processNativeDisplayArr = (arrInAppNotifs) => {\n    Object.keys(arrInAppNotifs).map(key => {\n      var elementId, id\n      if (arrInAppNotifs[key].display.divId) {\n        elementId = arrInAppNotifs[key].display.divId\n        id = document.getElementById(elementId)\n      } else {\n        elementId = arrInAppNotifs[key].display.divSelector\n        id = document.querySelector(elementId)\n      }\n      if (id !== null) {\n        arrInAppNotifs[key].msgContent.type === 2 ? renderPersonalisationBanner(arrInAppNotifs[key]) : renderPersonalisationCarousel(arrInAppNotifs[key])\n        delete arrInAppNotifs[key]\n      }\n    })\n  }\n\n  const addLoadListener = (arrInAppNotifs) => {\n    window.addEventListener('load', () => {\n      let count = 0\n      if (count < 20) {\n        const t = setInterval(() => {\n          processNativeDisplayArr(arrInAppNotifs)\n          if (Object.keys(arrInAppNotifs).length === 0 || count === 20) {\n            clearInterval(t)\n            arrInAppNotifs = {}\n          }\n          count++\n        }, 500)\n      }\n    })\n  }\n\n  if (msg.inapp_notifs != null) {\n    const arrInAppNotifs = {}\n    for (let index = 0; index < msg.inapp_notifs.length; index++) {\n      const targetNotif = msg.inapp_notifs[index]\n      if (targetNotif.display.wtarget_type == null || targetNotif.display.wtarget_type === 0) {\n        showFooterNotification(targetNotif)\n      } else if (targetNotif.display.wtarget_type === 1) { // if display['wtarget_type']==1 then exit intent\n        exitintentObj = targetNotif\n        window.document.body.onmouseleave = showExitIntent\n      } else if (targetNotif.display.wtarget_type === 2) { // if display['wtarget_type']==2 then web native display\n        if (targetNotif.msgContent.type === 2 || targetNotif.msgContent.type === 3) { // Check for banner and carousel\n          const element = targetNotif.display.divId ? document.getElementById(targetNotif.display.divId) : document.querySelector(targetNotif.display.divSelector)\n          if (element !== null) {\n            targetNotif.msgContent.type === 2 ? renderPersonalisationBanner(targetNotif) : renderPersonalisationCarousel(targetNotif)\n          } else {\n            arrInAppNotifs[targetNotif.wzrk_id.split('_')[0]] = targetNotif // Add targetNotif to object\n          }\n        } else {\n          showFooterNotification(targetNotif)\n        }\n      }\n    }\n    // Process banner or carousel campaign array\n    if (Object.keys(arrInAppNotifs).length) {\n      if (document.readyState === 'complete') {\n        processNativeDisplayArr(arrInAppNotifs)\n      } else {\n        addLoadListener(arrInAppNotifs)\n      }\n    }\n  }\n\n  const mergeEventMap = (newEvtMap) => {\n    if ($ct.globalEventsMap == null) {\n      $ct.globalEventsMap = StorageManager.readFromLSorCookie(EV_COOKIE)\n      if ($ct.globalEventsMap == null) {\n        $ct.globalEventsMap = newEvtMap\n        return\n      }\n    }\n    for (const key in newEvtMap) {\n      if (newEvtMap.hasOwnProperty(key)) {\n        const oldEvtObj = $ct.globalEventsMap[key]\n        const newEvtObj = newEvtMap[key]\n        if ($ct.globalEventsMap[key] != null) {\n          if (newEvtObj[0] != null && newEvtObj[0] > oldEvtObj[0]) {\n            $ct.globalEventsMap[key] = newEvtObj\n          }\n        } else {\n          $ct.globalEventsMap[key] = newEvtObj\n        }\n      }\n    }\n  }\n\n  const handleInboxNotifications = () => {\n    if (msg.inbox_preview) {\n      processInboxNotifs(msg)\n      return\n    }\n    if (msg.inbox_notifs) {\n      const msgArr = []\n      for (let index = 0; index < msg.inbox_notifs.length; index++) {\n        if (doCampHouseKeeping(msg.inbox_notifs[index]) !== false) {\n          msgArr.push(msg.inbox_notifs[index])\n        }\n      }\n      processInboxNotifs(msgArr)\n    }\n  }\n\n  if (msg.webInboxSetting || msg.inbox_notifs != null) {\n    /**\n     * When the user visits a website for the 1st time after web inbox channel is setup,\n     * we need to initialise the inbox here because the initializeWebInbox method within init will not be executed\n     * as we would not have any entry related to webInboxSettings in the LS\n     */\n\n    if (hasWebInboxSettingsInLS()) {\n      checkAndRegisterWebInboxElements()\n    }\n    if ($ct.inbox === null) {\n      msg.webInboxSetting && processWebInboxSettings(msg.webInboxSetting)\n      initializeWebInbox(_logger)\n        .then(() => {\n          handleInboxNotifications()\n        })\n        .catch(e => {})\n    } else {\n      handleInboxNotifications()\n    }\n  }\n\n  const staleDataUpdate = (staledata, campType) => {\n    const campObj = getCampaignObject()\n    const globalObj = campObj[campType].global\n    if (globalObj != null && campType) {\n      for (const idx in staledata) {\n        if (staledata.hasOwnProperty(idx)) {\n          delete globalObj[staledata[idx]]\n          if (StorageManager.read(CAMP_COOKIE_G)) {\n            const guidCampObj = JSON.parse(decodeURIComponent(StorageManager.read(CAMP_COOKIE_G)))\n            const guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n            if (guidCampObj[guid] && guidCampObj[guid][campType] && guidCampObj[guid][campType][staledata[idx]]) {\n              delete guidCampObj[guid][campType][staledata[idx]]\n              StorageManager.save(CAMP_COOKIE_G, encodeURIComponent(JSON.stringify(guidCampObj)))\n            }\n          }\n        }\n      }\n    }\n    saveCampaignObject(campObj)\n  }\n\n  if (StorageManager._isLocalStorageSupported()) {\n    try {\n      if (msg.evpr != null) {\n        const eventsMap = msg.evpr.events\n        const profileMap = msg.evpr.profile\n        const syncExpiry = msg.evpr.expires_in\n        const now = getNow()\n        StorageManager.setMetaProp('lsTime', now)\n        StorageManager.setMetaProp('exTs', syncExpiry)\n        mergeEventMap(eventsMap)\n        StorageManager.saveToLSorCookie(EV_COOKIE, $ct.globalEventsMap)\n        if ($ct.globalProfileMap == null) {\n          addToLocalProfileMap(profileMap, true)\n        } else {\n          addToLocalProfileMap(profileMap, false)\n        }\n      }\n      if (msg.arp != null) {\n        arp(msg.arp)\n      }\n      if (msg.inapp_stale != null && msg.inapp_stale.length > 0) {\n        // web popup stale\n        staleDataUpdate(msg.inapp_stale, 'wp')\n      }\n      if (msg.inbox_stale != null && msg.inbox_stale.length > 0) {\n        // web inbox stale\n        staleDataUpdate(msg.inbox_stale, 'wi')\n      }\n    } catch (e) {\n      _logger.error('Unable to persist evrp/arp: ' + e)\n    }\n  }\n}\n\nexport default _tr\n","import {\n  StorageManager\n} from '../util/storage'\nexport default class User {\n  #isPersonalisationActive\n\n  constructor ({\n    isPersonalisationActive\n  }) {\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  getTotalVisits () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    let visitCount = StorageManager.getMetaProp('sc')\n    if (visitCount == null) {\n      visitCount = 1\n    }\n    return visitCount\n  }\n\n  getLastVisit () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    const prevSession = StorageManager.getMetaProp('ps')\n    if (prevSession != null) {\n      return new Date(prevSession * 1000)\n    }\n  }\n}\n","import {\n  CLEVERTAP_ERROR_PREFIX\n} from '../util/messages'\n\nexport const logLevels = {\n  DISABLE: 0,\n  ERROR: 1,\n  INFO: 2,\n  DEBUG: 3\n}\n\nexport class Logger {\n  #logLevel\n  wzrkError = {}\n  constructor (logLevel) {\n    this.#logLevel = logLevel == null ? logLevel : logLevels.INFO\n    this.wzrkError = {}\n  }\n\n  get logLevel () {\n    return this.#logLevel\n  }\n\n  set logLevel (logLevel) {\n    this.#logLevel = logLevel\n  }\n\n  error (message) {\n    if (this.#logLevel >= logLevels.ERROR) {\n      this.#log('error', message)\n    }\n  }\n\n  info (message) {\n    if (this.#logLevel >= logLevels.INFO) {\n      this.#log('log', message)\n    }\n  }\n\n  debug (message) {\n    if (this.#logLevel >= logLevels.DEBUG || this.#isLegacyDebug) {\n      this.#log('debug', message)\n    }\n  }\n\n  reportError (code, description) {\n    this.wzrkError.c = code\n    this.wzrkError.d = description\n    this.error(`${CLEVERTAP_ERROR_PREFIX} ${code}: ${description}`)\n  }\n\n  #log (level, message) {\n    if (window.console) {\n      try {\n        const ts = new Date().getTime()\n        console[level](`CleverTap [${ts}]: ${message}`)\n      } catch (e) {}\n    }\n  }\n\n  get #isLegacyDebug () {\n    return (typeof sessionStorage !== 'undefined' && sessionStorage.WZRK_D === '')\n  }\n}\n\nexport default {\n  Logger,\n  logLevels\n}\n","import { singleQuoteRegex, SCOOKIE_EXP_TIME_IN_SECS } from '../util/constants'\nimport { isObject } from '../util/datatypes'\nimport { getNow } from '../util/datetime'\nimport { StorageManager } from '../util/storage'\nimport { getHostName } from '../util/url'\n\nexport default class SessionManager {\n  #logger\n  #sessionId\n  #isPersonalisationActive\n  cookieName // SCOOKIE_NAME\n  scookieObj\n\n  constructor ({\n    logger,\n    isPersonalisationActive\n  }) {\n    this.sessionId = StorageManager.getMetaProp('cs')\n    this.#logger = logger\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  get sessionId () {\n    return this.#sessionId\n  }\n\n  set sessionId (sessionId) {\n    this.#sessionId = sessionId\n  }\n\n  getSessionCookieObject () {\n    let scookieStr = StorageManager.readCookie(this.cookieName)\n    let obj = {}\n\n    if (scookieStr != null) {\n      // converting back single quotes to double for JSON parsing - http://www.iandevlin.com/blog/2012/04/html5/cookies-json-localstorage-and-opera\n      scookieStr = scookieStr.replace(singleQuoteRegex, '\"')\n\n      obj = JSON.parse(scookieStr)\n      if (!isObject(obj)) {\n        obj = {}\n      } else {\n        if (typeof obj.t !== 'undefined') { // check time elapsed since last request\n          const lastTime = obj.t\n          const now = getNow()\n          if ((now - lastTime) > (SCOOKIE_EXP_TIME_IN_SECS + 60)) {\n            // adding 60 seconds to compensate for in-journey requests\n            // ideally the cookie should've died after SCOOKIE_EXP_TIME_IN_SECS but it's still around as we can read\n            // hence we shouldn't use it.\n            obj = {}\n          }\n        }\n      }\n    }\n    this.scookieObj = obj\n    return obj\n  }\n\n  setSessionCookieObject (obj) {\n    const objStr = JSON.stringify(obj)\n    StorageManager.createBroadCookie(this.cookieName, objStr, SCOOKIE_EXP_TIME_IN_SECS, getHostName())\n  }\n\n  manageSession (session) {\n    // first time. check if current session id in localstorage is same\n    // if not same then prev = current and current = this new session\n    if (typeof this.sessionId === 'undefined' || this.sessionId !== session) {\n      const currentSessionInLS = StorageManager.getMetaProp('cs')\n      // if sessionId in meta is undefined - set current to both\n      if (typeof currentSessionInLS === 'undefined') {\n        StorageManager.setMetaProp('ps', session)\n        StorageManager.setMetaProp('cs', session)\n        StorageManager.setMetaProp('sc', 1)\n      } else if (currentSessionInLS !== session) {\n        // not same as session in local storage. new session\n        StorageManager.setMetaProp('ps', currentSessionInLS)\n        StorageManager.setMetaProp('cs', session)\n        let sessionCount = StorageManager.getMetaProp('sc')\n        if (typeof sessionCount === 'undefined') {\n          sessionCount = 0\n        }\n        StorageManager.setMetaProp('sc', sessionCount + 1)\n      }\n      this.sessionId = session\n    }\n  }\n\n  getTimeElapsed () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    if (this.scookieObj != null) { // TODO: check logic?\n      this.scookieObj = this.getSessionCookieObject()\n    }\n    const sessionStart = this.scookieObj.s\n    if (sessionStart != null) {\n      const ts = getNow()\n      return Math.floor(ts - sessionStart)\n    }\n  }\n\n  getPageCount () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n\n    if (this.scookieObj != null) { // TODO: check logic\n      this.scookieObj = this.getSessionCookieObject()\n    }\n    return this.scookieObj.p\n  }\n}\n","import { CAMP_COOKIE_NAME, CLEAR, EVT_PUSH, EV_COOKIE, FIRE_PUSH_UNREGISTERED, LCOOKIE_NAME, PUSH_SUBSCRIPTION_DATA, WEBPUSH_LS_KEY } from '../util/constants'\nimport { isObjectEmpty, isValueValid, removeUnsupportedChars } from '../util/datatypes'\nimport { getNow } from '../util/datetime'\nimport { compressData } from '../util/encoder'\nimport RequestDispatcher from '../util/requestDispatcher'\nimport { StorageManager, $ct } from '../util/storage'\nimport { addToURL } from '../util/url'\nimport { getCampaignObjForLc } from '../util/clevertap'\n\nlet seqNo = 0\nlet requestTime = 0\n\nexport default class RequestManager {\n  #logger\n  #account\n  #device\n  #session\n  #isPersonalisationActive\n  #clearCookie = false\n  processingBackup = false\n\n  constructor ({ logger, account, device, session, isPersonalisationActive }) {\n    this.#logger = logger\n    this.#account = account\n    this.#device = device\n    this.#session = session\n    this.#isPersonalisationActive = isPersonalisationActive\n\n    RequestDispatcher.logger = logger\n    RequestDispatcher.device = device\n  }\n\n  processBackupEvents () {\n    const backupMap = StorageManager.readFromLSorCookie(LCOOKIE_NAME)\n    if (typeof backupMap === 'undefined' || backupMap === null) {\n      return\n    }\n    this.processingBackup = true\n    for (const idx in backupMap) {\n      if (backupMap.hasOwnProperty(idx)) {\n        const backupEvent = backupMap[idx]\n        if (typeof backupEvent.fired === 'undefined') {\n          this.#logger.debug('Processing backup event : ' + backupEvent.q)\n          if (typeof backupEvent.q !== 'undefined') {\n            RequestDispatcher.fireRequest(backupEvent.q)\n          }\n          backupEvent.fired = true\n        }\n      }\n    }\n    StorageManager.saveToLSorCookie(LCOOKIE_NAME, backupMap)\n    this.processingBackup = false\n  }\n\n  addSystemDataToObject (dataObject, ignoreTrim) {\n    // ignore trim for chrome notifications; undefined everywhere else\n    if (typeof ignoreTrim === 'undefined') {\n      dataObject = removeUnsupportedChars(dataObject, this.#logger)\n    }\n\n    if (!isObjectEmpty(this.#logger.wzrkError)) {\n      dataObject.wzrk_error = this.#logger.wzrkError\n      this.#logger.wzrkError = {}\n    }\n\n    dataObject.id = this.#account.id\n\n    if (isValueValid(this.#device.gcookie)) {\n      dataObject.g = this.#device.gcookie\n    }\n\n    const obj = this.#session.getSessionCookieObject()\n    dataObject.s = obj.s // session cookie\n    dataObject.pg = (typeof obj.p === 'undefined') ? 1 : obj.p // Page count\n    if (sessionStorage.hasOwnProperty('WZRK_D')) { dataObject.debug = true }\n\n    return dataObject\n  }\n\n  addSystemDataToProfileObject (dataObject, ignoreTrim) {\n    if (!isObjectEmpty(this.#logger.wzrkError)) {\n      dataObject.wzrk_error = this.#logger.wzrkError\n      this.#logger.wzrkError = {}\n    }\n\n    dataObject.id = this.#account.id\n\n    if (isValueValid(this.#device.gcookie)) {\n      dataObject.g = this.#device.gcookie\n    }\n\n    const obj = this.#session.getSessionCookieObject()\n    dataObject.s = obj.s // session cookie\n    dataObject.pg = (typeof obj.p === 'undefined') ? 1 : obj.p // Page count\n    if (sessionStorage.hasOwnProperty('WZRK_D')) { dataObject.debug = true }\n\n    return dataObject\n  }\n\n  addFlags (data) {\n    // check if cookie should be cleared.\n    this.#clearCookie = StorageManager.getAndClearMetaProp(CLEAR)\n    if (this.#clearCookie !== undefined && this.#clearCookie) {\n      data.rc = true\n      this.#logger.debug('reset cookie sent in request and cleared from meta for future requests.')\n    }\n    if (this.#isPersonalisationActive()) {\n      const lastSyncTime = StorageManager.getMetaProp('lsTime')\n      const expirySeconds = StorageManager.getMetaProp('exTs')\n\n      // dsync not found in local storage - get data from server\n      if (typeof lastSyncTime === 'undefined' || typeof expirySeconds === 'undefined') {\n        data.dsync = true\n        return\n      }\n      const now = getNow()\n      // last sync time has expired - get fresh data from server\n      if (lastSyncTime + expirySeconds < now) {\n        data.dsync = true\n      }\n    }\n  }\n\n  // saves url to backup cache and fires the request\n  /**\n   *\n   * @param {string} url\n   * @param {boolean} override whether the request can go through or not\n   * @param {Boolean} sendOULFlag - true in case of a On User Login request\n   */\n  saveAndFireRequest (url, override, sendOULFlag) {\n    const now = getNow()\n    url = addToURL(url, 'rn', ++$ct.globalCache.REQ_N)\n    const data = url + '&i=' + now + '&sn=' + seqNo\n    StorageManager.backupEvent(data, $ct.globalCache.REQ_N, this.#logger)\n\n    // if offline is set to true, save the request in backup and return\n    if ($ct.offline) return\n    // if there is no override\n    // and an OUL request is not in progress\n    // then process the request as it is\n    // else block the request\n    // note - $ct.blockRequest should ideally be used for override\n    if ((!override || (this.#clearCookie !== undefined && this.#clearCookie)) && !window.isOULInProgress) {\n      if (now === requestTime) {\n        seqNo++\n      } else {\n        requestTime = now\n        seqNo = 0\n      }\n      window.oulReqN = $ct.globalCache.REQ_N\n      RequestDispatcher.fireRequest(data, false, sendOULFlag)\n    } else {\n      this.#logger.debug(`Not fired due to override - ${$ct.blockRequest} or clearCookie - ${this.#clearCookie} or OUL request in progress - ${window.isOULInProgress}`)\n    }\n  }\n\n  unregisterTokenForGuid (givenGUID) {\n    const payload = StorageManager.readFromLSorCookie(PUSH_SUBSCRIPTION_DATA)\n    // Send unregister event only when token is available\n    if (payload) {\n      const data = {}\n      data.type = 'data'\n      if (isValueValid(givenGUID)) {\n        data.g = givenGUID\n      }\n      data.action = 'unregister'\n      data.id = this.#account.id\n\n      const obj = this.#session.getSessionCookieObject()\n\n      data.s = obj.s // session cookie\n      const compressedData = compressData(JSON.stringify(data), this.#logger)\n\n      let pageLoadUrl = this.#account.dataPostURL\n      pageLoadUrl = addToURL(pageLoadUrl, 'type', 'data')\n      pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n      RequestDispatcher.fireRequest(pageLoadUrl, true)\n      StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, false)\n    }\n    // REGISTER TOKEN\n    this.registerToken(payload)\n  }\n\n  registerToken (payload) {\n    if (!payload) return\n    // add gcookie etc to the payload\n    payload = this.addSystemDataToObject(payload, true)\n    payload = JSON.stringify(payload)\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', 'data')\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(payload, this.#logger))\n    RequestDispatcher.fireRequest(pageLoadUrl)\n    // set in localstorage\n    StorageManager.save(WEBPUSH_LS_KEY, 'ok')\n  }\n\n  processEvent (data) {\n    this.#addToLocalEventMap(data.evtName)\n    data = this.addSystemDataToObject(data, undefined)\n    this.addFlags(data)\n    data[CAMP_COOKIE_NAME] = getCampaignObjForLc()\n    const compressedData = compressData(JSON.stringify(data), this.#logger)\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n    this.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n  }\n\n  #addToLocalEventMap (evtName) {\n    if (StorageManager._isLocalStorageSupported()) {\n      if (typeof $ct.globalEventsMap === 'undefined') {\n        $ct.globalEventsMap = StorageManager.readFromLSorCookie(EV_COOKIE)\n        if (typeof $ct.globalEventsMap === 'undefined') {\n          $ct.globalEventsMap = {}\n        }\n      }\n\n      const nowTs = getNow()\n      let evtDetail = $ct.globalEventsMap[evtName]\n      if (typeof evtDetail !== 'undefined') {\n        evtDetail[2] = nowTs\n        evtDetail[0]++\n      } else {\n        evtDetail = []\n        evtDetail.push(1)\n        evtDetail.push(nowTs)\n        evtDetail.push(nowTs)\n      }\n      $ct.globalEventsMap[evtName] = evtDetail\n      StorageManager.saveToLSorCookie(EV_COOKIE, $ct.globalEventsMap)\n    }\n  }\n}\n","import {\n  isObjectEmpty\n} from '../util/datatypes'\nimport {\n  EVT_PUSH,\n  USEIP_KEY,\n  OPTOUT_KEY,\n  CT_OPTOUT_KEY\n} from '../util/constants'\nimport {\n  StorageManager,\n  $ct\n} from '../util/storage'\nimport {\n  compressData\n} from '../util/encoder'\nimport {\n  addToURL\n} from '../util/url'\n\nexport default class Privacy extends Array {\n  #request\n  #account\n  #oldValues\n  #logger\n\n  constructor ({\n    request,\n    account,\n    logger\n  },\n  values) {\n    super()\n    this.#logger = logger\n    this.#request = request\n    this.#account = account\n    this.#oldValues = values\n  }\n\n  push (...privacyArr) {\n    if ($ct.isPrivacyArrPushed) {\n      this.#processPrivacyArray($ct.privacyArray.length > 0 ? $ct.privacyArray : privacyArr)\n    } else {\n      $ct.privacyArray.push(...privacyArr)\n    }\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processPrivacyArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  #processPrivacyArray (privacyArr) {\n    if (Array.isArray(privacyArr) && privacyArr.length > 0) {\n      const privacyObj = privacyArr.reduce((prev, curr) => ({ ...prev, ...curr }), {})\n      let data = {}\n      const profileObj = {}\n      var optOut = false\n\n      if (privacyObj.hasOwnProperty(OPTOUT_KEY)) {\n        optOut = privacyObj[OPTOUT_KEY]\n        if (typeof optOut === 'boolean') {\n          profileObj[CT_OPTOUT_KEY] = optOut\n          // should be true when user wants to opt in\n          $ct.isOptInRequest = !optOut\n        }\n      }\n      if (privacyObj.hasOwnProperty(USEIP_KEY)) {\n        const useIP = privacyObj[USEIP_KEY]\n        const shouldUseIP = (typeof useIP === 'boolean') ? useIP : false\n        StorageManager.setMetaProp(USEIP_KEY, shouldUseIP)\n      }\n      if (!isObjectEmpty(profileObj)) {\n        data.type = 'profile'\n        data.profile = profileObj\n        data = this.#request.addSystemDataToObject(data, undefined)\n        const compressedData = compressData(JSON.stringify(data), this.#logger)\n        let pageLoadUrl = this.#account.dataPostURL\n        pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n        pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n        pageLoadUrl = addToURL(pageLoadUrl, OPTOUT_KEY, optOut ? 'true' : 'false')\n        this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n        privacyArr.splice(0, privacyArr.length)\n      }\n    }\n  }\n}\n","import { StorageManager, $ct } from '../util/storage'\nimport { isObject } from '../util/datatypes'\nimport {\n  PUSH_SUBSCRIPTION_DATA\n} from '../util/constants'\nimport {\n  urlBase64ToUint8Array\n} from '../util/encoder'\n\nexport default class NotificationHandler extends Array {\n  #oldValues\n  #logger\n  #request\n  #account\n  #wizAlertJSPath\n  #fcmPublicKey\n\n  constructor ({\n    logger,\n    session,\n    request,\n    account\n  }, values) {\n    super()\n    this.#wizAlertJSPath = 'https://d2r1yp2w7bby2u.cloudfront.net/js/wzrk_dialog.min.js'\n    this.#fcmPublicKey = null\n    this.#oldValues = values\n    this.#logger = logger\n    this.#request = request\n    this.#account = account\n  }\n\n  push (...displayArgs) {\n    this.#setUpWebPush(displayArgs)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#setUpWebPush(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  #setUpWebPush (displayArgs) {\n    if ($ct.webPushEnabled && displayArgs.length > 0) {\n      this.#handleNotificationRegistration(displayArgs)\n    } else if ($ct.webPushEnabled == null && displayArgs.length > 0) {\n      $ct.notifApi.notifEnabledFromApi = true\n      $ct.notifApi.displayArgs = displayArgs.slice()\n    } else if ($ct.webPushEnabled === false && displayArgs.length > 0) {\n      this.#logger.error('Make sure push notifications are fully enabled and integrated')\n    }\n  }\n\n  #setUpWebPushNotifications (subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsServiceUrl) {\n    if (navigator.userAgent.indexOf('Chrome') !== -1 || navigator.userAgent.indexOf('Firefox') !== -1) {\n      this.#setUpChromeFirefoxNotifications(subscriptionCallback, serviceWorkerPath)\n    } else if (navigator.userAgent.indexOf('Safari') !== -1) {\n      this.#setUpSafariNotifications(subscriptionCallback, apnsWebPushId, apnsServiceUrl)\n    }\n  }\n\n  #setApplicationServerKey (applicationServerKey) {\n    this.#fcmPublicKey = applicationServerKey\n  }\n\n  #setUpSafariNotifications (subscriptionCallback, apnsWebPushId, apnsServiceUrl) {\n    // ensure that proper arguments are passed\n    if (typeof apnsWebPushId === 'undefined') {\n      this.#logger.error('Ensure that APNS Web Push ID is supplied')\n    }\n    if (typeof apnsServiceUrl === 'undefined') {\n      this.#logger.error('Ensure that APNS Web Push service path is supplied')\n    }\n    if ('safari' in window && 'pushNotification' in window.safari) {\n      window.safari.pushNotification.requestPermission(\n        apnsServiceUrl,\n        apnsWebPushId, {}, (subscription) => {\n          if (subscription.permission === 'granted') {\n            const subscriptionData = JSON.parse(JSON.stringify(subscription))\n            subscriptionData.endpoint = subscription.deviceToken\n            subscriptionData.browser = 'Safari'\n            StorageManager.saveToLSorCookie(PUSH_SUBSCRIPTION_DATA, subscriptionData)\n\n            this.#request.registerToken(subscriptionData)\n            this.#logger.info('Safari Web Push registered. Device Token: ' + subscription.deviceToken)\n          } else if (subscription.permission === 'denied') {\n            this.#logger.info('Error subscribing to Safari web push')\n          }\n        })\n    }\n  }\n\n  /**\n   * Sets up a service worker for WebPush(chrome/Firefox) push notifications and sends the data to LC\n   */\n  #setUpChromeFirefoxNotifications (subscriptionCallback, serviceWorkerPath) {\n    let registrationScope = ''\n\n    if ('serviceWorker' in navigator) {\n      navigator.serviceWorker.register(serviceWorkerPath).then((registration) => {\n        if (typeof __wzrk_account_id !== 'undefined') { // eslint-disable-line\n          // shopify accounts , since the service worker is not at root, serviceWorker.ready is never resolved.\n          // hence add a timeout and hope serviceWroker is ready within that time.\n          return new Promise(resolve => setTimeout(() => resolve(registration), 5000))\n        }\n        registrationScope = registration.scope\n\n        // IF SERVICE WORKER IS AT ROOT, RETURN THE READY PROMISE\n        // ELSE IF CHROME RETURN PROMISE AFTER 5 SECONDS\n        // OR getRegistrations PROMISE IF ITS FIREFOX\n        const rootDirRegex = /^(\\.?)(\\/?)([^/]*).js$/\n        const isServiceWorkerAtRoot = rootDirRegex.test(serviceWorkerPath)\n        if (isServiceWorkerAtRoot) {\n          return navigator.serviceWorker.ready\n        } else {\n          if (navigator.userAgent.indexOf('Chrome') !== -1) {\n            return new Promise(resolve => setTimeout(() => resolve(registration), 5000))\n          } else {\n            return navigator.serviceWorker.getRegistrations()\n          }\n        }\n      }).then((serviceWorkerRegistration) => {\n        // ITS AN ARRAY IN CASE OF FIREFOX, SO USE THE REGISTRATION WITH PROPER SCOPE\n        if (navigator.userAgent.indexOf('Firefox') !== -1 && Array.isArray(serviceWorkerRegistration)) {\n          serviceWorkerRegistration = serviceWorkerRegistration.filter((i) => i.scope === registrationScope)[0]\n        }\n        const subscribeObj = { userVisibleOnly: true }\n\n        if (this.#fcmPublicKey != null) {\n          subscribeObj.applicationServerKey = urlBase64ToUint8Array(this.#fcmPublicKey)\n        }\n\n        serviceWorkerRegistration.pushManager.subscribe(subscribeObj)\n          .then((subscription) => {\n            this.#logger.info('Service Worker registered. Endpoint: ' + subscription.endpoint)\n\n            // convert the subscription keys to strings; this sets it up nicely for pushing to LC\n            const subscriptionData = JSON.parse(JSON.stringify(subscription))\n\n            // remove the common chrome/firefox endpoint at the beginning of the token\n            if (navigator.userAgent.indexOf('Chrome') !== -1) {\n              subscriptionData.endpoint = subscriptionData.endpoint.split('/').pop()\n              subscriptionData.browser = 'Chrome'\n            } else if (navigator.userAgent.indexOf('Firefox') !== -1) {\n              subscriptionData.endpoint = subscriptionData.endpoint.split('/').pop()\n              subscriptionData.browser = 'Firefox'\n            }\n            StorageManager.saveToLSorCookie(PUSH_SUBSCRIPTION_DATA, subscriptionData)\n            this.#request.registerToken(subscriptionData)\n\n            if (typeof subscriptionCallback !== 'undefined' && typeof subscriptionCallback === 'function') {\n              subscriptionCallback()\n            }\n          }).catch((error) => {\n            this.#logger.error('Error subscribing: ' + error)\n            // unsubscribe from webpush if error\n            serviceWorkerRegistration.pushManager.getSubscription().then((subscription) => {\n              if (subscription !== null) {\n                subscription.unsubscribe().then((successful) => {\n                  // You've successfully unsubscribed\n                  this.#logger.info('Unsubscription successful')\n                }).catch((e) => {\n                  // Unsubscription failed\n                  this.#logger.error('Error unsubscribing: ' + e)\n                })\n              }\n            })\n          })\n      }).catch((err) => {\n        this.#logger.error('error registering service worker: ' + err)\n      })\n    }\n  }\n\n  #addWizAlertJS () {\n    const scriptTag = document.createElement('script')\n    scriptTag.setAttribute('type', 'text/javascript')\n    scriptTag.setAttribute('id', 'wzrk-alert-js')\n    scriptTag.setAttribute('src', this.#wizAlertJSPath)\n\n    // add the script tag to the end of the body\n    document.getElementsByTagName('body')[0].appendChild(scriptTag)\n\n    return scriptTag\n  }\n\n  #removeWizAlertJS () {\n    const scriptTag = document.getElementById('wzrk-alert-js')\n    scriptTag.parentNode.removeChild(scriptTag)\n  }\n\n  #handleNotificationRegistration (displayArgs) {\n    // make sure everything is specified\n    let titleText\n    let bodyText\n    let okButtonText\n    let rejectButtonText\n    let okButtonColor\n    let skipDialog\n    let askAgainTimeInSeconds\n    let okCallback\n    let rejectCallback\n    let subscriptionCallback\n    let hidePoweredByCT\n    let serviceWorkerPath\n    let httpsPopupPath\n    let httpsIframePath\n    let apnsWebPushId\n    let apnsWebPushServiceUrl\n\n    if (displayArgs.length === 1) {\n      if (isObject(displayArgs[0])) {\n        const notifObj = displayArgs[0]\n        titleText = notifObj.titleText\n        bodyText = notifObj.bodyText\n        okButtonText = notifObj.okButtonText\n        rejectButtonText = notifObj.rejectButtonText\n        okButtonColor = notifObj.okButtonColor\n        skipDialog = notifObj.skipDialog\n        askAgainTimeInSeconds = notifObj.askAgainTimeInSeconds\n        okCallback = notifObj.okCallback\n        rejectCallback = notifObj.rejectCallback\n        subscriptionCallback = notifObj.subscriptionCallback\n        hidePoweredByCT = notifObj.hidePoweredByCT\n        serviceWorkerPath = notifObj.serviceWorkerPath\n        httpsPopupPath = notifObj.httpsPopupPath\n        httpsIframePath = notifObj.httpsIframePath\n        apnsWebPushId = notifObj.apnsWebPushId\n        apnsWebPushServiceUrl = notifObj.apnsWebPushServiceUrl\n      }\n    } else {\n      titleText = displayArgs[0]\n      bodyText = displayArgs[1]\n      okButtonText = displayArgs[2]\n      rejectButtonText = displayArgs[3]\n      okButtonColor = displayArgs[4]\n      skipDialog = displayArgs[5]\n      askAgainTimeInSeconds = displayArgs[6]\n    }\n\n    if (skipDialog == null) {\n      skipDialog = false\n    }\n\n    if (hidePoweredByCT == null) {\n      hidePoweredByCT = false\n    }\n\n    if (serviceWorkerPath == null) {\n      serviceWorkerPath = '/clevertap_sw.js'\n    }\n\n    // ensure that the browser supports notifications\n    if (typeof navigator.serviceWorker === 'undefined') {\n      return\n    }\n\n    const isHTTP = httpsPopupPath != null && httpsIframePath != null\n\n    // make sure the site is on https for chrome notifications\n    if (window.location.protocol !== 'https:' && document.location.hostname !== 'localhost' && !isHTTP) {\n      this.#logger.error('Make sure you are https or localhost to register for notifications')\n      return\n    }\n\n    // right now, we only support Chrome V50 & higher & Firefox\n    if (navigator.userAgent.indexOf('Chrome') !== -1) {\n      const chromeAgent = navigator.userAgent.match(/Chrome\\/(\\d+)/)\n      if (chromeAgent == null || parseInt(chromeAgent[1], 10) < 50) { return }\n    } else if (navigator.userAgent.indexOf('Firefox') !== -1) {\n      const firefoxAgent = navigator.userAgent.match(/Firefox\\/(\\d+)/)\n      if (firefoxAgent == null || parseInt(firefoxAgent[1], 10) < 50) { return }\n    } else if (navigator.userAgent.indexOf('Safari') !== -1) {\n      const safariAgent = navigator.userAgent.match(/Safari\\/(\\d+)/)\n      if (safariAgent == null || parseInt(safariAgent[1], 10) < 50) { return }\n    } else {\n      return\n    }\n\n    // we check for the cookie in setUpChromeNotifications() the tokens may have changed\n\n    if (!isHTTP) {\n      if (Notification == null) {\n        return\n      }\n      // handle migrations from other services -> chrome notifications may have already been asked for before\n      if (Notification.permission === 'granted') {\n        // skip the dialog and register\n        this.#setUpWebPushNotifications(subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsWebPushServiceUrl)\n        return\n      } else if (Notification.permission === 'denied') {\n        // we've lost this profile :'(\n        return\n      }\n\n      if (skipDialog) {\n        this.#setUpWebPushNotifications(subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsWebPushServiceUrl)\n        return\n      }\n    }\n\n    // make sure the right parameters are passed\n    if (!titleText || !bodyText || !okButtonText || !rejectButtonText) {\n      this.#logger.error('Missing input parameters; please specify title, body, ok button and cancel button text')\n      return\n    }\n\n    // make sure okButtonColor is formatted properly\n    if (okButtonColor == null || !okButtonColor.match(/^#[a-f\\d]{6}$/i)) {\n      okButtonColor = '#f28046' // default color for positive button\n    }\n\n    // make sure the user isn't asked for notifications more than askAgainTimeInSeconds\n    const now = new Date().getTime() / 1000\n    if ((StorageManager.getMetaProp('notif_last_time')) == null) {\n      StorageManager.setMetaProp('notif_last_time', now)\n    } else {\n      if (askAgainTimeInSeconds == null) {\n        // 7 days by default\n        askAgainTimeInSeconds = 7 * 24 * 60 * 60\n      }\n\n      if (now - StorageManager.getMetaProp('notif_last_time') < askAgainTimeInSeconds) {\n        return\n      } else {\n        // continue asking\n        StorageManager.setMetaProp('notif_last_time', now)\n      }\n    }\n\n    if (isHTTP) {\n      // add the https iframe\n      const httpsIframe = document.createElement('iframe')\n      httpsIframe.setAttribute('style', 'display:none;')\n      httpsIframe.setAttribute('src', httpsIframePath)\n      document.body.appendChild(httpsIframe)\n      window.addEventListener('message', (event) => {\n        if (event.data != null) {\n          let obj = {}\n          try {\n            obj = JSON.parse(event.data)\n          } catch (e) {\n            // not a call from our iframe\n            return\n          }\n          if (obj.state != null) {\n            if (obj.from === 'ct' && obj.state === 'not') {\n              this.#addWizAlertJS().onload = () => {\n                // create our wizrocket popup\n                window.wzrkPermissionPopup.wizAlert({\n                  title: titleText,\n                  body: bodyText,\n                  confirmButtonText: okButtonText,\n                  confirmButtonColor: okButtonColor,\n                  rejectButtonText: rejectButtonText,\n                  hidePoweredByCT: hidePoweredByCT\n                }, (enabled) => { // callback function\n                  if (enabled) {\n                    // the user accepted on the dialog box\n                    if (typeof okCallback === 'function') {\n                      okCallback()\n                    }\n                    // redirect to popup.html\n                    window.open(httpsPopupPath)\n                  } else {\n                    if (typeof rejectCallback === 'function') {\n                      rejectCallback()\n                    }\n                  }\n                  this.#removeWizAlertJS()\n                })\n              }\n            }\n          }\n        }\n      }, false)\n    } else {\n      this.#addWizAlertJS().onload = () => {\n        // create our wizrocket popup\n        window.wzrkPermissionPopup.wizAlert({\n          title: titleText,\n          body: bodyText,\n          confirmButtonText: okButtonText,\n          confirmButtonColor: okButtonColor,\n          rejectButtonText: rejectButtonText,\n          hidePoweredByCT: hidePoweredByCT\n        }, (enabled) => { // callback function\n          if (enabled) {\n            // the user accepted on the dialog box\n            if (typeof okCallback === 'function') {\n              okCallback()\n            }\n            this.#setUpWebPushNotifications(subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsWebPushServiceUrl)\n          } else {\n            if (typeof rejectCallback === 'function') {\n              rejectCallback()\n            }\n          }\n          this.#removeWizAlertJS()\n        })\n      }\n    }\n  }\n\n  _enableWebPush (enabled, applicationServerKey) {\n    $ct.webPushEnabled = enabled\n    if (applicationServerKey != null) {\n      this.#setApplicationServerKey(applicationServerKey)\n    }\n    if ($ct.webPushEnabled && $ct.notifApi.notifEnabledFromApi) {\n      this.#handleNotificationRegistration($ct.notifApi.displayArgs)\n    } else if (!$ct.webPushEnabled && $ct.notifApi.notifEnabledFromApi) {\n      this.#logger.error('Ensure that web push notifications are fully enabled and integrated before requesting them')\n    }\n  }\n}\n","import Account from './modules/account'\nimport CleverTapAPI from './modules/api'\nimport DeviceManager from './modules/device'\nimport EventHandler from './modules/event'\nimport ProfileHandler from './modules/profile'\nimport UserLoginHandler from './modules/userLogin'\nimport _tr from './util/tr'\nimport User from './modules/user'\nimport { Logger, logLevels } from './modules/logger'\nimport SessionManager from './modules/session'\nimport ReqestManager from './modules/request'\nimport {\n  CAMP_COOKIE_NAME,\n  SCOOKIE_PREFIX,\n  NOTIFICATION_VIEWED,\n  NOTIFICATION_CLICKED,\n  EVT_PING,\n  FIRST_PING_FREQ_IN_MILLIS,\n  CONTINUOUS_PING_FREQ_IN_MILLIS,\n  GROUP_SUBSCRIPTION_REQUEST_ID,\n  WZRK_ID,\n  WZRK_PREFIX,\n  categoryLongKey,\n  COMMAND_INCREMENT,\n  COMMAND_DECREMENT,\n  COMMAND_SET,\n  COMMAND_ADD,\n  COMMAND_REMOVE,\n  COMMAND_DELETE,\n  EVT_PUSH\n} from './util/constants'\nimport { EMBED_ERROR } from './util/messages'\nimport { StorageManager, $ct } from './util/storage'\nimport { addToURL, getDomain, getURLParams } from './util/url'\nimport { getCampaignObjForLc, setEnum, handleEmailSubscription, closeIframe } from './util/clevertap'\nimport { compressData } from './util/encoder'\nimport Privacy from './modules/privacy'\nimport NotificationHandler from './modules/notification'\nimport { hasWebInboxSettingsInLS, checkAndRegisterWebInboxElements, initializeWebInbox, getInboxMessages, saveInboxMessages } from './modules/web-inbox/helper'\n\nexport default class CleverTap {\n  #logger\n  #api\n  #onloadcalled\n  #device\n  #session\n  #account\n  #request\n  #isSpa\n  #previousUrl\n  #boundCheckPageChanged = this.#checkPageChanged.bind(this)\n  #isWebPopUpSpamControlDisabled\n  enablePersonalization\n\n  get spa () {\n    return this.#isSpa\n  }\n\n  set spa (value) {\n    const isSpa = value === true\n    if (this.#isSpa !== isSpa && this.#onloadcalled === 1) {\n      // if clevertap.spa is changed after init has been called then update the click listeners\n      if (isSpa) {\n        document.addEventListener('click', this.#boundCheckPageChanged)\n      } else {\n        document.removeEventListener('click', this.#boundCheckPageChanged)\n      }\n    }\n    this.#isSpa = isSpa\n  }\n\n  get dismissSpamControl () {\n    return this.#isWebPopUpSpamControlDisabled\n  }\n\n  set dismissSpamControl (value) {\n    const isWebPopUpSpamControlDisabled = value === true\n    this.#isWebPopUpSpamControlDisabled = isWebPopUpSpamControlDisabled\n  }\n\n  constructor (clevertap = {}) {\n    this.#onloadcalled = 0\n    this._isPersonalisationActive = this._isPersonalisationActive.bind(this)\n    this.raiseNotificationClicked = () => { }\n    this.#logger = new Logger(logLevels.INFO)\n    this.#account = new Account(clevertap.account?.[0], clevertap.region || clevertap.account?.[1], clevertap.targetDomain || clevertap.account?.[2])\n    this.#device = new DeviceManager({ logger: this.#logger })\n    this.#session = new SessionManager({\n      logger: this.#logger,\n      isPersonalisationActive: this._isPersonalisationActive\n    })\n    this.#request = new ReqestManager({\n      logger: this.#logger,\n      account: this.#account,\n      device: this.#device,\n      session: this.#session,\n      isPersonalisationActive: this._isPersonalisationActive\n    })\n    this.enablePersonalization = clevertap.enablePersonalization || false\n    this.event = new EventHandler({\n      logger: this.#logger,\n      request: this.#request,\n      isPersonalisationActive: this._isPersonalisationActive\n    }, clevertap.event)\n\n    this.profile = new ProfileHandler({\n      logger: this.#logger,\n      request: this.#request,\n      account: this.#account,\n      isPersonalisationActive: this._isPersonalisationActive\n    }, clevertap.profile)\n\n    this.onUserLogin = new UserLoginHandler({\n      request: this.#request,\n      account: this.#account,\n      session: this.#session,\n      logger: this.#logger,\n      device: this.#device\n    }, clevertap.onUserLogin)\n\n    this.privacy = new Privacy({\n      request: this.#request,\n      account: this.#account,\n      logger: this.#logger\n    }, clevertap.privacy)\n\n    this.notifications = new NotificationHandler({\n      logger: this.#logger,\n      request: this.#request,\n      account: this.#account\n    }, clevertap.notifications)\n\n    this.#api = new CleverTapAPI({\n      logger: this.#logger,\n      request: this.#request,\n      device: this.#device,\n      session: this.#session\n    })\n\n    this.spa = clevertap.spa\n    this.dismissSpamControl = clevertap.dismissSpamControl\n\n    this.user = new User({\n      isPersonalisationActive: this._isPersonalisationActive\n    })\n\n    this.session = {\n      getTimeElapsed: () => {\n        return this.#session.getTimeElapsed()\n      },\n      getPageCount: () => {\n        return this.#session.getPageCount()\n      }\n    }\n\n    this.logout = () => {\n      this.#logger.debug('logout called')\n      StorageManager.setInstantDeleteFlagInK()\n    }\n\n    this.clear = () => {\n      this.onUserLogin.clear()\n    }\n\n    this.getCleverTapID = () => {\n      return this.#device.getGuid()\n    }\n\n    this.getAccountID = () => {\n      return this.#account.id\n    }\n\n    this.getSCDomain = () => {\n      return this.#account.finalTargetDomain\n    }\n\n    // Set the Signed Call sdk version and fire request\n    this.setSCSDKVersion = (ver) => {\n      this.#account.scSDKVersion = ver\n      const data = {}\n      data.af = { scv: 'sc-sdk-v' + this.#account.scSDKVersion }\n      let pageLoadUrl = this.#account.dataPostURL\n      pageLoadUrl = addToURL(pageLoadUrl, 'type', 'page')\n      pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n      this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n    }\n\n    if (hasWebInboxSettingsInLS()) {\n      checkAndRegisterWebInboxElements()\n      initializeWebInbox(this.#logger)\n    }\n\n    // Get Inbox Message Count\n    this.getInboxMessageCount = () => {\n      const msgCount = getInboxMessages()\n      return Object.keys(msgCount).length\n    }\n\n    // Get Inbox Unread Message Count\n    this.getInboxMessageUnreadCount = () => {\n      if ($ct.inbox) {\n        return $ct.inbox.unviewedCounter\n      } else {\n        this.#logger.debug('No unread messages')\n      }\n    }\n\n    // Get All Inbox messages\n    this.getAllInboxMessages = () => {\n      return getInboxMessages()\n    }\n\n    // Get only Unread messages\n    this.getUnreadInboxMessages = () => {\n      if ($ct.inbox) {\n        return $ct.inbox.unviewedMessages\n      } else {\n        this.#logger.debug('No unread messages')\n      }\n    }\n\n    // Get message object belonging to the given message id only. Message id should be a String\n    this.getInboxMessageForId = (messageId) => {\n      const messages = getInboxMessages()\n      if ((messageId !== null || messageId !== '') && messages.hasOwnProperty(messageId)) {\n        return messages[messageId]\n      } else {\n        this.#logger.error('No message available for message Id ' + messageId)\n      }\n    }\n\n    // Delete message from the Inbox. Message id should be a String\n    // If the message to be deleted is unviewed then decrement the badge count, delete the message from unviewedMessages list\n    // Then remove the message from local storage and update cookie\n    this.deleteInboxMessage = (messageId) => {\n      const messages = getInboxMessages()\n      if ((messageId !== null || messageId !== '') && messages.hasOwnProperty(messageId)) {\n        const el = document.querySelector('ct-web-inbox').shadowRoot.getElementById(messageId)\n        if (messages[messageId].viewed === 0) {\n          $ct.inbox.unviewedCounter--\n          delete $ct.inbox.unviewedMessages[messageId]\n          document.getElementById('unviewedBadge').innerText = $ct.inbox.unviewedCounter\n          document.getElementById('unviewedBadge').style.display = $ct.inbox.unviewedCounter > 0 ? 'flex' : 'none'\n        }\n        el && el.remove()\n        delete messages[messageId]\n        saveInboxMessages(messages)\n      } else {\n        this.#logger.error('No message available for message Id ' + messageId)\n      }\n    }\n\n    /* Mark Message as Read. Message id should be a String\n     - Check if the message Id exist in the unread message list\n     - Remove the unread marker, update the viewed flag, decrement the bage Count\n     - renderNotificationViewed */\n    this.markReadInboxMessage = (messageId) => {\n      const unreadMsg = $ct.inbox.unviewedMessages\n      const messages = getInboxMessages()\n      if ((messageId !== null || messageId !== '') && unreadMsg.hasOwnProperty(messageId)) {\n        const el = document.querySelector('ct-web-inbox').shadowRoot.getElementById(messageId)\n        if (el !== null) { el.shadowRoot.getElementById('unreadMarker').style.display = 'none' }\n        messages[messageId].viewed = 1\n        var counter = parseInt(document.getElementById('unviewedBadge').innerText) - 1\n        document.getElementById('unviewedBadge').innerText = counter\n        document.getElementById('unviewedBadge').style.display = counter > 0 ? 'flex' : 'none'\n        window.clevertap.renderNotificationViewed({ msgId: messages[messageId].wzrk_id, pivotId: messages[messageId].pivotId })\n        $ct.inbox.unviewedCounter--\n        delete $ct.inbox.unviewedMessages[messageId]\n        saveInboxMessages(messages)\n      } else {\n        this.#logger.error('No message available for message Id ' + messageId)\n      }\n    }\n\n    /* Mark all messages as read\n      - Get the count of unread messages, update unread marker style\n      - renderNotificationViewed, update the badge count and style\n    */\n    this.markReadAllInboxMessage = () => {\n      const unreadMsg = $ct.inbox.unviewedMessages\n      const messages = getInboxMessages()\n      if (Object.keys(unreadMsg).length > 0) {\n        const msgIds = Object.keys(unreadMsg)\n        msgIds.forEach(key => {\n          const el = document.querySelector('ct-web-inbox').shadowRoot.getElementById(key)\n          if (el !== null) { el.shadowRoot.getElementById('unreadMarker').style.display = 'none' }\n          messages[key].viewed = 1\n          window.clevertap.renderNotificationViewed({ msgId: messages[key].wzrk_id, pivotId: messages[key].wzrk_pivot })\n        })\n        document.getElementById('unviewedBadge').innerText = 0\n        document.getElementById('unviewedBadge').style.display = 'none'\n        saveInboxMessages(messages)\n        $ct.inbox.unviewedCounter = 0\n        $ct.inbox.unviewedMessages = {}\n      } else {\n        this.#logger.debug('All messages are already read')\n      }\n    }\n\n    // method for notification viewed\n    this.renderNotificationViewed = (detail) => {\n      processNotificationEvent(NOTIFICATION_VIEWED, detail)\n    }\n\n    // method for notification clicked\n    this.renderNotificationClicked = (detail) => {\n      processNotificationEvent(NOTIFICATION_CLICKED, detail)\n    }\n\n    const processNotificationEvent = (eventName, eventDetail) => {\n      if (!eventDetail || !eventDetail.msgId) { return }\n      const data = {}\n      data.type = 'event'\n      data.evtName = eventName\n      data.evtData = { [WZRK_ID]: eventDetail.msgId }\n\n      if (eventDetail.pivotId) {\n        data.evtData = { ...data.evtData, wzrk_pivot: eventDetail.pivotId }\n      }\n\n      if (eventDetail.wzrk_slideNo) {\n        data.evtData = { ...data.evtData, wzrk_slideNo: eventDetail.wzrk_slideNo }\n      }\n\n      // Adding kv pair to event data\n      if (eventDetail.kv && eventDetail.kv !== null && eventDetail.kv !== undefined) {\n        for (const key in eventDetail.kv) {\n          if (key.startsWith(WZRK_PREFIX)) {\n            data.evtData = { ...data.evtData, [key]: eventDetail.kv[key] }\n          }\n        }\n      }\n\n      // Adding msgCTkv to event data\n      if (eventDetail.msgCTkv && eventDetail.msgCTkv !== null && eventDetail.msgCTkv !== undefined) {\n        for (const key in eventDetail.msgCTkv) {\n          if (key.startsWith(WZRK_PREFIX)) {\n            data.evtData = { ...data.evtData, [key]: eventDetail.msgCTkv[key] }\n          }\n        }\n      }\n      this.#request.processEvent(data)\n    }\n\n    this.setLogLevel = (l) => {\n      this.#logger.logLevel = Number(l)\n      if (l === 3) {\n        sessionStorage.WZRK_D = ''\n      } else {\n        delete sessionStorage.WZRK_D\n      }\n    }\n    /**\n * @param {} key\n * @param {*} value\n */\n    this.handleIncrementValue = (key, value) => {\n      this.profile._handleIncrementDecrementValue(key, value, COMMAND_INCREMENT)\n    }\n\n    this.handleDecrementValue = (key, value) => {\n      this.profile._handleIncrementDecrementValue(key, value, COMMAND_DECREMENT)\n    }\n\n    this.setMultiValuesForKey = (key, value) => {\n      if (Array.isArray(value)) {\n        this.profile._handleMultiValueSet(key, value, COMMAND_SET)\n      } else {\n        console.error('setMultiValuesForKey should be called with a value of type array')\n      }\n    }\n\n    this.addMultiValueForKey = (key, value) => {\n      if (typeof value === 'string' || typeof value === 'number') {\n        this.profile._handleMultiValueAdd(key, value, COMMAND_ADD)\n      } else {\n        console.error('addMultiValueForKey should be called with a value of type string or number.')\n      }\n    }\n\n    this.addMultiValuesForKey = (key, value) => {\n      if (Array.isArray(value)) {\n        this.profile._handleMultiValueAdd(key, value, COMMAND_ADD)\n      } else {\n        console.error('addMultiValuesForKey should be called with a value of type array.')\n      }\n    }\n\n    this.removeMultiValueForKey = (key, value) => {\n      if (typeof value === 'string' || typeof value === 'number') {\n        this.profile._handleMultiValueRemove(key, value, COMMAND_REMOVE)\n      } else {\n        console.error('removeMultiValueForKey should be called with a value of type string or number.')\n      }\n    }\n\n    this.removeMultiValuesForKey = (key, value) => {\n      if (Array.isArray(value)) {\n        this.profile._handleMultiValueRemove(key, value, COMMAND_REMOVE)\n      } else {\n        console.error('removeMultiValuesForKey should be called with a value of type array.')\n      }\n    }\n\n    this.removeValueForKey = (key) => {\n      this.profile._handleMultiValueDelete(key, COMMAND_DELETE)\n    }\n\n    const _handleEmailSubscription = (subscription, reEncoded, fetchGroups) => {\n      handleEmailSubscription(subscription, reEncoded, fetchGroups, this.#account, this.#logger)\n    }\n\n    /**\n     *\n     * @param {number} lat\n     * @param {number} lng\n     * @param {callback function} handleCoordinates\n     * @returns\n    */\n    this.getLocation = function (lat, lng) {\n      // latitude and longitude should be number type\n      if ((lat && typeof lat !== 'number') || (lng && typeof lng !== 'number')) {\n        console.log('Latitude and Longitude must be of number type')\n        return\n      }\n      if (lat && lng) {\n        // valid latitude ranges bw +-90\n        if (lat <= -90 || lat > 90) {\n          console.log('A vaid latitude must range between -90 and 90')\n          return\n        }\n        // valid longitude ranges bw +-180\n        if (lng <= -180 || lng > 180) {\n          console.log('A valid longitude must range between -180 and 180')\n          return\n        }\n        $ct.location = { Latitude: lat, Longitude: lng }\n        this.sendMultiValueData({ Latitude: lat, Longitude: lng })\n      } else {\n        if (navigator.geolocation) {\n          navigator.geolocation.getCurrentPosition(showPosition.bind(this), showError)\n        } else {\n          console.log('Geolocation is not supported by this browser.')\n        }\n      }\n    }\n\n    function showPosition (position) {\n      var lat = position.coords.latitude\n      var lng = position.coords.longitude\n      $ct.location = { Latitude: lat, Longitude: lng }\n      this.sendMultiValueData({ Latitude: lat, Longitude: lng })\n    }\n\n    function showError (error) {\n      switch (error.code) {\n        case error.PERMISSION_DENIED:\n          console.log('User denied the request for Geolocation.')\n          break\n        case error.POSITION_UNAVAILABLE:\n          console.log('Location information is unavailable.')\n          break\n        case error.TIMEOUT:\n          console.log('The request to get user location timed out.')\n          break\n        case error.UNKNOWN_ERROR:\n          console.log('An unknown error occurred.')\n          break\n      }\n    }\n\n    const api = this.#api\n    api.logout = this.logout\n    api.clear = this.clear\n    api.closeIframe = (campaignId, divIdIgnored) => {\n      closeIframe(campaignId, divIdIgnored, this.#session.sessionId)\n    }\n    api.enableWebPush = (enabled, applicationServerKey) => {\n      this.notifications._enableWebPush(enabled, applicationServerKey)\n    }\n    api.tr = (msg) => {\n      _tr(msg, {\n        device: this.#device,\n        session: this.#session,\n        request: this.#request,\n        logger: this.#logger,\n        isWebPopUpSpamControlDisabled: this.#isWebPopUpSpamControlDisabled\n      })\n    }\n    api.setEnum = (enumVal) => {\n      setEnum(enumVal, this.#logger)\n    }\n    api.is_onloadcalled = () => {\n      return (this.#onloadcalled === 1)\n    }\n    api.subEmail = (reEncoded) => {\n      _handleEmailSubscription('1', reEncoded)\n    }\n    api.getEmail = (reEncoded, withGroups) => {\n      _handleEmailSubscription('-1', reEncoded, withGroups)\n    }\n    api.unSubEmail = (reEncoded) => {\n      _handleEmailSubscription('0', reEncoded)\n    }\n    api.unsubEmailGroups = (reEncoded) => {\n      $ct.unsubGroups = []\n      const elements = document.getElementsByClassName('ct-unsub-group-input-item')\n\n      for (let i = 0; i < elements.length; i++) {\n        const element = elements[i]\n        if (element.name) {\n          const data = { name: element.name, isUnsubscribed: element.checked }\n          $ct.unsubGroups.push(data)\n        }\n      }\n\n      _handleEmailSubscription(GROUP_SUBSCRIPTION_REQUEST_ID, reEncoded)\n    }\n    api.setSubscriptionGroups = (value) => {\n      $ct.unsubGroups = value\n    }\n    api.getSubscriptionGroups = () => {\n      return $ct.unsubGroups\n    }\n    api.changeSubscriptionGroups = (reEncoded, updatedGroups) => {\n      api.setSubscriptionGroups(updatedGroups)\n      _handleEmailSubscription(GROUP_SUBSCRIPTION_REQUEST_ID, reEncoded)\n    }\n    api.setUpdatedCategoryLong = (profile) => {\n      if (profile[categoryLongKey]) {\n        $ct.updatedCategoryLong = profile[categoryLongKey]\n      }\n    }\n    window.$CLTP_WR = window.$WZRK_WR = api\n\n    if (clevertap.account?.[0].id) {\n      // The accountId is present so can init with empty values.\n      // Needed to maintain backward compatability with legacy implementations.\n      // Npm imports/require will need to call init explictly with accountId\n      this.init()\n    }\n  }\n\n  // starts here\n  init (accountId, region, targetDomain) {\n    if (this.#onloadcalled === 1) {\n      // already initailsed\n      return\n    }\n    StorageManager.removeCookie('WZRK_P', window.location.hostname)\n    if (!this.#account.id) {\n      if (!accountId) {\n        this.#logger.error(EMBED_ERROR)\n        return\n      }\n      this.#account.id = accountId\n    }\n    this.#session.cookieName = SCOOKIE_PREFIX + '_' + this.#account.id\n\n    if (region) {\n      this.#account.region = region\n    }\n    if (targetDomain) {\n      this.#account.targetDomain = targetDomain\n    }\n\n    const currLocation = location.href\n    const urlParams = getURLParams(currLocation.toLowerCase())\n\n    // eslint-disable-next-line eqeqeq\n    if (typeof urlParams.e !== 'undefined' && urlParams.wzrk_ex == '0') {\n      return\n    }\n\n    $ct.isPrivacyArrPushed = true\n    if ($ct.privacyArray.length > 0) {\n      this.privacy.push($ct.privacyArray)\n    }\n\n    this.#processOldValues()\n    this.pageChanged()\n    const backupInterval = setInterval(() => {\n      if (this.#device.gcookie) {\n        clearInterval(backupInterval)\n        this.#request.processBackupEvents()\n      }\n    }, 3000)\n    if (this.#isSpa) {\n      // listen to click on the document and check if URL has changed.\n      document.addEventListener('click', this.#boundCheckPageChanged)\n    } else {\n      // remove existing click listeners if any\n      document.removeEventListener('click', this.#boundCheckPageChanged)\n    }\n    this.#onloadcalled = 1\n  }\n\n  // process the option array provided to the clevertap object\n  // after its been initialized\n  #processOldValues () {\n    this.onUserLogin._processOldValues()\n    this.privacy._processOldValues()\n    this.event._processOldValues()\n    this.profile._processOldValues()\n    this.notifications._processOldValues()\n  }\n\n  debounce (func, delay) {\n    let timeout\n    return function () {\n      clearTimeout(timeout)\n      timeout = setTimeout(func, delay)\n    }\n  }\n\n  #checkPageChanged () {\n    const debouncedPageChanged = this.debounce(() => {\n      if (this.#previousUrl !== location.href) {\n        this.pageChanged()\n      }\n    }, 300)\n    debouncedPageChanged()\n  }\n\n  pageChanged () {\n    const currLocation = window.location.href\n    const urlParams = getURLParams(currLocation.toLowerCase())\n    // -- update page count\n    const obj = this.#session.getSessionCookieObject()\n    let pgCount = (typeof obj.p === 'undefined') ? 0 : obj.p\n    obj.p = ++pgCount\n    this.#session.setSessionCookieObject(obj)\n    // -- update page count\n\n    let data = {}\n    let referrerDomain = getDomain(document.referrer)\n\n    if (window.location.hostname !== referrerDomain) {\n      const maxLen = 120\n      if (referrerDomain !== '') {\n        referrerDomain = referrerDomain.length > maxLen ? referrerDomain.substring(0, maxLen) : referrerDomain\n        data.referrer = referrerDomain\n      }\n\n      let utmSource = urlParams.utm_source || urlParams.wzrk_source\n      if (typeof utmSource !== 'undefined') {\n        utmSource = utmSource.length > maxLen ? utmSource.substring(0, maxLen) : utmSource\n        data.us = utmSource // utm_source\n      }\n\n      let utmMedium = urlParams.utm_medium || urlParams.wzrk_medium\n      if (typeof utmMedium !== 'undefined') {\n        utmMedium = utmMedium.length > maxLen ? utmMedium.substring(0, maxLen) : utmMedium\n        data.um = utmMedium // utm_medium\n      }\n\n      let utmCampaign = urlParams.utm_campaign || urlParams.wzrk_campaign\n      if (typeof utmCampaign !== 'undefined') {\n        utmCampaign = utmCampaign.length > maxLen ? utmCampaign.substring(0, maxLen) : utmCampaign\n        data.uc = utmCampaign // utm_campaign\n      }\n\n      // also independently send wzrk_medium to the backend\n      if (typeof urlParams.wzrk_medium !== 'undefined') {\n        const wm = urlParams.wzrk_medium\n        if (wm.match(/^email$|^social$|^search$/)) {\n          data.wm = wm // wzrk_medium\n        }\n      }\n    }\n\n    data = this.#request.addSystemDataToObject(data, undefined)\n    data.cpg = currLocation\n\n    data[CAMP_COOKIE_NAME] = getCampaignObjForLc()\n    let pageLoadUrl = this.#account.dataPostURL\n    this.#request.addFlags(data)\n    // send dsync flag when page = 1\n    if (parseInt(data.pg) === 1) {\n      this.#overrideDSyncFlag(data)\n    }\n    data.af = { lib: 'web-sdk-v$$PACKAGE_VERSION$$' }\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', 'page')\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n\n    this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n\n    this.#previousUrl = currLocation\n    setTimeout(() => {\n      if (pgCount <= 3) {\n        // send ping for up to 3 pages\n        this.#pingRequest()\n      }\n\n      if (this.#isPingContinuous()) {\n        setInterval(() => {\n          this.#pingRequest()\n        }, CONTINUOUS_PING_FREQ_IN_MILLIS)\n      }\n    }, FIRST_PING_FREQ_IN_MILLIS)\n  }\n\n  #pingRequest () {\n    let pageLoadUrl = this.#account.dataPostURL\n    let data = {}\n    data = this.#request.addSystemDataToObject(data, undefined)\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PING)\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n\n    this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n  }\n\n  #isPingContinuous () {\n    return (typeof window.wzrk_d !== 'undefined' && window.wzrk_d.ping === 'continuous')\n  }\n\n  _isPersonalisationActive () {\n    return StorageManager._isLocalStorageSupported() && this.enablePersonalization\n  }\n\n  #overrideDSyncFlag (data) {\n    if (this._isPersonalisationActive()) {\n      data.dsync = true\n    }\n  }\n\n  popupCallbacks = {};\n  popupCurrentWzrkId = '';\n\n  // eslint-disable-next-line accessor-pairs\n  set popupCallback (callback) {\n    this.popupCallbacks[this.popupCurrentWzrkId] = callback\n  }\n\n  /**\n   *\n   * @param {object} payload\n   */\n  sendMultiValueData (payload) {\n    // Send the updated value to LC\n    let data = {}\n    data.af = {}\n    const profileObj = {}\n    data.type = 'profile'\n    if (profileObj.tz == null) {\n      profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n    }\n    data.profile = profileObj\n    if (payload) {\n      const keys = Object.keys(payload)\n      keys.forEach(key => {\n        data.af[key] = payload[key]\n      })\n    }\n    if ($ct.location) {\n      data.af = { ...data.af, ...$ct.location }\n    }\n    data = this.#request.addSystemDataToProfileObject(data, undefined)\n    this.#request.addFlags(data)\n    const compressedData = compressData(JSON.stringify(data), this.#logger)\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n    this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n  }\n\n  // offline mode\n  /**\n   * events will be recorded and queued locally when passed with true\n   * but will not be sent to the server until offline is disabled by passing false\n   * @param {boolean} arg\n   */\n\n  setOffline (arg) {\n    if (typeof arg !== 'boolean') {\n      console.error('setOffline should be called with a value of type boolean')\n      return\n    }\n    $ct.offline = arg\n    // if offline is disabled\n    // process events from cache\n    if (!arg) {\n      this.#request.processBackupEvents()\n    }\n  }\n}\n","import Clevertap from './clevertap'\n\nconst clevertap = new Clevertap(window.clevertap)\n\nwindow.clevertap = window.wizrocket = clevertap\n\nexport default clevertap\n"],"names":["TARGET_DOMAIN","TARGET_PROTOCOL","DEFAULT_REGION","Account","id","region","targetDomain","accountId","dcSDKVersion","finalTargetDomain","unsupportedKeyCharRegex","RegExp","unsupportedValueCharRegex","singleQuoteRegex","CLEAR","CHARGED_ID","CHARGEDID_COOKIE_NAME","GCOOKIE_NAME","KCOOKIE_NAME","CAMP_COOKIE_NAME","CAMP_COOKIE_G","SCOOKIE_PREFIX","SCOOKIE_EXP_TIME_IN_SECS","EV_COOKIE","META_COOKIE","PR_COOKIE","ARP_COOKIE","LCOOKIE_NAME","GLOBAL","DISPLAY","WEBPUSH_LS_KEY","OPTOUT_KEY","CT_OPTOUT_KEY","OPTOUT_COOKIE_ENDSWITH","USEIP_KEY","LRU_CACHE","LRU_CACHE_SIZE","IS_OUL","EVT_PUSH","EVT_PING","COOKIE_EXPIRY","MAX_TRIES","FIRST_PING_FREQ_IN_MILLIS","CONTINUOUS_PING_FREQ_IN_MILLIS","GROUP_SUBSCRIPTION_REQUEST_ID","categoryLongKey","WZRK_PREFIX","WZRK_ID","NOTIFICATION_VIEWED","NOTIFICATION_CLICKED","FIRE_PUSH_UNREGISTERED","PUSH_SUBSCRIPTION_DATA","COMMAND_INCREMENT","COMMAND_DECREMENT","COMMAND_SET","COMMAND_ADD","COMMAND_REMOVE","COMMAND_DELETE","WEBINBOX_CONFIG","WEBINBOX","MAX_INBOX_MSG","SYSTEM_EVENTS","isString","input","String","isObject","Object","prototype","toString","call","isDateObject","Date","isObjectEmpty","obj","prop","hasOwnProperty","isConvertibleToNumber","n","isNaN","parseFloat","isFinite","isNumber","test","isValueValid","value","undefined","removeUnsupportedChars","o","logger","key","sanitizedVal","sanitizedKey","sanitize","length","substring","reportError","val","regex","replace","getToday","today","getFullYear","getMonth","getDay","getNow","Math","floor","getTime","convertToWZRKDate","dateObj","round","setDate","dt","isDateValid","date","matches","exec","d","m","y","composedDate","getDate","StorageManager","_isLocalStorageSupported","localStorage","setItem","JSON","stringify","data","getItem","parse","e","removeItem","name","domain","cookieStr","document","cookie","seconds","expires","domainStr","setTime","toGMTString","encodeURIComponent","nameEQ","ca","split","idx","c","charAt","indexOf","decodeURIComponent","window","property","save","createCookie","location","hostname","$ct","globalCache","read","readCookie","trim","err","broadDomain","domainParts","testBroadDomain","testCookieName","removeCookie","tempCookie","metaObj","readFromLSorCookie","wzrkMetaObj","saveToLSorCookie","getMetaProp","setMetaProp","k","flag","reqNo","backupArr","q","debug","respNo","backupMap","gcookie","REQ_N","RESP_N","globalProfileMap","globalEventsMap","blockRequest","isOptInRequest","webPushEnabled","campaignDivMap","currentSessionId","wiz_counter","notifApi","notifEnabledFromApi","unsubGroups","updatedCategoryLong","inbox","isPrivacyArrPushed","privacyArray","offline","LRUCache","max","lruCache","tempLruCache","cache","entry","push","item","saveCacheToLS","allKeys","objToArray","index","temp","keysArr","keysLength","newCache","indexToDelete","splice","CleverTapAPI","request","device","session","global","resume","respNumber","optOutResponse","oulReq","newGuid","isOULInProgress","oulReqN","removeBackup","sessionObj","getSessionCookieObject","s","getAndClearMetaProp","kIdFromLS","guidFromLRUCache","set","lastK","getSecondLastKey","lastGUID","unregisterTokenForGuid","createBroadCookie","manageSession","t","setSessionCookieObject","processingBackup","processBackupEvents","DeviceManager","getGuid","guid","error","DATA_NOT_SENT_TEXT","CLEVERTAP_ERROR_PREFIX","EMBED_ERROR","EVENT_ERROR","GENDER_ERROR","EMPLOYED_ERROR","MARRIED_ERROR","EDUCATION_ERROR","AGE_ERROR","DOB_ERROR","ENUM_FORMAT_ERROR","PHONE_FORMAT_ERROR","_globalChargedId","isEventStructureFlat","eventObj","Array","isArray","isChargedEventStructureValid","chargedObj","itemKey","chargedId","EventHandler","values","isPersonalisationActive","eventsArr","evtName","evtObj","respObj","firstTime","lastTime","count","eventName","shift","includes","type","unshift","evtData","processEvent","getURLParams","url","urlParams","uri","match","pl","search","decode","replacement","getDomain","a","createElement","href","addToURL","v","getHostName","urlBase64ToUint8Array","base64String","padding","repeat","base64","rawData","atob","processedData","i","charCodeAt","Uint8Array","compressData","dataObject","compressToBase64","compress","uncompressed","context_dictionary","context_dictionaryToCreate","context_c","context_wc","context_w","context_enlargeIn","context_dictSize","context_numBits","context_data_string","context_data_val","context_data_position","ii","f","fromCharCode","pow","getKeyStr","_keyStr","output","chr1","chr2","chr3","enc1","enc2","enc3","enc4","NaN","RequestDispatcher","skipARP","sendOULFlag","skipResARP","_arp","pageLoadUrl","useIP","slice","tries","setTimeout","clevertap","wizrocket","plugin","ctCbScripts","getElementsByClassName","parentNode","removeChild","setAttribute","async","getElementsByTagName","appendChild","getCampaignObject","finalcampObj","campObj","wp","saveCampaignObject","campaignObj","newObj","setCampaignObjectForGuid","guidCampObj","finalCampObj","keys","forEach","campKeyObj","globalObj","dailyObj","campaignIdArray","resultObj","dailyC","totalC","campaignId","console","getCampaignObjForLc","storageValue","decodedValue","parsedValue","resultObjWP","resultObjWI","wi","todayCwp","todayCwi","tc","wmp","wimp","tlc","witlc","isProfileValid","profileObj","valid","profileKey","profileVal","Age","Phone","processFBUserObj","user","profileData","Name","FBID","gender","Gender","getHighestEducation","eduArr","college","highschool","edu","relationship_status","Married","education","Education","work","Employed","email","Email","birthday","mmddyy","DOB","processGPlusUserObj","displayName","GPID","image","isDefault","Photo","emails","emailIdx","emailObj","organizations","orgObj","yyyymmdd","relationshipStatus","addToLocalProfileMap","override","_custom","closeIframe","divIdIgnored","sessionCampaignObj","divId","getElementById","style","display","arp","jsonMap","isOULARP","arpFromStorage","setEnum","enumVal","handleEmailSubscription","subscription","reEncoded","fetchGroups","account","urlParamsAsIs","encodedEmailId","encodedProfileProps","p","emailURL","fireRequest","ProfileHandler","profilesArr","propName","command","tz","profile","addSystemDataToProfileObject","addFlags","compressedData","dataPostURL","saveAndFireRequest","arrayVal","array","toLowerCase","sendMultiValueData","propKey","propVal","profileArr","outerObj","Site","Facebook","FbProfileObj","GPlusProfileObj","addSystemDataToObject","UserLoginHandler","addToK","ids","g","kId","anonymousUser","foundInCache","getLastKey","gFromCache","get","clear","Identity","cookieName","loginArr","pop","processProfile","setInstantDeleteFlagInK","CTWebPersonalisationBanner","_details","shadow","attachShadow","mode","innerHTML","getBannerContent","trackClick","addEventListener","onClickUrl","details","onClick","open","parent","renderNotificationClicked","msgId","pivotId","renderNotificationViewed","divHeight","css","desktopImageURL","mobileImageURL","html","renderBanner","HTMLElement","CTWebPersonalisationCarousel","_target","_carousel","slides","previouslySelectedItem","selectedItem","autoSlide","stopAutoSlideTimeout","customElements","define","getStyles","carousel","getCarouselContent","showNavBtns","insertAdjacentHTML","navBtnsHtml","showNavArrows","leftNavArrowHtml","rightNavArrowHtml","setupClick","updateSelectedItem","startAutoSlide","setupOnHover","target","wzrk_id","wzrk_pivot","event","eventID","startsWith","selected","endsWith","goToNext","goToPrev","wzrk_slideNo","clearInterval","clearTimeout","detail","banner","classList","add","navBtnsCss","navArrowsCss","prevItem","prevButton","remove","button","setInterval","sliderTime","goTo","prev","cur","renderCarousel","CTWebPopupImageOnly","_session","popup","container","sessionId","getImageOnlyPopupContent","shadowRoot","closeIcon","updateImageAndContainerWidth","msgContent","width","getRenderedImageWidth","setProperty","visibility","img","ratio","naturalWidth","naturalHeight","height","renderImageOnlyPopup","Message","config","message","wrapper","snackBar","renderMessage","part","_el","msg","createEl","templateType","prepareBasicMessage","timeStamp","determineTimeStampText","viewed","unreadMarker","imageUrl","imageContainer","addImage","iconTitleDescWrapper","iconUrl","iconContainer","titleDescWrapper","title","innerText","description","buttons","buttonsContainer","addButtons","hasCopyAction","b","text","cssText","action","addSnackbar","greenTickSvg","clipboardMsg","path","isPreview","raiseClickedForBasicTemplates","payload","tagName","kv","wzrk_c2a","openUrlInNewTab","focus","navigator","clipboard","writeText","clipboardText","log","messageStyles","backgroundColor","borderColor","titleColor","descriptionColor","buttonColor","buttonTextColor","unreadMarkerColor","inboxContainerStyles","panelBackgroundColor","panelBorderColor","headerBackgroundColor","headerTitleColor","closeIconColor","categoriesTabColor","categoriesTitleColor","categoriesBorderColor","selectedCategoryTabColor","selectedCategoryTitleColor","selectedCategoryBorderColor","headerCategoryAndPoweredByCTHeight","Inbox","isInboxOpen","selectedCategory","unviewedMessages","unviewedCounter","inboxConfigForPreview","inboxSelector","emptyInboxMsg","inboxCard","unviewedBadge","observer","selectedCategoryRef","addClickListenerOnDocument","composedPath","toggleInbox","prevCategoryRef","updateActiveCategory","_path","filter","messageEl","raiseClickedEvent","contains","setBadgeStyle","msgCount","init","styles","notificationsBadge","addUnviewedBadge","createinbox","removeEventListener","categories","getInboxStyles","messages","deleteExpiredAndGetUnexpiredMsgs","msgIds","buildUIForMessages","updateUnviewedBadgeCounter","deleteMsgsFromUI","getInboxMessages","now","wzrk_ttl","el","sort","reduce","acc","saveInboxMessages","msgs","inboxMsgs","incomingMsgs","textColor","body","updateUnviewedBadgePosition","getBoundingClientRect","top","right","left","header","headerTitle","createCategories","hidePoweredByCT","poweredByText","src","options","root","rootMargin","threshold","IntersectionObserver","entries","handleMessageViewed","addMsgsToInboxFromLS","categoriesContainer","leftArrow","arrowSvg","children","scrollBy","categoriesWrapper","_categories","category","rightArrow","firstCategory","lastCategory","firstCategoryObserver","categoryObserverCb","intersectionRatio","observe","lastCategoryObserver","hide","activeCategory","scrollTop","counter","childNodes","getAttribute","updateTSForRenderedMsgs","maxMsgsInInbox","firstChild","tags","insertBefore","msgTotalCount","querySelectorAll","ctInboxMsgs","hasMessages","raiseViewedEvent","isIntersecting","updateMessageInLS","zIndex","scrollLeft","scrollWidth","setInboxPosition","windowWidth","outerWidth","customInboxStyles","getComputedStyle","getPropertyValue","bottom","hasPositionDefined","res","getInboxPosition","clientHeight","clientWidth","xPos","yPos","ts","headerHeight","categoriesHeight","hidePoweredByCTHeight","tabColor","selectedTab","inboxStyles","cardStyles","cards","msgStyles","updateInboxMessages","processWebInboxSettings","webInboxSetting","_settings","processInboxNotifs","inbox_preview","incomingMessagesForPreview","inbox_notifs","incomingMessages","addWebInbox","checkAndRegisterWebInboxElements","getAndMigrateInboxMessages","gudInboxObj","storedInboxObj","initializeWebInbox","Promise","resolve","reject","readyState","onLoaded","inboxHeight","inboxWidth","horizontalScroll","scrollingElement","verticalScroll","innerWidth","windowHeight","innerHeight","selectorRect","selectorX","x","selectorY","selectorLeft","selectorRight","selectorTop","selectorBottom","selectorHeight","selectorWidth","selectorCenter","halfOfInboxHeight","halfOfInboxWidth","inboxOnSide","availableHeight","inboxRight","availableWidth","inboxLeft","diff","hasWebInboxSettingsInLS","_tr","isWebPopUpSpamControlDisabled","_device","_request","_logger","_wizCounter","doCampHouseKeeping","targetingMsgJson","incrCount","excludeFromFreqCaps","currentCount","totalCount","sessionStorage","campTypeObj","wtarget_type","wmc","wimc","campaignSessionLimit","campaignDailyLimit","campaignTotalLimit","totalDailyLimit","totalSessionLimit","totalInboxSessionLimit","efc","parseInt","mdc","tdc","campaignSessionCount","totalSessionCount","campaignDailyCount","totalDailyCount","campaignTotalCount","delay","campKey","newCampObj","getCookieParams","scookieObj","setupClickEvent","contentDiv","isLegacy","ctaElement","jsCTAElements","jsFunc","preview","onclick","invokeExternalJs","func","setupClickUrl","incrementImpression","renderPersonalisationBanner","divSelector","bannerEl","containerEl","querySelector","renderPersonalisationCarousel","renderPopUpImageOnly","popupImageOnly","renderFooterNotification","displayObj","inaObj","kvPairsEvent","CustomEvent","dispatchEvent","layout","showExitIntent","element","msgDiv","isBanner","viewHeight","viewWidth","legacy","marginBottom","contentHeight","bottomPosition","widthPerct","userAgent","proto","iFrameStyle","iframe","borderRadius","br","frameborder","marginheight","marginwidth","scrolling","pointerCss","bgColor","btnBg","leftTd","btColor","theme","titleText","descriptionText","imageTd","onClickStr","ifrm","contentWindow","contentDocument","doc","write","appendScriptForCustomEvent","close","adjustIFrameHeight","scrollHeight","margin","ua","onload","inDoc","_timer","script","_callBackCalled","showFooterNotification","notificationCallback","raiseNotificationClicked","raiseNotificationViewed","popupCurrentWzrkId","popupCallbacks","popupCallback","msgCTkv","wzrkPrefixKey","wzrkJson","raisePopupNotificationClicked","notificationData","eventData","wzrkPrefixObj","exitintentObj","targetObj","clientY","opacityDiv","ctaText","processNativeDisplayArr","arrInAppNotifs","map","elementId","addLoadListener","inapp_notifs","targetNotif","onmouseleave","mergeEventMap","newEvtMap","oldEvtObj","newEvtObj","handleInboxNotifications","msgArr","then","catch","staleDataUpdate","staledata","campType","evpr","eventsMap","events","profileMap","syncExpiry","expires_in","inapp_stale","inbox_stale","User","visitCount","prevSession","logLevels","DISABLE","ERROR","INFO","DEBUG","Logger","logLevel","wzrkError","code","level","WZRK_D","SessionManager","scookieStr","objStr","currentSessionInLS","sessionCount","sessionStart","seqNo","requestTime","RequestManager","backupEvent","fired","ignoreTrim","wzrk_error","pg","rc","lastSyncTime","expirySeconds","dsync","givenGUID","registerToken","nowTs","evtDetail","Privacy","privacyArr","privacyObj","curr","optOut","shouldUseIP","NotificationHandler","displayArgs","enabled","applicationServerKey","subscriptionCallback","serviceWorkerPath","apnsWebPushId","apnsServiceUrl","safari","pushNotification","requestPermission","permission","subscriptionData","endpoint","deviceToken","browser","info","registrationScope","serviceWorker","register","registration","__wzrk_account_id","scope","rootDirRegex","isServiceWorkerAtRoot","ready","getRegistrations","serviceWorkerRegistration","subscribeObj","userVisibleOnly","pushManager","subscribe","getSubscription","unsubscribe","successful","scriptTag","bodyText","okButtonText","rejectButtonText","okButtonColor","skipDialog","askAgainTimeInSeconds","okCallback","rejectCallback","httpsPopupPath","httpsIframePath","apnsWebPushServiceUrl","notifObj","isHTTP","protocol","chromeAgent","firefoxAgent","safariAgent","Notification","httpsIframe","state","from","wzrkPermissionPopup","wizAlert","confirmButtonText","confirmButtonColor","CleverTap","isSpa","bind","enablePersonalization","_isPersonalisationActive","ReqestManager","onUserLogin","privacy","notifications","spa","dismissSpamControl","getTimeElapsed","getPageCount","logout","getCleverTapID","getAccountID","getSCDomain","setSCSDKVersion","ver","scSDKVersion","af","scv","getInboxMessageCount","getInboxMessageUnreadCount","getAllInboxMessages","getUnreadInboxMessages","getInboxMessageForId","messageId","deleteInboxMessage","markReadInboxMessage","unreadMsg","markReadAllInboxMessage","processNotificationEvent","eventDetail","setLogLevel","l","Number","handleIncrementValue","_handleIncrementDecrementValue","handleDecrementValue","setMultiValuesForKey","_handleMultiValueSet","addMultiValueForKey","_handleMultiValueAdd","addMultiValuesForKey","removeMultiValueForKey","_handleMultiValueRemove","removeMultiValuesForKey","removeValueForKey","_handleMultiValueDelete","_handleEmailSubscription","getLocation","lat","lng","Latitude","Longitude","geolocation","getCurrentPosition","showPosition","showError","position","coords","latitude","longitude","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","UNKNOWN_ERROR","api","enableWebPush","_enableWebPush","tr","is_onloadcalled","subEmail","getEmail","withGroups","unSubEmail","unsubEmailGroups","elements","isUnsubscribed","checked","setSubscriptionGroups","getSubscriptionGroups","changeSubscriptionGroups","updatedGroups","setUpdatedCategoryLong","$CLTP_WR","$WZRK_WR","currLocation","wzrk_ex","pageChanged","backupInterval","timeout","pgCount","referrerDomain","referrer","maxLen","utmSource","utm_source","wzrk_source","us","utmMedium","utm_medium","wzrk_medium","um","utmCampaign","utm_campaign","wzrk_campaign","uc","wm","cpg","lib","arg","callback","_processOldValues","debouncedPageChanged","debounce","wzrk_d","ping","Clevertap"],"mappings":"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"}
=======
{"version":3,"file":"clevertap.js","sources":["src/options.js","src/modules/account.js","src/util/constants.js","src/util/datatypes.js","src/util/datetime.js","src/util/storage.js","src/util/lruCache.js","src/modules/api.js","src/modules/device.js","src/util/messages.js","src/util/validator.js","src/modules/event.js","src/util/url.js","src/util/encoder.js","src/util/requestDispatcher.js","src/util/clevertap.js","src/modules/profile.js","src/modules/userLogin.js","src/util/web-personalisation/banner.js","src/util/web-personalisation/carousel.js","src/util/web-popupImageonly/popupImageonly.js","src/modules/web-inbox/Message.js","src/modules/web-inbox/inboxStyles.js","src/modules/web-inbox/WebInbox.js","src/modules/web-inbox/helper.js","src/util/tr.js","src/modules/user.js","src/modules/logger.js","src/modules/session.js","src/modules/request.js","src/modules/privacy.js","src/modules/notification.js","src/clevertap.js","src/main.js"],"sourcesContent":["export const TARGET_DOMAIN = 'clevertap-prod.com'\nexport const TARGET_PROTOCOL = 'https:'\nexport const DEFAULT_REGION = 'eu1'\n","import { DEFAULT_REGION, TARGET_DOMAIN, TARGET_PROTOCOL } from '../options'\n\nexport default class Account {\n  #accountId\n  #region = ''\n  #targetDomain = TARGET_DOMAIN\n  #dcSdkversion = ''\n\n  constructor ({ id } = {}, region = '', targetDomain = TARGET_DOMAIN) {\n    this.id = id\n    if (region) {\n      this.region = region\n    }\n    if (targetDomain) {\n      this.targetDomain = targetDomain\n    }\n  }\n\n  get id () {\n    return this.#accountId\n  }\n\n  set id (accountId) {\n    this.#accountId = accountId\n  }\n\n  get region () {\n    return this.#region\n  }\n\n  set region (region) {\n    this.#region = region\n  }\n\n  get dcSDKVersion () {\n    return this.#dcSdkversion\n  }\n\n  set dcSDKVersion (dcSDKVersion) {\n    this.#dcSdkversion = dcSDKVersion\n  }\n\n  get targetDomain () {\n    return this.#targetDomain\n  }\n\n  set targetDomain (targetDomain) {\n    this.#targetDomain = targetDomain\n  }\n\n  get finalTargetDomain () {\n    if (this.region) {\n      return `${this.region}.${this.targetDomain}`\n    } else {\n      if (this.targetDomain === TARGET_DOMAIN) {\n        return `${DEFAULT_REGION}.${this.targetDomain}`\n      }\n      return this.targetDomain\n    }\n  }\n\n  get dataPostURL () {\n    return `${TARGET_PROTOCOL}//${this.finalTargetDomain}/a?t=96`\n  }\n\n  get recorderURL () {\n    return `${TARGET_PROTOCOL}//${this.finalTargetDomain}/r?r=1`\n  }\n\n  get emailURL () {\n    return `${TARGET_PROTOCOL}//${this.finalTargetDomain}/e?r=1`\n  }\n}\n","export const unsupportedKeyCharRegex = new RegExp('^\\\\s+|\\\\\\.|\\:|\\\\\\$|\\'|\\\"|\\\\\\\\|\\\\s+$', 'g')\nexport const unsupportedValueCharRegex = new RegExp(\"^\\\\s+|\\'|\\\"|\\\\\\\\|\\\\s+$\", 'g')\nexport const doubleQuoteRegex = new RegExp('\\\"', 'g')\nexport const singleQuoteRegex = new RegExp('\\'', 'g')\nexport const CLEAR = 'clear'\nexport const CHARGED_ID = 'Charged ID'\nexport const CHARGEDID_COOKIE_NAME = 'WZRK_CHARGED_ID'\nexport const GCOOKIE_NAME = 'WZRK_G'\nexport const KCOOKIE_NAME = 'WZRK_K'\nexport const CAMP_COOKIE_NAME = 'WZRK_CAMP'\nexport const CAMP_COOKIE_G = 'WZRK_CAMP_G'// cookie for storing campaign details against guid\nexport const SCOOKIE_PREFIX = 'WZRK_S'\nexport const SCOOKIE_EXP_TIME_IN_SECS = 60 * 20 // 20 mins\nexport const EV_COOKIE = 'WZRK_EV'\nexport const META_COOKIE = 'WZRK_META'\nexport const PR_COOKIE = 'WZRK_PR'\nexport const ARP_COOKIE = 'WZRK_ARP'\nexport const LCOOKIE_NAME = 'WZRK_L'\nexport const NOTIF_COOKIE_NAME = 'WZRK_N'\nexport const GLOBAL = 'global'\nexport const TOTAL_COUNT = 'tc'\nexport const DISPLAY = 'display'\nexport const UNDEFINED = 'undefined'\nexport const WEBPUSH_LS_KEY = 'WZRK_WPR'\nexport const OPTOUT_KEY = 'optOut'\nexport const CT_OPTOUT_KEY = 'ct_optout'\nexport const OPTOUT_COOKIE_ENDSWITH = ':OO'\nexport const USEIP_KEY = 'useIP'\nexport const LRU_CACHE = 'WZRK_X'\nexport const LRU_CACHE_SIZE = 100\nexport const IS_OUL = 'isOUL'\nexport const EVT_PUSH = 'push'\nexport const EVT_PING = 'ping'\nexport const COOKIE_EXPIRY = 86400 * 365 // 1 Year in seconds\nexport const MAX_TRIES = 200 // API tries\nexport const FIRST_PING_FREQ_IN_MILLIS = 2 * 60 * 1000 // 2 mins\nexport const CONTINUOUS_PING_FREQ_IN_MILLIS = 5 * 60 * 1000 // 5 mins\nexport const GROUP_SUBSCRIPTION_REQUEST_ID = '2'\nexport const categoryLongKey = 'cUsY'\nexport const WZRK_PREFIX = 'wzrk_'\nexport const WZRK_ID = 'wzrk_id'\nexport const NOTIFICATION_VIEWED = 'Notification Viewed'\nexport const NOTIFICATION_CLICKED = 'Notification Clicked'\nexport const FIRE_PUSH_UNREGISTERED = 'WZRK_FPU'\nexport const PUSH_SUBSCRIPTION_DATA = 'WZRK_PSD' // PUSH SUBSCRIPTION DATA FOR REGISTER/UNREGISTER TOKEN\nexport const COMMAND_INCREMENT = '$incr'\nexport const COMMAND_DECREMENT = '$decr'\nexport const COMMAND_SET = '$set'\nexport const COMMAND_ADD = '$add'\nexport const COMMAND_REMOVE = '$remove'\nexport const COMMAND_DELETE = '$delete'\nexport const WEBINBOX_CONFIG = 'WZRK_INBOX_CONFIG'\nexport const WEBINBOX = 'WZRK_INBOX'\nexport const MAX_INBOX_MSG = 15\n\nexport const SYSTEM_EVENTS = [\n  'Stayed',\n  'UTM Visited',\n  'App Launched',\n  'Notification Sent',\n  NOTIFICATION_VIEWED,\n  NOTIFICATION_CLICKED\n]\n","import {\n  unsupportedKeyCharRegex,\n  unsupportedValueCharRegex\n} from './constants'\n\nexport const isString = (input) => {\n  return (typeof input === 'string' || input instanceof String)\n}\n\nexport const isObject = (input) => {\n  // TODO: refine\n  return Object.prototype.toString.call(input) === '[object Object]'\n}\n\nexport const isDateObject = (input) => {\n  return typeof (input) === 'object' && (input instanceof Date)\n}\n\nexport const isObjectEmpty = (obj) => {\n  for (const prop in obj) {\n    if (obj.hasOwnProperty(prop)) { return false }\n  }\n  return true\n}\n\nexport const isConvertibleToNumber = (n) => {\n  return !isNaN(parseFloat(n)) && isFinite(n)\n}\n\nexport const isNumber = (n) => {\n  return /^-?[\\d.]+(?:e-?\\d+)?$/.test(n) && typeof n === 'number'\n}\n\nexport const isValueValid = (value) => {\n  if (value === null || value === undefined || value === 'undefined') {\n    return false\n  }\n  return true\n}\n\nexport const arrayContains = (arr, obj) => {\n  var i = arr.length\n  while (i--) {\n    if (arr[i] === obj) {\n      return true\n    }\n  }\n  return false\n}\n\nexport const removeUnsupportedChars = (o, logger) => {\n  // keys can't be greater than 1024 chars, values can't be greater than 1024 chars\n  if (typeof o === 'object') {\n    for (const key in o) {\n      if (o.hasOwnProperty(key)) {\n        const sanitizedVal = removeUnsupportedChars(o[key], logger)\n        let sanitizedKey\n        sanitizedKey = sanitize(key, unsupportedKeyCharRegex)\n        if (sanitizedKey.length > 1024) {\n          sanitizedKey = sanitizedKey.substring(0, 1024)\n          logger.reportError(520, sanitizedKey + '... length exceeded 1024 chars. Trimmed.')\n        }\n        delete o[key]\n        o[sanitizedKey] = sanitizedVal\n      }\n    }\n  } else {\n    let val\n\n    if (isString(o)) {\n      val = sanitize(o, unsupportedValueCharRegex)\n      if (val.length > 1024) {\n        val = val.substring(0, 1024)\n        logger.reportError(521, val + '... length exceeded 1024 chars. Trimmed.')\n      }\n    } else {\n      val = o\n    }\n    return val\n  }\n  return o\n}\n\nexport const sanitize = (input, regex) => {\n  return input.replace(regex, '')\n}\n","export const getToday = () => {\n  const today = new Date()\n  return today.getFullYear() + '' + today.getMonth() + '' + today.getDay()\n}\n\nexport const getNow = () => {\n  return Math.floor((new Date()).getTime() / 1000)\n}\n\nexport const convertToWZRKDate = (dateObj) => {\n  return ('$D_' + Math.round(dateObj.getTime() / 1000))\n}\n\nexport const setDate = (dt) => {\n  // expecting  yyyymmdd format either as a number or a string\n  if (isDateValid(dt)) {\n    return '$D_' + dt\n  }\n}\n\nexport const isDateValid = (date) => {\n  const matches = /^(\\d{4})(\\d{2})(\\d{2})$/.exec(date)\n  if (matches == null) return false\n  const d = matches[3]\n  const m = matches[2] - 1\n  const y = matches[1]\n  const composedDate = new Date(y, m, d)\n  // eslint-disable-next-line eqeqeq\n  return composedDate.getDate() == d && composedDate.getMonth() == m && composedDate.getFullYear() == y\n}\n","import {\n  GCOOKIE_NAME,\n  META_COOKIE,\n  KCOOKIE_NAME,\n  LCOOKIE_NAME\n} from './constants'\nexport class StorageManager {\n  static save (key, value) {\n    if (!key || !value) {\n      return false\n    }\n    if (this._isLocalStorageSupported()) {\n      localStorage.setItem(key, typeof value === 'string' ? value : JSON.stringify(value))\n      return true\n    }\n  }\n\n  static read (key) {\n    if (!key) {\n      return false\n    }\n    let data = null\n    if (this._isLocalStorageSupported()) {\n      data = localStorage.getItem(key)\n    }\n    if (data != null) {\n      try {\n        data = JSON.parse(data)\n      } catch (e) {}\n    }\n    return data\n  }\n\n  static remove (key) {\n    if (!key) {\n      return false\n    }\n    if (this._isLocalStorageSupported()) {\n      localStorage.removeItem(key)\n      return true\n    }\n  }\n\n  static removeCookie (name, domain) {\n    let cookieStr = name + '=; expires=Thu, 01 Jan 1970 00:00:01 GMT;'\n\n    if (domain) {\n      cookieStr = cookieStr + ' domain=' + domain + '; path=/'\n    }\n\n    document.cookie = cookieStr\n  }\n\n  static createCookie (name, value, seconds, domain) {\n    let expires = ''\n    let domainStr = ''\n    if (seconds) {\n      const date = new Date()\n      date.setTime(date.getTime() + (seconds * 1000))\n\n      expires = '; expires=' + date.toGMTString()\n    }\n\n    if (domain) {\n      domainStr = '; domain=' + domain\n    }\n\n    value = encodeURIComponent(value)\n\n    document.cookie = name + '=' + value + expires + domainStr + '; path=/'\n  }\n\n  static readCookie (name) {\n    const nameEQ = name + '='\n    const ca = document.cookie.split(';')\n    for (let idx = 0; idx < ca.length; idx++) {\n      let c = ca[idx]\n      while (c.charAt(0) === ' ') {\n        c = c.substring(1, c.length)\n      }\n      // eslint-disable-next-line eqeqeq\n      if (c.indexOf(nameEQ) == 0) {\n        return decodeURIComponent(c.substring(nameEQ.length, c.length))\n      }\n    }\n    return null\n  }\n\n  static _isLocalStorageSupported () {\n    return 'localStorage' in window && window.localStorage !== null && typeof window.localStorage.setItem === 'function'\n  }\n\n  static saveToLSorCookie (property, value) {\n    if (value == null) {\n      return\n    }\n    try {\n      if (this._isLocalStorageSupported()) {\n        this.save(property, encodeURIComponent(JSON.stringify(value)))\n      } else {\n        if (property === GCOOKIE_NAME) {\n          this.createCookie(property, encodeURIComponent(value), 0, window.location.hostname)\n        } else {\n          this.createCookie(property, encodeURIComponent(JSON.stringify(value)), 0, window.location.hostname)\n        }\n      }\n      $ct.globalCache[property] = value\n    } catch (e) {}\n  }\n\n  static readFromLSorCookie (property) {\n    let data\n    if ($ct.globalCache.hasOwnProperty(property)) {\n      return $ct.globalCache[property]\n    }\n    if (this._isLocalStorageSupported()) {\n      data = this.read(property)\n    } else {\n      data = this.readCookie(property)\n    }\n\n    if (data !== null && data !== undefined && !(typeof data.trim === 'function' && data.trim() === '')) {\n      let value\n      try {\n        value = JSON.parse(decodeURIComponent(data))\n      } catch (err) {\n        value = decodeURIComponent(data)\n      }\n      $ct.globalCache[property] = value\n      return value\n    }\n  }\n\n  static createBroadCookie (name, value, seconds, domain) {\n    // sets cookie on the base domain. e.g. if domain is baz.foo.bar.com, set cookie on \".bar.com\"\n    // To update an existing \"broad domain\" cookie, we need to know what domain it was actually set on.\n    // since a retrieved cookie never tells which domain it was set on, we need to set another test cookie\n    // to find out which \"broadest\" domain the cookie was set on. Then delete the test cookie, and use that domain\n    // for updating the actual cookie.\n\n    if (domain) {\n      let broadDomain = $ct.broadDomain\n      if (broadDomain == null) { // if we don't know the broadDomain yet, then find out\n        const domainParts = domain.split('.')\n        let testBroadDomain = ''\n        for (let idx = domainParts.length - 1; idx >= 0; idx--) {\n          if (idx === 0) {\n            testBroadDomain = domainParts[idx] + testBroadDomain\n          } else {\n            testBroadDomain = '.' + domainParts[idx] + testBroadDomain\n          }\n\n          // only needed if the cookie already exists and needs to be updated. See note above.\n          if (this.readCookie(name)) {\n            // no guarantee that browser will delete cookie, hence create short lived cookies\n            var testCookieName = 'test_' + name + idx\n            this.createCookie(testCookieName, value, 10, testBroadDomain) // self-destruct after 10 seconds\n            if (!this.readCookie(testCookieName)) { // if test cookie not set, then the actual cookie wouldn't have been set on this domain either.\n              continue\n            } else { // else if cookie set, then delete the test and the original cookie\n              this.removeCookie(testCookieName, testBroadDomain)\n            }\n          }\n\n          this.createCookie(name, value, seconds, testBroadDomain)\n          const tempCookie = this.readCookie(name)\n          // eslint-disable-next-line eqeqeq\n          if (tempCookie == value) {\n            broadDomain = testBroadDomain\n            $ct.broadDomain = broadDomain\n            break\n          }\n        }\n      } else {\n        this.createCookie(name, value, seconds, broadDomain)\n      }\n    } else {\n      this.createCookie(name, value, seconds, domain)\n    }\n  }\n\n  static getMetaProp (property) {\n    const metaObj = this.readFromLSorCookie(META_COOKIE)\n    if (metaObj != null) {\n      return metaObj[property]\n    }\n  }\n\n  static setMetaProp (property, value) {\n    if (this._isLocalStorageSupported()) {\n      let wzrkMetaObj = this.readFromLSorCookie(META_COOKIE)\n      if (wzrkMetaObj == null) {\n        wzrkMetaObj = {}\n      }\n      if (value === undefined) {\n        delete wzrkMetaObj[property]\n      } else {\n        wzrkMetaObj[property] = value\n      }\n      this.saveToLSorCookie(META_COOKIE, wzrkMetaObj)\n    }\n  }\n\n  static getAndClearMetaProp (property) {\n    const value = this.getMetaProp(property)\n    this.setMetaProp(property, undefined)\n    return value\n  }\n\n  static setInstantDeleteFlagInK () {\n    let k = this.readFromLSorCookie(KCOOKIE_NAME)\n    if (k == null) {\n      k = {}\n    }\n    k.flag = true\n    this.saveToLSorCookie(KCOOKIE_NAME, k)\n  }\n\n  static backupEvent (data, reqNo, logger) {\n    let backupArr = this.readFromLSorCookie(LCOOKIE_NAME)\n    if (typeof backupArr === 'undefined') {\n      backupArr = {}\n    }\n    backupArr[reqNo] = { q: data }\n    this.saveToLSorCookie(LCOOKIE_NAME, backupArr)\n    logger.debug(`stored in ${LCOOKIE_NAME} reqNo : ${reqNo} -> ${data}`)\n  }\n\n  static removeBackup (respNo, logger) {\n    const backupMap = this.readFromLSorCookie(LCOOKIE_NAME)\n    if (typeof backupMap !== 'undefined' && backupMap !== null && typeof backupMap[respNo] !== 'undefined') {\n      logger.debug(`del event: ${respNo} data-> ${backupMap[respNo].q}`)\n      delete backupMap[respNo]\n      this.saveToLSorCookie(LCOOKIE_NAME, backupMap)\n    }\n  }\n}\n\nexport const $ct = {\n  globalCache: {\n    gcookie: null,\n    REQ_N: 0,\n    RESP_N: 0\n  },\n  LRU_CACHE: null,\n  globalProfileMap: undefined,\n  globalEventsMap: undefined,\n  blockRequest: false,\n  isOptInRequest: false,\n  broadDomain: null,\n  webPushEnabled: null,\n  campaignDivMap: {},\n  currentSessionId: null,\n  wiz_counter: 0, // to keep track of number of times we load the body\n  notifApi: {\n    notifEnabledFromApi: false\n  }, // helper variable to handle race condition and check when notifications were called\n  unsubGroups: [],\n  updatedCategoryLong: null,\n  inbox: null,\n  isPrivacyArrPushed: false,\n  privacyArray: [],\n  offline: false,\n  location: null\n  // domain: window.location.hostname, url -> getHostName()\n  // gcookie: -> device\n}\n","import { StorageManager } from './storage'\nimport { LRU_CACHE } from './constants'\n\nexport default class LRUCache {\n  #keyOrder\n\n  constructor (max) {\n    this.max = max\n    let lruCache = StorageManager.readFromLSorCookie(LRU_CACHE)\n    if (lruCache) {\n      const tempLruCache = {}\n      this.#keyOrder = []\n      lruCache = lruCache.cache\n      for (const entry in lruCache) {\n        if (lruCache.hasOwnProperty(entry)) {\n          tempLruCache[lruCache[entry][0]] = lruCache[entry][1]\n          this.#keyOrder.push(lruCache[entry][0])\n        }\n      }\n      this.cache = tempLruCache\n    } else {\n      this.cache = {}\n      this.#keyOrder = []\n    }\n  }\n\n  get (key) {\n    const item = this.cache[key]\n    if (item) {\n      this.cache = this.#deleteFromObject(key, this.cache)\n      this.cache[key] = item\n      this.#keyOrder.push(key)\n    }\n    this.saveCacheToLS(this.cache)\n    return item\n  }\n\n  set (key, value) {\n    const item = this.cache[key]\n    const allKeys = this.#keyOrder\n    if (item != null) {\n      this.cache = this.#deleteFromObject(key, this.cache)\n    } else if (allKeys.length === this.max) {\n      this.cache = this.#deleteFromObject(allKeys[0], this.cache)\n    }\n    this.cache[key] = value\n    if (this.#keyOrder[this.#keyOrder - 1] !== key) {\n      this.#keyOrder.push(key)\n    }\n    this.saveCacheToLS(this.cache)\n  }\n\n  saveCacheToLS (cache) {\n    const objToArray = []\n    const allKeys = this.#keyOrder\n    for (const index in allKeys) {\n      if (allKeys.hasOwnProperty(index)) {\n        const temp = []\n        temp.push(allKeys[index])\n        temp.push(cache[allKeys[index]])\n        objToArray.push(temp)\n      }\n    }\n    StorageManager.saveToLSorCookie(LRU_CACHE, { cache: objToArray })\n  }\n\n  getKey (value) {\n    if (value === null) {\n      return null\n    }\n    const allKeys = this.#keyOrder\n    for (const index in allKeys) {\n      if (allKeys.hasOwnProperty(index)) {\n        if (this.cache[allKeys[index]] === value) {\n          return allKeys[index]\n        }\n      }\n    }\n    return null\n  }\n\n  getSecondLastKey () {\n    const keysArr = this.#keyOrder\n    if (keysArr != null && keysArr.length > 1) {\n      return keysArr[keysArr.length - 2]\n    }\n    return -1\n  }\n\n  getLastKey () {\n    const keysLength = this.#keyOrder.length\n    if (keysLength) {\n      return this.#keyOrder[keysLength - 1]\n    }\n  }\n\n  #deleteFromObject (key, obj) {\n    const allKeys = JSON.parse(JSON.stringify(this.#keyOrder))\n    const newCache = {}\n    let indexToDelete\n    for (const index in allKeys) {\n      if (allKeys.hasOwnProperty(index)) {\n        if (allKeys[index] !== key) {\n          newCache[allKeys[index]] = obj[allKeys[index]]\n        } else {\n          indexToDelete = index\n        }\n      }\n    }\n    allKeys.splice(indexToDelete, 1)\n    this.#keyOrder = JSON.parse(JSON.stringify(allKeys))\n    return newCache\n  }\n}\n","import { COOKIE_EXPIRY, FIRE_PUSH_UNREGISTERED, GCOOKIE_NAME, KCOOKIE_NAME, LRU_CACHE_SIZE, USEIP_KEY } from '../util/constants'\nimport { isValueValid } from '../util/datatypes'\nimport { getNow } from '../util/datetime'\nimport LRUCache from '../util/lruCache'\nimport { StorageManager, $ct } from '../util/storage'\n\nexport default class CleverTapAPI {\n  #logger\n  #request\n  #device\n  #session\n\n  constructor ({ logger, request, device, session }) {\n    this.#logger = logger\n    this.#request = request\n    this.#device = device\n    this.#session = session\n  }\n\n  /**\n   *\n   * @param {string} global gcookie\n   * @param {string} session\n   * @param {boolean} resume sent true in case of an OUL request from client side, which is returned as it is by server\n   * @param {number} respNumber the index of the request in backupmanager\n   * @param {boolean} optOutResponse\n   * @returns\n   */\n\n  s (global, session, resume, respNumber, optOutResponse) {\n    let oulReq = false\n    let newGuid = false\n\n    // for a scenario when OUL request is true from client side\n    // but resume is returned as false from server end\n    // we maintan a OulReqN var in the window object\n    // and compare with respNumber to determine the response of an OUL request\n    if (window.isOULInProgress) {\n      if (resume || (respNumber !== 'undefined' && respNumber === window.oulReqN)) {\n        window.isOULInProgress = false\n        oulReq = true\n      }\n    }\n\n    // call back function used to store global and session ids for the user\n    if (typeof respNumber === 'undefined') {\n      respNumber = 0\n    }\n\n    StorageManager.removeBackup(respNumber, this.#logger)\n\n    if (respNumber > $ct.globalCache.REQ_N) {\n      // request for some other user so ignore\n      return\n    }\n\n    if (!isValueValid(this.#device.gcookie)) {\n      if (global) {\n        newGuid = true\n      }\n    }\n\n    if (!isValueValid(this.#device.gcookie) || resume || typeof optOutResponse === 'boolean') {\n      const sessionObj = this.#session.getSessionCookieObject()\n\n      /*  If the received session is less than the session in the cookie,\n          then don't update guid as it will be response for old request\n      */\n      if (window.isOULInProgress || (sessionObj.s && (session < sessionObj.s))) {\n        return\n      }\n      this.#logger.debug(`Cookie was ${this.#device.gcookie} set to ${global}`)\n      this.#device.gcookie = global\n      if (!isValueValid(this.#device.gcookie)) {\n        // clear useIP meta prop\n        StorageManager.getAndClearMetaProp(USEIP_KEY)\n      }\n      if (global && StorageManager._isLocalStorageSupported()) {\n        if ($ct.LRU_CACHE == null) {\n          $ct.LRU_CACHE = new LRUCache(LRU_CACHE_SIZE)\n        }\n\n        const kIdFromLS = StorageManager.readFromLSorCookie(KCOOKIE_NAME)\n        let guidFromLRUCache\n        if (kIdFromLS != null && kIdFromLS.id) {\n          guidFromLRUCache = $ct.LRU_CACHE.cache[kIdFromLS.id]\n          if (resume) {\n            if (!guidFromLRUCache) {\n              StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, true)\n              // replace login identity in OUL request\n              // with the gcookie returned in exchange\n              $ct.LRU_CACHE.set(kIdFromLS.id, global)\n            }\n          }\n        }\n\n        StorageManager.saveToLSorCookie(GCOOKIE_NAME, global)\n        // lastk provides the guid\n        const lastK = $ct.LRU_CACHE.getSecondLastKey()\n        if (StorageManager.readFromLSorCookie(FIRE_PUSH_UNREGISTERED) && lastK !== -1) {\n          const lastGUID = $ct.LRU_CACHE.cache[lastK]\n          // fire the request directly via fireRequest to unregister the token\n          // then other requests with the updated guid should follow\n          this.#request.unregisterTokenForGuid(lastGUID)\n        }\n      }\n      StorageManager.createBroadCookie(GCOOKIE_NAME, global, COOKIE_EXPIRY, window.location.hostname)\n      StorageManager.saveToLSorCookie(GCOOKIE_NAME, global)\n    }\n\n    if (StorageManager._isLocalStorageSupported()) {\n      this.#session.manageSession(session)\n    }\n\n    // session cookie\n    const obj = this.#session.getSessionCookieObject()\n\n    // for the race-condition where two responses come back with different session ids. don't write the older session id.\n    if (typeof obj.s === 'undefined' || obj.s <= session) {\n      obj.s = session\n      obj.t = getNow() // time of last response from server\n      this.#session.setSessionCookieObject(obj)\n    }\n\n    // set blockRequest to false only if the device has a valid gcookie\n    if (isValueValid(this.#device.gcookie)) {\n      $ct.blockRequest = false\n    }\n\n    // only process the backup events after an OUL request or a new guid is recieved\n    if ((oulReq || newGuid) && !this.#request.processingBackup) {\n      this.#request.processBackupEvents()\n    }\n\n    $ct.globalCache.RESP_N = respNumber\n  }\n}\n","import { isValueValid } from '../util/datatypes'\nimport { StorageManager } from '../util/storage'\nimport { GCOOKIE_NAME, COOKIE_EXPIRY } from '../util/constants'\n\nexport default class DeviceManager {\n  #logger\n  gcookie\n\n  constructor ({ logger }) {\n    this.#logger = logger\n    this.gcookie = this.getGuid()\n  }\n\n  getGuid () {\n    let guid = null\n    if (isValueValid(this.gcookie)) {\n      return this.gcookie\n    }\n    if (StorageManager._isLocalStorageSupported()) {\n      const value = StorageManager.read(GCOOKIE_NAME)\n      if (isValueValid(value)) {\n        try {\n          guid = JSON.parse(decodeURIComponent(value))\n        } catch (e) {\n          this.#logger.debug('Cannot parse Gcookie from localstorage - must be encoded ' + value)\n          // assumming guids are of size 32. supporting both formats.\n          // guid can have encodedURIComponent or be without it.\n          // 1.56e4078ed15749928c042479ec2b4d47 - breaks on JSON.parse(decodeURIComponent())\n          // 2.%2256e4078ed15749928c042479ec2b4d47%22\n          if (value.length === 32) {\n            guid = value\n            StorageManager.saveToLSorCookie(GCOOKIE_NAME, value)\n          } else {\n            this.#logger.error('Illegal guid ' + value)\n          }\n        }\n\n        // Persist to cookie storage if not present there.\n        if (isValueValid(guid)) {\n          StorageManager.createBroadCookie(GCOOKIE_NAME, guid, COOKIE_EXPIRY, window.location.hostname)\n        }\n      }\n    }\n\n    if (!isValueValid(guid)) {\n      guid = StorageManager.readCookie(GCOOKIE_NAME)\n      if (isValueValid(guid) && (guid.indexOf('%') === 0 || guid.indexOf('\\'') === 0 || guid.indexOf('\"') === 0)) {\n        guid = null\n      }\n      if (isValueValid(guid)) {\n        StorageManager.saveToLSorCookie(GCOOKIE_NAME, guid)\n      }\n    }\n\n    return guid\n  }\n}\n","export const DATA_NOT_SENT_TEXT = 'This property has been ignored.'\nexport const INVALID_ACCOUNT = 'Invalid account ID'\nexport const INVALID_EVENT = 'Event structure not valid. Unable to process event'\nexport const CLEVERTAP_ERROR_PREFIX = 'CleverTap error:' // Formerly wzrk_error_txt\nexport const EMBED_ERROR = `${CLEVERTAP_ERROR_PREFIX} Incorrect embed script.`\nexport const EVENT_ERROR = `${CLEVERTAP_ERROR_PREFIX} Event structure not valid. ${DATA_NOT_SENT_TEXT}`\nexport const GENDER_ERROR = `${CLEVERTAP_ERROR_PREFIX} Gender value should be either M or F. ${DATA_NOT_SENT_TEXT}`\nexport const EMPLOYED_ERROR = `${CLEVERTAP_ERROR_PREFIX} Employed value should be either Y or N. ${DATA_NOT_SENT_TEXT}`\nexport const MARRIED_ERROR = `${CLEVERTAP_ERROR_PREFIX} Married value should be either Y or N. ${DATA_NOT_SENT_TEXT}`\nexport const EDUCATION_ERROR = `${CLEVERTAP_ERROR_PREFIX} Education value should be either School, College or Graduate. ${DATA_NOT_SENT_TEXT}`\nexport const AGE_ERROR = `${CLEVERTAP_ERROR_PREFIX} Age value should be a number. ${DATA_NOT_SENT_TEXT}`\nexport const DOB_ERROR = `${CLEVERTAP_ERROR_PREFIX} DOB value should be a Date Object`\nexport const OBJECT_ARRAY_ERROR = `${CLEVERTAP_ERROR_PREFIX} Expecting Object array in profile`\nexport const DATE_FORMAT_ERROR = `${CLEVERTAP_ERROR_PREFIX} setDate(number). number should be formatted as yyyymmdd`\nexport const ENUM_FORMAT_ERROR = `${CLEVERTAP_ERROR_PREFIX} setEnum(value). value should be a string or a number`\nexport const PHONE_FORMAT_ERROR = `${CLEVERTAP_ERROR_PREFIX} Phone number should be formatted as +[country code][number]`\n","import { isObject, isDateObject, isString, isNumber } from './datatypes'\nimport { convertToWZRKDate } from './datetime'\nimport { CHARGED_ID, CHARGEDID_COOKIE_NAME } from './constants'\nimport { StorageManager } from './storage'\n\nlet _globalChargedId\n\nexport const isEventStructureFlat = (eventObj) => {\n  // Events cannot have nested structure or Arrays\n  if (isObject(eventObj)) {\n    for (var key in eventObj) {\n      if (eventObj.hasOwnProperty(key)) {\n        if (isObject(eventObj[key]) || Array.isArray(eventObj[key])) {\n          return false\n        } else if (isDateObject(eventObj[key])) {\n          eventObj[key] = convertToWZRKDate(eventObj[key])\n        }\n      }\n    }\n    return true\n  }\n  return false\n}\n\nexport const isChargedEventStructureValid = (chargedObj, logger) => {\n  if (isObject(chargedObj)) {\n    for (var key in chargedObj) {\n      if (chargedObj.hasOwnProperty(key)) {\n        if (key === 'Items') {\n          if (!Array.isArray(chargedObj[key])) {\n            return false\n          }\n\n          if (chargedObj[key].length > 50) {\n            logger.reportError(522, 'Charged Items exceed 50 limit. Actual count: ' + chargedObj[key].length)\n          }\n\n          for (var itemKey in chargedObj[key]) {\n            if (chargedObj[key].hasOwnProperty(itemKey)) { // since default array implementation could be overridden - e.g. Teabox site\n              if (!isObject(chargedObj[key][itemKey]) || !isEventStructureFlat(chargedObj[key][itemKey])) {\n                return false\n              }\n            }\n          }\n        } else {\n          if (isObject(chargedObj[key]) || Array.isArray(chargedObj[key])) {\n            return false\n          } else if (isDateObject(chargedObj[key])) {\n            chargedObj[key] = convertToWZRKDate(chargedObj[key])\n          }\n        }\n      }\n    }\n\n    if (isString(chargedObj[CHARGED_ID]) || isNumber(chargedObj[CHARGED_ID])) {\n      // save charged Id\n      const chargedId = chargedObj[CHARGED_ID] + '' // casting chargedId to string\n\n      if (typeof _globalChargedId === 'undefined') {\n        _globalChargedId = StorageManager.readFromLSorCookie(CHARGEDID_COOKIE_NAME)\n      }\n      if (typeof _globalChargedId !== 'undefined' && _globalChargedId.trim() === chargedId.trim()) {\n        // drop event- duplicate charged id\n        logger.error('Duplicate charged Id - Dropped' + chargedObj)\n        return false\n      }\n      _globalChargedId = chargedId\n      StorageManager.saveToLSorCookie(CHARGEDID_COOKIE_NAME, chargedId)\n    }\n    return true\n  } // if object (chargedObject)\n  return false\n}\n","import { isString, isObject, sanitize } from '../util/datatypes'\nimport { EVENT_ERROR } from '../util/messages'\nimport { EV_COOKIE, SYSTEM_EVENTS, unsupportedKeyCharRegex } from '../util/constants'\nimport { isChargedEventStructureValid, isEventStructureFlat } from '../util/validator'\nimport { StorageManager, $ct } from '../util/storage'\n\nexport default class EventHandler extends Array {\n  #logger\n  #oldValues\n  #request\n  #isPersonalisationActive\n\n  constructor ({ logger, request, isPersonalisationActive }, values) {\n    super()\n    this.#logger = logger\n    this.#oldValues = values\n    this.#request = request\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  push (...eventsArr) {\n    this.#processEventArray(eventsArr)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processEventArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  #processEventArray (eventsArr) {\n    if (Array.isArray(eventsArr)) {\n      while (eventsArr.length > 0) {\n        var eventName = eventsArr.shift()\n        if (!isString(eventName)) {\n          this.#logger.error(EVENT_ERROR)\n          continue\n        }\n\n        if (eventName.length > 1024) {\n          eventName = eventName.substring(0, 1024)\n          this.#logger.reportError(510, eventName + '... length exceeded 1024 chars. Trimmed.')\n        }\n\n        if (SYSTEM_EVENTS.includes(eventName)) {\n          this.#logger.reportError(513, eventName + ' is a restricted system event. It cannot be used as an event name.')\n          continue\n        }\n\n        const data = {}\n        data.type = 'event'\n        data.evtName = sanitize(eventName, unsupportedKeyCharRegex)\n\n        if (eventsArr.length !== 0) {\n          const eventObj = eventsArr.shift()\n          if (!isObject(eventObj)) {\n            // put it back if it is not an object\n            eventsArr.unshift(eventObj)\n          } else {\n            // check Charged Event vs. other events.\n            if (eventName === 'Charged') {\n              if (!isChargedEventStructureValid(eventObj, this.#logger)) {\n                this.#logger.reportError(511, 'Charged event structure invalid. Not sent.')\n                continue\n              }\n            } else {\n              if (!isEventStructureFlat(eventObj)) {\n                this.#logger.reportError(512, eventName + ' event structure invalid. Not sent.')\n                continue\n              }\n            }\n            data.evtData = eventObj\n          }\n        }\n\n        this.#request.processEvent(data)\n      }\n    }\n  }\n\n  getDetails (evtName) {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    if (typeof $ct.globalEventsMap === 'undefined') {\n      $ct.globalEventsMap = StorageManager.readFromLSorCookie(EV_COOKIE)\n    }\n    if (typeof $ct.globalEventsMap === 'undefined') {\n      return\n    }\n    const evtObj = $ct.globalEventsMap[evtName]\n    const respObj = {}\n    if (typeof evtObj !== 'undefined') {\n      respObj.firstTime = new Date(evtObj[1] * 1000)\n      respObj.lastTime = new Date(evtObj[2] * 1000)\n      respObj.count = evtObj[0]\n      return respObj\n    }\n  }\n}\n","export const getURLParams = (url) => {\n  const urlParams = {}\n  const idx = url.indexOf('?')\n\n  if (idx > 1) {\n    const uri = url.substring(idx + 1)\n    let match\n    const pl = /\\+/g // Regex for replacing addition symbol with a space\n    const search = /([^&=]+)=?([^&]*)/g\n    const decode = function (s) {\n      let replacement = s.replace(pl, ' ')\n      try {\n        replacement = decodeURIComponent(replacement)\n      } catch (e) {\n        // eat\n      }\n      return replacement\n    }\n    match = search.exec(uri)\n    while (match) {\n      urlParams[decode(match[1])] = decode(match[2])\n      match = search.exec(uri)\n    }\n  }\n  return urlParams\n}\n\nexport const getDomain = (url) => {\n  if (url === '') return ''\n  var a = document.createElement('a')\n  a.href = url\n  return a.hostname\n}\n\nexport const addToURL = (url, k, v) => {\n  return url + '&' + k + '=' + encodeURIComponent(v)\n}\n\nexport const getHostName = () => {\n  return window.location.hostname\n}\n","/* eslint-disable */\nexport const urlBase64ToUint8Array = (base64String) => {\n  let padding = '='.repeat((4 - base64String.length % 4) % 4)\n  let base64 = (base64String + padding)\n      .replace(/\\-/g, '+')\n      .replace(/_/g, '/')\n\n  let rawData = window.atob(base64)\n  let processedData = []\n  for (let i=0; i<rawData.length; i++) {\n    processedData.push(rawData.charCodeAt(i))\n  }\n  return new Uint8Array(processedData)\n}\n\nexport const compressData = (dataObject, logger) => {\n  logger && typeof logger.debug === 'function' && logger.debug('dobj:' + dataObject)\n  return compressToBase64(dataObject)\n}\n\nexport const compress = (uncompressed) => {\n  if (uncompressed == null) return ''\n  let i, value,\n      context_dictionary = {},\n      context_dictionaryToCreate = {},\n      context_c = '',\n      context_wc = '',\n      context_w = '',\n      context_enlargeIn = 2, // Compensate for the first entry which should not count\n      context_dictSize = 3,\n      context_numBits = 2,\n      context_data_string = '',\n      context_data_val = 0,\n      context_data_position = 0,\n      ii,\n      f = String.fromCharCode\n\n  for (ii = 0; ii < uncompressed.length; ii += 1) {\n    context_c = uncompressed.charAt(ii)\n    if (!Object.prototype.hasOwnProperty.call(context_dictionary, context_c)) {\n      context_dictionary[context_c] = context_dictSize++\n      context_dictionaryToCreate[context_c] = true\n    }\n\n    context_wc = context_w + context_c\n    if (Object.prototype.hasOwnProperty.call(context_dictionary, context_wc)) {\n      context_w = context_wc\n    } else {\n      if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate, context_w)) {\n        if (context_w.charCodeAt(0) < 256) {\n          for (i = 0; i < context_numBits; i++) {\n            context_data_val = (context_data_val << 1)\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n          }\n          value = context_w.charCodeAt(0)\n          for (i = 0; i < 8; i++) {\n            context_data_val = (context_data_val << 1) | (value & 1)\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n            value = value >> 1\n          }\n        } else {\n          value = 1\n          for (i = 0; i < context_numBits; i++) {\n            context_data_val = (context_data_val << 1) | value\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n            value = 0\n          }\n          value = context_w.charCodeAt(0)\n          for (i = 0; i < 16; i++) {\n            context_data_val = (context_data_val << 1) | (value & 1)\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n            value = value >> 1\n          }\n        }\n        context_enlargeIn--\n        if (context_enlargeIn == 0) {\n          context_enlargeIn = Math.pow(2, context_numBits)\n          context_numBits++\n        }\n        delete context_dictionaryToCreate[context_w]\n      } else {\n        value = context_dictionary[context_w];\n        for (i = 0; i < context_numBits; i++) {\n          context_data_val = (context_data_val << 1) | (value & 1)\n          if (context_data_position == 15) {\n            context_data_position = 0;\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = value >> 1\n        }\n\n\n      }\n      context_enlargeIn--\n      if (context_enlargeIn == 0) {\n        context_enlargeIn = Math.pow(2, context_numBits)\n        context_numBits++\n      }\n      // Add wc to the dictionary.\n      context_dictionary[context_wc] = context_dictSize++\n      context_w = String(context_c)\n    }\n  }\n\n  // Output the code for w.\n  if (context_w !== '') {\n    if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate, context_w)) {\n      if (context_w.charCodeAt(0) < 256) {\n        for (i = 0; i < context_numBits; i++) {\n          context_data_val = (context_data_val << 1)\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n        }\n        value = context_w.charCodeAt(0)\n        for (i = 0; i < 8; i++) {\n          context_data_val = (context_data_val << 1) | (value & 1)\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = value >> 1\n        }\n      } else {\n        value = 1\n        for (i = 0; i < context_numBits; i++) {\n          context_data_val = (context_data_val << 1) | value\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = 0\n        }\n        value = context_w.charCodeAt(0);\n        for (i = 0; i < 16; i++) {\n          context_data_val = (context_data_val << 1) | (value & 1)\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = value >> 1\n        }\n      }\n      context_enlargeIn--\n      if (context_enlargeIn == 0) {\n        context_enlargeIn = Math.pow(2, context_numBits)\n        context_numBits++\n      }\n      delete context_dictionaryToCreate[context_w]\n    } else {\n      value = context_dictionary[context_w]\n      for (i = 0; i < context_numBits; i++) {\n        context_data_val = (context_data_val << 1) | (value & 1)\n        if (context_data_position == 15) {\n          context_data_position = 0\n          context_data_string += f(context_data_val)\n          context_data_val = 0\n        } else {\n          context_data_position++\n        }\n        value = value >> 1\n      }\n\n\n    }\n    context_enlargeIn--\n    if (context_enlargeIn == 0) {\n      context_enlargeIn = Math.pow(2, context_numBits)\n      context_numBits++\n    }\n  }\n\n  // Mark the end of the stream\n  value = 2\n  for (i = 0; i < context_numBits; i++) {\n    context_data_val = (context_data_val << 1) | (value & 1)\n    if (context_data_position == 15) {\n      context_data_position = 0\n      context_data_string += f(context_data_val)\n      context_data_val = 0\n    } else {\n      context_data_position++\n    }\n    value = value >> 1\n  }\n\n  // Flush the last char\n  while (true) {\n    context_data_val = (context_data_val << 1)\n    if (context_data_position == 15) {\n      context_data_string += f(context_data_val)\n      break\n    } else context_data_position++\n  }\n  return context_data_string\n}\n\nexport const getKeyStr = () => {\n  let key = ''\n  let i = 0\n\n  for (i = 0; i <= 25; i++) {\n    key = key + String.fromCharCode(i + 65)\n  }\n\n  for (i = 0; i <= 25; i++) {\n    key = key + String.fromCharCode(i + 97)\n  }\n\n  for (i = 0; i < 10; i++) {\n    key = key + i\n  }\n\n  return key + '+/='\n}\n\nconst _keyStr = getKeyStr()\n\nexport const convertToFormattedHex = (byte_arr) => {\n  let hex_str = '',\n      i,\n      len,\n      tmp_hex\n\n  if (!Array.isArray(byte_arr)) {\n    return false\n  }\n\n  len = byte_arr.length\n\n  for (i = 0; i < len; ++i) {\n    if (byte_arr[i] < 0) {\n      byte_arr[i] = byte_arr[i] + 256\n    }\n    if (byte_arr[i] === undefined) {\n      byte_arr[i] = 0\n    }\n    tmp_hex = byte_arr[i].toString(16)\n\n    if (tmp_hex.length == 1) tmp_hex = '0' + tmp_hex // Add leading zero.\n\n    //        beautification - needed if you're printing this in the console, else keep commented\n    //        if ((i + 1) % 16 === 0) {\n    //          tmp_hex += \"\\n\";\n    //        } else {\n    //          tmp_hex += \" \";\n    //        }\n\n    hex_str += tmp_hex\n  }\n\n  return hex_str.trim()\n}\n\nexport const convertStringToHex = (s) => {\n  let byte_arr = []\n  for (let i = 0; i < s.length; i++) {\n    let value = s.charCodeAt(i)\n    byte_arr.push(value & 255)\n    byte_arr.push((value >> 8) & 255)\n  }\n  return convertToFormattedHex(byte_arr)\n}\n\nexport const compressToBase64 = (input) => {\n  if (input == null) return ''\n  var output = ''\n  var chr1, chr2, chr3, enc1, enc2, enc3, enc4\n  var i = 0\n\n  input = compress(input)\n\n  while (i < input.length * 2) {\n\n    if (i % 2 == 0) {\n      chr1 = input.charCodeAt(i / 2) >> 8\n      chr2 = input.charCodeAt(i / 2) & 255\n      if (i / 2 + 1 < input.length)\n        chr3 = input.charCodeAt(i / 2 + 1) >> 8\n      else\n        chr3 = NaN\n    } else {\n      chr1 = input.charCodeAt((i - 1) / 2) & 255\n      if ((i + 1) / 2 < input.length) {\n        chr2 = input.charCodeAt((i + 1) / 2) >> 8\n        chr3 = input.charCodeAt((i + 1) / 2) & 255\n      } else\n        chr2 = chr3 = NaN\n    }\n    i += 3\n\n    enc1 = chr1 >> 2;\n    enc2 = ((chr1 & 3) << 4) | (chr2 >> 4)\n    enc3 = ((chr2 & 15) << 2) | (chr3 >> 6)\n    enc4 = chr3 & 63\n\n    if (isNaN(chr2)) {\n      enc3 = enc4 = 64\n    } else if (isNaN(chr3)) {\n      enc4 = 64\n    }\n\n    output = output +\n      _keyStr.charAt(enc1) + _keyStr.charAt(enc2) +\n      _keyStr.charAt(enc3) + _keyStr.charAt(enc4)\n\n  }\n\n  return output\n}\n","\nimport { ARP_COOKIE, MAX_TRIES, OPTOUT_COOKIE_ENDSWITH, USEIP_KEY } from './constants'\nimport { isString, isValueValid } from './datatypes'\nimport { compressData } from './encoder'\nimport { StorageManager, $ct } from './storage'\nimport { addToURL } from './url'\n\nexport default class RequestDispatcher {\n  static logger\n  static device\n\n  // ANCHOR - Requests get fired from here\n  static #fireRequest (url, tries, skipARP, sendOULFlag) {\n    if (this.#dropRequestDueToOptOut()) {\n      this.logger.debug('req dropped due to optout cookie: ' + this.device.gcookie)\n      return\n    }\n\n    // set a request in progress\n    // so that if gcookie is not present, no other request can be made asynchronusly\n    if (!isValueValid(this.device.gcookie)) {\n      $ct.blockRequest = true\n    }\n    /**\n     * if the gcookie is null\n     * and the request is not the first request\n     * and the tries are less than max tries\n     * keep retrying\n     */\n    if (!isValueValid(this.device.gcookie) &&\n      ($ct.globalCache.RESP_N < $ct.globalCache.REQ_N - 1) &&\n      tries < MAX_TRIES) {\n      // if ongoing First Request is in progress, initiate retry\n      setTimeout(() => {\n        this.logger.debug(`retrying fire request for url: ${url}, tries: ${tries}`)\n        this.#fireRequest(url, tries + 1, skipARP, sendOULFlag)\n      }, 50)\n      return\n    }\n\n    // set isOULInProgress to true\n    // when sendOULFlag is set to true\n    if (!sendOULFlag) {\n      if (isValueValid(this.device.gcookie)) {\n        // add gcookie to url\n        url = addToURL(url, 'gc', this.device.gcookie)\n      }\n      url = this.#addARPToRequest(url, skipARP)\n    } else {\n      window.isOULInProgress = true\n    }\n\n    url = addToURL(url, 'tries', tries) // Add tries to URL\n\n    url = this.#addUseIPToRequest(url)\n    url = addToURL(url, 'r', new Date().getTime()) // add epoch to beat caching of the URL\n    // TODO: Figure out a better way to handle plugin check\n    if (window.clevertap?.hasOwnProperty('plugin') || window.wizrocket?.hasOwnProperty('plugin')) {\n      // used to add plugin name in request parameter\n      const plugin = window.clevertap.plugin || window.wizrocket.plugin\n      url = addToURL(url, 'ct_pl', plugin)\n    }\n    if (url.indexOf('chrome-extension:') !== -1) {\n      url = url.replace('chrome-extension:', 'https:')\n    }\n    // TODO: Try using Function constructor instead of appending script.\n    var ctCbScripts = document.getElementsByClassName('ct-jp-cb')\n    while (ctCbScripts[0] && ctCbScripts[0].parentNode) {\n      ctCbScripts[0].parentNode.removeChild(ctCbScripts[0])\n    }\n    const s = document.createElement('script')\n    s.setAttribute('type', 'text/javascript')\n    s.setAttribute('src', url)\n    s.setAttribute('class', 'ct-jp-cb')\n    s.setAttribute('rel', 'nofollow')\n    s.async = true\n    document.getElementsByTagName('head')[0].appendChild(s)\n    this.logger.debug('req snt -> url: ' + url)\n  }\n\n  /**\n   *\n   * @param {string} url\n   * @param {*} skipARP\n   * @param {boolean} sendOULFlag\n   */\n  static fireRequest (url, skipARP, sendOULFlag) {\n    this.#fireRequest(url, 1, skipARP, sendOULFlag)\n  }\n\n  static #dropRequestDueToOptOut () {\n    if ($ct.isOptInRequest || !isValueValid(this.device.gcookie) || !isString(this.device.gcookie)) {\n      $ct.isOptInRequest = false\n      return false\n    }\n    return this.device.gcookie.slice(-3) === OPTOUT_COOKIE_ENDSWITH\n  }\n\n  static #addUseIPToRequest (pageLoadUrl) {\n    var useIP = StorageManager.getMetaProp(USEIP_KEY)\n    if (typeof useIP !== 'boolean') {\n      useIP = false\n    }\n    return addToURL(pageLoadUrl, USEIP_KEY, useIP ? 'true' : 'false')\n  };\n\n  static #addARPToRequest (url, skipResARP) {\n    if (skipResARP === true) {\n      const _arp = {}\n      _arp.skipResARP = true\n      return addToURL(url, 'arp', compressData(JSON.stringify(_arp), this.logger))\n    }\n    if (StorageManager._isLocalStorageSupported() && typeof localStorage.getItem(ARP_COOKIE) !== 'undefined' && localStorage.getItem(ARP_COOKIE) !== null) {\n      return addToURL(url, 'arp', compressData(JSON.stringify(StorageManager.readFromLSorCookie(ARP_COOKIE)), this.logger))\n    }\n    return url\n  }\n}\n","// CleverTap specific utilities\n\nimport {\n  StorageManager,\n  $ct\n} from './storage'\nimport {\n  CAMP_COOKIE_NAME,\n  singleQuoteRegex,\n  PR_COOKIE,\n  ARP_COOKIE,\n  GCOOKIE_NAME,\n  IS_OUL,\n  categoryLongKey,\n  CAMP_COOKIE_G\n} from './constants'\nimport {\n  GENDER_ERROR,\n  EMPLOYED_ERROR,\n  MARRIED_ERROR,\n  EDUCATION_ERROR,\n  AGE_ERROR,\n  DOB_ERROR,\n  PHONE_FORMAT_ERROR,\n  ENUM_FORMAT_ERROR\n} from './messages'\nimport {\n  getToday,\n  convertToWZRKDate,\n  setDate,\n  getNow\n} from './datetime'\nimport {\n  isObject,\n  isDateObject,\n  isConvertibleToNumber,\n  isObjectEmpty,\n  isString,\n  isNumber,\n  isValueValid\n} from './datatypes'\n\nimport { addToURL, getURLParams } from './url'\nimport { compressData } from './encoder'\nimport RequestDispatcher from './requestDispatcher'\n\nexport const getCampaignObject = () => {\n  let finalcampObj = {}\n  if (StorageManager._isLocalStorageSupported()) {\n    let campObj = StorageManager.read(CAMP_COOKIE_NAME)\n    if (campObj != null) {\n      campObj = JSON.parse(decodeURIComponent(campObj).replace(singleQuoteRegex, '\\\"'))\n      if (campObj.hasOwnProperty('global')) {\n        finalcampObj.wp = campObj\n      } else {\n        finalcampObj = campObj\n      }\n    } else {\n      finalcampObj = {}\n    }\n  }\n  return finalcampObj\n}\n\nexport const saveCampaignObject = (campaignObj) => {\n  if (StorageManager._isLocalStorageSupported()) {\n    const newObj = { ...getCampaignObject(), ...campaignObj }\n    const campObj = JSON.stringify(newObj)\n    StorageManager.save(CAMP_COOKIE_NAME, encodeURIComponent(campObj))\n    // Update the CAMP_COOKIE_G to be in sync with CAMP_COOKIE_NAME\n    setCampaignObjectForGuid()\n  }\n}\n\n// set Campaign Object against the guid, with daily count and total count details\nexport const setCampaignObjectForGuid = () => {\n  if (StorageManager._isLocalStorageSupported()) {\n    let guid = StorageManager.read(GCOOKIE_NAME)\n    if (isValueValid(guid)) {\n      try {\n        guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n        const guidCampObj = StorageManager.read(CAMP_COOKIE_G) ? JSON.parse(decodeURIComponent(StorageManager.read(CAMP_COOKIE_G))) : {}\n        if (guid && StorageManager._isLocalStorageSupported()) {\n          var finalCampObj = {}\n          var campObj = getCampaignObject()\n          Object.keys(campObj).forEach(key => {\n            const campKeyObj = (guid in guidCampObj && Object.keys(guidCampObj[guid]).length && guidCampObj[guid][key]) ? guidCampObj[guid][key] : {}\n            const globalObj = campObj[key].global\n            const today = getToday()\n            const dailyObj = campObj[key][today]\n            if (typeof globalObj !== 'undefined') {\n              const campaignIdArray = Object.keys(globalObj)\n              for (const index in campaignIdArray) {\n                let resultObj = []\n                if (campaignIdArray.hasOwnProperty(index)) {\n                  let dailyC = 0\n                  let totalC = 0\n                  const campaignId = campaignIdArray[index]\n                  if (campaignId === 'tc') {\n                    continue\n                  }\n                  if (typeof dailyObj !== 'undefined' && typeof dailyObj[campaignId] !== 'undefined') {\n                    dailyC = dailyObj[campaignId]\n                  }\n                  if (typeof globalObj !== 'undefined' && typeof globalObj[campaignId] !== 'undefined') {\n                    totalC = globalObj[campaignId]\n                  }\n                  resultObj = [campaignId, dailyC, totalC]\n                  campKeyObj[campaignId] = resultObj\n                }\n              }\n            }\n            finalCampObj = { ...finalCampObj, [key]: campKeyObj }\n          })\n          guidCampObj[guid] = finalCampObj\n          StorageManager.save(CAMP_COOKIE_G, encodeURIComponent(JSON.stringify(guidCampObj)))\n        }\n      } catch (e) {\n        console.error('Invalid clevertap Id ' + e)\n      }\n    }\n  }\n}\nexport const getCampaignObjForLc = () => {\n  // before preparing data to send to LC , check if the entry for the guid is already there in CAMP_COOKIE_G\n  const guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n\n  let campObj = {}\n  if (StorageManager._isLocalStorageSupported()) {\n    let resultObj = {}\n    campObj = getCampaignObject()\n    const storageValue = StorageManager.read(CAMP_COOKIE_G)\n    const decodedValue = storageValue ? decodeURIComponent(storageValue) : null\n    const parsedValue = decodedValue ? JSON.parse(decodedValue) : null\n\n    const resultObjWP = (!!guid &&\n                        storageValue !== undefined && storageValue !== null &&\n                        parsedValue && parsedValue[guid] && parsedValue[guid].wp)\n      ? Object.values(parsedValue[guid].wp)\n      : []\n\n    const resultObjWI = (!!guid &&\n                        storageValue !== undefined && storageValue !== null &&\n                        parsedValue && parsedValue[guid] && parsedValue[guid].wi)\n      ? Object.values(parsedValue[guid].wi)\n      : []\n\n    const today = getToday()\n    let todayCwp = 0\n    let todayCwi = 0\n    if (campObj.wp && campObj.wp[today] && campObj.wp[today].tc !== 'undefined') {\n      todayCwp = campObj.wp[today].tc\n    }\n    if (campObj.wi && campObj.wi[today] && campObj.wi[today].tc !== 'undefined') {\n      todayCwi = campObj.wi[today].tc\n    }\n    resultObj = {\n      wmp: todayCwp,\n      wimp: todayCwi,\n      tlc: resultObjWP,\n      witlc: resultObjWI\n    }\n    return resultObj\n  }\n}\n\nexport const isProfileValid = (profileObj, { logger }) => {\n  let valid = false\n  if (isObject(profileObj)) {\n    for (const profileKey in profileObj) {\n      if (profileObj.hasOwnProperty(profileKey)) {\n        valid = true\n        let profileVal = profileObj[profileKey]\n\n        if (profileVal == null) {\n          delete profileObj[profileKey]\n          continue\n        }\n        if (profileKey === 'Gender' && !profileVal.match(/^M$|^F$/)) {\n          valid = false\n          logger.error(GENDER_ERROR)\n        }\n\n        if (profileKey === 'Employed' && !profileVal.match(/^Y$|^N$/)) {\n          valid = false\n          logger.error(EMPLOYED_ERROR)\n        }\n\n        if (profileKey === 'Married' && !profileVal.match(/^Y$|^N$/)) {\n          valid = false\n          logger.error(MARRIED_ERROR)\n        }\n\n        if (profileKey === 'Education' && !profileVal.match(/^School$|^College$|^Graduate$/)) {\n          valid = false\n          logger.error(EDUCATION_ERROR)\n        }\n\n        if (profileKey === 'Age' && profileVal != null) {\n          if (isConvertibleToNumber(profileVal)) {\n            profileObj.Age = +profileVal\n          } else {\n            valid = false\n            logger.error(AGE_ERROR)\n          }\n        }\n        // dob will come in like this - $dt_19470815 or dateObject\n        if (profileKey === 'DOB') {\n          if (((!(/^\\$D_/).test(profileVal) || (profileVal + '').length !== 11)) && !isDateObject(profileVal)) {\n            valid = false\n            logger.error(DOB_ERROR)\n          }\n\n          if (isDateObject(profileVal)) {\n            profileObj[profileKey] = convertToWZRKDate(profileVal)\n          }\n        } else if (isDateObject(profileVal)) {\n          profileObj[profileKey] = convertToWZRKDate(profileVal)\n        }\n\n        if (profileKey === 'Phone' && !isObjectEmpty(profileVal)) {\n          if (profileVal.length > 8 && (profileVal.charAt(0) === '+')) { // valid phone number\n            profileVal = profileVal.substring(1, profileVal.length)\n            if (isConvertibleToNumber(profileVal)) {\n              profileObj.Phone = +profileVal\n            } else {\n              valid = false\n              logger.error(PHONE_FORMAT_ERROR + '. Removed.')\n            }\n          } else {\n            valid = false\n            logger.error(PHONE_FORMAT_ERROR + '. Removed.')\n          }\n        }\n\n        if (!valid) {\n          delete profileObj[profileKey]\n        }\n      }\n    }\n  }\n  return valid\n}\n\nexport const processFBUserObj = (user) => {\n  const profileData = {}\n  profileData.Name = user.name\n  if (user.id != null) {\n    profileData.FBID = user.id + ''\n  }\n  // Feb 2014 - FB announced over 58 gender options, hence we specifically look for male or female. Rest we don't care.\n  if (user.gender === 'male') {\n    profileData.Gender = 'M'\n  } else if (user.gender === 'female') {\n    profileData.Gender = 'F'\n  } else {\n    profileData.Gender = 'O'\n  }\n\n  const getHighestEducation = function (eduArr) {\n    if (eduArr != null) {\n      let college = ''\n      let highschool = ''\n\n      for (let i = 0; i < eduArr.length; i++) {\n        const edu = eduArr[i]\n        if (edu.type != null) {\n          const type = edu.type\n          if (type === 'Graduate School') {\n            return 'Graduate'\n          } else if (type === 'College') {\n            college = '1'\n          } else if (type === 'High School') {\n            highschool = '1'\n          }\n        }\n      }\n\n      if (college === '1') {\n        return 'College'\n      } else if (highschool === '1') {\n        return 'School'\n      }\n    }\n  }\n\n  if (user.relationship_status != null) {\n    profileData.Married = 'N'\n    if (user.relationship_status === 'Married') {\n      profileData.Married = 'Y'\n    }\n  }\n\n  const edu = getHighestEducation(user.education)\n  if (edu != null) {\n    profileData.Education = edu\n  }\n\n  const work = (user.work != null) ? user.work.length : 0\n  if (work > 0) {\n    profileData.Employed = 'Y'\n  } else {\n    profileData.Employed = 'N'\n  }\n\n  if (user.email != null) {\n    profileData.Email = user.email\n  }\n\n  if (user.birthday != null) {\n    const mmddyy = user.birthday.split('/') // comes in as \"08/15/1947\"\n    profileData.DOB = setDate(mmddyy[2] + mmddyy[0] + mmddyy[1])\n  }\n  return profileData\n}\n\nexport const processGPlusUserObj = (user, { logger }) => {\n  const profileData = {}\n  if (user.displayName != null) {\n    profileData.Name = user.displayName\n  }\n  if (user.id != null) {\n    profileData.GPID = user.id + ''\n  }\n\n  if (user.gender != null) {\n    if (user.gender === 'male') {\n      profileData.Gender = 'M'\n    } else if (user.gender === 'female') {\n      profileData.Gender = 'F'\n    } else if (user.gender === 'other') {\n      profileData.Gender = 'O'\n    }\n  }\n\n  if (user.image != null) {\n    if (user.image.isDefault === false) {\n      profileData.Photo = user.image.url.split('?sz')[0]\n    }\n  }\n\n  if (user.emails != null) {\n    for (let emailIdx = 0; emailIdx < user.emails.length; emailIdx++) {\n      const emailObj = user.emails[emailIdx]\n      if (emailObj.type === 'account') {\n        profileData.Email = emailObj.value\n      }\n    }\n  }\n\n  if (user.organizations != null) {\n    profileData.Employed = 'N'\n    for (let i = 0; i < user.organizations.length; i++) {\n      const orgObj = user.organizations[i]\n      if (orgObj.type === 'work') {\n        profileData.Employed = 'Y'\n      }\n    }\n  }\n\n  if (user.birthday != null) {\n    const yyyymmdd = user.birthday.split('-') // comes in as \"1976-07-27\"\n    profileData.DOB = setDate(yyyymmdd[0] + yyyymmdd[1] + yyyymmdd[2])\n  }\n\n  if (user.relationshipStatus != null) {\n    profileData.Married = 'N'\n    if (user.relationshipStatus === 'married') {\n      profileData.Married = 'Y'\n    }\n  }\n  logger.debug('gplus usr profile ' + JSON.stringify(profileData))\n\n  return profileData\n}\n\nexport const addToLocalProfileMap = (profileObj, override) => {\n  if (StorageManager._isLocalStorageSupported()) {\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n      if ($ct.globalProfileMap == null) {\n        $ct.globalProfileMap = {}\n      }\n    }\n\n    // Move props from custom bucket to outside.\n    if (profileObj._custom != null) {\n      const keys = profileObj._custom\n      for (const key in keys) {\n        if (keys.hasOwnProperty(key)) {\n          profileObj[key] = keys[key]\n        }\n      }\n      delete profileObj._custom\n    }\n\n    for (const prop in profileObj) {\n      if (profileObj.hasOwnProperty(prop)) {\n        if ($ct.globalProfileMap.hasOwnProperty(prop) && !override) {\n          continue\n        }\n        $ct.globalProfileMap[prop] = profileObj[prop]\n      }\n    }\n    if ($ct.globalProfileMap._custom != null) {\n      delete $ct.globalProfileMap._custom\n    }\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n  }\n}\n\nexport const closeIframe = (campaignId, divIdIgnored, currentSessionId) => {\n  if (campaignId != null && campaignId !== '-1') {\n    if (StorageManager._isLocalStorageSupported()) {\n      const campaignObj = getCampaignObject()\n\n      let sessionCampaignObj = campaignObj.wp[currentSessionId]\n      if (sessionCampaignObj == null) {\n        sessionCampaignObj = {}\n        campaignObj[currentSessionId] = sessionCampaignObj\n      }\n      sessionCampaignObj[campaignId] = 'dnd'\n      saveCampaignObject(campaignObj)\n    }\n  }\n  if ($ct.campaignDivMap != null) {\n    const divId = $ct.campaignDivMap[campaignId]\n    if (divId != null) {\n      document.getElementById(divId).style.display = 'none'\n      if (divId === 'intentPreview') {\n        if (document.getElementById('intentOpacityDiv') != null) {\n          document.getElementById('intentOpacityDiv').style.display = 'none'\n        }\n      }\n    }\n  }\n}\n\nexport const arp = (jsonMap) => {\n  // For unregister calls dont set arp in LS\n  if (jsonMap.skipResARP != null && jsonMap.skipResARP) {\n    console.debug('Update ARP Request rejected', jsonMap)\n    return null\n  }\n\n  const isOULARP = jsonMap[IS_OUL] === true\n\n  if (StorageManager._isLocalStorageSupported()) {\n    // Update arp only if it is null or an oul request\n    try {\n      let arpFromStorage = StorageManager.readFromLSorCookie(ARP_COOKIE)\n      if (arpFromStorage == null || isOULARP) {\n        arpFromStorage = {}\n        for (const key in jsonMap) {\n          if (jsonMap.hasOwnProperty(key)) {\n            if (jsonMap[key] === -1) {\n              delete arpFromStorage[key]\n            } else {\n              arpFromStorage[key] = jsonMap[key]\n            }\n          }\n        }\n        StorageManager.saveToLSorCookie(ARP_COOKIE, arpFromStorage)\n      }\n    } catch (e) {\n      console.error('Unable to parse ARP JSON: ' + e)\n    }\n  }\n}\n\nexport const getWrappedLink = (link, targetId, type, request, account, logger) => {\n  let data = {}\n  data.sendTo = link\n  data.targetId = targetId\n  data.epoch = getNow()\n\n  if (type != null) {\n    data.type = type\n  } else {\n    data.type = 'view'\n  }\n\n  data = request.addSystemDataToObject(data, undefined)\n  return addToURL(account.recorderURL, 'd', compressData(JSON.stringify(data), logger))\n}\n\nexport const getMessageTemplate = () => {\n  return `<div class=\"notice-message\">\n    <a href=\"[RECORDER_HREF]\" class=\"box\">\n      <div class=\"avatar\"><span class=\"fa [ICON] fa-4x fa-fw\"></span></div>\n      <div class=\"info\">\n        <div class=\"title\">[TITLE]</div>\n        <div class=\"clearfix\"></div>\n        <div class=\"text\">[TEXT]</div>\n      </div>\n      <div class=\"clearfix\"></div>\n    </a>\n  </div>\n  <div class=\"clearfix\"></div>`\n}\n\nexport const getMessageHeadTemplate = () => {\n  return `<head>\n    <base target=\"_parent\" />\n    <link rel=\"stylesheet\" href=\"http://static.clevertap.com/fa/font-awesome.css\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <style>\n    [STYLE]\n    </style>\n  </head>`\n}\n\nexport const setEnum = (enumVal, logger) => {\n  if (isString(enumVal) || isNumber(enumVal)) {\n    return '$E_' + enumVal\n  }\n  logger.error(ENUM_FORMAT_ERROR)\n}\nexport const handleEmailSubscription = (subscription, reEncoded, fetchGroups, account, logger) => {\n  const urlParamsAsIs = getURLParams(location.href) // can't use url_params as it is in lowercase above\n  const encodedEmailId = urlParamsAsIs.e\n  const encodedProfileProps = urlParamsAsIs.p\n\n  if (typeof encodedEmailId !== 'undefined') {\n    const data = {}\n    data.id = account.id // accountId\n    data.unsubGroups = $ct.unsubGroups // unsubscribe groups\n\n    if ($ct.updatedCategoryLong) {\n      data[categoryLongKey] = $ct.updatedCategoryLong\n    }\n\n    let url = account.emailURL\n    if (fetchGroups) {\n      url = addToURL(url, 'fetchGroups', fetchGroups)\n    }\n    if (reEncoded) {\n      url = addToURL(url, 'encoded', reEncoded)\n    }\n    url = addToURL(url, 'e', encodedEmailId)\n    url = addToURL(url, 'd', compressData(JSON.stringify(data), logger))\n    if (encodedProfileProps) {\n      url = addToURL(url, 'p', encodedProfileProps)\n    }\n\n    if (subscription !== '-1') {\n      url = addToURL(url, 'sub', subscription)\n    }\n    RequestDispatcher.fireRequest(url)\n  }\n}\n","import {\n  isObjectEmpty\n} from '../util/datatypes'\nimport {\n  isProfileValid,\n  processFBUserObj,\n  processGPlusUserObj,\n  addToLocalProfileMap\n} from '../util/clevertap'\nimport {\n  COMMAND_DELETE,\n  COMMAND_INCREMENT,\n  EVT_PUSH,\n  PR_COOKIE\n} from '../util/constants'\nimport {\n  addToURL\n} from '../util/url'\nimport {\n  StorageManager,\n  $ct\n} from '../util/storage'\nimport { compressData } from '../util/encoder'\nexport default class ProfileHandler extends Array {\n  #logger\n  #request\n  #account\n  #oldValues\n  #isPersonalisationActive\n\n  constructor ({\n    logger,\n    request,\n    account,\n    isPersonalisationActive\n  }, values) {\n    super()\n    this.#logger = logger\n    this.#request = request\n    this.#account = account\n    this.#oldValues = values\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  push (...profilesArr) {\n    this.#processProfileArray(profilesArr)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processProfileArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  getAttribute (propName) {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n    }\n    if ($ct.globalProfileMap != null) {\n      return $ct.globalProfileMap[propName]\n    }\n  }\n\n  #processProfileArray (profileArr) {\n    if (Array.isArray(profileArr) && profileArr.length > 0) {\n      for (const index in profileArr) {\n        if (profileArr.hasOwnProperty(index)) {\n          const outerObj = profileArr[index]\n          let data = {}\n          let profileObj\n          if (outerObj.Site != null) { // organic data from the site\n            profileObj = outerObj.Site\n            if (isObjectEmpty(profileObj) || !isProfileValid(profileObj, {\n              logger: this.#logger\n            })) {\n              return\n            }\n          } else if (outerObj.Facebook != null) { // fb connect data\n            const FbProfileObj = outerObj.Facebook\n            // make sure that the object contains any data at all\n\n            if (!isObjectEmpty(FbProfileObj) && (!FbProfileObj.error)) {\n              profileObj = processFBUserObj(FbProfileObj)\n            }\n          } else if (outerObj['Google Plus'] != null) {\n            const GPlusProfileObj = outerObj['Google Plus']\n            if (!isObjectEmpty(GPlusProfileObj) && (!GPlusProfileObj.error)) {\n              profileObj = processGPlusUserObj(GPlusProfileObj, { logger: this.#logger })\n            }\n          }\n          if (profileObj != null && (!isObjectEmpty(profileObj))) { // profile got set from above\n            data.type = 'profile'\n            if (profileObj.tz == null) {\n              // try to auto capture user timezone if not present\n              profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n            }\n\n            data.profile = profileObj\n            addToLocalProfileMap(profileObj, true)\n            data = this.#request.addSystemDataToObject(data, undefined)\n\n            this.#request.addFlags(data)\n\n            let pageLoadUrl = this.#account.dataPostURL\n            pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n            pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n\n            this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   *\n   * @param {any} key\n   * @param {number} value\n   * @param {string} command\n   * increases or decreases value of the number type properties in profile object\n   */\n  _handleIncrementDecrementValue (key, value, command) {\n    // Check if the value is greater than 0\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n    }\n    if ($ct.globalProfileMap == null && !$ct.globalProfileMap?.hasOwnProperty(key)) {\n      // Check if the profile map already has the propery defined\n      console.error('Kindly create profile with required proprty to increment/decrement.')\n    } else if (!value || typeof value !== 'number' || value <= 0) {\n      console.error('Value should be a number greater than 0')\n    } else {\n      // Update the profile property in local storage\n      if (command === COMMAND_INCREMENT) {\n        $ct.globalProfileMap[key] = $ct.globalProfileMap[key] + value\n      } else {\n        $ct.globalProfileMap[key] = $ct.globalProfileMap[key] - value\n      }\n      StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n\n      // Send the updated value to LC\n      let data = {}\n      const profileObj = {}\n      data.type = 'profile'\n      profileObj[key] = { [command]: value }\n      if (profileObj.tz == null) {\n        // try to auto capture user timezone if not present\n        profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n      }\n      data.profile = profileObj\n      data = this.#request.addSystemDataToProfileObject(data, undefined)\n\n      this.#request.addFlags(data)\n      let pageLoadUrl = this.#account.dataPostURL\n      pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n      pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n\n      this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n    }\n  }\n\n  /**\n   *\n   * @param {any} key\n   * @param {array} arrayVal\n   * @param {string} command\n   * overwrites/sets new value(s) against a key/property in profile object\n   */\n  _handleMultiValueSet (key, arrayVal, command) {\n    const array = []\n    for (let i = 0; i < arrayVal.length; i++) {\n      if (typeof arrayVal[i] === 'number' && !array.includes(arrayVal[i])) {\n        array.push(arrayVal[i])\n      } else if (typeof arrayVal[i] === 'string' && !array.includes(arrayVal[i].toLowerCase())) {\n        array.push(arrayVal[i].toLowerCase())\n      } else {\n        console.error('array supports only string or number type values')\n      }\n    }\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE) ?? {}\n    }\n    $ct.globalProfileMap[key] = array\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n    this.sendMultiValueData(key, arrayVal, command)\n  }\n\n  /**\n   *\n   * @param {any} propKey - the property name to be added in the profile object\n   * @param {string, number, array} propVal - the property value to be added against the @propkey key\n   * @param {string} command\n   * Adds array or single value against a key/property in profile object\n   */\n  _handleMultiValueAdd (propKey, propVal, command) {\n    var array = []\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE) ?? {}\n    }\n    // if the value to be set is either string or number\n    if (typeof propVal === 'string' || typeof propVal === 'number') {\n      if ($ct.globalProfileMap.hasOwnProperty(propKey)) {\n        array = $ct.globalProfileMap[propKey]\n        typeof propVal === 'number' ? array.push(propVal) : array.push(propVal.toLowerCase())\n      } else {\n        $ct.globalProfileMap[propKey] = propVal\n      }\n      // if propVal is an array\n    } else {\n      if ($ct.globalProfileMap.hasOwnProperty(propKey)) {\n        array = $ct.globalProfileMap[propKey]\n      }\n      /**\n       * checks for case sensitive inputs and filters the same ones\n       */\n      for (var i = 0; i < propVal.length; i++) {\n        if (typeof propVal[i] === 'number' && !array.includes(propVal[i])) {\n          array.push(propVal[i])\n        } else if (typeof propVal[i] === 'string' && !array.includes(propVal[i].toLowerCase())) {\n          array.push(propVal[i].toLowerCase())\n        } else if ((typeof propVal[i] === 'number' && array.includes(propVal[i])) || (typeof propVal[i] === 'string' && array.includes(propVal[i].toLowerCase()))) {\n          console.error('Values already included')\n        } else {\n          console.error('array supports only string or number type values')\n        }\n      }\n      $ct.globalProfileMap[propKey] = array\n    }\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n    this.sendMultiValueData(propKey, propVal, command)\n  }\n\n  /**\n   *\n   * @param {any} propKey\n   * @param {string, number, array} propVal\n   * @param {string} command\n   * removes value(s) against a key/property in profile object\n   */\n  _handleMultiValueRemove (propKey, propVal, command) {\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n    }\n    if (!$ct?.globalProfileMap?.hasOwnProperty(propKey)) {\n      console.error(`The property ${propKey} does not exist.`)\n    } else {\n      if (typeof propVal === 'string' || typeof propVal === 'number') {\n        var index = $ct.globalProfileMap[propKey].indexOf(propVal)\n        if (index !== -1) {\n          $ct.globalProfileMap[propKey].splice(index, 1)\n        }\n      } else {\n        for (var k = 0; k < propVal.length; k++) {\n          var idx = $ct.globalProfileMap[propKey].indexOf(propVal[k])\n          if (idx !== -1) {\n            $ct.globalProfileMap[propKey].splice(idx, 1)\n          }\n        }\n      }\n    }\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n    this.sendMultiValueData(propKey, propVal, command)\n  }\n\n  /**\n   *\n   * @param {any} propKey\n   * @param {string} command\n   * deletes a key value pair from the profile object\n   */\n  _handleMultiValueDelete (propKey, command) {\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n    }\n    if (!$ct?.globalProfileMap?.hasOwnProperty(propKey)) {\n      console.error(`The property ${propKey} does not exist.`)\n    } else {\n      delete $ct.globalProfileMap[propKey]\n    }\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n    this.sendMultiValueData(propKey, null, command)\n  }\n\n  sendMultiValueData (propKey, propVal, command) {\n    // Send the updated value to LC\n    let data = {}\n    const profileObj = {}\n    data.type = 'profile'\n\n    // this removes the property at backend\n    profileObj[propKey] = { [command]: command === COMMAND_DELETE ? true : propVal }\n    if (profileObj.tz == null) {\n      profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n    }\n    data.profile = profileObj\n    data = this.#request.addSystemDataToProfileObject(data, undefined)\n    this.#request.addFlags(data)\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n\n    this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n  }\n}\n","import {\n  isObject,\n  isObjectEmpty\n} from '../util/datatypes'\nimport {\n  KCOOKIE_NAME,\n  GCOOKIE_NAME,\n  EVT_PUSH,\n  LRU_CACHE_SIZE,\n  IS_OUL,\n  CAMP_COOKIE_NAME,\n  CHARGEDID_COOKIE_NAME,\n  PR_COOKIE,\n  EV_COOKIE,\n  ARP_COOKIE,\n  CLEAR,\n  META_COOKIE,\n  FIRE_PUSH_UNREGISTERED\n} from '../util/constants'\nimport {\n  StorageManager,\n  $ct\n} from '../util/storage'\nimport LRUCache from '../util/lruCache'\nimport {\n  compressData\n} from '../util/encoder'\nimport {\n  addToURL,\n  getHostName\n} from '../util/url'\nimport {\n  isProfileValid,\n  processFBUserObj,\n  processGPlusUserObj,\n  addToLocalProfileMap\n} from '../util/clevertap'\n\nexport default class UserLoginHandler extends Array {\n  #request\n  #logger\n  #account\n  #session\n  #oldValues\n  #device\n\n  constructor ({\n    request,\n    account,\n    session,\n    logger,\n    device\n  },\n  values) {\n    super()\n    this.#request = request\n    this.#account = account\n    this.#session = session\n    this.#logger = logger\n    this.#oldValues = values\n    this.#device = device\n  }\n\n  // On User Login\n  #processOUL (profileArr) {\n    let sendOULFlag = true\n    StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, sendOULFlag)\n    const addToK = (ids) => {\n      let k = StorageManager.readFromLSorCookie(KCOOKIE_NAME)\n      const g = StorageManager.readFromLSorCookie(GCOOKIE_NAME)\n      let kId\n      if (k == null) {\n        k = {}\n        kId = ids\n      } else {\n        /* check if already exists */\n        kId = k.id\n        let anonymousUser = false\n        let foundInCache = false\n        if (kId == null) {\n          kId = ids[0]\n          anonymousUser = true\n        }\n        if ($ct.LRU_CACHE == null && StorageManager._isLocalStorageSupported()) {\n          $ct.LRU_CACHE = new LRUCache(LRU_CACHE_SIZE)\n        }\n\n        if (anonymousUser) {\n          if ((g) != null) {\n            // if have gcookie\n            $ct.LRU_CACHE.set(kId, g)\n            $ct.blockRequest = false\n          }\n        } else {\n          // check if the id is present in the cache\n          // set foundInCache to true\n          for (const idx in ids) {\n            if (ids.hasOwnProperty(idx)) {\n              const id = ids[idx]\n              if ($ct.LRU_CACHE.cache[id]) {\n                kId = id\n                foundInCache = true\n                break\n              }\n            }\n          }\n        }\n\n        if (foundInCache) {\n          if (kId !== $ct.LRU_CACHE.getLastKey()) {\n            // New User found\n            // remove the entire cache\n            this.#handleCookieFromCache()\n          } else {\n            sendOULFlag = false\n            StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, sendOULFlag)\n          }\n          const gFromCache = $ct.LRU_CACHE.get(kId)\n          $ct.LRU_CACHE.set(kId, gFromCache)\n          StorageManager.saveToLSorCookie(GCOOKIE_NAME, gFromCache)\n          this.#device.gcookie = gFromCache\n\n          const lastK = $ct.LRU_CACHE.getSecondLastKey()\n          if (StorageManager.readFromLSorCookie(FIRE_PUSH_UNREGISTERED) && lastK !== -1) {\n            // CACHED OLD USER FOUND. TRANSFER PUSH TOKEN TO THIS USER\n            const lastGUID = $ct.LRU_CACHE.cache[lastK]\n            this.#request.unregisterTokenForGuid(lastGUID)\n          }\n        } else {\n          if (!anonymousUser) {\n            this.clear()\n          } else {\n            if ((g) != null) {\n              this.#device.gcookie = g\n              StorageManager.saveToLSorCookie(GCOOKIE_NAME, g)\n              sendOULFlag = false\n            }\n          }\n          StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, false)\n          kId = ids[0]\n        }\n      }\n      k.id = kId\n      StorageManager.saveToLSorCookie(KCOOKIE_NAME, k)\n    }\n\n    if (Array.isArray(profileArr) && profileArr.length > 0) {\n      for (const index in profileArr) {\n        if (profileArr.hasOwnProperty(index)) {\n          const outerObj = profileArr[index]\n          let data = {}\n          let profileObj\n          if (outerObj.Site != null) { // organic data from the site\n            profileObj = outerObj.Site\n            if (isObjectEmpty(profileObj) || !isProfileValid(profileObj, {\n              logger: this.#logger\n            })) {\n              return\n            }\n          } else if (outerObj.Facebook != null) { // fb connect data\n            const FbProfileObj = outerObj.Facebook\n            // make sure that the object contains any data at all\n\n            if (!isObjectEmpty(FbProfileObj) && (!FbProfileObj.error)) {\n              profileObj = processFBUserObj(FbProfileObj)\n            }\n          } else if (outerObj['Google Plus'] != null) {\n            const GPlusProfileObj = outerObj['Google Plus']\n            if (isObjectEmpty(GPlusProfileObj) && (!GPlusProfileObj.error)) {\n              profileObj = processGPlusUserObj(GPlusProfileObj, { logger: this.#logger })\n            }\n          }\n          if (profileObj != null && (!isObjectEmpty(profileObj))) { // profile got set from above\n            data.type = 'profile'\n            if (profileObj.tz == null) {\n              // try to auto capture user timezone if not present\n              profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n            }\n\n            data.profile = profileObj\n            const ids = []\n            if (StorageManager._isLocalStorageSupported()) {\n              if (profileObj.Identity) {\n                ids.push(profileObj.Identity)\n              }\n              if (profileObj.Email) {\n                ids.push(profileObj.Email)\n              }\n              if (profileObj.GPID) {\n                ids.push('GP:' + profileObj.GPID)\n              }\n              if (profileObj.FBID) {\n                ids.push('FB:' + profileObj.FBID)\n              }\n              if (ids.length > 0) {\n                addToK(ids)\n              }\n            }\n            addToLocalProfileMap(profileObj, true)\n            data = this.#request.addSystemDataToObject(data, undefined)\n\n            this.#request.addFlags(data)\n            // Adding 'isOUL' flag in true for OUL cases which.\n            // This flag tells LC to create a new arp object.\n            // Also we will receive the same flag in response arp which tells to delete existing arp object.\n            if (sendOULFlag) {\n              data[IS_OUL] = true\n            }\n\n            let pageLoadUrl = this.#account.dataPostURL\n            pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n            pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n\n            // Whenever sendOULFlag is true then dont send arp and gcookie (guid in memory in the request)\n            // Also when this flag is set we will get another flag from LC in arp which tells us to delete arp\n            // stored in the cache and replace it with the response arp.\n\n            this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest, sendOULFlag)\n          }\n        }\n      }\n    }\n  }\n\n  clear () {\n    this.#logger.debug('clear called. Reset flag has been set.')\n    this.#deleteUser()\n    StorageManager.setMetaProp(CLEAR, true)\n  }\n\n  #handleCookieFromCache () {\n    $ct.blockRequest = false\n    console.debug('Block request is false')\n    if (StorageManager._isLocalStorageSupported()) {\n      delete localStorage[PR_COOKIE]\n      delete localStorage[EV_COOKIE]\n      delete localStorage[META_COOKIE]\n      delete localStorage[ARP_COOKIE]\n      delete localStorage[CAMP_COOKIE_NAME]\n      delete localStorage[CHARGEDID_COOKIE_NAME]\n    }\n    StorageManager.removeCookie(CAMP_COOKIE_NAME, getHostName())\n    StorageManager.removeCookie(this.#session.cookieName, $ct.broadDomain)\n    StorageManager.removeCookie(ARP_COOKIE, $ct.broadDomain)\n    this.#session.setSessionCookieObject('')\n  }\n\n  #deleteUser () {\n    $ct.blockRequest = true\n    this.#logger.debug('Block request is true')\n    $ct.globalCache = {\n      gcookie: null,\n      REQ_N: 0,\n      RESP_N: 0\n    }\n    if (StorageManager._isLocalStorageSupported()) {\n      delete localStorage[GCOOKIE_NAME]\n      delete localStorage[KCOOKIE_NAME]\n      delete localStorage[PR_COOKIE]\n      delete localStorage[EV_COOKIE]\n      delete localStorage[META_COOKIE]\n      delete localStorage[ARP_COOKIE]\n      delete localStorage[CAMP_COOKIE_NAME]\n      delete localStorage[CHARGEDID_COOKIE_NAME]\n    }\n    StorageManager.removeCookie(GCOOKIE_NAME, $ct.broadDomain)\n    StorageManager.removeCookie(CAMP_COOKIE_NAME, getHostName())\n    StorageManager.removeCookie(KCOOKIE_NAME, getHostName())\n    StorageManager.removeCookie(this.#session.cookieName, $ct.broadDomain)\n    StorageManager.removeCookie(ARP_COOKIE, $ct.broadDomain)\n    this.#device.gcookie = null\n    this.#session.setSessionCookieObject('')\n  }\n\n  #processLoginArray (loginArr) {\n    if (Array.isArray(loginArr) && loginArr.length > 0) {\n      const profileObj = loginArr.pop()\n      const processProfile = profileObj != null && isObject(profileObj) &&\n          ((profileObj.Site != null && Object.keys(profileObj.Site).length > 0) ||\n              (profileObj.Facebook != null && Object.keys(profileObj.Facebook).length > 0) ||\n              (profileObj['Google Plus'] != null && Object.keys(profileObj['Google Plus']).length > 0))\n      if (processProfile) {\n        StorageManager.setInstantDeleteFlagInK()\n        try {\n          this.#processOUL([profileObj])\n        } catch (e) {\n          this.#logger.debug(e)\n        }\n      } else {\n        this.#logger.error('Profile object is in incorrect format')\n      }\n    }\n  }\n\n  push (...profilesArr) {\n    this.#processLoginArray(profilesArr)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processLoginArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n}\n","export class CTWebPersonalisationBanner extends HTMLElement {\n  constructor () {\n    super()\n    this.shadow = this.attachShadow({ mode: 'open' })\n  }\n\n  _details = null\n  shadow = null\n\n  get details () {\n    return this._details || ''\n  }\n\n  set details (val) {\n    if (this._details === null) {\n      this._details = val\n      this.renderBanner()\n    }\n  }\n\n  renderBanner () {\n    this.shadow.innerHTML = this.getBannerContent()\n    if (this.trackClick !== false) {\n      this.addEventListener('click', () => {\n        const onClickUrl = this.details.onClick\n        if (onClickUrl) {\n          this.details.window ? window.open(onClickUrl, '_blank') : window.parent.location.href = onClickUrl\n        }\n        window.clevertap.renderNotificationClicked({ msgId: this.msgId, pivotId: this.pivotId })\n      })\n    }\n    window.clevertap.renderNotificationViewed({ msgId: this.msgId, pivotId: this.pivotId })\n  }\n\n  getBannerContent () {\n    return `\n      <style type=\"text/css\">\n        .banner {\n          position: relative;\n          cursor: ${this.details.onClick ? 'pointer' : ''}\n        }\n        img {\n          height: ${this.divHeight ? this.divHeight : 'auto'};\n          width: 100%;\n        }\n        .wrapper:is(.left, .right, .center) {\n          display: flex;\n          justify-content: center;\n          flex-direction: column;\n          align-items: center;\n          position: absolute;\n          width: 100%;\n          height: 100%;\n          overflow: auto;\n          top: 0;\n        }\n        ${this.details.css ? this.details.css : ''}\n      </style>\n      <div class=\"banner\">\n        <picture>\n          <source media=\"(min-width:480px)\" srcset=\"${this.details.desktopImageURL}\">\n          <source srcset=\"${this.details.mobileImageURL}\">\n          <img src=\"${this.details.desktopImageURL}\" alt=\"Please upload a picture\" style=\"width:100%;\" part=\"banner__img\">\n        </picture>\n        ${this.details.html ? this.details.html : ''}\n      </div>\n    `\n  }\n}\n","import { CTWebPersonalisationBanner } from './banner'\nexport class CTWebPersonalisationCarousel extends HTMLElement {\n  constructor () {\n    super()\n    this.shadow = this.attachShadow({ mode: 'open' })\n    if (customElements.get('ct-web-personalisation-banner') === undefined) {\n      customElements.define('ct-web-personalisation-banner', CTWebPersonalisationBanner)\n    }\n  }\n\n  _target = null\n  _carousel = null\n  shadow = null\n  slides = 0\n  previouslySelectedItem = -1\n  selectedItem = 1\n  autoSlide = null\n  stopAutoSlideTimeout = null\n\n  get target () {\n    return this._target || ''\n  }\n\n  set target (val) {\n    if (this._target === null) {\n      this._target = val\n      this.renderCarousel()\n    }\n  }\n\n  get details () {\n    return this.target.display.details\n  }\n\n  get display () {\n    return this.target.display\n  }\n\n  renderCarousel () {\n    this.slides = this.details.length\n    this.shadow.innerHTML = this.getStyles()\n    const carousel = this.getCarouselContent()\n    if (this.display.showNavBtns) {\n      carousel.insertAdjacentHTML('beforeend', this.display.navBtnsHtml)\n    }\n    if (this.display.showNavArrows) {\n      carousel.insertAdjacentHTML('beforeend', this.display.leftNavArrowHtml)\n      carousel.insertAdjacentHTML('beforeend', this.display.rightNavArrowHtml)\n    }\n    this._carousel = carousel\n    this.shadow.appendChild(carousel)\n    this.setupClick()\n    this.updateSelectedItem()\n    // TODO: enable conditionally\n    this.startAutoSlide()\n    this.setupOnHover()\n    window.clevertap.renderNotificationViewed({ msgId: this.target.wzrk_id, pivotId: this.target.wzrk_pivot })\n  }\n\n  setupClick () {\n    this._carousel.addEventListener('click', (event) => {\n      const eventID = event.target.id\n      if (eventID.startsWith('carousel__button')) {\n        const selected = +eventID.split('-')[1]\n        if (selected !== this.selectedItem) {\n          this.previouslySelectedItem = this.selectedItem\n          this.selectedItem = selected\n          this.updateSelectedItem()\n          this.startAutoSlide()\n        }\n      } else if (eventID.startsWith('carousel__arrow')) {\n        eventID.endsWith('right') ? this.goToNext() : this.goToPrev()\n        this.startAutoSlide()\n      } else if (eventID.indexOf('-') > -1) {\n        const item = +eventID.split('-')[1]\n        const index = item - 1\n        if (window.parent.clevertap) {\n          // console.log('Raise notification clicked event for ', item)\n          window.clevertap.renderNotificationClicked({ msgId: this.target.wzrk_id, pivotId: this.target.wzrk_pivot, wzrk_slideNo: item })\n        }\n        const url = this.details[index].onClick\n        if (url !== '') {\n          this.details[index].window ? window.open(url, '_blank') : window.location.href = url\n        }\n      }\n    })\n  }\n\n  setupOnHover () {\n    this._carousel.addEventListener('mouseenter', (event) => {\n      this.stopAutoSlideTimeout = setTimeout(() => {\n        this.autoSlide = clearInterval(this.autoSlide)\n      }, 500)\n    })\n\n    this._carousel.addEventListener('mouseleave', (event) => {\n      clearTimeout(this.stopAutoSlideTimeout)\n      if (this.autoSlide === undefined) {\n        this.startAutoSlide()\n      }\n    })\n  }\n\n  getCarouselContent () {\n    const carousel = document.createElement('div')\n    carousel.setAttribute('class', 'carousel')\n\n    this.details.forEach((detail, i) => {\n      const banner = document.createElement('ct-web-personalisation-banner')\n      banner.classList.add('carousel__item')\n      banner.trackClick = false\n      banner.setAttribute('id', `carousel__item-${i + 1}`)\n      banner.details = detail\n      carousel.appendChild(banner)\n    })\n\n    return carousel\n  }\n\n  getStyles () {\n    return `\n      <style>\n      .carousel {\n        position: relative;\n      }\n\n      .carousel__item {\n        background-color: grey;\n        display: none;\n        background-repeat: no-repeat;\n        background-size: cover;\n      }\n\n      ct-web-personalisation-banner::part(banner__img) {\n        height: ${this?.target?.display?.divHeight ? this.target.display.divHeight : 'auto'};\n        width: 100%;\n        transition: 2s;\n      }\n\n      .carousel__item--selected {\n        display: block;\n      }\n      ${this.display.navBtnsCss}\n      ${this.display.navArrowsCss}\n      </style>\n  `\n  }\n\n  updateSelectedItem () {\n    if (this.previouslySelectedItem !== -1) {\n      const prevItem = this.shadow.getElementById(`carousel__item-${this.previouslySelectedItem}`)\n      const prevButton = this.shadow.getElementById(`carousel__button-${this.previouslySelectedItem}`)\n      prevItem.classList.remove('carousel__item--selected')\n      prevButton.classList.remove('carousel__button--selected')\n    }\n    const item = this.shadow.getElementById(`carousel__item-${this.selectedItem}`)\n    const button = this.shadow.getElementById(`carousel__button-${this.selectedItem}`)\n    item.classList.add('carousel__item--selected')\n    button.classList.add('carousel__button--selected')\n  }\n\n  startAutoSlide () {\n    clearInterval(this.autoSlide)\n    this.autoSlide = setInterval(() => {\n      this.goToNext()\n    }, this.display.sliderTime ? this.display.sliderTime * 1000 : 3000)\n  }\n\n  goToNext () {\n    this.goTo(this.selectedItem, (this.selectedItem + 1) % this.slides)\n  }\n\n  goToPrev () {\n    this.goTo(this.selectedItem, this.selectedItem - 1)\n  }\n\n  goTo (prev, cur) {\n    this.previouslySelectedItem = prev\n    this.selectedItem = cur\n    if (cur === 0) {\n      this.selectedItem = this.slides\n    }\n    this.updateSelectedItem()\n  }\n}\n","import {\n  getCampaignObject,\n  saveCampaignObject\n} from '../clevertap'\nimport { StorageManager } from '../storage'\n\nexport class CTWebPopupImageOnly extends HTMLElement {\n  constructor () {\n    super()\n    this.shadow = this.attachShadow({ mode: 'open' })\n  }\n\n    _target = null\n    _session = null\n    shadow = null\n    popup = null\n    container = null\n\n    get target () {\n      return this._target || ''\n    }\n\n    set target (val) {\n      if (this._target === null) {\n        this._target = val\n        this.renderImageOnlyPopup()\n      }\n    }\n\n    get session () {\n      return this._session || ''\n    }\n\n    set session (val) {\n      this._session = val\n    }\n\n    get msgId () {\n      return this.target.wzrk_id\n    }\n\n    get pivotId () {\n      return this.target.wzrk_pivot\n    }\n\n    get onClickUrl () {\n      return this.target.display.onClickUrl\n    }\n\n    renderImageOnlyPopup () {\n      const campaignId = this.target.wzrk_id.split('_')[0]\n      const currentSessionId = this.session.sessionId\n\n      this.shadow.innerHTML = this.getImageOnlyPopupContent()\n      this.popup = this.shadowRoot.getElementById('imageOnlyPopup')\n      this.container = this.shadowRoot.getElementById('container')\n      this.closeIcon = this.shadowRoot.getElementById('close')\n\n      this.popup.addEventListener('load', this.updateImageAndContainerWidth())\n\n      this.closeIcon.addEventListener('click', () => {\n        document.getElementById('wzrkImageOnlyDiv').style.display = 'none'\n        this.remove()\n        if (campaignId != null && campaignId !== '-1') {\n          if (StorageManager._isLocalStorageSupported()) {\n            const campaignObj = getCampaignObject()\n\n            let sessionCampaignObj = campaignObj.wp[currentSessionId]\n            if (sessionCampaignObj == null) {\n              sessionCampaignObj = {}\n              campaignObj[currentSessionId] = sessionCampaignObj\n            }\n            sessionCampaignObj[campaignId] = 'dnd'\n            saveCampaignObject(campaignObj)\n          }\n        }\n      })\n\n      window.clevertap.renderNotificationViewed({ msgId: this.msgId, pivotId: this.pivotId })\n\n      if (this.onClickUrl) {\n        this.popup.addEventListener('click', () => {\n          this.target.display.window ? window.open(this.onClickUrl, '_blank') : window.parent.location.href = this.onClickUrl\n          window.clevertap.renderNotificationClicked({ msgId: this.msgId, pivotId: this.pivotId })\n        })\n      }\n    }\n\n    getImageOnlyPopupContent () {\n      return `\n        ${this.target.msgContent.css}\n        ${this.target.msgContent.html}\n      `\n    }\n\n    updateImageAndContainerWidth () {\n      return () => {\n        const width = this.getRenderedImageWidth(this.popup)\n        this.popup.style.setProperty('width', `${width}px`)\n        this.container.style.setProperty('width', `${width}px`)\n        this.container.style.setProperty('height', 'auto')\n        this.container.style.setProperty('position', 'fixed')\n        this.popup.style.setProperty('visibility', 'visible')\n        this.closeIcon.style.setProperty('visibility', 'visible')\n        document.getElementById('wzrkImageOnlyDiv').style.visibility = 'visible'\n      }\n    }\n\n    getRenderedImageWidth (img) {\n      const ratio = img.naturalWidth / img.naturalHeight\n      return img.height * ratio\n    }\n}\n","import { determineTimeStampText, greenTickSvg } from './helper'\nexport class Message extends HTMLElement {\n  constructor (config, message) {\n    super()\n    this.shadow = this.attachShadow({ mode: 'open' })\n    this.config = config\n    this.message = message\n    this.renderMessage(message)\n  }\n\n  wrapper = null\n  snackBar = null\n\n  get pivotId () {\n    return this.message.wzrk_pivot\n  }\n\n  get campaignId () {\n    return this.message.wzrk_id\n  }\n\n  createEl (type, id, part) {\n    const _el = document.createElement(type)\n    _el.setAttribute('id', id)\n    _el.setAttribute('part', part || id)\n    return _el\n  }\n\n  renderMessage (msg) {\n    this.wrapper = this.createEl('div', 'messageWrapper')\n\n    switch (msg.templateType) {\n      case 'text-only':\n      case 'text-with-icon':\n      case 'text-with-icon-and-image': {\n        const message = this.prepareBasicMessage(msg.msg[0])\n        this.wrapper.appendChild(message)\n      }\n    }\n\n    const timeStamp = this.createEl('div', 'timeStamp')\n    timeStamp.innerHTML = `<span>${determineTimeStampText(msg.id.split('_')[1])}<span>`\n    if (!msg.viewed) {\n      const unreadMarker = this.createEl('span', 'unreadMarker')\n      timeStamp.appendChild(unreadMarker)\n    }\n\n    this.wrapper.appendChild(timeStamp)\n    this.shadow.appendChild(this.wrapper)\n  }\n\n  prepareBasicMessage (msg) {\n    const message = this.createEl('div', 'message')\n\n    if (msg.imageUrl) {\n      const imageContainer = this.addImage(msg.imageUrl, 'mainImg')\n      message.appendChild(imageContainer)\n    }\n    const iconTitleDescWrapper = this.createEl('div', 'iconTitleDescWrapper')\n    if (msg.iconUrl) {\n      const iconContainer = this.addImage(msg.iconUrl, 'iconImg')\n      iconTitleDescWrapper.appendChild(iconContainer)\n    }\n    const titleDescWrapper = this.createEl('div', 'titleDescWrapper')\n    if (msg.title) {\n      const title = this.createEl('div', 'title')\n      title.innerText = msg.title\n      titleDescWrapper.appendChild(title)\n    }\n    if (msg.description) {\n      const description = this.createEl('div', 'description')\n      description.innerText = msg.description\n      titleDescWrapper.appendChild(description)\n    }\n    if (msg.title || msg.description) {\n      iconTitleDescWrapper.appendChild(titleDescWrapper)\n    }\n\n    if (msg.iconUrl || msg.title || msg.description) {\n      message.appendChild(iconTitleDescWrapper)\n    }\n    if (msg.buttons && msg.buttons.length) {\n      const buttonsContainer = this.addButtons(msg.buttons)\n      message.appendChild(buttonsContainer)\n    }\n    return message\n  }\n\n  addButtons (buttons = []) {\n    const buttonsContainer = this.createEl('div', 'buttonsContainer')\n    let hasCopyAction = false\n    buttons.forEach((b, i) => {\n      const button = this.createEl('button', `button-${i}`, 'button')\n      button.innerText = b.text\n      if (i > 0) {\n        button.style.cssText += 'margin-left: 2px;'\n      }\n      if (b.action === 'copy') {\n        hasCopyAction = true\n      }\n      buttonsContainer.appendChild(button)\n    })\n    if (hasCopyAction) {\n      this.addSnackbar(buttonsContainer)\n    }\n    return buttonsContainer\n  }\n\n  addSnackbar (buttonsContainer) {\n    this.snackBar = this.createEl('div', `snackbar-${this.campaignId}`, 'snackbar')\n    this.snackBar.innerHTML = greenTickSvg\n    const clipboardMsg = this.createEl('span', `snackbar-msg-${this.campaignId}`, 'snackbar-msg')\n    clipboardMsg.innerText = 'Copied to clipboard'\n    this.snackBar.appendChild(clipboardMsg)\n    buttonsContainer.appendChild(this.snackBar)\n  }\n\n  addImage (url, type) {\n    const imageContainer = this.createEl('div', `${type}Container`)\n    const image = this.createEl('img', type)\n    image.setAttribute('src', url)\n    // images will be fetched as and when the element comes into the viewport\n    image.setAttribute('loading', 'lazy')\n    imageContainer.appendChild(image)\n    return imageContainer\n  }\n\n  raiseClickedEvent (path, isPreview) {\n    switch (this.message.templateType) {\n      case 'text-only':\n      case 'text-with-icon':\n      case 'text-with-icon-and-image': {\n        this.raiseClickedForBasicTemplates(path, isPreview)\n      }\n    }\n  }\n\n  raiseClickedForBasicTemplates (path, isPreview) {\n    const msg = this.message.msg[0]\n    const payload = { msgId: this.campaignId, pivotId: this.pivotId }\n    if (path.tagName === 'BUTTON') {\n      const id = path.id.split('-')[1]\n      const button = msg.buttons[id]\n      payload.kv = {\n        wzrk_c2a: button.text\n      }\n      if (button.action === 'url') {\n        button.openUrlInNewTab ? window.open(button.url, '_blank') : (window.location = button.url)\n      } else if (button.action === 'copy') {\n        window.focus()\n        navigator.clipboard.writeText(button.clipboardText)\n        this.snackBar.style.setProperty('display', 'flex', 'important')\n        setTimeout(() => {\n          this.snackBar.style.setProperty('display', 'none', 'important')\n        }, 2000)\n      }\n    } else if (path.tagName === 'CT-INBOX-MESSAGE' && msg.onClickUrl) {\n      msg.openUrlInNewTab ? window.open(msg.onClickUrl, '_blank') : (window.location = msg.onClickUrl)\n    }\n    if (isPreview) {\n      console.log('Notifiction clicked event will be raised at run time with payload ::', payload)\n    } else {\n      window.clevertap.renderNotificationClicked(payload)\n    }\n  }\n}\n","export const messageStyles = ({ backgroundColor, borderColor, titleColor, descriptionColor, buttonColor, buttonTextColor, unreadMarkerColor }) => {\n  return `\n    <style id=\"messageStyles\">\n      ct-inbox-message::part(messageWrapper) {\n        margin-bottom: 16px; \n      }\n      ct-inbox-message::part(message) {\n        background-color: ${backgroundColor}; \n        border: 1px solid ${borderColor};\n        border-radius: 4px; \n        overflow: hidden;\n        min-height: 40px;\n      }\n      ct-inbox-message::part(message):hover {\n        box-shadow: 0px 4px 8px rgb(0 0 0 / 10%);\n        cursor: pointer;\n      }\n      ct-inbox-message::part(iconTitleDescWrapper) {\n        display: flex; \n        padding: 16px;\n      }\n      ct-inbox-message::part(titleDescWrapper) {\n        display: flex; \n        flex-direction: column;\n      }\n      ct-inbox-message::part(iconImgContainer) {\n        display: flex; \n        margin-right: 16px;\n      }\n      ct-inbox-message::part(mainImgContainer) {\n        line-height: 0;\n      }\n      ct-inbox-message::part(mainImg) {\n        width: 100%; \n        background: #b2b1ae;\n      }\n      ct-inbox-message::part(iconImg) {\n        height: 40px; \n        width: 40px;\n      }\n      ct-inbox-message::part(title) {\n        font-size: 14px !important; \n        line-height: 20px; \n        font-weight: 600; \n        color: ${titleColor}\n      }\n      ct-inbox-message::part(description) {\n        font-size: 14px !important; \n        line-height: 20px; \n        font-weight: 400; \n        color: ${descriptionColor}\n      }\n      ct-inbox-message::part(button) {\n        background-color: ${buttonColor}; \n        color: ${buttonTextColor}; \n        padding: 8px 16px; \n        font-size: 12px; \n        line-height: 16px; \n        font-weight: 600; \n        flex: 1; \n        border-radius: 0px; \n        text-transform: capitalize; \n        cursor: pointer; \n        border: none;\n      }\n      ct-inbox-message::part(buttonsContainer) {\n        display: flex;\n        position: relative;\n      }\n      ct-inbox-message::part(snackbar) {\n        position: absolute;\n        top: calc(-100% - 12px);\n        left: 50%;\n        transform: translate(-50%, 0px);\n        font-size: 14px;\n        font-weight: 400;\n        background: #FFFFFF;\n        border: 1px solid #ECEDF2;\n        box-shadow: 0px 4px 8px rgb(0 0 0 / 6%), 0px 0px 2px rgb(0 0 0 / 4%);\n        border-radius: 4px;\n        z-index: 2;\n        display: none;\n        width: max-content;\n        align-items: center;\n        padding: 8px 16px;\n        justify-content: center;\n      }\n\n      ct-inbox-message::part(snackbar-msg) {\n        color: black;\n        margin-left: 8px;\n      }\n\n      ct-inbox-message::part(timeStamp) {\n        display: flex; \n        justify-content: end; \n        align-items: center; \n        margin-top: 4px; \n        font-size: 12px !important; \n        line-height: 16px; \n        color: black;\n      }\n      ct-inbox-message::part(unreadMarker) {\n        height: 8px; \n        width: 8px; \n        border-radius: 50%; \n        background-color: ${unreadMarkerColor}; \n        margin-left: 8px;\n      }\n      @media only screen and (min-width: 420px) {\n        ct-inbox-message::part(mainImg) {\n          height: 180px;\n        }\n      }\n    </style>\n  `\n}\n\nexport const inboxContainerStyles = ({\n  panelBackgroundColor,\n  panelBorderColor,\n  headerBackgroundColor,\n  headerTitleColor,\n  closeIconColor,\n  categoriesTabColor,\n  categoriesTitleColor,\n  categoriesBorderColor,\n  selectedCategoryTabColor,\n  selectedCategoryTitleColor,\n  selectedCategoryBorderColor,\n  headerCategoryAndPoweredByCTHeight\n}) => {\n  return `\n      <style id=\"webInboxStyles\">\n        #inbox {\n          width: 100%;\n          position: fixed;\n          background-color: #fff; \n          display: none; \n          box-shadow: 0px 2px 10px 0px #d7d7d791;\n          background-color: ${panelBackgroundColor}; \n          border: 1px solid ${panelBorderColor};\n          top: 0;\n          left: 0;\n          height: 100%;\n          overflow: auto;\n          z-index: 1;\n          box-sizing: content-box;\n          border-radius: 4px;\n        }\n  \n        #emptyInboxMsg {\n          display: block;\n          padding: 10px;\n          text-align: center;\n          color: black;\n        }\n  \n        #header {\n          height: 36px; \n          width: 100%; \n          display: flex; \n          justify-content: center; \n          align-items: center; \n          background-color: ${headerBackgroundColor}; \n          background-color: var(--card-bg, ${headerBackgroundColor});\n          color: ${headerTitleColor}\n        }\n  \n        #closeInbox {\n          font-size: 20px; \n          margin-right: 12px; \n          color: ${closeIconColor}; \n          cursor: pointer;\n        }\n  \n        #headerTitle {\n          font-size: 14px; \n          line-height: 20px; \n          flex-grow: 1; \n          font-weight: 700; \n          text-align: center;\n          flex-grow: 1;\n          text-align: center;\n        }\n  \n        #categoriesContainer {\n          padding: 16px 16px 0 16px; \n          height: 32px; \n          display: flex;\n          scroll-behavior: smooth;\n          position: relative;\n        }\n\n        #categoriesWrapper {\n          height: 32px; \n          overflow-x: scroll;\n          display: flex;\n          white-space: nowrap;\n          scrollbar-width: none;\n        }\n\n        #categoriesWrapper::-webkit-scrollbar {\n          display: none;\n        }\n  \n        #leftArrow, #rightArrow {\n          height: 32px;\n          align-items: center;\n          font-weight: 700;\n          position: absolute;\n          z-index: 2;\n          pointer-events: auto;\n          cursor: pointer;\n          display: none;\n        }\n\n        #leftArrow {\n          left: 0;\n          padding-left: 4px;\n          padding-right: 16px;\n          background: linear-gradient(90deg, ${panelBackgroundColor} 0%, ${panelBackgroundColor}99 80%, ${panelBackgroundColor}0d 100%);\n        }\n\n        #rightArrow {\n          right: 0;\n          padding-right: 4px;\n          padding-left: 16px;\n          background: linear-gradient(-90deg, ${panelBackgroundColor} 0%, ${panelBackgroundColor}99 80%, ${panelBackgroundColor}0d 100%);\n        }\n\n        [id^=\"category-\"] {\n          display: flex; \n          flex: 1 1 0; \n          justify-content: center; \n          align-items: center; \n          font-size: 14px; \n          line-height: 20px; \n          background-color: ${categoriesTabColor}; \n          color: ${categoriesTitleColor}; \n          cursor: pointer;\n          padding: 6px 24px;\n          margin: 0 3px;\n          border-radius: 16px;\n          border: ${categoriesBorderColor ? '1px solid ' + categoriesBorderColor : 'none'};\n        }\n\n        [id^=\"category-\"][selected=\"true\"] {\n          background-color: ${selectedCategoryTabColor}; \n          color: ${selectedCategoryTitleColor}; \n          border: ${selectedCategoryBorderColor ? '1px solid ' + selectedCategoryBorderColor : 'none'}\n        }\n  \n        #inboxCard {\n          padding: 0 16px 0 16px;\n          overflow-y: auto;\n          box-sizing: border-box;\n          margin-top: 16px;\n        }\n\n        #poweredByCT {\n          display: block;\n          height: 16px;\n          padding: 8px 0px;\n          margin: auto;\n        }\n  \n        @media only screen and (min-width: 420px) {\n          #inbox {\n            width: var(--inbox-width, 392px);\n            height: var(--inbox-height, 546px);\n            position: var(--inbox-position, fixed);\n            right: var(--inbox-right, unset);\n            bottom: var(--inbox-bottom, unset);\n            top: var(--inbox-top, unset);\n            left: var(--inbox-left, unset);\n          }\n  \n          #inboxCard {\n            height: calc(var(--inbox-height, 546px) - ${headerCategoryAndPoweredByCTHeight}px); \n          }\n  \n        }\n      </style>\n      `\n}\n","import { StorageManager, $ct } from '../../util/storage'\nimport { Message } from './Message'\nimport { inboxContainerStyles, messageStyles } from './inboxStyles'\nimport { getInboxPosition, determineTimeStampText, arrowSvg, getInboxMessages, saveInboxMessages } from './helper'\nimport { WEBINBOX_CONFIG, MAX_INBOX_MSG } from '../../util/constants'\n\nexport class Inbox extends HTMLElement {\n  constructor (logger) {\n    super()\n    this.logger = logger\n    this.shadow = this.attachShadow({ mode: 'open' })\n  }\n\n  isInboxOpen = false\n  selectedCategory = null\n  unviewedMessages = {}\n  unviewedCounter = 0\n  isPreview = false\n  inboxConfigForPreview = {}\n\n  // dom references\n  inboxSelector = null\n  inbox = null\n  emptyInboxMsg = null\n  inboxCard = null\n  unviewedBadge = null\n  observer = null\n  selectedCategoryRef = null\n\n  get incomingMessages () {\n    return []\n  }\n\n  set incomingMessages (msgs = []) {\n    if (msgs.length > 0 && this.inbox) {\n      this.updateInboxMessages(msgs)\n    }\n  }\n\n  get incomingMessagesForPreview () {\n    return []\n  }\n\n  set incomingMessagesForPreview (msgs = []) {\n    if (msgs.length > 0 && this.inbox) {\n      this.isPreview = true\n      this.unviewedCounter = 0\n      msgs.forEach((m) => {\n        m.id = `${m.wzrk_id.split('_')[0]}_${Date.now()}`\n        this.unviewedMessages[m.id] = m\n        this.unviewedCounter++\n      })\n      this.buildUIForMessages(msgs)\n      this.updateUnviewedBadgeCounter()\n    }\n  }\n\n  connectedCallback () {\n    this.init()\n  }\n\n  init () {\n    this.config = this.isPreview ? this.inboxConfigForPreview : StorageManager.readFromLSorCookie(WEBINBOX_CONFIG) || {}\n    if (Object.keys(this.config).length === 0) {\n      return\n    }\n    this.inboxSelector = document.getElementById(this.config.inboxSelector)\n    if (this.inboxSelector === null) {\n      return\n    }\n\n    if (this.config.styles.notificationsBadge) {\n      this.addUnviewedBadge()\n    } else if (this.unviewedBadge) {\n      this.unviewedBadge.remove()\n    }\n\n    this.createinbox()\n\n    /**\n     * We need to remove the listener as there could be a scenario where init would be called when\n     * we get updated web inbox settings from LC after the inbox has been initialised.\n     * It can so happen that the inbox-selector would have changed.\n     */\n    document.removeEventListener('click', this.addClickListenerOnDocument)\n    document.addEventListener('click', this.addClickListenerOnDocument)\n    this.config.categories.length && this.updateActiveCategory(this.selectedCategoryRef.innerText)\n\n    this.shadow.innerHTML = this.getInboxStyles()\n    this.shadow.appendChild(this.inbox)\n  }\n\n  addMsgsToInboxFromLS () {\n    const messages = this.deleteExpiredAndGetUnexpiredMsgs(false)\n    const msgIds = messages ? Object.keys(messages) : []\n    if (msgIds.length === 0) {\n      return\n    }\n    msgIds.forEach((m) => {\n      if (!messages[m].viewed) {\n        this.unviewedMessages[m] = messages[m]\n        this.unviewedCounter++\n      }\n    })\n    this.buildUIForMessages(messages)\n    this.updateUnviewedBadgeCounter()\n  }\n\n  /**\n   * @param {*} deleteMsgsFromUI - If this param is true, then we'll have to check the UI and delete expired messages from the DOM\n   * It'll be false when you are building the inbox layout for the very first time.\n   *\n   * This method reads the inbox messages from LS,\n   * based on the deleteMsgsFromUI flag deletes the expired messages from UI and decrements the unviewed counter if the message was not viewed,\n   * sorts the messages based on the date,\n   * saves the unexpired messages to LS\n   * and returns the sorted unexpired messages\n   *\n   * Scenarios when we encounter expired messages -\n   * 1. building ui for the 1st time, no need to decrement the unviewed counter as the correct count will be set at the time of rendering\n   * 2. UI is already built (deleteMsgsFromUI = true) and you open the inbox\n   *    a. You'll find the expired msg in inbox\n   *    b. You'll not find the expired msg in inbox.\n   *       This happens when we receive new messages from LC, increment unviewed counter, save it in LS. (We build the UI only when the user opens inbox.)\n   *  In both the above scenarios, we'll still have to decrement the unviewed counter if the message was not viewed.\n   */\n  deleteExpiredAndGetUnexpiredMsgs (deleteMsgsFromUI = true) {\n    let messages = getInboxMessages()\n\n    const now = Math.floor(Date.now() / 1000)\n    for (const msg in messages) {\n      if (messages[msg].wzrk_ttl && messages[msg].wzrk_ttl > 0 && messages[msg].wzrk_ttl < now) {\n        if (deleteMsgsFromUI) {\n          const el = this.shadowRoot.getElementById(messages[msg].id)\n          el && el.remove()\n          if (!messages[msg].viewed) {\n            this.unviewedCounter--\n            this.updateUnviewedBadgeCounter()\n          }\n        }\n        delete messages[msg]\n      }\n    }\n    if (messages && messages.length > 0) {\n      messages = Object.values(messages).sort((a, b) => b.date - a.date).reduce((acc, m) => { acc[m.id] = m; return acc }, {})\n    }\n    saveInboxMessages(messages)\n    return messages\n  }\n\n  updateInboxMessages (msgs = []) {\n    const inboxMsgs = this.deleteExpiredAndGetUnexpiredMsgs()\n    const date = Date.now()\n    const incomingMsgs = {}\n    msgs.forEach((m, i) => {\n      const key = `${m.wzrk_id.split('_')[0]}_${Date.now()}`\n      m.id = key\n      // We are doing this to preserve the order of the messages\n      m.date = date - i\n      m.viewed = 0\n      inboxMsgs[key] = m\n      incomingMsgs[key] = m\n      this.unviewedMessages[key] = m\n      this.unviewedCounter++\n    })\n    saveInboxMessages(inboxMsgs)\n    this.buildUIForMessages(incomingMsgs)\n    this.updateUnviewedBadgeCounter()\n  }\n\n  createEl (type, id, part) {\n    const _el = document.createElement(type)\n    _el.setAttribute('id', id)\n    _el.setAttribute('part', part || id)\n    return _el\n  }\n\n  addUnviewedBadge () {\n    if (!this.unviewedBadge) {\n      this.unviewedBadge = this.createEl('div', 'unviewedBadge')\n      // As this unviewedBadge element will be directly added to the DOM, we are defining inline styles\n      this.unviewedBadge.style.cssText = `display: none; position: absolute; height: 16px; width: 26px; border-radius: 8px; background-color: ${this.config.styles.notificationsBadge.backgroundColor}; font-size: 12px; color: ${this.config.styles.notificationsBadge.textColor}; font-weight: bold; align-items: center; justify-content: center;`\n      document.body.appendChild(this.unviewedBadge)\n    }\n    this.updateUnviewedBadgePosition()\n\n    // called when user switches b/w portrait and landscape mode.\n    window.addEventListener('resize', () => {\n      this.updateUnviewedBadgePosition()\n    })\n  }\n\n  updateUnviewedBadgePosition () {\n    const { top, right } = this.inboxSelector.getBoundingClientRect()\n    this.unviewedBadge.style.top = `${top - 8}px`\n    this.unviewedBadge.style.left = `${right - 8}px`\n  }\n\n  createinbox () {\n    this.inbox = this.createEl('div', 'inbox')\n    const header = this.createEl('div', 'header')\n\n    const headerTitle = this.createEl('div', 'headerTitle')\n    headerTitle.innerText = this.config.title\n\n    const closeIcon = this.createEl('div', 'closeInbox')\n    closeIcon.innerHTML = '&times'\n\n    header.appendChild(headerTitle)\n    header.appendChild(closeIcon)\n    this.inbox.appendChild(header)\n    if (this.config.categories.length) {\n      const categories = this.createCategories()\n      this.inbox.appendChild(categories)\n    }\n    this.inboxCard = this.createEl('div', 'inboxCard')\n    this.inbox.appendChild(this.inboxCard)\n\n    this.emptyInboxMsg = this.createEl('div', 'emptyInboxMsg')\n    this.emptyInboxMsg.innerText = 'All messages will be displayed here.'\n    this.inboxCard.appendChild(this.emptyInboxMsg)\n\n    if (this.config.hidePoweredByCT === false) {\n      const poweredByText = this.createEl('img', 'poweredByCT')\n      poweredByText.src = 'https://d2r1yp2w7bby2u.cloudfront.net/js/PB_CT_new.png'\n      this.inbox.appendChild(poweredByText)\n    }\n\n    // Intersection observer for notification viewed\n    const options = {\n      root: this.inboxCard,\n      rootMargin: '0px',\n      threshold: 0.5\n    }\n    this.observer = new IntersectionObserver((entries, observer) => { this.handleMessageViewed(entries) }, options)\n\n    this.addMsgsToInboxFromLS()\n  }\n\n  createCategories () {\n    const categoriesContainer = this.createEl('div', 'categoriesContainer')\n\n    const leftArrow = this.createEl('div', 'leftArrow')\n    leftArrow.innerHTML = arrowSvg\n    leftArrow.children[0].style = 'transform: rotate(180deg)'\n    leftArrow.addEventListener('click', () => {\n      this.shadowRoot.getElementById('categoriesWrapper').scrollBy(-70, 0)\n    })\n    categoriesContainer.appendChild(leftArrow)\n\n    const categoriesWrapper = this.createEl('div', 'categoriesWrapper')\n    const _categories = ['All', ...this.config.categories]\n    _categories.forEach((c, i) => {\n      const category = this.createEl('div', `category-${i}`, 'category')\n      category.innerText = c\n      if (i === 0) {\n        this.selectedCategoryRef = category\n      }\n      categoriesWrapper.appendChild(category)\n    })\n    categoriesContainer.appendChild(categoriesWrapper)\n\n    const rightArrow = this.createEl('div', 'rightArrow')\n    rightArrow.innerHTML = arrowSvg\n    rightArrow.addEventListener('click', () => {\n      this.shadowRoot.getElementById('categoriesWrapper').scrollBy(70, 0)\n    })\n    categoriesContainer.appendChild(rightArrow)\n\n    const options = { root: categoriesContainer, threshold: 0.9 }\n    const firstCategory = categoriesWrapper.children[0]\n    const lastCategory = categoriesWrapper.children[this.config.categories.length]\n\n    const firstCategoryObserver = new IntersectionObserver((e) => {\n      this.categoryObserverCb(leftArrow, e[0].intersectionRatio >= 0.9)\n    }, options)\n    firstCategoryObserver.observe(firstCategory)\n\n    const lastCategoryObserver = new IntersectionObserver((e) => {\n      this.categoryObserverCb(rightArrow, e[0].intersectionRatio >= 0.9)\n    }, options)\n    lastCategoryObserver.observe(lastCategory)\n\n    return categoriesContainer\n  }\n\n  categoryObserverCb (el, hide) {\n    if (!el) {\n      return\n    }\n    el.style.display = hide ? 'none' : 'flex'\n  }\n\n  updateActiveCategory (activeCategory) {\n    this.selectedCategory = activeCategory\n\n    this.inboxCard.scrollTop = 0\n    let counter = 0\n\n    this.prevCategoryRef && this.prevCategoryRef.setAttribute('selected', 'false')\n    this.selectedCategoryRef.setAttribute('selected', 'true')\n\n    this.inboxCard.childNodes.forEach(c => {\n      if (c.getAttribute('id') !== 'emptyInboxMsg') {\n        c.style.display = (this.selectedCategory === 'All' || c.getAttribute('category') === this.selectedCategory) ? 'block' : 'none'\n        if (c.style.display === 'block') {\n          counter++\n        }\n      }\n    })\n    if (counter === 0) {\n      this.emptyInboxMsg.innerText = `${activeCategory} messages will be displayed here.`\n      this.emptyInboxMsg.style.display = 'block'\n    } else {\n      this.emptyInboxMsg.style.display = 'none'\n    }\n  }\n\n  buildUIForMessages (messages = {}) {\n    !this.isPreview && this.updateTSForRenderedMsgs()\n    this.inboxCard.scrollTop = 0\n    const maxMsgsInInbox = this.config.maxMsgsInInbox ?? MAX_INBOX_MSG\n    const firstChild = this.inboxCard.firstChild\n\n    for (const m in messages) {\n      const item = new Message(this.config, messages[m])\n      item.setAttribute('id', messages[m].id)\n      item.setAttribute('pivot', messages[m].wzrk_pivot)\n      item.setAttribute('part', 'ct-inbox-message')\n      if (this.config.categories.length > 0) {\n        item.setAttribute('category', messages[m].tags[0] || '')\n        item.style.display = (this.selectedCategory === 'All' || messages[m].category === this.selectedCategory) ? 'block' : 'none'\n      } else {\n        item.style.display = 'block'\n      }\n      this.inboxCard.insertBefore(item, firstChild)\n      this.observer.observe(item)\n    }\n\n    let msgTotalCount = this.inboxCard.querySelectorAll('ct-inbox-message').length\n    while (msgTotalCount > maxMsgsInInbox) {\n      const ctInboxMsgs = this.inboxCard.querySelectorAll('ct-inbox-message')\n      if (ctInboxMsgs.length > 0) { ctInboxMsgs[ctInboxMsgs.length - 1].remove() }\n      msgTotalCount--\n    }\n    const hasMessages = this.inboxCard.querySelectorAll('ct-inbox-message[style*=\"display: block\"]').length\n    this.emptyInboxMsg.style.display = hasMessages ? 'none' : 'block'\n  }\n\n  /**\n   * Adds a click listener on the document. For every click we check\n   * 1. if the click has happenned within the inbox\n   *    - on close button, we close the inbox\n   *    - on any of the category, we set that as the activeCategory\n   *    - on any of the message, we mark raise notification clicked event. To identify the clicks on a button, we have p.id.startsWith('button-')\n   * 2. if the user has clicked on the inboxSelector, we toggle inbox\n   * 3. if the click is anywhere else on the UI and the inbox is open, we simply close it\n   */\n\n  addClickListenerOnDocument = (() => {\n    return (e) => {\n      if (e.composedPath().includes(this.inbox)) {\n        // path is not supported on FF. So we fallback to e.composedPath\n        const path = e.path || (e.composedPath && e.composedPath())\n        if (path.length) {\n          const id = path[0].id\n          if (id === 'closeInbox') {\n            this.toggleInbox()\n          } else if (id.startsWith('category-')) {\n            this.prevCategoryRef = this.selectedCategoryRef\n            this.selectedCategoryRef = path[0]\n            this.updateActiveCategory(path[0].innerText)\n          } else {\n            const _path = path.filter((p) => p.id?.startsWith('button-') || p.tagName === 'CT-INBOX-MESSAGE')\n            if (_path.length) {\n              const messageEl = _path[_path.length - 1]\n              messageEl.raiseClickedEvent(_path[0], this.isPreview)\n            }\n          }\n        }\n      } else if (this.inboxSelector.contains(e.target) || this.isInboxOpen) {\n        this.toggleInbox(e)\n      }\n    }\n  })()\n\n  /**\n   * This function will be called every time when a message comes into the inbox viewport and it's visibility increases to 50% or drops below 50%\n   * If a msg is 50% visible in the UI, we need to mark the message as viewed in LS and raise notification viewed event\n   */\n  handleMessageViewed (entries) {\n    const raiseViewedEvent = !this.isPreview\n    if (this.isInboxOpen) {\n      entries.forEach((e) => {\n        if (e.isIntersecting && this.unviewedMessages.hasOwnProperty(e.target.id) && e.target.message.viewed === 0) {\n          e.target.message.viewed = 1\n          if (raiseViewedEvent) {\n            window.clevertap.renderNotificationViewed({ msgId: e.target.campaignId, pivotId: e.target.pivotId })\n            this.updateMessageInLS(e.target.id, { ...e.target.message, viewed: 1 })\n            setTimeout(() => {\n              e.target.shadowRoot.getElementById('unreadMarker').style.display = 'none'\n            }, 1000)\n          } else {\n            console.log('Notifiction viewed event will be raised at run time with payload ::', { msgId: e.target.campaignId, pivotId: e.target.pivotId })\n          }\n          this.unviewedCounter--\n          this.updateUnviewedBadgeCounter()\n          delete this.unviewedMessages[e.target.id]\n        }\n      })\n    }\n  }\n\n  updateMessageInLS (key, value) {\n    if (!this.isPreview) {\n      const messages = getInboxMessages()\n      messages[key] = value\n      saveInboxMessages(messages)\n    }\n  }\n\n  // create a separte fn fro refactoring\n  toggleInbox (e) {\n    this.isInboxOpen = !this.isInboxOpen\n    if (this.isInboxOpen) {\n      this.inboxCard.scrollTop = 0\n      !this.isPreview && this.deleteExpiredAndGetUnexpiredMsgs()\n      this.inbox.style.display = 'block'\n      this.inbox.style.zIndex = '2147483647' // zIndex should be max for the inbox to be rendered on top of all elements\n      if (this.config.categories.length) {\n        this.selectedCategoryRef.setAttribute('selected', 'false')\n        this.selectedCategoryRef = this.shadowRoot.getElementById('category-0')\n        this.updateActiveCategory(this.selectedCategoryRef.innerText)\n        this.shadowRoot.getElementById('categoriesWrapper').scrollLeft -= this.shadowRoot.getElementById('categoriesWrapper').scrollWidth\n      }\n      this.setInboxPosition(e)\n    } else {\n      this.inbox.style.display = 'none'\n    }\n  }\n\n  setInboxPosition (e) {\n    const windowWidth = window.outerWidth\n    const customInboxStyles = getComputedStyle($ct.inbox)\n    const top = customInboxStyles.getPropertyValue('--inbox-top')\n    const bottom = customInboxStyles.getPropertyValue('--inbox-bottom')\n    const left = customInboxStyles.getPropertyValue('--inbox-left')\n    const right = customInboxStyles.getPropertyValue('--inbox-right')\n    const hasPositionDefined = top || bottom || left || right\n    if (windowWidth > 481 && !hasPositionDefined) {\n      const res = getInboxPosition(e, this.inbox.clientHeight, this.inbox.clientWidth)\n      const xPos = res.xPos\n      const yPos = res.yPos\n      this.inbox.style.top = yPos + 'px'\n      this.inbox.style.left = xPos + 'px'\n    }\n  }\n\n  /**\n   * Updates the UI with the number of unviewed messages\n   * If there are more than 9 unviewed messages, we show the count as 9+\n   */\n\n  setBadgeStyle = (msgCount) => {\n    if (this.unviewedBadge !== null) {\n      this.unviewedBadge.innerText = msgCount > 9 ? '9+' : msgCount\n      this.unviewedBadge.style.display = msgCount > 0 ? 'flex' : 'none'\n    }\n  }\n\n  updateUnviewedBadgeCounter () {\n    if (this.isPreview) {\n      this.setBadgeStyle(this.unviewedCounter)\n      return\n    }\n    let counter = 0\n    this.inboxCard.querySelectorAll('ct-inbox-message').forEach((m) => {\n      const messages = getInboxMessages()\n      if (messages[m.id] && messages[m.id].viewed === 0) {\n        counter++\n      }\n    })\n    this.setBadgeStyle(counter)\n  }\n\n  updateTSForRenderedMsgs () {\n    this.inboxCard.querySelectorAll('ct-inbox-message').forEach((m) => {\n      const ts = m.id.split('_')[1]\n      m.shadow.getElementById('timeStamp').firstChild.innerText = determineTimeStampText(ts)\n    })\n  }\n\n  getInboxStyles () {\n    const headerHeight = 36\n    const categoriesHeight = this.config.categories.length ? 64 : 16\n    const hidePoweredByCTHeight = this.config.hidePoweredByCT === false ? 32 : 0\n\n    const styles = {\n      panelBackgroundColor: this.config.styles.panelBackgroundColor,\n      panelBorderColor: this.config.styles.panelBorderColor,\n      headerBackgroundColor: this.config.styles.header.backgroundColor,\n      headerTitleColor: this.config.styles.header.titleColor,\n      closeIconColor: this.config.styles.closeIconColor,\n      categoriesTabColor: this.config.styles.categories.tabColor,\n      categoriesTitleColor: this.config.styles.categories.titleColor,\n      selectedCategoryTabColor: this.config.styles.categories.selectedTab.tabColor,\n      selectedCategoryTitleColor: this.config.styles.categories.selectedTab.titleColor,\n      headerCategoryAndPoweredByCTHeight: headerHeight + categoriesHeight + hidePoweredByCTHeight\n    }\n    if (this.config.styles.categories.borderColor) {\n      styles.categoriesBorderColor = this.config.styles.categories.borderColor\n    }\n    if (this.config.styles.categories.selectedTab.borderColor) {\n      styles.selectedCategoryBorderColor = this.config.styles.categories.selectedTab.borderColor\n    }\n\n    const inboxStyles = inboxContainerStyles(styles)\n\n    const cardStyles = this.config.styles.cards\n    const msgStyles = messageStyles({\n      backgroundColor: cardStyles.backgroundColor,\n      borderColor: cardStyles.borderColor,\n      titleColor: cardStyles.titleColor,\n      descriptionColor: cardStyles.descriptionColor,\n      buttonColor: cardStyles.buttonColor,\n      buttonTextColor: cardStyles.buttonTextColor,\n      unreadMarkerColor: cardStyles.unreadMarkerColor\n    })\n\n    return inboxStyles + msgStyles\n  }\n}\n","import { StorageManager, $ct } from '../../util/storage'\nimport { Inbox } from './WebInbox'\nimport { Message } from './Message'\nimport { WEBINBOX_CONFIG, GCOOKIE_NAME, WEBINBOX } from '../../util/constants'\nimport { isValueValid } from '../../util/datatypes'\n\nexport const processWebInboxSettings = (webInboxSetting, isPreview = false) => {\n  const _settings = StorageManager.readFromLSorCookie(WEBINBOX_CONFIG) || {}\n  if (isPreview) {\n    $ct.inbox.inboxConfigForPreview = webInboxSetting\n    $ct.inbox.isPreview = true\n    $ct.inbox && $ct.inbox.init()\n  } else if (JSON.stringify(_settings) !== JSON.stringify(webInboxSetting)) {\n    StorageManager.saveToLSorCookie(WEBINBOX_CONFIG, webInboxSetting)\n    $ct.inbox && $ct.inbox.init()\n  }\n}\n\nexport const processInboxNotifs = (msg) => {\n  if (msg.inbox_preview) {\n    $ct.inbox.incomingMessagesForPreview = msg.inbox_notifs\n  } else {\n    $ct.inbox.incomingMessages = msg\n  }\n}\n\nexport const processWebInboxResponse = (msg) => {\n  if (msg.webInboxSetting) {\n    processWebInboxSettings(msg.webInboxSetting, msg.inbox_preview)\n  }\n  if (msg.inbox_notifs != null) {\n    processInboxNotifs(msg)\n  }\n}\n\nexport const addWebInbox = (logger) => {\n  checkAndRegisterWebInboxElements()\n  $ct.inbox = new Inbox({ logger })\n  document.body.appendChild($ct.inbox)\n}\n\nconst getAndMigrateInboxMessages = (guid) => {\n  const messages = StorageManager.readFromLSorCookie(WEBINBOX) || {}\n  // Doing this to migrate message to guid level\n  if (Object.keys(messages).length > 0 && Object.keys(messages)[0].includes('_')) {\n    const gudInboxObj = {}\n    gudInboxObj[guid] = messages\n    StorageManager.saveToLSorCookie(WEBINBOX, gudInboxObj)\n    return gudInboxObj\n  }\n  return messages\n}\n\nexport const getInboxMessages = () => {\n  const guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n  if (!isValueValid(guid)) { return {} }\n  const messages = getAndMigrateInboxMessages(guid)\n\n  return messages.hasOwnProperty(guid) ? messages[guid] : {}\n}\n\nexport const saveInboxMessages = (messages) => {\n  const guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n  if (!isValueValid(guid)) { return }\n  const storedInboxObj = getAndMigrateInboxMessages(guid)\n\n  const newObj = { ...storedInboxObj, [guid]: messages }\n  StorageManager.saveToLSorCookie(WEBINBOX, newObj)\n}\n\nexport const initializeWebInbox = (logger) => {\n  return new Promise((resolve, reject) => {\n    if (document.readyState === 'complete') {\n      addWebInbox(logger)\n      resolve()\n    } else {\n      const config = StorageManager.readFromLSorCookie(WEBINBOX_CONFIG) || {}\n      const onLoaded = () => {\n        /**\n         * We need this null check here because $ct.inbox could be initialised via init method too on document load.\n         * In that case we don't need to call addWebInbox method\n         */\n        if ($ct.inbox === null) {\n          addWebInbox(logger)\n        }\n        resolve()\n      }\n      window.addEventListener('load', () => {\n        /**\n         * Scripts can be loaded layzily, we may not get element from dom as it may not be mounted yet\n         * We will to check element for 10 seconds and give up\n         */\n        if (document.getElementById(config.inboxSelector)) {\n          onLoaded()\n        } else {\n          // check for element for next 10 seconds\n          let count = 0\n          if (count < 20) {\n            const t = setInterval(() => {\n              if (document.getElementById(config.inboxSelector)) {\n                onLoaded()\n                clearInterval(t)\n                resolve()\n              } else if (count >= 20) {\n                clearInterval(t)\n                logger.debug('Failed to add inbox')\n              }\n              count++\n            }, 500)\n          }\n        }\n      })\n    }\n  })\n}\n\nexport const checkAndRegisterWebInboxElements = () => {\n  if (customElements.get('ct-web-inbox') === undefined) {\n    customElements.define('ct-web-inbox', Inbox)\n    customElements.define('ct-inbox-message', Message)\n  }\n}\n\nexport const getInboxPosition = (e, inboxHeight, inboxWidth) => {\n  const horizontalScroll = document.scrollingElement.scrollLeft\n  const verticalScroll = document.scrollingElement.scrollTop\n  const windowWidth = window.innerWidth + horizontalScroll\n  const windowHeight = window.innerHeight + verticalScroll\n  const selectorRect = e.target.getBoundingClientRect()\n  const selectorX = selectorRect.x + horizontalScroll\n  const selectorY = selectorRect.y + verticalScroll\n  const selectorLeft = selectorRect.left + horizontalScroll\n  const selectorRight = selectorRect.right + horizontalScroll\n  const selectorTop = selectorRect.top + verticalScroll\n  const selectorBottom = selectorRect.bottom + verticalScroll\n  const selectorHeight = selectorRect.height\n  const selectorWidth = selectorRect.width\n  const selectorCenter = {\n    x: selectorX + (selectorWidth / 2),\n    y: selectorY + (selectorHeight / 2)\n  }\n  const halfOfInboxHeight = (inboxHeight / 2)\n  const halfOfInboxWidth = (inboxWidth / 2)\n  let inboxOnSide = false\n\n  let xPos, yPos\n\n  const padding = 16\n\n  /**\n   * y co-ordinates:\n   * Try to push the card downwards\n   * if that's not possible, push it upwards\n   * if that too is not possible, then the card will be placed on the side. Add some padding.\n   *\n   * x co-ordinates:\n   * If the card is on the side,\n   *    try to place it to the right. If it's not possible,\n   *    place it to the left\n   * If the card is either on top/ bottom, set the x co-ordinate such that the selector center and the inbox card center become the same\n   * Now,\n   *  if the left of the inbox card is < 0,\n   *    try to get the left aligned to the selectorLeft.\n   *    if that's not possible, simply set left to 0\n   *  if the right of the inbox card > windowWidth,\n   *    try to get the right of rhe inbox card aligned with the selectorRight\n   *    if that's not possible, simply set the inbox right to the window Right\n   */\n  if (selectorBottom + inboxHeight <= windowHeight) { // try to place the card down\n    const availableHeight = windowHeight - (selectorBottom + inboxHeight)\n    yPos = availableHeight >= padding ? selectorBottom + padding : selectorBottom + availableHeight\n  } else if (selectorTop - inboxHeight >= verticalScroll) { // try to place the card up\n    const availableHeight = selectorTop - inboxHeight\n    yPos = availableHeight >= padding ? selectorTop - inboxHeight - padding : selectorTop - inboxHeight - availableHeight\n  } else {\n    inboxOnSide = true\n    yPos = selectorCenter.y - halfOfInboxHeight // with this the y co-ordinate of the selector center and the inbox card center become the same\n    if (yPos < verticalScroll) {\n      yPos = verticalScroll\n    } else if (yPos + inboxHeight > windowHeight) {\n      yPos = windowHeight - inboxHeight\n    }\n  }\n\n  if (inboxOnSide) {\n    // See if we can place the card to the right of the selector\n    const inboxRight = selectorRight + inboxWidth\n    if (inboxRight <= windowWidth) {\n      const availableWidth = inboxRight + padding <= windowWidth ? padding : windowWidth - inboxRight\n      xPos = selectorRight + availableWidth\n    } else {\n      const inboxLeft = selectorLeft - inboxWidth\n      const availableWidth = inboxLeft - padding >= horizontalScroll ? padding : inboxLeft - horizontalScroll\n      xPos = inboxLeft - availableWidth\n    }\n  } else {\n    xPos = selectorCenter.x - halfOfInboxWidth\n    if (xPos < horizontalScroll) {\n      if (selectorLeft + inboxWidth <= windowWidth) {\n        xPos = selectorLeft\n      } else {\n        xPos = horizontalScroll\n      }\n    } else if (xPos + inboxWidth > windowWidth) {\n      if (selectorRight - inboxWidth >= horizontalScroll) {\n        xPos = selectorRight - inboxWidth\n      } else {\n        xPos = windowWidth - inboxWidth\n      }\n    }\n  }\n\n  return { xPos, yPos }\n}\n\nexport const determineTimeStampText = (ts) => {\n  const now = Date.now()\n  let diff = Math.floor((now - ts) / 60000)\n  if (diff < 5) {\n    return 'Just now'\n  }\n  if (diff < 60) {\n    return `${diff} minute${diff > 1 ? 's' : ''} ago`\n  }\n  diff = Math.floor(diff / 60)\n  if (diff < 24) {\n    return `${diff} hour${diff > 1 ? 's' : ''} ago`\n  }\n  diff = Math.floor(diff / 24)\n  return `${diff} day${diff > 1 ? 's' : ''} ago`\n}\n\nexport const hasWebInboxSettingsInLS = () => {\n  return Object.keys(StorageManager.readFromLSorCookie(WEBINBOX_CONFIG) || {}).length > 0\n}\n\nexport const arrowSvg = `<svg width=\"6\" height=\"10\" viewBox=\"0 0 6 10\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M0.258435 9.74751C-0.0478584 9.44825 -0.081891 8.98373 0.156337 8.64775L0.258435 8.52836L3.87106 5L0.258435 1.47164C-0.0478588 1.17239 -0.0818914 0.707867 0.156337 0.371887L0.258435 0.252494C0.564728 -0.0467585 1.04018 -0.0800085 1.38407 0.152743L1.50627 0.252494L5.74156 4.39042C6.04786 4.68968 6.08189 5.1542 5.84366 5.49018L5.74156 5.60957L1.50627 9.74751C1.16169 10.0842 0.603015 10.0842 0.258435 9.74751Z\" fill=\"#63698F\"/>\n</svg>\n`\nexport const greenTickSvg = `<svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16C12.4183 16 16 12.4183 16 8ZM9.6839 5.93602C9.97083 5.55698 10.503 5.48833 10.8725 5.78269C11.2135 6.0544 11.2968 6.54044 11.0819 6.91173L11.0219 7.00198L8.09831 10.864C7.80581 11.2504 7.26654 11.3086 6.90323 11.0122L6.82822 10.9433L5.04597 9.10191C4.71635 8.76136 4.71826 8.21117 5.05023 7.87303C5.35666 7.5609 5.83722 7.53855 6.16859 7.80482L6.24814 7.87739L7.35133 9.01717L9.6839 5.93602Z\" fill=\"#03A387\"/>\n</svg>\n`\n","import {\n  addToLocalProfileMap,\n  arp,\n  getCampaignObject,\n  saveCampaignObject,\n  closeIframe\n} from './clevertap'\n\nimport {\n  CAMP_COOKIE_NAME,\n  DISPLAY,\n  GLOBAL,\n  EV_COOKIE,\n  NOTIFICATION_VIEWED,\n  NOTIFICATION_CLICKED,\n  WZRK_PREFIX,\n  WZRK_ID,\n  CAMP_COOKIE_G,\n  GCOOKIE_NAME\n} from './constants'\n\nimport {\n  getNow,\n  getToday\n} from './datetime'\n\nimport {\n  compressToBase64\n} from './encoder'\n\nimport { StorageManager, $ct } from './storage'\nimport RequestDispatcher from './requestDispatcher'\nimport { CTWebPersonalisationBanner } from './web-personalisation/banner'\nimport { CTWebPersonalisationCarousel } from './web-personalisation/carousel'\nimport { CTWebPopupImageOnly } from './web-popupImageonly/popupImageonly'\nimport { checkAndRegisterWebInboxElements, initializeWebInbox, processWebInboxSettings, hasWebInboxSettingsInLS, processInboxNotifs } from '../modules/web-inbox/helper'\n\nconst _tr = (msg, {\n  device,\n  session,\n  request,\n  logger,\n  isWebPopUpSpamControlDisabled\n}) => {\n  const _device = device\n  const _session = session\n  const _request = request\n  const _logger = logger\n  let _wizCounter = 0\n\n  // Campaign House keeping\n  const doCampHouseKeeping = (targetingMsgJson) => {\n    const campaignId = targetingMsgJson.wzrk_id.split('_')[0]\n    const today = getToday()\n\n    const incrCount = (obj, campaignId, excludeFromFreqCaps) => {\n      let currentCount = 0\n      let totalCount = 0\n      if (obj[campaignId] != null) {\n        currentCount = obj[campaignId]\n      }\n      currentCount++\n      if (obj.tc != null) {\n        totalCount = obj.tc\n      }\n      // if exclude from caps then dont add to total counts\n      if (excludeFromFreqCaps < 0) {\n        totalCount++\n      }\n\n      obj.tc = totalCount\n      obj[campaignId] = currentCount\n    }\n\n    if (StorageManager._isLocalStorageSupported()) {\n      delete sessionStorage[CAMP_COOKIE_NAME]\n      var campTypeObj = {}\n      const campObj = getCampaignObject()\n      if (targetingMsgJson.display.wtarget_type === 3 && campObj.hasOwnProperty('wi')) {\n        campTypeObj = campObj.wi\n      } else if ((targetingMsgJson.display.wtarget_type === 0 || targetingMsgJson.display.wtarget_type === 1) && campObj.hasOwnProperty('wp')) {\n        campTypeObj = campObj.wp\n      } else {\n        campTypeObj = {}\n      }\n      if (campObj.hasOwnProperty('global')) {\n        campTypeObj.wp = campObj\n      }\n      // global session limit. default is 1\n      if (targetingMsgJson[DISPLAY].wmc == null) {\n        targetingMsgJson[DISPLAY].wmc = 1\n      }\n\n      // global session limit for web inbox. default is 1\n      if (targetingMsgJson[DISPLAY].wimc == null) {\n        targetingMsgJson[DISPLAY].wimc = 1\n      }\n\n      var excludeFromFreqCaps = -1 // efc - Exclude from frequency caps\n      let campaignSessionLimit = -1 // mdc - Once per session\n      let campaignDailyLimit = -1 // tdc - Once per day\n      let campaignTotalLimit = -1 // tlc - Once per user for the duration of campaign\n      let totalDailyLimit = -1\n      let totalSessionLimit = -1 // wmc - Web Popup Global Session Limit\n      let totalInboxSessionLimit = -1 // wimc - Web Inbox Global Session Limit\n\n      if (targetingMsgJson[DISPLAY].efc != null) { // exclude from frequency cap\n        excludeFromFreqCaps = parseInt(targetingMsgJson[DISPLAY].efc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].mdc != null) { // Campaign Session Limit\n        campaignSessionLimit = parseInt(targetingMsgJson[DISPLAY].mdc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].tdc != null) { // No of web popups in a day per campaign\n        campaignDailyLimit = parseInt(targetingMsgJson[DISPLAY].tdc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].tlc != null) { // Total lifetime count\n        campaignTotalLimit = parseInt(targetingMsgJson[DISPLAY].tlc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].wmp != null) { // No of campaigns per day\n        totalDailyLimit = parseInt(targetingMsgJson[DISPLAY].wmp, 10)\n      }\n      if (targetingMsgJson[DISPLAY].wmc != null) { // No of campaigns per session\n        totalSessionLimit = parseInt(targetingMsgJson[DISPLAY].wmc, 10)\n      }\n\n      if (targetingMsgJson[DISPLAY].wimc != null) { // No of inbox campaigns per session\n        totalInboxSessionLimit = parseInt(targetingMsgJson[DISPLAY].wimc, 10)\n      }\n      // session level capping\n      var sessionObj = campTypeObj[_session.sessionId]\n      if (sessionObj) {\n        const campaignSessionCount = sessionObj[campaignId]\n        const totalSessionCount = sessionObj.tc\n        // dnd\n        if (campaignSessionCount === 'dnd' && !isWebPopUpSpamControlDisabled) {\n          return false\n        }\n\n        if (targetingMsgJson[DISPLAY].wtarget_type === 3) {\n          // Inbox session\n          if (totalInboxSessionLimit > 0 && totalSessionCount >= totalInboxSessionLimit && excludeFromFreqCaps < 0) {\n            return false\n          }\n        } else {\n          // session\n          if (totalSessionLimit > 0 && totalSessionCount >= totalSessionLimit && excludeFromFreqCaps < 0) {\n            return false\n          }\n        }\n\n        // campaign session\n        if (campaignSessionLimit > 0 && campaignSessionCount >= campaignSessionLimit) {\n          return false\n        }\n      } else {\n        sessionObj = {}\n        campTypeObj[_session.sessionId] = sessionObj\n      }\n\n      // daily level capping\n      var dailyObj = campTypeObj[today]\n      if (dailyObj != null) {\n        const campaignDailyCount = dailyObj[campaignId]\n        const totalDailyCount = dailyObj.tc\n        // daily\n        if (totalDailyLimit > 0 && totalDailyCount >= totalDailyLimit && excludeFromFreqCaps < 0) {\n          return false\n        }\n        // campaign daily\n        if (campaignDailyLimit > 0 && campaignDailyCount >= campaignDailyLimit) {\n          return false\n        }\n      } else {\n        dailyObj = {}\n        campTypeObj[today] = dailyObj\n      }\n\n      var globalObj = campTypeObj[GLOBAL]\n      if (globalObj != null) {\n        const campaignTotalCount = globalObj[campaignId]\n        // campaign total\n        if (campaignTotalLimit > 0 && campaignTotalCount >= campaignTotalLimit) {\n          return false\n        }\n      } else {\n        globalObj = {}\n        campTypeObj[GLOBAL] = globalObj\n      }\n    }\n    // delay\n    if (targetingMsgJson[DISPLAY].delay != null && targetingMsgJson[DISPLAY].delay > 0) {\n      const delay = targetingMsgJson[DISPLAY].delay\n      targetingMsgJson[DISPLAY].delay = 0\n      setTimeout(_tr, delay * 1000, msg, {\n        device: _device,\n        session: _session,\n        request: _request,\n        logger: _logger\n      })\n      return false\n    }\n\n    incrCount(sessionObj, campaignId, excludeFromFreqCaps)\n    incrCount(dailyObj, campaignId, excludeFromFreqCaps)\n    incrCount(globalObj, campaignId, excludeFromFreqCaps)\n\n    let campKey = 'wp'\n    if (targetingMsgJson[DISPLAY].wtarget_type === 3) {\n      campKey = 'wi'\n    }\n    // get ride of stale sessions and day entries\n    const newCampObj = {}\n    newCampObj[_session.sessionId] = sessionObj\n    newCampObj[today] = dailyObj\n    newCampObj[GLOBAL] = globalObj\n    saveCampaignObject({ [campKey]: newCampObj })\n  }\n\n  const getCookieParams = () => {\n    const gcookie = _device.getGuid()\n    const scookieObj = _session.getSessionCookieObject()\n    return '&t=wc&d=' + encodeURIComponent(compressToBase64(gcookie + '|' + scookieObj.p + '|' + scookieObj.s))\n  }\n\n  const setupClickEvent = (onClick, targetingMsgJson, contentDiv, divId, isLegacy) => {\n    if (onClick !== '' && onClick != null) {\n      let ctaElement\n      let jsCTAElements\n      if (isLegacy) {\n        ctaElement = contentDiv\n      } else if (contentDiv !== null) {\n        jsCTAElements = contentDiv.getElementsByClassName('jsCT_CTA')\n        if (jsCTAElements != null && jsCTAElements.length === 1) {\n          ctaElement = jsCTAElements[0]\n        }\n      }\n      const jsFunc = targetingMsgJson.display.jsFunc\n      const isPreview = targetingMsgJson.display.preview\n      if (isPreview == null) {\n        onClick += getCookieParams()\n      }\n\n      if (ctaElement != null) {\n        ctaElement.onclick = () => {\n          // invoke js function call\n          if (jsFunc != null) {\n            // track notification clicked event\n            if (isPreview == null) {\n              RequestDispatcher.fireRequest(onClick)\n            }\n            invokeExternalJs(jsFunc, targetingMsgJson)\n            // close iframe. using -1 for no campaignId\n            closeIframe('-1', divId, _session.sessionId)\n            return\n          }\n          // pass on the gcookie|page|scookieId for capturing the click event\n          if (targetingMsgJson.display.window === 1) {\n            window.open(onClick, '_blank')\n          } else {\n            window.location = onClick\n          }\n        }\n      }\n    }\n  }\n\n  const invokeExternalJs = (jsFunc, targetingMsgJson) => {\n    const func = window.parent[jsFunc]\n    if (typeof func === 'function') {\n      if (targetingMsgJson.display.kv != null) {\n        func(targetingMsgJson.display.kv)\n      } else {\n        func()\n      }\n    }\n  }\n\n  const setupClickUrl = (onClick, targetingMsgJson, contentDiv, divId, isLegacy) => {\n    incrementImpression(targetingMsgJson)\n    setupClickEvent(onClick, targetingMsgJson, contentDiv, divId, isLegacy)\n  }\n\n  const incrementImpression = (targetingMsgJson) => {\n    const data = {}\n    data.type = 'event'\n    data.evtName = NOTIFICATION_VIEWED\n    data.evtData = { [WZRK_ID]: targetingMsgJson.wzrk_id }\n    if (targetingMsgJson.wzrk_pivot) {\n      data.evtData = { ...data.evtData, wzrk_pivot: targetingMsgJson.wzrk_pivot }\n    }\n    _request.processEvent(data)\n  }\n\n  const renderPersonalisationBanner = (targetingMsgJson) => {\n    if (customElements.get('ct-web-personalisation-banner') === undefined) {\n      customElements.define('ct-web-personalisation-banner', CTWebPersonalisationBanner)\n    }\n    const divId = targetingMsgJson.display.divId ?? targetingMsgJson.display.divSelector\n    const bannerEl = document.createElement('ct-web-personalisation-banner')\n    bannerEl.msgId = targetingMsgJson.wzrk_id\n    bannerEl.pivotId = targetingMsgJson.wzrk_pivot\n    bannerEl.divHeight = targetingMsgJson.display.divHeight\n    bannerEl.details = targetingMsgJson.display.details[0]\n    const containerEl = targetingMsgJson.display.divId ? document.getElementById(divId) : document.querySelector(divId)\n    containerEl.innerHTML = ''\n    containerEl.appendChild(bannerEl)\n  }\n\n  const renderPersonalisationCarousel = (targetingMsgJson) => {\n    if (customElements.get('ct-web-personalisation-carousel') === undefined) {\n      customElements.define('ct-web-personalisation-carousel', CTWebPersonalisationCarousel)\n    }\n    const divId = targetingMsgJson.display.divId ?? targetingMsgJson.display.divSelector\n    const carousel = document.createElement('ct-web-personalisation-carousel')\n    carousel.target = targetingMsgJson\n    const container = targetingMsgJson.display.divId ? document.getElementById(divId) : document.querySelector(divId)\n    container.innerHTML = ''\n    container.appendChild(carousel)\n  }\n\n  const renderPopUpImageOnly = (targetingMsgJson) => {\n    const divId = 'wzrkImageOnlyDiv'\n    const popupImageOnly = document.createElement('ct-web-popup-imageonly')\n    popupImageOnly.session = _session\n    popupImageOnly.target = targetingMsgJson\n    const containerEl = document.getElementById(divId)\n    containerEl.innerHTML = ''\n    containerEl.style.visibility = 'hidden'\n    containerEl.appendChild(popupImageOnly)\n  }\n\n  const renderFooterNotification = (targetingMsgJson) => {\n    const campaignId = targetingMsgJson.wzrk_id.split('_')[0]\n    const displayObj = targetingMsgJson.display\n\n    if (displayObj.wtarget_type === 2) { // Handling Web Native display\n      // Logic for kv pair data\n      if (targetingMsgJson.msgContent.type === 1) {\n        const inaObj = {}\n\n        inaObj.msgId = targetingMsgJson.wzrk_id\n        if (targetingMsgJson.wzrk_pivot) {\n          inaObj.pivotId = targetingMsgJson.wzrk_pivot\n        }\n        if (targetingMsgJson.msgContent.kv != null) {\n          inaObj.kv = targetingMsgJson.msgContent.kv\n        }\n        const kvPairsEvent = new CustomEvent('CT_web_native_display', { detail: inaObj })\n        document.dispatchEvent(kvPairsEvent)\n        return\n      }\n    }\n    if (displayObj.layout === 1) { // Handling Web Exit Intent\n      return showExitIntent(undefined, targetingMsgJson)\n    }\n    if (displayObj.layout === 3) { // Handling Web Popup Image Only\n      const divId = 'wzrkImageOnlyDiv'\n      if (doCampHouseKeeping(targetingMsgJson) === false) {\n        return\n      }\n      if (isWebPopUpSpamControlDisabled && document.getElementById(divId) != null) {\n        const element = document.getElementById(divId)\n        element.remove()\n      }\n      if (document.getElementById(divId) != null) {\n        return\n      }\n      const msgDiv = document.createElement('div')\n      msgDiv.id = divId\n      document.body.appendChild(msgDiv)\n      if (customElements.get('ct-web-popup-imageonly') === undefined) {\n        customElements.define('ct-web-popup-imageonly', CTWebPopupImageOnly)\n      }\n      return renderPopUpImageOnly(targetingMsgJson)\n    }\n\n    if (doCampHouseKeeping(targetingMsgJson) === false) {\n      return\n    }\n\n    const divId = 'wizParDiv' + displayObj.layout\n\n    if (isWebPopUpSpamControlDisabled && document.getElementById(divId) != null) {\n      const element = document.getElementById(divId)\n      element.remove()\n    }\n    if (document.getElementById(divId) != null) {\n      return\n    }\n    $ct.campaignDivMap[campaignId] = divId\n    const isBanner = displayObj.layout === 2\n    const msgDiv = document.createElement('div')\n    msgDiv.id = divId\n    const viewHeight = window.innerHeight\n    const viewWidth = window.innerWidth\n    let legacy = false\n\n    if (!isBanner) {\n      const marginBottom = viewHeight * 5 / 100\n      var contentHeight = 10\n      let right = viewWidth * 5 / 100\n      let bottomPosition = contentHeight + marginBottom\n      let width = viewWidth * 30 / 100 + 20\n      let widthPerct = 'width:30%;'\n      // for small devices  - mobile phones\n      if ((/mobile/i.test(navigator.userAgent) || (/mini/i.test(navigator.userAgent))) && /iPad/i.test(navigator.userAgent) === false) {\n        width = viewWidth * 85 / 100 + 20\n        right = viewWidth * 5 / 100\n        bottomPosition = viewHeight * 5 / 100\n        widthPerct = 'width:80%;'\n        // medium devices - tablets\n      } else if ('ontouchstart' in window || (/tablet/i.test(navigator.userAgent))) {\n        width = viewWidth * 50 / 100 + 20\n        right = viewWidth * 5 / 100\n        bottomPosition = viewHeight * 5 / 100\n        widthPerct = 'width:50%;'\n      }\n      // legacy footer notif\n      if (displayObj.proto == null) {\n        legacy = true\n        msgDiv.setAttribute('style', 'display:block;overflow:hidden; bottom:' + bottomPosition + 'px !important;width:' + width + 'px !important;right:' + right + 'px !important;position:fixed;z-index:2147483647;')\n      } else {\n        msgDiv.setAttribute('style', widthPerct + displayObj.iFrameStyle)\n      }\n    } else {\n      msgDiv.setAttribute('style', displayObj.iFrameStyle)\n    }\n    document.body.appendChild(msgDiv)\n    const iframe = document.createElement('iframe')\n\n    const borderRadius = displayObj.br === false ? '0' : '8'\n\n    iframe.frameborder = '0px'\n    iframe.marginheight = '0px'\n    iframe.marginwidth = '0px'\n    iframe.scrolling = 'no'\n    iframe.id = 'wiz-iframe'\n    const onClick = targetingMsgJson.display.onClick\n    let pointerCss = ''\n    if (onClick !== '' && onClick != null) {\n      pointerCss = 'cursor:pointer;'\n    }\n\n    let html\n    // direct html\n    if (targetingMsgJson.msgContent.type === 1) {\n      html = targetingMsgJson.msgContent.html\n      html = html.replace(/##campaignId##/g, campaignId)\n      html = html.replace(/##campaignId_batchId##/g, targetingMsgJson.wzrk_id)\n    } else {\n      const css = '' +\n        '<style type=\"text/css\">' +\n        'body{margin:0;padding:0;}' +\n        '#contentDiv.wzrk{overflow:hidden;padding:0;text-align:center;' + pointerCss + '}' +\n        '#contentDiv.wzrk td{padding:15px 10px;}' +\n        '.wzrkPPtitle{font-weight: bold;font-size: 16px;font-family:arial;padding-bottom:10px;word-break: break-word;}' +\n        '.wzrkPPdscr{font-size: 14px;font-family:arial;line-height:16px;word-break: break-word;display:inline-block;}' +\n        '.PL15{padding-left:15px;}' +\n        '.wzrkPPwarp{margin:20px 20px 0 5px;padding:0px;border-radius: ' + borderRadius + 'px;box-shadow: 1px 1px 5px #888888;}' +\n        'a.wzrkClose{cursor:pointer;position: absolute;top: 11px;right: 11px;z-index: 2147483647;font-size:19px;font-family:arial;font-weight:bold;text-decoration: none;width: 25px;/*height: 25px;*/text-align: center; -webkit-appearance: none; line-height: 25px;' +\n        'background: #353535;border: #fff 2px solid;border-radius: 100%;box-shadow: #777 2px 2px 2px;color:#fff;}' +\n        'a:hover.wzrkClose{background-color:#d1914a !important;color:#fff !important; -webkit-appearance: none;}' +\n        'td{vertical-align:top;}' +\n        'td.imgTd{border-top-left-radius:8px;border-bottom-left-radius:8px;}' +\n        '</style>'\n\n      let bgColor, textColor, btnBg, leftTd, btColor\n      if (targetingMsgJson.display.theme === 'dark') {\n        bgColor = '#2d2d2e'\n        textColor = '#eaeaea'\n        btnBg = '#353535'\n        leftTd = '#353535'\n        btColor = '#ffffff'\n      } else {\n        bgColor = '#ffffff'\n        textColor = '#000000'\n        leftTd = '#f4f4f4'\n        btnBg = '#a5a6a6'\n        btColor = '#ffffff'\n      }\n      const titleText = targetingMsgJson.msgContent.title\n      const descriptionText = targetingMsgJson.msgContent.description\n      let imageTd = ''\n      if (targetingMsgJson.msgContent.imageUrl != null && targetingMsgJson.msgContent.imageUrl !== '') {\n        imageTd = \"<td class='imgTd' style='background-color:\" + leftTd + \"'><img src='\" + targetingMsgJson.msgContent.imageUrl + \"' height='60' width='60'></td>\"\n      }\n      const onClickStr = 'parent.$WZRK_WR.closeIframe(' + campaignId + \",'\" + divId + \"');\"\n      const title = \"<div class='wzrkPPwarp' style='color:\" + textColor + ';background-color:' + bgColor + \";'>\" +\n        \"<a href='javascript:void(0);' onclick=\" + onClickStr + \" class='wzrkClose' style='background-color:\" + btnBg + ';color:' + btColor + \"'>&times;</a>\" +\n        \"<div id='contentDiv' class='wzrk'>\" +\n        \"<table cellpadding='0' cellspacing='0' border='0'>\" +\n        // \"<tr><td colspan='2'></td></tr>\"+\n        '<tr>' + imageTd + \"<td style='vertical-align:top;'>\" +\n        \"<div class='wzrkPPtitle' style='color:\" + textColor + \"'>\" + titleText + '</div>'\n      const body = \"<div class='wzrkPPdscr' style='color:\" + textColor + \"'>\" + descriptionText + '<div></td></tr></table></div>'\n      html = css + title + body\n    }\n\n    iframe.setAttribute('style', 'z-index: 2147483647; display:block; width: 100% !important; border:0px !important; border-color:none !important;')\n    msgDiv.appendChild(iframe)\n    const ifrm = (iframe.contentWindow) ? iframe.contentWindow : (iframe.contentDocument.document) ? iframe.contentDocument.document : iframe.contentDocument\n    const doc = ifrm.document\n\n    doc.open()\n    doc.write(html)\n\n    if (displayObj['custom-editor']) {\n      appendScriptForCustomEvent(targetingMsgJson, doc)\n    }\n    doc.close()\n\n    const adjustIFrameHeight = () => {\n      // adjust iframe and body height of html inside correctly\n      contentHeight = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv').scrollHeight\n      if (displayObj['custom-editor'] !== true && !isBanner) {\n        contentHeight += 25\n      }\n      document.getElementById('wiz-iframe').contentDocument.body.style.margin = '0px'\n      document.getElementById('wiz-iframe').style.height = contentHeight + 'px'\n    }\n\n    const ua = navigator.userAgent.toLowerCase()\n    if (ua.indexOf('safari') !== -1) {\n      if (ua.indexOf('chrome') > -1) {\n        iframe.onload = () => {\n          adjustIFrameHeight()\n          const contentDiv = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv')\n          setupClickUrl(onClick, targetingMsgJson, contentDiv, divId, legacy)\n        }\n      } else {\n        let inDoc = iframe.contentDocument || iframe.contentWindow\n        if (inDoc.document) inDoc = inDoc.document\n        // safari iphone 7+ needs this.\n        adjustIFrameHeight()\n        const _timer = setInterval(() => {\n          if (inDoc.readyState === 'complete') {\n            clearInterval(_timer)\n            // adjust iframe and body height of html inside correctly\n            adjustIFrameHeight()\n            const contentDiv = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv')\n            setupClickUrl(onClick, targetingMsgJson, contentDiv, divId, legacy)\n          }\n        }, 10)\n      }\n    } else {\n      iframe.onload = () => {\n        // adjust iframe and body height of html inside correctly\n        adjustIFrameHeight()\n        const contentDiv = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv')\n        setupClickUrl(onClick, targetingMsgJson, contentDiv, divId, legacy)\n      }\n    }\n  }\n\n  const appendScriptForCustomEvent = (targetingMsgJson, doc) => {\n    const script = doc.createElement('script')\n    script.innerHTML = `\n      const ct__camapignId = '${targetingMsgJson.wzrk_id}';\n      const ct__formatVal = (v) => {\n          return v && v.trim().substring(0, 20);\n      }\n      const ct__parentOrigin =  window.parent.origin;\n      document.body.addEventListener('click', (event) => {\n        const elem = event.target.closest?.('a[wzrk_c2a], button[wzrk_c2a]');\n        if (elem) {\n            const {innerText, id, name, value, href} = elem;\n            const clickAttr = elem.getAttribute('onclick') || elem.getAttribute('click');\n            const onclickURL = clickAttr?.match(/(window.open)[(\\](\\\"|')(.*)(\\\"|',)/)?.[3] || clickAttr?.match(/(location.href *= *)(\\\"|')(.*)(\\\"|')/)?.[3];\n            const props = {innerText, id, name, value};\n            let msgCTkv = Object.keys(props).reduce((acc, c) => {\n                const formattedVal = ct__formatVal(props[c]);\n                formattedVal && (acc['wzrk_click_' + c] = formattedVal);\n                return acc;\n            }, {});\n            if(onclickURL) { msgCTkv['wzrk_click_' + 'url'] = onclickURL; }\n            if(href) { msgCTkv['wzrk_click_' + 'c2a'] = href; }\n            const notifData = { msgId: ct__camapignId, msgCTkv, pivotId: '${targetingMsgJson.wzrk_pivot}' };\n            window.parent.clevertap.renderNotificationClicked(notifData);\n        }\n      });\n    `\n    doc.body.appendChild(script)\n  }\n\n  let _callBackCalled = false\n\n  const showFooterNotification = (targetingMsgJson) => {\n    let onClick = targetingMsgJson.display.onClick\n\n    // TODO: Needs wizrocket as a global variable\n    if (window.clevertap.hasOwnProperty('notificationCallback') &&\n      typeof window.clevertap.notificationCallback !== 'undefined' &&\n      typeof window.clevertap.notificationCallback === 'function') {\n      const notificationCallback = window.clevertap.notificationCallback\n\n      if (!_callBackCalled) {\n        const inaObj = {}\n        inaObj.msgContent = targetingMsgJson.msgContent\n        inaObj.msgId = targetingMsgJson.wzrk_id\n        if (targetingMsgJson.wzrk_pivot) {\n          inaObj.pivotId = targetingMsgJson.wzrk_pivot\n        }\n        if (targetingMsgJson.display.kv != null) {\n          inaObj.kv = targetingMsgJson.display.kv\n        }\n\n        window.clevertap.raiseNotificationClicked = () => {\n          if (onClick !== '' && onClick != null) {\n            const jsFunc = targetingMsgJson.display.jsFunc\n            onClick += getCookieParams()\n\n            // invoke js function call\n            if (jsFunc != null) {\n              // track notification clicked event\n              RequestDispatcher.fireRequest(onClick)\n              invokeExternalJs(jsFunc, targetingMsgJson)\n              return\n            }\n            // pass on the gcookie|page|scookieId for capturing the click event\n            if (targetingMsgJson.display.window === 1) {\n              window.open(onClick, '_blank')\n            } else {\n              window.location = onClick\n            }\n          }\n        }\n        window.clevertap.raiseNotificationViewed = () => {\n          incrementImpression(targetingMsgJson)\n        }\n        notificationCallback(inaObj)\n        _callBackCalled = true\n      }\n    } else {\n      window.clevertap.popupCurrentWzrkId = targetingMsgJson.wzrk_id\n      renderFooterNotification(targetingMsgJson)\n\n      if (window.clevertap.hasOwnProperty('popupCallbacks') &&\n        typeof window.clevertap.popupCallbacks !== 'undefined' &&\n        typeof window.clevertap.popupCallbacks[targetingMsgJson.wzrk_id] === 'function') {\n        const popupCallback = window.clevertap.popupCallbacks[targetingMsgJson.wzrk_id]\n\n        const inaObj = {}\n        inaObj.msgContent = targetingMsgJson.msgContent\n        inaObj.msgId = targetingMsgJson.wzrk_id\n\n        if (targetingMsgJson.wzrk_pivot) {\n          inaObj.pivotId = targetingMsgJson.wzrk_pivot\n        }\n\n        var msgCTkv = []\n        for (var wzrkPrefixKey in targetingMsgJson) {\n          // ADD WZRK PREFIX KEY VALUE PAIRS\n          if (wzrkPrefixKey.startsWith(WZRK_PREFIX) && wzrkPrefixKey !== WZRK_ID) {\n            const wzrkJson = { [wzrkPrefixKey]: targetingMsgJson[wzrkPrefixKey] }\n            msgCTkv.push(wzrkJson)\n          }\n        }\n\n        if (msgCTkv.length > 0) {\n          inaObj.msgCTkv = msgCTkv\n        }\n        if (targetingMsgJson.display.kv != null) {\n          inaObj.kv = targetingMsgJson.display.kv\n        }\n\n        // PUBLIC API TO RECORD CLICKED EVENT\n        window.clevertap.raisePopupNotificationClicked = (notificationData) => {\n          if (!notificationData || !notificationData.msgId) { return }\n\n          const eventData = {}\n          eventData.type = 'event'\n          eventData.evtName = NOTIFICATION_CLICKED\n          eventData.evtData = { [WZRK_ID]: notificationData.msgId }\n          if (targetingMsgJson.wzrk_pivot) {\n            eventData.evtData = { ...eventData.evtData, wzrk_pivot: notificationData.pivotId }\n          }\n\n          // WZRK PREFIX KEY VALUE PAIRS\n          if (notificationData.msgCTkv) {\n            for (var wzrkPrefixObj of notificationData.msgCTkv) {\n              eventData.evtData = { ...eventData.evtData, ...wzrkPrefixObj }\n            }\n          }\n\n          _request.processEvent(eventData)\n        }\n        popupCallback(inaObj)\n      }\n    }\n  }\n\n  let exitintentObj\n  const showExitIntent = (event, targetObj) => {\n    let targetingMsgJson\n    if (event != null && event.clientY > 0) {\n      return\n    }\n    if (targetObj == null) {\n      targetingMsgJson = exitintentObj\n    } else {\n      targetingMsgJson = targetObj\n    }\n\n    if (isWebPopUpSpamControlDisabled && targetingMsgJson.display.wtarget_type === 0 && document.getElementById('intentPreview') != null && document.getElementById('intentOpacityDiv') != null) {\n      const element = document.getElementById('intentPreview')\n      element.remove()\n      document.getElementById('intentOpacityDiv').remove()\n    }\n\n    if (document.getElementById('intentPreview') != null) {\n      return\n    }\n    // dont show exit intent on tablet/mobile - only on desktop\n    if (targetingMsgJson.display.layout == null &&\n      ((/mobile/i.test(navigator.userAgent)) || (/mini/i.test(navigator.userAgent)) || (/iPad/i.test(navigator.userAgent)) ||\n        ('ontouchstart' in window) || (/tablet/i.test(navigator.userAgent)))) {\n      return\n    }\n\n    if (doCampHouseKeeping(targetingMsgJson) === false) {\n      return\n    }\n    const campaignId = targetingMsgJson.wzrk_id.split('_')[0]\n    $ct.campaignDivMap[campaignId] = 'intentPreview'\n    let legacy = false\n    const opacityDiv = document.createElement('div')\n    opacityDiv.id = 'intentOpacityDiv'\n    opacityDiv.setAttribute('style', 'position: fixed;top: 0;bottom: 0;left: 0;width: 100%;height: 100%;z-index: 2147483646;background: rgba(0,0,0,0.7);')\n    document.body.appendChild(opacityDiv)\n\n    const msgDiv = document.createElement('div')\n    msgDiv.id = 'intentPreview'\n\n    if (targetingMsgJson.display.proto == null) {\n      legacy = true\n      msgDiv.setAttribute('style', 'display:block;overflow:hidden;top:55% !important;left:50% !important;position:fixed;z-index:2147483647;width:600px !important;height:600px !important;margin:-300px 0 0 -300px !important;')\n    } else {\n      msgDiv.setAttribute('style', targetingMsgJson.display.iFrameStyle)\n    }\n    document.body.appendChild(msgDiv)\n    const iframe = document.createElement('iframe')\n    const borderRadius = targetingMsgJson.display.br === false ? '0' : '8'\n    iframe.frameborder = '0px'\n    iframe.marginheight = '0px'\n    iframe.marginwidth = '0px'\n    iframe.scrolling = 'no'\n    iframe.id = 'wiz-iframe-intent'\n    const onClick = targetingMsgJson.display.onClick\n    let pointerCss = ''\n    if (onClick !== '' && onClick != null) {\n      pointerCss = 'cursor:pointer;'\n    }\n    let html\n    // direct html\n    if (targetingMsgJson.msgContent.type === 1) {\n      html = targetingMsgJson.msgContent.html\n      html = html.replace(/##campaignId##/g, campaignId)\n      html = html.replace(/##campaignId_batchId##/g, targetingMsgJson.wzrk_id)\n    } else {\n      const css = '' +\n        '<style type=\"text/css\">' +\n        'body{margin:0;padding:0;}' +\n        '#contentDiv.wzrk{overflow:hidden;padding:0 0 20px 0;text-align:center;' + pointerCss + '}' +\n        '#contentDiv.wzrk td{padding:15px 10px;}' +\n        '.wzrkPPtitle{font-weight: bold;font-size: 24px;font-family:arial;word-break: break-word;padding-top:20px;}' +\n        '.wzrkPPdscr{font-size: 14px;font-family:arial;line-height:16px;word-break: break-word;display:inline-block;padding:20px 20px 0 20px;line-height:20px;}' +\n        '.PL15{padding-left:15px;}' +\n        '.wzrkPPwarp{margin:20px 20px 0 5px;padding:0px;border-radius: ' + borderRadius + 'px;box-shadow: 1px 1px 5px #888888;}' +\n        'a.wzrkClose{cursor:pointer;position: absolute;top: 11px;right: 11px;z-index: 2147483647;font-size:19px;font-family:arial;font-weight:bold;text-decoration: none;width: 25px;/*height: 25px;*/text-align: center; -webkit-appearance: none; line-height: 25px;' +\n        'background: #353535;border: #fff 2px solid;border-radius: 100%;box-shadow: #777 2px 2px 2px;color:#fff;}' +\n        'a:hover.wzrkClose{background-color:#d1914a !important;color:#fff !important; -webkit-appearance: none;}' +\n        '#contentDiv .button{padding-top:20px;}' +\n        '#contentDiv .button a{font-size: 14px;font-weight:bold;font-family:arial;text-align:center;display:inline-block;text-decoration:none;padding:0 30px;height:40px;line-height:40px;background:#ea693b;color:#fff;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;}' +\n        '</style>'\n\n      let bgColor, textColor, btnBg, btColor\n      if (targetingMsgJson.display.theme === 'dark') {\n        bgColor = '#2d2d2e'\n        textColor = '#eaeaea'\n        btnBg = '#353535'\n        btColor = '#ffffff'\n      } else {\n        bgColor = '#ffffff'\n        textColor = '#000000'\n        btnBg = '#a5a6a6'\n        btColor = '#ffffff'\n      }\n      const titleText = targetingMsgJson.msgContent.title\n      const descriptionText = targetingMsgJson.msgContent.description\n      let ctaText = ''\n      if (targetingMsgJson.msgContent.ctaText != null && targetingMsgJson.msgContent.ctaText !== '') {\n        ctaText = \"<div class='button'><a href='#'>\" + targetingMsgJson.msgContent.ctaText + '</a></div>'\n      }\n\n      let imageTd = ''\n      if (targetingMsgJson.msgContent.imageUrl != null && targetingMsgJson.msgContent.imageUrl !== '') {\n        imageTd = \"<div style='padding-top:20px;'><img src='\" + targetingMsgJson.msgContent.imageUrl + \"' width='500' alt=\" + titleText + ' /></div>'\n      }\n      const onClickStr = 'parent.$WZRK_WR.closeIframe(' + campaignId + \",'intentPreview');\"\n      const title = \"<div class='wzrkPPwarp' style='color:\" + textColor + ';background-color:' + bgColor + \";'>\" +\n        \"<a href='javascript:void(0);' onclick=\" + onClickStr + \" class='wzrkClose' style='background-color:\" + btnBg + ';color:' + btColor + \"'>&times;</a>\" +\n        \"<div id='contentDiv' class='wzrk'>\" +\n        \"<div class='wzrkPPtitle' style='color:\" + textColor + \"'>\" + titleText + '</div>'\n      const body = \"<div class='wzrkPPdscr' style='color:\" + textColor + \"'>\" + descriptionText + '</div>' + imageTd + ctaText +\n        '</div></div>'\n      html = css + title + body\n    }\n    iframe.setAttribute('style', 'z-index: 2147483647; display:block; height: 100% !important; width: 100% !important;min-height:80px !important;border:0px !important; border-color:none !important;')\n    msgDiv.appendChild(iframe)\n    const ifrm = (iframe.contentWindow) ? iframe.contentWindow : (iframe.contentDocument.document) ? iframe.contentDocument.document : iframe.contentDocument\n    const doc = ifrm.document\n\n    doc.open()\n    doc.write(html)\n    if (targetingMsgJson.display['custom-editor']) {\n      appendScriptForCustomEvent(targetingMsgJson, doc)\n    }\n    doc.close()\n\n    const contentDiv = document.getElementById('wiz-iframe-intent').contentDocument.getElementById('contentDiv')\n    setupClickUrl(onClick, targetingMsgJson, contentDiv, 'intentPreview', legacy)\n  }\n\n  if (!document.body) {\n    if (_wizCounter < 6) {\n      _wizCounter++\n      setTimeout(_tr, 1000, msg, {\n        device: _device,\n        session: _session,\n        request: _request,\n        logger: _logger\n      })\n    }\n    return\n  }\n  const processNativeDisplayArr = (arrInAppNotifs) => {\n    Object.keys(arrInAppNotifs).map(key => {\n      var elementId, id\n      if (arrInAppNotifs[key].display.divId) {\n        elementId = arrInAppNotifs[key].display.divId\n        id = document.getElementById(elementId)\n      } else {\n        elementId = arrInAppNotifs[key].display.divSelector\n        id = document.querySelector(elementId)\n      }\n      if (id !== null) {\n        arrInAppNotifs[key].msgContent.type === 2 ? renderPersonalisationBanner(arrInAppNotifs[key]) : renderPersonalisationCarousel(arrInAppNotifs[key])\n        delete arrInAppNotifs[key]\n      }\n    })\n  }\n\n  const addLoadListener = (arrInAppNotifs) => {\n    window.addEventListener('load', () => {\n      let count = 0\n      if (count < 20) {\n        const t = setInterval(() => {\n          processNativeDisplayArr(arrInAppNotifs)\n          if (Object.keys(arrInAppNotifs).length === 0 || count === 20) {\n            clearInterval(t)\n            arrInAppNotifs = {}\n          }\n          count++\n        }, 500)\n      }\n    })\n  }\n\n  if (msg.inapp_notifs != null) {\n    const arrInAppNotifs = {}\n    for (let index = 0; index < msg.inapp_notifs.length; index++) {\n      const targetNotif = msg.inapp_notifs[index]\n      if (targetNotif.display.wtarget_type == null || targetNotif.display.wtarget_type === 0) {\n        showFooterNotification(targetNotif)\n      } else if (targetNotif.display.wtarget_type === 1) { // if display['wtarget_type']==1 then exit intent\n        exitintentObj = targetNotif\n        window.document.body.onmouseleave = showExitIntent\n      } else if (targetNotif.display.wtarget_type === 2) { // if display['wtarget_type']==2 then web native display\n        if (targetNotif.msgContent.type === 2 || targetNotif.msgContent.type === 3) { // Check for banner and carousel\n          const element = targetNotif.display.divId ? document.getElementById(targetNotif.display.divId) : document.querySelector(targetNotif.display.divSelector)\n          if (element !== null) {\n            targetNotif.msgContent.type === 2 ? renderPersonalisationBanner(targetNotif) : renderPersonalisationCarousel(targetNotif)\n          } else {\n            arrInAppNotifs[targetNotif.wzrk_id.split('_')[0]] = targetNotif // Add targetNotif to object\n          }\n        } else {\n          showFooterNotification(targetNotif)\n        }\n      }\n    }\n    // Process banner or carousel campaign array\n    if (Object.keys(arrInAppNotifs).length) {\n      if (document.readyState === 'complete') {\n        processNativeDisplayArr(arrInAppNotifs)\n      } else {\n        addLoadListener(arrInAppNotifs)\n      }\n    }\n  }\n\n  const mergeEventMap = (newEvtMap) => {\n    if ($ct.globalEventsMap == null) {\n      $ct.globalEventsMap = StorageManager.readFromLSorCookie(EV_COOKIE)\n      if ($ct.globalEventsMap == null) {\n        $ct.globalEventsMap = newEvtMap\n        return\n      }\n    }\n    for (const key in newEvtMap) {\n      if (newEvtMap.hasOwnProperty(key)) {\n        const oldEvtObj = $ct.globalEventsMap[key]\n        const newEvtObj = newEvtMap[key]\n        if ($ct.globalEventsMap[key] != null) {\n          if (newEvtObj[0] != null && newEvtObj[0] > oldEvtObj[0]) {\n            $ct.globalEventsMap[key] = newEvtObj\n          }\n        } else {\n          $ct.globalEventsMap[key] = newEvtObj\n        }\n      }\n    }\n  }\n\n  const handleInboxNotifications = () => {\n    if (msg.inbox_preview) {\n      processInboxNotifs(msg)\n      return\n    }\n    if (msg.inbox_notifs) {\n      const msgArr = []\n      for (let index = 0; index < msg.inbox_notifs.length; index++) {\n        if (doCampHouseKeeping(msg.inbox_notifs[index]) !== false) {\n          msgArr.push(msg.inbox_notifs[index])\n        }\n      }\n      processInboxNotifs(msgArr)\n    }\n  }\n\n  if (msg.webInboxSetting || msg.inbox_notifs != null) {\n    /**\n     * When the user visits a website for the 1st time after web inbox channel is setup,\n     * we need to initialise the inbox here because the initializeWebInbox method within init will not be executed\n     * as we would not have any entry related to webInboxSettings in the LS\n     */\n\n    if (hasWebInboxSettingsInLS()) {\n      checkAndRegisterWebInboxElements()\n    }\n    if ($ct.inbox === null) {\n      msg.webInboxSetting && processWebInboxSettings(msg.webInboxSetting)\n      initializeWebInbox(_logger)\n        .then(() => {\n          handleInboxNotifications()\n        })\n        .catch(e => {})\n    } else {\n      handleInboxNotifications()\n    }\n  }\n\n  const staleDataUpdate = (staledata, campType) => {\n    const campObj = getCampaignObject()\n    const globalObj = campObj[campType].global\n    if (globalObj != null && campType) {\n      for (const idx in staledata) {\n        if (staledata.hasOwnProperty(idx)) {\n          delete globalObj[staledata[idx]]\n          if (StorageManager.read(CAMP_COOKIE_G)) {\n            const guidCampObj = JSON.parse(decodeURIComponent(StorageManager.read(CAMP_COOKIE_G)))\n            const guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n            if (guidCampObj[guid] && guidCampObj[guid][campType] && guidCampObj[guid][campType][staledata[idx]]) {\n              delete guidCampObj[guid][campType][staledata[idx]]\n              StorageManager.save(CAMP_COOKIE_G, encodeURIComponent(JSON.stringify(guidCampObj)))\n            }\n          }\n        }\n      }\n    }\n    saveCampaignObject(campObj)\n  }\n\n  if (StorageManager._isLocalStorageSupported()) {\n    try {\n      if (msg.evpr != null) {\n        const eventsMap = msg.evpr.events\n        const profileMap = msg.evpr.profile\n        const syncExpiry = msg.evpr.expires_in\n        const now = getNow()\n        StorageManager.setMetaProp('lsTime', now)\n        StorageManager.setMetaProp('exTs', syncExpiry)\n        mergeEventMap(eventsMap)\n        StorageManager.saveToLSorCookie(EV_COOKIE, $ct.globalEventsMap)\n        if ($ct.globalProfileMap == null) {\n          addToLocalProfileMap(profileMap, true)\n        } else {\n          addToLocalProfileMap(profileMap, false)\n        }\n      }\n      if (msg.arp != null) {\n        arp(msg.arp)\n      }\n      if (msg.inapp_stale != null && msg.inapp_stale.length > 0) {\n        // web popup stale\n        staleDataUpdate(msg.inapp_stale, 'wp')\n      }\n      if (msg.inbox_stale != null && msg.inbox_stale.length > 0) {\n        // web inbox stale\n        staleDataUpdate(msg.inbox_stale, 'wi')\n      }\n    } catch (e) {\n      _logger.error('Unable to persist evrp/arp: ' + e)\n    }\n  }\n}\n\nexport default _tr\n","import {\n  StorageManager\n} from '../util/storage'\nexport default class User {\n  #isPersonalisationActive\n\n  constructor ({\n    isPersonalisationActive\n  }) {\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  getTotalVisits () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    let visitCount = StorageManager.getMetaProp('sc')\n    if (visitCount == null) {\n      visitCount = 1\n    }\n    return visitCount\n  }\n\n  getLastVisit () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    const prevSession = StorageManager.getMetaProp('ps')\n    if (prevSession != null) {\n      return new Date(prevSession * 1000)\n    }\n  }\n}\n","import {\n  CLEVERTAP_ERROR_PREFIX\n} from '../util/messages'\n\nexport const logLevels = {\n  DISABLE: 0,\n  ERROR: 1,\n  INFO: 2,\n  DEBUG: 3\n}\n\nexport class Logger {\n  #logLevel\n  wzrkError = {}\n  constructor (logLevel) {\n    this.#logLevel = logLevel == null ? logLevel : logLevels.INFO\n    this.wzrkError = {}\n  }\n\n  get logLevel () {\n    return this.#logLevel\n  }\n\n  set logLevel (logLevel) {\n    this.#logLevel = logLevel\n  }\n\n  error (message) {\n    if (this.#logLevel >= logLevels.ERROR) {\n      this.#log('error', message)\n    }\n  }\n\n  info (message) {\n    if (this.#logLevel >= logLevels.INFO) {\n      this.#log('log', message)\n    }\n  }\n\n  debug (message) {\n    if (this.#logLevel >= logLevels.DEBUG || this.#isLegacyDebug) {\n      this.#log('debug', message)\n    }\n  }\n\n  reportError (code, description) {\n    this.wzrkError.c = code\n    this.wzrkError.d = description\n    this.error(`${CLEVERTAP_ERROR_PREFIX} ${code}: ${description}`)\n  }\n\n  #log (level, message) {\n    if (window.console) {\n      try {\n        const ts = new Date().getTime()\n        console[level](`CleverTap [${ts}]: ${message}`)\n      } catch (e) {}\n    }\n  }\n\n  get #isLegacyDebug () {\n    return (typeof sessionStorage !== 'undefined' && sessionStorage.WZRK_D === '')\n  }\n}\n\nexport default {\n  Logger,\n  logLevels\n}\n","import { singleQuoteRegex, SCOOKIE_EXP_TIME_IN_SECS } from '../util/constants'\nimport { isObject } from '../util/datatypes'\nimport { getNow } from '../util/datetime'\nimport { StorageManager } from '../util/storage'\nimport { getHostName } from '../util/url'\n\nexport default class SessionManager {\n  #logger\n  #sessionId\n  #isPersonalisationActive\n  cookieName // SCOOKIE_NAME\n  scookieObj\n\n  constructor ({\n    logger,\n    isPersonalisationActive\n  }) {\n    this.sessionId = StorageManager.getMetaProp('cs')\n    this.#logger = logger\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  get sessionId () {\n    return this.#sessionId\n  }\n\n  set sessionId (sessionId) {\n    this.#sessionId = sessionId\n  }\n\n  getSessionCookieObject () {\n    let scookieStr = StorageManager.readCookie(this.cookieName)\n    let obj = {}\n\n    if (scookieStr != null) {\n      // converting back single quotes to double for JSON parsing - http://www.iandevlin.com/blog/2012/04/html5/cookies-json-localstorage-and-opera\n      scookieStr = scookieStr.replace(singleQuoteRegex, '\"')\n\n      obj = JSON.parse(scookieStr)\n      if (!isObject(obj)) {\n        obj = {}\n      } else {\n        if (typeof obj.t !== 'undefined') { // check time elapsed since last request\n          const lastTime = obj.t\n          const now = getNow()\n          if ((now - lastTime) > (SCOOKIE_EXP_TIME_IN_SECS + 60)) {\n            // adding 60 seconds to compensate for in-journey requests\n            // ideally the cookie should've died after SCOOKIE_EXP_TIME_IN_SECS but it's still around as we can read\n            // hence we shouldn't use it.\n            obj = {}\n          }\n        }\n      }\n    }\n    this.scookieObj = obj\n    return obj\n  }\n\n  setSessionCookieObject (obj) {\n    const objStr = JSON.stringify(obj)\n    StorageManager.createBroadCookie(this.cookieName, objStr, SCOOKIE_EXP_TIME_IN_SECS, getHostName())\n  }\n\n  manageSession (session) {\n    // first time. check if current session id in localstorage is same\n    // if not same then prev = current and current = this new session\n    if (typeof this.sessionId === 'undefined' || this.sessionId !== session) {\n      const currentSessionInLS = StorageManager.getMetaProp('cs')\n      // if sessionId in meta is undefined - set current to both\n      if (typeof currentSessionInLS === 'undefined') {\n        StorageManager.setMetaProp('ps', session)\n        StorageManager.setMetaProp('cs', session)\n        StorageManager.setMetaProp('sc', 1)\n      } else if (currentSessionInLS !== session) {\n        // not same as session in local storage. new session\n        StorageManager.setMetaProp('ps', currentSessionInLS)\n        StorageManager.setMetaProp('cs', session)\n        let sessionCount = StorageManager.getMetaProp('sc')\n        if (typeof sessionCount === 'undefined') {\n          sessionCount = 0\n        }\n        StorageManager.setMetaProp('sc', sessionCount + 1)\n      }\n      this.sessionId = session\n    }\n  }\n\n  getTimeElapsed () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    if (this.scookieObj != null) { // TODO: check logic?\n      this.scookieObj = this.getSessionCookieObject()\n    }\n    const sessionStart = this.scookieObj.s\n    if (sessionStart != null) {\n      const ts = getNow()\n      return Math.floor(ts - sessionStart)\n    }\n  }\n\n  getPageCount () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n\n    if (this.scookieObj != null) { // TODO: check logic\n      this.scookieObj = this.getSessionCookieObject()\n    }\n    return this.scookieObj.p\n  }\n}\n","import { CAMP_COOKIE_NAME, CLEAR, EVT_PUSH, EV_COOKIE, FIRE_PUSH_UNREGISTERED, LCOOKIE_NAME, PUSH_SUBSCRIPTION_DATA, WEBPUSH_LS_KEY } from '../util/constants'\nimport { isObjectEmpty, isValueValid, removeUnsupportedChars } from '../util/datatypes'\nimport { getNow } from '../util/datetime'\nimport { compressData } from '../util/encoder'\nimport RequestDispatcher from '../util/requestDispatcher'\nimport { StorageManager, $ct } from '../util/storage'\nimport { addToURL } from '../util/url'\nimport { getCampaignObjForLc } from '../util/clevertap'\n\nlet seqNo = 0\nlet requestTime = 0\n\nexport default class RequestManager {\n  #logger\n  #account\n  #device\n  #session\n  #isPersonalisationActive\n  #clearCookie = false\n  processingBackup = false\n\n  constructor ({ logger, account, device, session, isPersonalisationActive }) {\n    this.#logger = logger\n    this.#account = account\n    this.#device = device\n    this.#session = session\n    this.#isPersonalisationActive = isPersonalisationActive\n\n    RequestDispatcher.logger = logger\n    RequestDispatcher.device = device\n  }\n\n  processBackupEvents () {\n    const backupMap = StorageManager.readFromLSorCookie(LCOOKIE_NAME)\n    if (typeof backupMap === 'undefined' || backupMap === null) {\n      return\n    }\n    this.processingBackup = true\n    for (const idx in backupMap) {\n      if (backupMap.hasOwnProperty(idx)) {\n        const backupEvent = backupMap[idx]\n        if (typeof backupEvent.fired === 'undefined') {\n          this.#logger.debug('Processing backup event : ' + backupEvent.q)\n          if (typeof backupEvent.q !== 'undefined') {\n            RequestDispatcher.fireRequest(backupEvent.q)\n          }\n          backupEvent.fired = true\n        }\n      }\n    }\n    StorageManager.saveToLSorCookie(LCOOKIE_NAME, backupMap)\n    this.processingBackup = false\n  }\n\n  addSystemDataToObject (dataObject, ignoreTrim) {\n    // ignore trim for chrome notifications; undefined everywhere else\n    if (typeof ignoreTrim === 'undefined') {\n      dataObject = removeUnsupportedChars(dataObject, this.#logger)\n    }\n\n    if (!isObjectEmpty(this.#logger.wzrkError)) {\n      dataObject.wzrk_error = this.#logger.wzrkError\n      this.#logger.wzrkError = {}\n    }\n\n    dataObject.id = this.#account.id\n\n    if (isValueValid(this.#device.gcookie)) {\n      dataObject.g = this.#device.gcookie\n    }\n\n    const obj = this.#session.getSessionCookieObject()\n    dataObject.s = obj.s // session cookie\n    dataObject.pg = (typeof obj.p === 'undefined') ? 1 : obj.p // Page count\n    if (sessionStorage.hasOwnProperty('WZRK_D')) { dataObject.debug = true }\n\n    return dataObject\n  }\n\n  addSystemDataToProfileObject (dataObject, ignoreTrim) {\n    if (!isObjectEmpty(this.#logger.wzrkError)) {\n      dataObject.wzrk_error = this.#logger.wzrkError\n      this.#logger.wzrkError = {}\n    }\n\n    dataObject.id = this.#account.id\n\n    if (isValueValid(this.#device.gcookie)) {\n      dataObject.g = this.#device.gcookie\n    }\n\n    const obj = this.#session.getSessionCookieObject()\n    dataObject.s = obj.s // session cookie\n    dataObject.pg = (typeof obj.p === 'undefined') ? 1 : obj.p // Page count\n    if (sessionStorage.hasOwnProperty('WZRK_D')) { dataObject.debug = true }\n\n    return dataObject\n  }\n\n  addFlags (data) {\n    // check if cookie should be cleared.\n    this.#clearCookie = StorageManager.getAndClearMetaProp(CLEAR)\n    if (this.#clearCookie !== undefined && this.#clearCookie) {\n      data.rc = true\n      this.#logger.debug('reset cookie sent in request and cleared from meta for future requests.')\n    }\n    if (this.#isPersonalisationActive()) {\n      const lastSyncTime = StorageManager.getMetaProp('lsTime')\n      const expirySeconds = StorageManager.getMetaProp('exTs')\n\n      // dsync not found in local storage - get data from server\n      if (typeof lastSyncTime === 'undefined' || typeof expirySeconds === 'undefined') {\n        data.dsync = true\n        return\n      }\n      const now = getNow()\n      // last sync time has expired - get fresh data from server\n      if (lastSyncTime + expirySeconds < now) {\n        data.dsync = true\n      }\n    }\n  }\n\n  // saves url to backup cache and fires the request\n  /**\n   *\n   * @param {string} url\n   * @param {boolean} override whether the request can go through or not\n   * @param {Boolean} sendOULFlag - true in case of a On User Login request\n   */\n  saveAndFireRequest (url, override, sendOULFlag) {\n    const now = getNow()\n    url = addToURL(url, 'rn', ++$ct.globalCache.REQ_N)\n    const data = url + '&i=' + now + '&sn=' + seqNo\n    StorageManager.backupEvent(data, $ct.globalCache.REQ_N, this.#logger)\n\n    // if offline is set to true, save the request in backup and return\n    if ($ct.offline) return\n    // if there is no override\n    // and an OUL request is not in progress\n    // then process the request as it is\n    // else block the request\n    // note - $ct.blockRequest should ideally be used for override\n    if ((!override || (this.#clearCookie !== undefined && this.#clearCookie)) && !window.isOULInProgress) {\n      if (now === requestTime) {\n        seqNo++\n      } else {\n        requestTime = now\n        seqNo = 0\n      }\n      window.oulReqN = $ct.globalCache.REQ_N\n      RequestDispatcher.fireRequest(data, false, sendOULFlag)\n    } else {\n      this.#logger.debug(`Not fired due to override - ${$ct.blockRequest} or clearCookie - ${this.#clearCookie} or OUL request in progress - ${window.isOULInProgress}`)\n    }\n  }\n\n  unregisterTokenForGuid (givenGUID) {\n    const payload = StorageManager.readFromLSorCookie(PUSH_SUBSCRIPTION_DATA)\n    // Send unregister event only when token is available\n    if (payload) {\n      const data = {}\n      data.type = 'data'\n      if (isValueValid(givenGUID)) {\n        data.g = givenGUID\n      }\n      data.action = 'unregister'\n      data.id = this.#account.id\n\n      const obj = this.#session.getSessionCookieObject()\n\n      data.s = obj.s // session cookie\n      const compressedData = compressData(JSON.stringify(data), this.#logger)\n\n      let pageLoadUrl = this.#account.dataPostURL\n      pageLoadUrl = addToURL(pageLoadUrl, 'type', 'data')\n      pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n      RequestDispatcher.fireRequest(pageLoadUrl, true)\n      StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, false)\n    }\n    // REGISTER TOKEN\n    this.registerToken(payload)\n  }\n\n  registerToken (payload) {\n    if (!payload) return\n    // add gcookie etc to the payload\n    payload = this.addSystemDataToObject(payload, true)\n    payload = JSON.stringify(payload)\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', 'data')\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(payload, this.#logger))\n    RequestDispatcher.fireRequest(pageLoadUrl)\n    // set in localstorage\n    StorageManager.save(WEBPUSH_LS_KEY, 'ok')\n  }\n\n  processEvent (data) {\n    this.#addToLocalEventMap(data.evtName)\n    data = this.addSystemDataToObject(data, undefined)\n    this.addFlags(data)\n    data[CAMP_COOKIE_NAME] = getCampaignObjForLc()\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n\n    this.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n  }\n\n  #addToLocalEventMap (evtName) {\n    if (StorageManager._isLocalStorageSupported()) {\n      if (typeof $ct.globalEventsMap === 'undefined') {\n        $ct.globalEventsMap = StorageManager.readFromLSorCookie(EV_COOKIE)\n        if (typeof $ct.globalEventsMap === 'undefined') {\n          $ct.globalEventsMap = {}\n        }\n      }\n\n      const nowTs = getNow()\n      let evtDetail = $ct.globalEventsMap[evtName]\n      if (typeof evtDetail !== 'undefined') {\n        evtDetail[2] = nowTs\n        evtDetail[0]++\n      } else {\n        evtDetail = []\n        evtDetail.push(1)\n        evtDetail.push(nowTs)\n        evtDetail.push(nowTs)\n      }\n      $ct.globalEventsMap[evtName] = evtDetail\n      StorageManager.saveToLSorCookie(EV_COOKIE, $ct.globalEventsMap)\n    }\n  }\n}\n","import {\n  isObjectEmpty\n} from '../util/datatypes'\nimport {\n  EVT_PUSH,\n  USEIP_KEY,\n  OPTOUT_KEY,\n  CT_OPTOUT_KEY\n} from '../util/constants'\nimport {\n  StorageManager,\n  $ct\n} from '../util/storage'\nimport {\n  compressData\n} from '../util/encoder'\nimport {\n  addToURL\n} from '../util/url'\n\nexport default class Privacy extends Array {\n  #request\n  #account\n  #oldValues\n  #logger\n\n  constructor ({\n    request,\n    account,\n    logger\n  },\n  values) {\n    super()\n    this.#logger = logger\n    this.#request = request\n    this.#account = account\n    this.#oldValues = values\n  }\n\n  push (...privacyArr) {\n    if ($ct.isPrivacyArrPushed) {\n      this.#processPrivacyArray($ct.privacyArray.length > 0 ? $ct.privacyArray : privacyArr)\n    } else {\n      $ct.privacyArray.push(...privacyArr)\n    }\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processPrivacyArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  #processPrivacyArray (privacyArr) {\n    if (Array.isArray(privacyArr) && privacyArr.length > 0) {\n      const privacyObj = privacyArr.reduce((prev, curr) => ({ ...prev, ...curr }), {})\n      let data = {}\n      const profileObj = {}\n      var optOut = false\n\n      if (privacyObj.hasOwnProperty(OPTOUT_KEY)) {\n        optOut = privacyObj[OPTOUT_KEY]\n        if (typeof optOut === 'boolean') {\n          profileObj[CT_OPTOUT_KEY] = optOut\n          // should be true when user wants to opt in\n          $ct.isOptInRequest = !optOut\n        }\n      }\n      if (privacyObj.hasOwnProperty(USEIP_KEY)) {\n        const useIP = privacyObj[USEIP_KEY]\n        const shouldUseIP = (typeof useIP === 'boolean') ? useIP : false\n        StorageManager.setMetaProp(USEIP_KEY, shouldUseIP)\n      }\n      if (!isObjectEmpty(profileObj)) {\n        data.type = 'profile'\n        data.profile = profileObj\n        data = this.#request.addSystemDataToObject(data, undefined)\n        let pageLoadUrl = this.#account.dataPostURL\n        pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n        pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n        pageLoadUrl = addToURL(pageLoadUrl, OPTOUT_KEY, optOut ? 'true' : 'false')\n        this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n        privacyArr.splice(0, privacyArr.length)\n      }\n    }\n  }\n}\n","import { StorageManager, $ct } from '../util/storage'\nimport { isObject } from '../util/datatypes'\nimport {\n  PUSH_SUBSCRIPTION_DATA\n} from '../util/constants'\nimport {\n  urlBase64ToUint8Array\n} from '../util/encoder'\n\nexport default class NotificationHandler extends Array {\n  #oldValues\n  #logger\n  #request\n  #account\n  #wizAlertJSPath\n  #fcmPublicKey\n\n  constructor ({\n    logger,\n    session,\n    request,\n    account\n  }, values) {\n    super()\n    this.#wizAlertJSPath = 'https://d2r1yp2w7bby2u.cloudfront.net/js/wzrk_dialog.min.js'\n    this.#fcmPublicKey = null\n    this.#oldValues = values\n    this.#logger = logger\n    this.#request = request\n    this.#account = account\n  }\n\n  push (...displayArgs) {\n    this.#setUpWebPush(displayArgs)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#setUpWebPush(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  #setUpWebPush (displayArgs) {\n    if ($ct.webPushEnabled && displayArgs.length > 0) {\n      this.#handleNotificationRegistration(displayArgs)\n    } else if ($ct.webPushEnabled == null && displayArgs.length > 0) {\n      $ct.notifApi.notifEnabledFromApi = true\n      $ct.notifApi.displayArgs = displayArgs.slice()\n    } else if ($ct.webPushEnabled === false && displayArgs.length > 0) {\n      this.#logger.error('Make sure push notifications are fully enabled and integrated')\n    }\n  }\n\n  #setUpWebPushNotifications (subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsServiceUrl) {\n    if (navigator.userAgent.indexOf('Chrome') !== -1 || navigator.userAgent.indexOf('Firefox') !== -1) {\n      this.#setUpChromeFirefoxNotifications(subscriptionCallback, serviceWorkerPath)\n    } else if (navigator.userAgent.indexOf('Safari') !== -1) {\n      this.#setUpSafariNotifications(subscriptionCallback, apnsWebPushId, apnsServiceUrl)\n    }\n  }\n\n  #setApplicationServerKey (applicationServerKey) {\n    this.#fcmPublicKey = applicationServerKey\n  }\n\n  #setUpSafariNotifications (subscriptionCallback, apnsWebPushId, apnsServiceUrl) {\n    // ensure that proper arguments are passed\n    if (typeof apnsWebPushId === 'undefined') {\n      this.#logger.error('Ensure that APNS Web Push ID is supplied')\n    }\n    if (typeof apnsServiceUrl === 'undefined') {\n      this.#logger.error('Ensure that APNS Web Push service path is supplied')\n    }\n    if ('safari' in window && 'pushNotification' in window.safari) {\n      window.safari.pushNotification.requestPermission(\n        apnsServiceUrl,\n        apnsWebPushId, {}, (subscription) => {\n          if (subscription.permission === 'granted') {\n            const subscriptionData = JSON.parse(JSON.stringify(subscription))\n            subscriptionData.endpoint = subscription.deviceToken\n            subscriptionData.browser = 'Safari'\n            StorageManager.saveToLSorCookie(PUSH_SUBSCRIPTION_DATA, subscriptionData)\n\n            this.#request.registerToken(subscriptionData)\n            this.#logger.info('Safari Web Push registered. Device Token: ' + subscription.deviceToken)\n          } else if (subscription.permission === 'denied') {\n            this.#logger.info('Error subscribing to Safari web push')\n          }\n        })\n    }\n  }\n\n  /**\n   * Sets up a service worker for WebPush(chrome/Firefox) push notifications and sends the data to LC\n   */\n  #setUpChromeFirefoxNotifications (subscriptionCallback, serviceWorkerPath) {\n    let registrationScope = ''\n\n    if ('serviceWorker' in navigator) {\n      navigator.serviceWorker.register(serviceWorkerPath).then((registration) => {\n        if (typeof __wzrk_account_id !== 'undefined') { // eslint-disable-line\n          // shopify accounts , since the service worker is not at root, serviceWorker.ready is never resolved.\n          // hence add a timeout and hope serviceWroker is ready within that time.\n          return new Promise(resolve => setTimeout(() => resolve(registration), 5000))\n        }\n        registrationScope = registration.scope\n\n        // IF SERVICE WORKER IS AT ROOT, RETURN THE READY PROMISE\n        // ELSE IF CHROME RETURN PROMISE AFTER 5 SECONDS\n        // OR getRegistrations PROMISE IF ITS FIREFOX\n        const rootDirRegex = /^(\\.?)(\\/?)([^/]*).js$/\n        const isServiceWorkerAtRoot = rootDirRegex.test(serviceWorkerPath)\n        if (isServiceWorkerAtRoot) {\n          return navigator.serviceWorker.ready\n        } else {\n          if (navigator.userAgent.indexOf('Chrome') !== -1) {\n            return new Promise(resolve => setTimeout(() => resolve(registration), 5000))\n          } else {\n            return navigator.serviceWorker.getRegistrations()\n          }\n        }\n      }).then((serviceWorkerRegistration) => {\n        // ITS AN ARRAY IN CASE OF FIREFOX, SO USE THE REGISTRATION WITH PROPER SCOPE\n        if (navigator.userAgent.indexOf('Firefox') !== -1 && Array.isArray(serviceWorkerRegistration)) {\n          serviceWorkerRegistration = serviceWorkerRegistration.filter((i) => i.scope === registrationScope)[0]\n        }\n        const subscribeObj = { userVisibleOnly: true }\n\n        if (this.#fcmPublicKey != null) {\n          subscribeObj.applicationServerKey = urlBase64ToUint8Array(this.#fcmPublicKey)\n        }\n\n        serviceWorkerRegistration.pushManager.subscribe(subscribeObj)\n          .then((subscription) => {\n            this.#logger.info('Service Worker registered. Endpoint: ' + subscription.endpoint)\n\n            // convert the subscription keys to strings; this sets it up nicely for pushing to LC\n            const subscriptionData = JSON.parse(JSON.stringify(subscription))\n\n            // remove the common chrome/firefox endpoint at the beginning of the token\n            if (navigator.userAgent.indexOf('Chrome') !== -1) {\n              subscriptionData.endpoint = subscriptionData.endpoint.split('/').pop()\n              subscriptionData.browser = 'Chrome'\n            } else if (navigator.userAgent.indexOf('Firefox') !== -1) {\n              subscriptionData.endpoint = subscriptionData.endpoint.split('/').pop()\n              subscriptionData.browser = 'Firefox'\n            }\n            StorageManager.saveToLSorCookie(PUSH_SUBSCRIPTION_DATA, subscriptionData)\n            this.#request.registerToken(subscriptionData)\n\n            if (typeof subscriptionCallback !== 'undefined' && typeof subscriptionCallback === 'function') {\n              subscriptionCallback()\n            }\n          }).catch((error) => {\n            this.#logger.error('Error subscribing: ' + error)\n            // unsubscribe from webpush if error\n            serviceWorkerRegistration.pushManager.getSubscription().then((subscription) => {\n              if (subscription !== null) {\n                subscription.unsubscribe().then((successful) => {\n                  // You've successfully unsubscribed\n                  this.#logger.info('Unsubscription successful')\n                }).catch((e) => {\n                  // Unsubscription failed\n                  this.#logger.error('Error unsubscribing: ' + e)\n                })\n              }\n            })\n          })\n      }).catch((err) => {\n        this.#logger.error('error registering service worker: ' + err)\n      })\n    }\n  }\n\n  #addWizAlertJS () {\n    const scriptTag = document.createElement('script')\n    scriptTag.setAttribute('type', 'text/javascript')\n    scriptTag.setAttribute('id', 'wzrk-alert-js')\n    scriptTag.setAttribute('src', this.#wizAlertJSPath)\n\n    // add the script tag to the end of the body\n    document.getElementsByTagName('body')[0].appendChild(scriptTag)\n\n    return scriptTag\n  }\n\n  #removeWizAlertJS () {\n    const scriptTag = document.getElementById('wzrk-alert-js')\n    scriptTag.parentNode.removeChild(scriptTag)\n  }\n\n  #handleNotificationRegistration (displayArgs) {\n    // make sure everything is specified\n    let titleText\n    let bodyText\n    let okButtonText\n    let rejectButtonText\n    let okButtonColor\n    let skipDialog\n    let askAgainTimeInSeconds\n    let okCallback\n    let rejectCallback\n    let subscriptionCallback\n    let hidePoweredByCT\n    let serviceWorkerPath\n    let httpsPopupPath\n    let httpsIframePath\n    let apnsWebPushId\n    let apnsWebPushServiceUrl\n\n    if (displayArgs.length === 1) {\n      if (isObject(displayArgs[0])) {\n        const notifObj = displayArgs[0]\n        titleText = notifObj.titleText\n        bodyText = notifObj.bodyText\n        okButtonText = notifObj.okButtonText\n        rejectButtonText = notifObj.rejectButtonText\n        okButtonColor = notifObj.okButtonColor\n        skipDialog = notifObj.skipDialog\n        askAgainTimeInSeconds = notifObj.askAgainTimeInSeconds\n        okCallback = notifObj.okCallback\n        rejectCallback = notifObj.rejectCallback\n        subscriptionCallback = notifObj.subscriptionCallback\n        hidePoweredByCT = notifObj.hidePoweredByCT\n        serviceWorkerPath = notifObj.serviceWorkerPath\n        httpsPopupPath = notifObj.httpsPopupPath\n        httpsIframePath = notifObj.httpsIframePath\n        apnsWebPushId = notifObj.apnsWebPushId\n        apnsWebPushServiceUrl = notifObj.apnsWebPushServiceUrl\n      }\n    } else {\n      titleText = displayArgs[0]\n      bodyText = displayArgs[1]\n      okButtonText = displayArgs[2]\n      rejectButtonText = displayArgs[3]\n      okButtonColor = displayArgs[4]\n      skipDialog = displayArgs[5]\n      askAgainTimeInSeconds = displayArgs[6]\n    }\n\n    if (skipDialog == null) {\n      skipDialog = false\n    }\n\n    if (hidePoweredByCT == null) {\n      hidePoweredByCT = false\n    }\n\n    if (serviceWorkerPath == null) {\n      serviceWorkerPath = '/clevertap_sw.js'\n    }\n\n    // ensure that the browser supports notifications\n    if (typeof navigator.serviceWorker === 'undefined') {\n      return\n    }\n\n    const isHTTP = httpsPopupPath != null && httpsIframePath != null\n\n    // make sure the site is on https for chrome notifications\n    if (window.location.protocol !== 'https:' && document.location.hostname !== 'localhost' && !isHTTP) {\n      this.#logger.error('Make sure you are https or localhost to register for notifications')\n      return\n    }\n\n    // right now, we only support Chrome V50 & higher & Firefox\n    if (navigator.userAgent.indexOf('Chrome') !== -1) {\n      const chromeAgent = navigator.userAgent.match(/Chrome\\/(\\d+)/)\n      if (chromeAgent == null || parseInt(chromeAgent[1], 10) < 50) { return }\n    } else if (navigator.userAgent.indexOf('Firefox') !== -1) {\n      const firefoxAgent = navigator.userAgent.match(/Firefox\\/(\\d+)/)\n      if (firefoxAgent == null || parseInt(firefoxAgent[1], 10) < 50) { return }\n    } else if (navigator.userAgent.indexOf('Safari') !== -1) {\n      const safariAgent = navigator.userAgent.match(/Safari\\/(\\d+)/)\n      if (safariAgent == null || parseInt(safariAgent[1], 10) < 50) { return }\n    } else {\n      return\n    }\n\n    // we check for the cookie in setUpChromeNotifications() the tokens may have changed\n\n    if (!isHTTP) {\n      if (Notification == null) {\n        return\n      }\n      // handle migrations from other services -> chrome notifications may have already been asked for before\n      if (Notification.permission === 'granted') {\n        // skip the dialog and register\n        this.#setUpWebPushNotifications(subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsWebPushServiceUrl)\n        return\n      } else if (Notification.permission === 'denied') {\n        // we've lost this profile :'(\n        return\n      }\n\n      if (skipDialog) {\n        this.#setUpWebPushNotifications(subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsWebPushServiceUrl)\n        return\n      }\n    }\n\n    // make sure the right parameters are passed\n    if (!titleText || !bodyText || !okButtonText || !rejectButtonText) {\n      this.#logger.error('Missing input parameters; please specify title, body, ok button and cancel button text')\n      return\n    }\n\n    // make sure okButtonColor is formatted properly\n    if (okButtonColor == null || !okButtonColor.match(/^#[a-f\\d]{6}$/i)) {\n      okButtonColor = '#f28046' // default color for positive button\n    }\n\n    // make sure the user isn't asked for notifications more than askAgainTimeInSeconds\n    const now = new Date().getTime() / 1000\n    if ((StorageManager.getMetaProp('notif_last_time')) == null) {\n      StorageManager.setMetaProp('notif_last_time', now)\n    } else {\n      if (askAgainTimeInSeconds == null) {\n        // 7 days by default\n        askAgainTimeInSeconds = 7 * 24 * 60 * 60\n      }\n\n      if (now - StorageManager.getMetaProp('notif_last_time') < askAgainTimeInSeconds) {\n        return\n      } else {\n        // continue asking\n        StorageManager.setMetaProp('notif_last_time', now)\n      }\n    }\n\n    if (isHTTP) {\n      // add the https iframe\n      const httpsIframe = document.createElement('iframe')\n      httpsIframe.setAttribute('style', 'display:none;')\n      httpsIframe.setAttribute('src', httpsIframePath)\n      document.body.appendChild(httpsIframe)\n      window.addEventListener('message', (event) => {\n        if (event.data != null) {\n          let obj = {}\n          try {\n            obj = JSON.parse(event.data)\n          } catch (e) {\n            // not a call from our iframe\n            return\n          }\n          if (obj.state != null) {\n            if (obj.from === 'ct' && obj.state === 'not') {\n              this.#addWizAlertJS().onload = () => {\n                // create our wizrocket popup\n                window.wzrkPermissionPopup.wizAlert({\n                  title: titleText,\n                  body: bodyText,\n                  confirmButtonText: okButtonText,\n                  confirmButtonColor: okButtonColor,\n                  rejectButtonText: rejectButtonText,\n                  hidePoweredByCT: hidePoweredByCT\n                }, (enabled) => { // callback function\n                  if (enabled) {\n                    // the user accepted on the dialog box\n                    if (typeof okCallback === 'function') {\n                      okCallback()\n                    }\n                    // redirect to popup.html\n                    window.open(httpsPopupPath)\n                  } else {\n                    if (typeof rejectCallback === 'function') {\n                      rejectCallback()\n                    }\n                  }\n                  this.#removeWizAlertJS()\n                })\n              }\n            }\n          }\n        }\n      }, false)\n    } else {\n      this.#addWizAlertJS().onload = () => {\n        // create our wizrocket popup\n        window.wzrkPermissionPopup.wizAlert({\n          title: titleText,\n          body: bodyText,\n          confirmButtonText: okButtonText,\n          confirmButtonColor: okButtonColor,\n          rejectButtonText: rejectButtonText,\n          hidePoweredByCT: hidePoweredByCT\n        }, (enabled) => { // callback function\n          if (enabled) {\n            // the user accepted on the dialog box\n            if (typeof okCallback === 'function') {\n              okCallback()\n            }\n            this.#setUpWebPushNotifications(subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsWebPushServiceUrl)\n          } else {\n            if (typeof rejectCallback === 'function') {\n              rejectCallback()\n            }\n          }\n          this.#removeWizAlertJS()\n        })\n      }\n    }\n  }\n\n  _enableWebPush (enabled, applicationServerKey) {\n    $ct.webPushEnabled = enabled\n    if (applicationServerKey != null) {\n      this.#setApplicationServerKey(applicationServerKey)\n    }\n    if ($ct.webPushEnabled && $ct.notifApi.notifEnabledFromApi) {\n      this.#handleNotificationRegistration($ct.notifApi.displayArgs)\n    } else if (!$ct.webPushEnabled && $ct.notifApi.notifEnabledFromApi) {\n      this.#logger.error('Ensure that web push notifications are fully enabled and integrated before requesting them')\n    }\n  }\n}\n","import Account from './modules/account'\nimport CleverTapAPI from './modules/api'\nimport DeviceManager from './modules/device'\nimport EventHandler from './modules/event'\nimport ProfileHandler from './modules/profile'\nimport UserLoginHandler from './modules/userLogin'\nimport _tr from './util/tr'\nimport User from './modules/user'\nimport { Logger, logLevels } from './modules/logger'\nimport SessionManager from './modules/session'\nimport ReqestManager from './modules/request'\nimport {\n  CAMP_COOKIE_NAME,\n  SCOOKIE_PREFIX,\n  NOTIFICATION_VIEWED,\n  NOTIFICATION_CLICKED,\n  EVT_PING,\n  FIRST_PING_FREQ_IN_MILLIS,\n  CONTINUOUS_PING_FREQ_IN_MILLIS,\n  GROUP_SUBSCRIPTION_REQUEST_ID,\n  WZRK_ID,\n  WZRK_PREFIX,\n  categoryLongKey,\n  COMMAND_INCREMENT,\n  COMMAND_DECREMENT,\n  COMMAND_SET,\n  COMMAND_ADD,\n  COMMAND_REMOVE,\n  COMMAND_DELETE,\n  EVT_PUSH\n} from './util/constants'\nimport { EMBED_ERROR } from './util/messages'\nimport { StorageManager, $ct } from './util/storage'\nimport { addToURL, getDomain, getURLParams } from './util/url'\nimport { getCampaignObjForLc, setEnum, handleEmailSubscription, closeIframe } from './util/clevertap'\nimport { compressData } from './util/encoder'\nimport Privacy from './modules/privacy'\nimport NotificationHandler from './modules/notification'\nimport { hasWebInboxSettingsInLS, checkAndRegisterWebInboxElements, initializeWebInbox, getInboxMessages, saveInboxMessages } from './modules/web-inbox/helper'\n\nexport default class CleverTap {\n  #logger\n  #api\n  #onloadcalled\n  #device\n  #session\n  #account\n  #request\n  #isSpa\n  #previousUrl\n  #boundCheckPageChanged = this.#checkPageChanged.bind(this)\n  #isWebPopUpSpamControlDisabled\n  enablePersonalization\n\n  get spa () {\n    return this.#isSpa\n  }\n\n  set spa (value) {\n    const isSpa = value === true\n    if (this.#isSpa !== isSpa && this.#onloadcalled === 1) {\n      // if clevertap.spa is changed after init has been called then update the click listeners\n      if (isSpa) {\n        document.addEventListener('click', this.#boundCheckPageChanged)\n      } else {\n        document.removeEventListener('click', this.#boundCheckPageChanged)\n      }\n    }\n    this.#isSpa = isSpa\n  }\n\n  get dismissSpamControl () {\n    return this.#isWebPopUpSpamControlDisabled\n  }\n\n  set dismissSpamControl (value) {\n    const isWebPopUpSpamControlDisabled = value === true\n    this.#isWebPopUpSpamControlDisabled = isWebPopUpSpamControlDisabled\n  }\n\n  constructor (clevertap = {}) {\n    this.#onloadcalled = 0\n    this._isPersonalisationActive = this._isPersonalisationActive.bind(this)\n    this.raiseNotificationClicked = () => { }\n    this.#logger = new Logger(logLevels.INFO)\n    this.#account = new Account(clevertap.account?.[0], clevertap.region || clevertap.account?.[1], clevertap.targetDomain || clevertap.account?.[2])\n    this.#device = new DeviceManager({ logger: this.#logger })\n    this.#session = new SessionManager({\n      logger: this.#logger,\n      isPersonalisationActive: this._isPersonalisationActive\n    })\n    this.#request = new ReqestManager({\n      logger: this.#logger,\n      account: this.#account,\n      device: this.#device,\n      session: this.#session,\n      isPersonalisationActive: this._isPersonalisationActive\n    })\n    this.enablePersonalization = clevertap.enablePersonalization || false\n    this.event = new EventHandler({\n      logger: this.#logger,\n      request: this.#request,\n      isPersonalisationActive: this._isPersonalisationActive\n    }, clevertap.event)\n\n    this.profile = new ProfileHandler({\n      logger: this.#logger,\n      request: this.#request,\n      account: this.#account,\n      isPersonalisationActive: this._isPersonalisationActive\n    }, clevertap.profile)\n\n    this.onUserLogin = new UserLoginHandler({\n      request: this.#request,\n      account: this.#account,\n      session: this.#session,\n      logger: this.#logger,\n      device: this.#device\n    }, clevertap.onUserLogin)\n\n    this.privacy = new Privacy({\n      request: this.#request,\n      account: this.#account,\n      logger: this.#logger\n    }, clevertap.privacy)\n\n    this.notifications = new NotificationHandler({\n      logger: this.#logger,\n      request: this.#request,\n      account: this.#account\n    }, clevertap.notifications)\n\n    this.#api = new CleverTapAPI({\n      logger: this.#logger,\n      request: this.#request,\n      device: this.#device,\n      session: this.#session\n    })\n\n    this.spa = clevertap.spa\n    this.dismissSpamControl = clevertap.dismissSpamControl\n\n    this.user = new User({\n      isPersonalisationActive: this._isPersonalisationActive\n    })\n\n    this.session = {\n      getTimeElapsed: () => {\n        return this.#session.getTimeElapsed()\n      },\n      getPageCount: () => {\n        return this.#session.getPageCount()\n      }\n    }\n\n    this.logout = () => {\n      this.#logger.debug('logout called')\n      StorageManager.setInstantDeleteFlagInK()\n    }\n\n    this.clear = () => {\n      this.onUserLogin.clear()\n    }\n\n    this.getCleverTapID = () => {\n      return this.#device.getGuid()\n    }\n\n    this.getAccountID = () => {\n      return this.#account.id\n    }\n\n    this.getSCDomain = () => {\n      return this.#account.finalTargetDomain\n    }\n\n    // Set the Signed Call sdk version and fire request\n    this.setSCSDKVersion = (ver) => {\n      this.#account.scSDKVersion = ver\n      const data = {}\n      data.af = { scv: 'sc-sdk-v' + this.#account.scSDKVersion }\n      let pageLoadUrl = this.#account.dataPostURL\n      pageLoadUrl = addToURL(pageLoadUrl, 'type', 'page')\n      pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n      this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n    }\n\n    if (hasWebInboxSettingsInLS()) {\n      checkAndRegisterWebInboxElements()\n      initializeWebInbox(this.#logger)\n    }\n\n    // Get Inbox Message Count\n    this.getInboxMessageCount = () => {\n      const msgCount = getInboxMessages()\n      return Object.keys(msgCount).length\n    }\n\n    // Get Inbox Unread Message Count\n    this.getInboxMessageUnreadCount = () => {\n      if ($ct.inbox) {\n        return $ct.inbox.unviewedCounter\n      } else {\n        this.#logger.debug('No unread messages')\n      }\n    }\n\n    // Get All Inbox messages\n    this.getAllInboxMessages = () => {\n      return getInboxMessages()\n    }\n\n    // Get only Unread messages\n    this.getUnreadInboxMessages = () => {\n      if ($ct.inbox) {\n        return $ct.inbox.unviewedMessages\n      } else {\n        this.#logger.debug('No unread messages')\n      }\n    }\n\n    // Get message object belonging to the given message id only. Message id should be a String\n    this.getInboxMessageForId = (messageId) => {\n      const messages = getInboxMessages()\n      if ((messageId !== null || messageId !== '') && messages.hasOwnProperty(messageId)) {\n        return messages[messageId]\n      } else {\n        this.#logger.error('No message available for message Id ' + messageId)\n      }\n    }\n\n    // Delete message from the Inbox. Message id should be a String\n    // If the message to be deleted is unviewed then decrement the badge count, delete the message from unviewedMessages list\n    // Then remove the message from local storage and update cookie\n    this.deleteInboxMessage = (messageId) => {\n      const messages = getInboxMessages()\n      if ((messageId !== null || messageId !== '') && messages.hasOwnProperty(messageId)) {\n        const el = document.querySelector('ct-web-inbox').shadowRoot.getElementById(messageId)\n        if (messages[messageId].viewed === 0) {\n          $ct.inbox.unviewedCounter--\n          delete $ct.inbox.unviewedMessages[messageId]\n          document.getElementById('unviewedBadge').innerText = $ct.inbox.unviewedCounter\n          document.getElementById('unviewedBadge').style.display = $ct.inbox.unviewedCounter > 0 ? 'flex' : 'none'\n        }\n        el && el.remove()\n        delete messages[messageId]\n        saveInboxMessages(messages)\n      } else {\n        this.#logger.error('No message available for message Id ' + messageId)\n      }\n    }\n\n    /* Mark Message as Read. Message id should be a String\n     - Check if the message Id exist in the unread message list\n     - Remove the unread marker, update the viewed flag, decrement the bage Count\n     - renderNotificationViewed */\n    this.markReadInboxMessage = (messageId) => {\n      const unreadMsg = $ct.inbox.unviewedMessages\n      const messages = getInboxMessages()\n      if ((messageId !== null || messageId !== '') && unreadMsg.hasOwnProperty(messageId)) {\n        const el = document.querySelector('ct-web-inbox').shadowRoot.getElementById(messageId)\n        if (el !== null) { el.shadowRoot.getElementById('unreadMarker').style.display = 'none' }\n        messages[messageId].viewed = 1\n        var counter = parseInt(document.getElementById('unviewedBadge').innerText) - 1\n        document.getElementById('unviewedBadge').innerText = counter\n        document.getElementById('unviewedBadge').style.display = counter > 0 ? 'flex' : 'none'\n        window.clevertap.renderNotificationViewed({ msgId: messages[messageId].wzrk_id, pivotId: messages[messageId].pivotId })\n        $ct.inbox.unviewedCounter--\n        delete $ct.inbox.unviewedMessages[messageId]\n        saveInboxMessages(messages)\n      } else {\n        this.#logger.error('No message available for message Id ' + messageId)\n      }\n    }\n\n    /* Mark all messages as read\n      - Get the count of unread messages, update unread marker style\n      - renderNotificationViewed, update the badge count and style\n    */\n    this.markReadAllInboxMessage = () => {\n      const unreadMsg = $ct.inbox.unviewedMessages\n      const messages = getInboxMessages()\n      if (Object.keys(unreadMsg).length > 0) {\n        const msgIds = Object.keys(unreadMsg)\n        msgIds.forEach(key => {\n          const el = document.querySelector('ct-web-inbox').shadowRoot.getElementById(key)\n          if (el !== null) { el.shadowRoot.getElementById('unreadMarker').style.display = 'none' }\n          messages[key].viewed = 1\n          window.clevertap.renderNotificationViewed({ msgId: messages[key].wzrk_id, pivotId: messages[key].wzrk_pivot })\n        })\n        document.getElementById('unviewedBadge').innerText = 0\n        document.getElementById('unviewedBadge').style.display = 'none'\n        saveInboxMessages(messages)\n        $ct.inbox.unviewedCounter = 0\n        $ct.inbox.unviewedMessages = {}\n      } else {\n        this.#logger.debug('All messages are already read')\n      }\n    }\n\n    // method for notification viewed\n    this.renderNotificationViewed = (detail) => {\n      processNotificationEvent(NOTIFICATION_VIEWED, detail)\n    }\n\n    // method for notification clicked\n    this.renderNotificationClicked = (detail) => {\n      processNotificationEvent(NOTIFICATION_CLICKED, detail)\n    }\n\n    const processNotificationEvent = (eventName, eventDetail) => {\n      if (!eventDetail || !eventDetail.msgId) { return }\n      const data = {}\n      data.type = 'event'\n      data.evtName = eventName\n      data.evtData = { [WZRK_ID]: eventDetail.msgId }\n\n      if (eventDetail.pivotId) {\n        data.evtData = { ...data.evtData, wzrk_pivot: eventDetail.pivotId }\n      }\n\n      if (eventDetail.wzrk_slideNo) {\n        data.evtData = { ...data.evtData, wzrk_slideNo: eventDetail.wzrk_slideNo }\n      }\n\n      // Adding kv pair to event data\n      if (eventDetail.kv && eventDetail.kv !== null && eventDetail.kv !== undefined) {\n        for (const key in eventDetail.kv) {\n          if (key.startsWith(WZRK_PREFIX)) {\n            data.evtData = { ...data.evtData, [key]: eventDetail.kv[key] }\n          }\n        }\n      }\n\n      // Adding msgCTkv to event data\n      if (eventDetail.msgCTkv && eventDetail.msgCTkv !== null && eventDetail.msgCTkv !== undefined) {\n        for (const key in eventDetail.msgCTkv) {\n          if (key.startsWith(WZRK_PREFIX)) {\n            data.evtData = { ...data.evtData, [key]: eventDetail.msgCTkv[key] }\n          }\n        }\n      }\n      this.#request.processEvent(data)\n    }\n\n    this.setLogLevel = (l) => {\n      this.#logger.logLevel = Number(l)\n      if (l === 3) {\n        sessionStorage.WZRK_D = ''\n      } else {\n        delete sessionStorage.WZRK_D\n      }\n    }\n    /**\n * @param {} key\n * @param {*} value\n */\n    this.handleIncrementValue = (key, value) => {\n      this.profile._handleIncrementDecrementValue(key, value, COMMAND_INCREMENT)\n    }\n\n    this.handleDecrementValue = (key, value) => {\n      this.profile._handleIncrementDecrementValue(key, value, COMMAND_DECREMENT)\n    }\n\n    this.setMultiValuesForKey = (key, value) => {\n      if (Array.isArray(value)) {\n        this.profile._handleMultiValueSet(key, value, COMMAND_SET)\n      } else {\n        console.error('setMultiValuesForKey should be called with a value of type array')\n      }\n    }\n\n    this.addMultiValueForKey = (key, value) => {\n      if (typeof value === 'string' || typeof value === 'number') {\n        this.profile._handleMultiValueAdd(key, value, COMMAND_ADD)\n      } else {\n        console.error('addMultiValueForKey should be called with a value of type string or number.')\n      }\n    }\n\n    this.addMultiValuesForKey = (key, value) => {\n      if (Array.isArray(value)) {\n        this.profile._handleMultiValueAdd(key, value, COMMAND_ADD)\n      } else {\n        console.error('addMultiValuesForKey should be called with a value of type array.')\n      }\n    }\n\n    this.removeMultiValueForKey = (key, value) => {\n      if (typeof value === 'string' || typeof value === 'number') {\n        this.profile._handleMultiValueRemove(key, value, COMMAND_REMOVE)\n      } else {\n        console.error('removeMultiValueForKey should be called with a value of type string or number.')\n      }\n    }\n\n    this.removeMultiValuesForKey = (key, value) => {\n      if (Array.isArray(value)) {\n        this.profile._handleMultiValueRemove(key, value, COMMAND_REMOVE)\n      } else {\n        console.error('removeMultiValuesForKey should be called with a value of type array.')\n      }\n    }\n\n    this.removeValueForKey = (key) => {\n      this.profile._handleMultiValueDelete(key, COMMAND_DELETE)\n    }\n\n    const _handleEmailSubscription = (subscription, reEncoded, fetchGroups) => {\n      handleEmailSubscription(subscription, reEncoded, fetchGroups, this.#account, this.#logger)\n    }\n\n    /**\n     *\n     * @param {number} lat\n     * @param {number} lng\n     * @param {callback function} handleCoordinates\n     * @returns\n    */\n    this.getLocation = function (lat, lng) {\n      // latitude and longitude should be number type\n      if ((lat && typeof lat !== 'number') || (lng && typeof lng !== 'number')) {\n        console.log('Latitude and Longitude must be of number type')\n        return\n      }\n      if (lat && lng) {\n        // valid latitude ranges bw +-90\n        if (lat <= -90 || lat > 90) {\n          console.log('A vaid latitude must range between -90 and 90')\n          return\n        }\n        // valid longitude ranges bw +-180\n        if (lng <= -180 || lng > 180) {\n          console.log('A valid longitude must range between -180 and 180')\n          return\n        }\n        $ct.location = { Latitude: lat, Longitude: lng }\n        this.sendMultiValueData({ Latitude: lat, Longitude: lng })\n      } else {\n        if (navigator.geolocation) {\n          navigator.geolocation.getCurrentPosition(showPosition.bind(this), showError)\n        } else {\n          console.log('Geolocation is not supported by this browser.')\n        }\n      }\n    }\n\n    function showPosition (position) {\n      var lat = position.coords.latitude\n      var lng = position.coords.longitude\n      $ct.location = { Latitude: lat, Longitude: lng }\n      this.sendMultiValueData({ Latitude: lat, Longitude: lng })\n    }\n\n    function showError (error) {\n      switch (error.code) {\n        case error.PERMISSION_DENIED:\n          console.log('User denied the request for Geolocation.')\n          break\n        case error.POSITION_UNAVAILABLE:\n          console.log('Location information is unavailable.')\n          break\n        case error.TIMEOUT:\n          console.log('The request to get user location timed out.')\n          break\n        case error.UNKNOWN_ERROR:\n          console.log('An unknown error occurred.')\n          break\n      }\n    }\n\n    const api = this.#api\n    api.logout = this.logout\n    api.clear = this.clear\n    api.closeIframe = (campaignId, divIdIgnored) => {\n      closeIframe(campaignId, divIdIgnored, this.#session.sessionId)\n    }\n    api.enableWebPush = (enabled, applicationServerKey) => {\n      this.notifications._enableWebPush(enabled, applicationServerKey)\n    }\n    api.tr = (msg) => {\n      _tr(msg, {\n        device: this.#device,\n        session: this.#session,\n        request: this.#request,\n        logger: this.#logger,\n        isWebPopUpSpamControlDisabled: this.#isWebPopUpSpamControlDisabled\n      })\n    }\n    api.setEnum = (enumVal) => {\n      setEnum(enumVal, this.#logger)\n    }\n    api.is_onloadcalled = () => {\n      return (this.#onloadcalled === 1)\n    }\n    api.subEmail = (reEncoded) => {\n      _handleEmailSubscription('1', reEncoded)\n    }\n    api.getEmail = (reEncoded, withGroups) => {\n      _handleEmailSubscription('-1', reEncoded, withGroups)\n    }\n    api.unSubEmail = (reEncoded) => {\n      _handleEmailSubscription('0', reEncoded)\n    }\n    api.unsubEmailGroups = (reEncoded) => {\n      $ct.unsubGroups = []\n      const elements = document.getElementsByClassName('ct-unsub-group-input-item')\n\n      for (let i = 0; i < elements.length; i++) {\n        const element = elements[i]\n        if (element.name) {\n          const data = { name: element.name, isUnsubscribed: element.checked }\n          $ct.unsubGroups.push(data)\n        }\n      }\n\n      _handleEmailSubscription(GROUP_SUBSCRIPTION_REQUEST_ID, reEncoded)\n    }\n    api.setSubscriptionGroups = (value) => {\n      $ct.unsubGroups = value\n    }\n    api.getSubscriptionGroups = () => {\n      return $ct.unsubGroups\n    }\n    api.changeSubscriptionGroups = (reEncoded, updatedGroups) => {\n      api.setSubscriptionGroups(updatedGroups)\n      _handleEmailSubscription(GROUP_SUBSCRIPTION_REQUEST_ID, reEncoded)\n    }\n    api.setUpdatedCategoryLong = (profile) => {\n      if (profile[categoryLongKey]) {\n        $ct.updatedCategoryLong = profile[categoryLongKey]\n      }\n    }\n    window.$CLTP_WR = window.$WZRK_WR = api\n\n    if (clevertap.account?.[0].id) {\n      // The accountId is present so can init with empty values.\n      // Needed to maintain backward compatability with legacy implementations.\n      // Npm imports/require will need to call init explictly with accountId\n      this.init()\n    }\n  }\n\n  // starts here\n  init (accountId, region, targetDomain) {\n    if (this.#onloadcalled === 1) {\n      // already initailsed\n      return\n    }\n    StorageManager.removeCookie('WZRK_P', window.location.hostname)\n    if (!this.#account.id) {\n      if (!accountId) {\n        this.#logger.error(EMBED_ERROR)\n        return\n      }\n      this.#account.id = accountId\n    }\n    this.#session.cookieName = SCOOKIE_PREFIX + '_' + this.#account.id\n\n    if (region) {\n      this.#account.region = region\n    }\n    if (targetDomain) {\n      this.#account.targetDomain = targetDomain\n    }\n\n    const currLocation = location.href\n    const urlParams = getURLParams(currLocation.toLowerCase())\n\n    // eslint-disable-next-line eqeqeq\n    if (typeof urlParams.e !== 'undefined' && urlParams.wzrk_ex == '0') {\n      return\n    }\n\n    $ct.isPrivacyArrPushed = true\n    if ($ct.privacyArray.length > 0) {\n      this.privacy.push($ct.privacyArray)\n    }\n\n    this.#processOldValues()\n    this.pageChanged()\n    const backupInterval = setInterval(() => {\n      if (this.#device.gcookie) {\n        clearInterval(backupInterval)\n        this.#request.processBackupEvents()\n      }\n    }, 3000)\n    if (this.#isSpa) {\n      // listen to click on the document and check if URL has changed.\n      document.addEventListener('click', this.#boundCheckPageChanged)\n    } else {\n      // remove existing click listeners if any\n      document.removeEventListener('click', this.#boundCheckPageChanged)\n    }\n    this.#onloadcalled = 1\n  }\n\n  // process the option array provided to the clevertap object\n  // after its been initialized\n  #processOldValues () {\n    this.onUserLogin._processOldValues()\n    this.privacy._processOldValues()\n    this.event._processOldValues()\n    this.profile._processOldValues()\n    this.notifications._processOldValues()\n  }\n\n  debounce (func, delay) {\n    let timeout\n    return function () {\n      clearTimeout(timeout)\n      timeout = setTimeout(func, delay)\n    }\n  }\n\n  #checkPageChanged () {\n    const debouncedPageChanged = this.debounce(() => {\n      if (this.#previousUrl !== location.href) {\n        this.pageChanged()\n      }\n    }, 300)\n    debouncedPageChanged()\n  }\n\n  pageChanged () {\n    const currLocation = window.location.href\n    const urlParams = getURLParams(currLocation.toLowerCase())\n    // -- update page count\n    const obj = this.#session.getSessionCookieObject()\n    let pgCount = (typeof obj.p === 'undefined') ? 0 : obj.p\n    obj.p = ++pgCount\n    this.#session.setSessionCookieObject(obj)\n    // -- update page count\n\n    let data = {}\n    let referrerDomain = getDomain(document.referrer)\n\n    if (window.location.hostname !== referrerDomain) {\n      const maxLen = 120\n      if (referrerDomain !== '') {\n        referrerDomain = referrerDomain.length > maxLen ? referrerDomain.substring(0, maxLen) : referrerDomain\n        data.referrer = referrerDomain\n      }\n\n      let utmSource = urlParams.utm_source || urlParams.wzrk_source\n      if (typeof utmSource !== 'undefined') {\n        utmSource = utmSource.length > maxLen ? utmSource.substring(0, maxLen) : utmSource\n        data.us = utmSource // utm_source\n      }\n\n      let utmMedium = urlParams.utm_medium || urlParams.wzrk_medium\n      if (typeof utmMedium !== 'undefined') {\n        utmMedium = utmMedium.length > maxLen ? utmMedium.substring(0, maxLen) : utmMedium\n        data.um = utmMedium // utm_medium\n      }\n\n      let utmCampaign = urlParams.utm_campaign || urlParams.wzrk_campaign\n      if (typeof utmCampaign !== 'undefined') {\n        utmCampaign = utmCampaign.length > maxLen ? utmCampaign.substring(0, maxLen) : utmCampaign\n        data.uc = utmCampaign // utm_campaign\n      }\n\n      // also independently send wzrk_medium to the backend\n      if (typeof urlParams.wzrk_medium !== 'undefined') {\n        const wm = urlParams.wzrk_medium\n        if (wm.match(/^email$|^social$|^search$/)) {\n          data.wm = wm // wzrk_medium\n        }\n      }\n    }\n\n    data = this.#request.addSystemDataToObject(data, undefined)\n    data.cpg = currLocation\n\n    data[CAMP_COOKIE_NAME] = getCampaignObjForLc()\n    let pageLoadUrl = this.#account.dataPostURL\n    this.#request.addFlags(data)\n    // send dsync flag when page = 1\n    if (parseInt(data.pg) === 1) {\n      this.#overrideDSyncFlag(data)\n    }\n    data.af = { lib: 'web-sdk-v$$PACKAGE_VERSION$$' }\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', 'page')\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n\n    this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n\n    this.#previousUrl = currLocation\n    setTimeout(() => {\n      if (pgCount <= 3) {\n        // send ping for up to 3 pages\n        this.#pingRequest()\n      }\n\n      if (this.#isPingContinuous()) {\n        setInterval(() => {\n          this.#pingRequest()\n        }, CONTINUOUS_PING_FREQ_IN_MILLIS)\n      }\n    }, FIRST_PING_FREQ_IN_MILLIS)\n  }\n\n  #pingRequest () {\n    let pageLoadUrl = this.#account.dataPostURL\n    let data = {}\n    data = this.#request.addSystemDataToObject(data, undefined)\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PING)\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n\n    this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n  }\n\n  #isPingContinuous () {\n    return (typeof window.wzrk_d !== 'undefined' && window.wzrk_d.ping === 'continuous')\n  }\n\n  _isPersonalisationActive () {\n    return StorageManager._isLocalStorageSupported() && this.enablePersonalization\n  }\n\n  #overrideDSyncFlag (data) {\n    if (this._isPersonalisationActive()) {\n      data.dsync = true\n    }\n  }\n\n  popupCallbacks = {};\n  popupCurrentWzrkId = '';\n\n  // eslint-disable-next-line accessor-pairs\n  set popupCallback (callback) {\n    this.popupCallbacks[this.popupCurrentWzrkId] = callback\n  }\n\n  /**\n   *\n   * @param {object} payload\n   */\n  sendMultiValueData (payload) {\n    // Send the updated value to LC\n    let data = {}\n    data.af = {}\n    const profileObj = {}\n    data.type = 'profile'\n    if (profileObj.tz == null) {\n      profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n    }\n    data.profile = profileObj\n    if (payload) {\n      const keys = Object.keys(payload)\n      keys.forEach(key => {\n        data.af[key] = payload[key]\n      })\n    }\n    if ($ct.location) {\n      data.af = { ...data.af, ...$ct.location }\n    }\n    data = this.#request.addSystemDataToProfileObject(data, undefined)\n    this.#request.addFlags(data)\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n\n    this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n  }\n\n  // offline mode\n  /**\n   * events will be recorded and queued locally when passed with true\n   * but will not be sent to the server until offline is disabled by passing false\n   * @param {boolean} arg\n   */\n\n  setOffline (arg) {\n    if (typeof arg !== 'boolean') {\n      console.error('setOffline should be called with a value of type boolean')\n      return\n    }\n    $ct.offline = arg\n    // if offline is disabled\n    // process events from cache\n    if (!arg) {\n      this.#request.processBackupEvents()\n    }\n  }\n}\n","import Clevertap from './clevertap'\n\nconst clevertap = new Clevertap(window.clevertap)\n\nwindow.clevertap = window.wizrocket = clevertap\n\nexport default clevertap\n"],"names":["TARGET_DOMAIN","TARGET_PROTOCOL","DEFAULT_REGION","Account","id","region","targetDomain","accountId","dcSDKVersion","finalTargetDomain","unsupportedKeyCharRegex","RegExp","unsupportedValueCharRegex","singleQuoteRegex","CLEAR","CHARGED_ID","CHARGEDID_COOKIE_NAME","GCOOKIE_NAME","KCOOKIE_NAME","CAMP_COOKIE_NAME","CAMP_COOKIE_G","SCOOKIE_PREFIX","SCOOKIE_EXP_TIME_IN_SECS","EV_COOKIE","META_COOKIE","PR_COOKIE","ARP_COOKIE","LCOOKIE_NAME","GLOBAL","DISPLAY","WEBPUSH_LS_KEY","OPTOUT_KEY","CT_OPTOUT_KEY","OPTOUT_COOKIE_ENDSWITH","USEIP_KEY","LRU_CACHE","LRU_CACHE_SIZE","IS_OUL","EVT_PUSH","EVT_PING","COOKIE_EXPIRY","MAX_TRIES","FIRST_PING_FREQ_IN_MILLIS","CONTINUOUS_PING_FREQ_IN_MILLIS","GROUP_SUBSCRIPTION_REQUEST_ID","categoryLongKey","WZRK_PREFIX","WZRK_ID","NOTIFICATION_VIEWED","NOTIFICATION_CLICKED","FIRE_PUSH_UNREGISTERED","PUSH_SUBSCRIPTION_DATA","COMMAND_INCREMENT","COMMAND_DECREMENT","COMMAND_SET","COMMAND_ADD","COMMAND_REMOVE","COMMAND_DELETE","WEBINBOX_CONFIG","WEBINBOX","MAX_INBOX_MSG","SYSTEM_EVENTS","isString","input","String","isObject","Object","prototype","toString","call","isDateObject","Date","isObjectEmpty","obj","prop","hasOwnProperty","isConvertibleToNumber","n","isNaN","parseFloat","isFinite","isNumber","test","isValueValid","value","undefined","removeUnsupportedChars","o","logger","key","sanitizedVal","sanitizedKey","sanitize","length","substring","reportError","val","regex","replace","getToday","today","getFullYear","getMonth","getDay","getNow","Math","floor","getTime","convertToWZRKDate","dateObj","round","setDate","dt","isDateValid","date","matches","exec","d","m","y","composedDate","getDate","StorageManager","_isLocalStorageSupported","localStorage","setItem","JSON","stringify","data","getItem","parse","e","removeItem","name","domain","cookieStr","document","cookie","seconds","expires","domainStr","setTime","toGMTString","encodeURIComponent","nameEQ","ca","split","idx","c","charAt","indexOf","decodeURIComponent","window","property","save","createCookie","location","hostname","$ct","globalCache","read","readCookie","trim","err","broadDomain","domainParts","testBroadDomain","testCookieName","removeCookie","tempCookie","metaObj","readFromLSorCookie","wzrkMetaObj","saveToLSorCookie","getMetaProp","setMetaProp","k","flag","reqNo","backupArr","q","debug","respNo","backupMap","gcookie","REQ_N","RESP_N","globalProfileMap","globalEventsMap","blockRequest","isOptInRequest","webPushEnabled","campaignDivMap","currentSessionId","wiz_counter","notifApi","notifEnabledFromApi","unsubGroups","updatedCategoryLong","inbox","isPrivacyArrPushed","privacyArray","offline","LRUCache","max","lruCache","tempLruCache","cache","entry","push","item","saveCacheToLS","allKeys","objToArray","index","temp","keysArr","keysLength","newCache","indexToDelete","splice","CleverTapAPI","request","device","session","global","resume","respNumber","optOutResponse","oulReq","newGuid","isOULInProgress","oulReqN","removeBackup","sessionObj","getSessionCookieObject","s","getAndClearMetaProp","kIdFromLS","guidFromLRUCache","set","lastK","getSecondLastKey","lastGUID","unregisterTokenForGuid","createBroadCookie","manageSession","t","setSessionCookieObject","processingBackup","processBackupEvents","DeviceManager","getGuid","guid","error","DATA_NOT_SENT_TEXT","CLEVERTAP_ERROR_PREFIX","EMBED_ERROR","EVENT_ERROR","GENDER_ERROR","EMPLOYED_ERROR","MARRIED_ERROR","EDUCATION_ERROR","AGE_ERROR","DOB_ERROR","ENUM_FORMAT_ERROR","PHONE_FORMAT_ERROR","_globalChargedId","isEventStructureFlat","eventObj","Array","isArray","isChargedEventStructureValid","chargedObj","itemKey","chargedId","EventHandler","values","isPersonalisationActive","eventsArr","evtName","evtObj","respObj","firstTime","lastTime","count","eventName","shift","includes","type","unshift","evtData","processEvent","getURLParams","url","urlParams","uri","match","pl","search","decode","replacement","getDomain","a","createElement","href","addToURL","v","getHostName","urlBase64ToUint8Array","base64String","padding","repeat","base64","rawData","atob","processedData","i","charCodeAt","Uint8Array","compressData","dataObject","compressToBase64","compress","uncompressed","context_dictionary","context_dictionaryToCreate","context_c","context_wc","context_w","context_enlargeIn","context_dictSize","context_numBits","context_data_string","context_data_val","context_data_position","ii","f","fromCharCode","pow","getKeyStr","_keyStr","output","chr1","chr2","chr3","enc1","enc2","enc3","enc4","NaN","RequestDispatcher","skipARP","sendOULFlag","skipResARP","_arp","pageLoadUrl","useIP","slice","tries","setTimeout","clevertap","wizrocket","plugin","ctCbScripts","getElementsByClassName","parentNode","removeChild","setAttribute","async","getElementsByTagName","appendChild","getCampaignObject","finalcampObj","campObj","wp","saveCampaignObject","campaignObj","newObj","setCampaignObjectForGuid","guidCampObj","finalCampObj","keys","forEach","campKeyObj","globalObj","dailyObj","campaignIdArray","resultObj","dailyC","totalC","campaignId","console","getCampaignObjForLc","storageValue","decodedValue","parsedValue","resultObjWP","resultObjWI","wi","todayCwp","todayCwi","tc","wmp","wimp","tlc","witlc","isProfileValid","profileObj","valid","profileKey","profileVal","Age","Phone","processFBUserObj","user","profileData","Name","FBID","gender","Gender","getHighestEducation","eduArr","college","highschool","edu","relationship_status","Married","education","Education","work","Employed","email","Email","birthday","mmddyy","DOB","processGPlusUserObj","displayName","GPID","image","isDefault","Photo","emails","emailIdx","emailObj","organizations","orgObj","yyyymmdd","relationshipStatus","addToLocalProfileMap","override","_custom","closeIframe","divIdIgnored","sessionCampaignObj","divId","getElementById","style","display","arp","jsonMap","isOULARP","arpFromStorage","setEnum","enumVal","handleEmailSubscription","subscription","reEncoded","fetchGroups","account","urlParamsAsIs","encodedEmailId","encodedProfileProps","p","emailURL","fireRequest","ProfileHandler","profilesArr","propName","command","tz","profile","addSystemDataToProfileObject","addFlags","dataPostURL","saveAndFireRequest","arrayVal","array","toLowerCase","sendMultiValueData","propKey","propVal","profileArr","outerObj","Site","Facebook","FbProfileObj","GPlusProfileObj","addSystemDataToObject","UserLoginHandler","addToK","ids","g","kId","anonymousUser","foundInCache","getLastKey","gFromCache","get","clear","Identity","cookieName","loginArr","pop","processProfile","setInstantDeleteFlagInK","CTWebPersonalisationBanner","_details","shadow","attachShadow","mode","innerHTML","getBannerContent","trackClick","addEventListener","onClickUrl","details","onClick","open","parent","renderNotificationClicked","msgId","pivotId","renderNotificationViewed","divHeight","css","desktopImageURL","mobileImageURL","html","renderBanner","HTMLElement","CTWebPersonalisationCarousel","_target","_carousel","slides","previouslySelectedItem","selectedItem","autoSlide","stopAutoSlideTimeout","customElements","define","getStyles","carousel","getCarouselContent","showNavBtns","insertAdjacentHTML","navBtnsHtml","showNavArrows","leftNavArrowHtml","rightNavArrowHtml","setupClick","updateSelectedItem","startAutoSlide","setupOnHover","target","wzrk_id","wzrk_pivot","event","eventID","startsWith","selected","endsWith","goToNext","goToPrev","wzrk_slideNo","clearInterval","clearTimeout","detail","banner","classList","add","navBtnsCss","navArrowsCss","prevItem","prevButton","remove","button","setInterval","sliderTime","goTo","prev","cur","renderCarousel","CTWebPopupImageOnly","_session","popup","container","sessionId","getImageOnlyPopupContent","shadowRoot","closeIcon","updateImageAndContainerWidth","msgContent","width","getRenderedImageWidth","setProperty","visibility","img","ratio","naturalWidth","naturalHeight","height","renderImageOnlyPopup","Message","config","message","wrapper","snackBar","renderMessage","part","_el","msg","createEl","templateType","prepareBasicMessage","timeStamp","determineTimeStampText","viewed","unreadMarker","imageUrl","imageContainer","addImage","iconTitleDescWrapper","iconUrl","iconContainer","titleDescWrapper","title","innerText","description","buttons","buttonsContainer","addButtons","hasCopyAction","b","text","cssText","action","addSnackbar","greenTickSvg","clipboardMsg","path","isPreview","raiseClickedForBasicTemplates","payload","tagName","kv","wzrk_c2a","openUrlInNewTab","focus","navigator","clipboard","writeText","clipboardText","log","messageStyles","backgroundColor","borderColor","titleColor","descriptionColor","buttonColor","buttonTextColor","unreadMarkerColor","inboxContainerStyles","panelBackgroundColor","panelBorderColor","headerBackgroundColor","headerTitleColor","closeIconColor","categoriesTabColor","categoriesTitleColor","categoriesBorderColor","selectedCategoryTabColor","selectedCategoryTitleColor","selectedCategoryBorderColor","headerCategoryAndPoweredByCTHeight","Inbox","isInboxOpen","selectedCategory","unviewedMessages","unviewedCounter","inboxConfigForPreview","inboxSelector","emptyInboxMsg","inboxCard","unviewedBadge","observer","selectedCategoryRef","addClickListenerOnDocument","composedPath","toggleInbox","prevCategoryRef","updateActiveCategory","_path","filter","messageEl","raiseClickedEvent","contains","setBadgeStyle","msgCount","init","styles","notificationsBadge","addUnviewedBadge","createinbox","removeEventListener","categories","getInboxStyles","messages","deleteExpiredAndGetUnexpiredMsgs","msgIds","buildUIForMessages","updateUnviewedBadgeCounter","deleteMsgsFromUI","getInboxMessages","now","wzrk_ttl","el","sort","reduce","acc","saveInboxMessages","msgs","inboxMsgs","incomingMsgs","textColor","body","updateUnviewedBadgePosition","getBoundingClientRect","top","right","left","header","headerTitle","createCategories","hidePoweredByCT","poweredByText","src","options","root","rootMargin","threshold","IntersectionObserver","entries","handleMessageViewed","addMsgsToInboxFromLS","categoriesContainer","leftArrow","arrowSvg","children","scrollBy","categoriesWrapper","_categories","category","rightArrow","firstCategory","lastCategory","firstCategoryObserver","categoryObserverCb","intersectionRatio","observe","lastCategoryObserver","hide","activeCategory","scrollTop","counter","childNodes","getAttribute","updateTSForRenderedMsgs","maxMsgsInInbox","firstChild","tags","insertBefore","msgTotalCount","querySelectorAll","ctInboxMsgs","hasMessages","raiseViewedEvent","isIntersecting","updateMessageInLS","zIndex","scrollLeft","scrollWidth","setInboxPosition","windowWidth","outerWidth","customInboxStyles","getComputedStyle","getPropertyValue","bottom","hasPositionDefined","res","getInboxPosition","clientHeight","clientWidth","xPos","yPos","ts","headerHeight","categoriesHeight","hidePoweredByCTHeight","tabColor","selectedTab","inboxStyles","cardStyles","cards","msgStyles","updateInboxMessages","processWebInboxSettings","webInboxSetting","_settings","processInboxNotifs","inbox_preview","incomingMessagesForPreview","inbox_notifs","incomingMessages","addWebInbox","checkAndRegisterWebInboxElements","getAndMigrateInboxMessages","gudInboxObj","storedInboxObj","initializeWebInbox","Promise","resolve","reject","readyState","onLoaded","inboxHeight","inboxWidth","horizontalScroll","scrollingElement","verticalScroll","innerWidth","windowHeight","innerHeight","selectorRect","selectorX","x","selectorY","selectorLeft","selectorRight","selectorTop","selectorBottom","selectorHeight","selectorWidth","selectorCenter","halfOfInboxHeight","halfOfInboxWidth","inboxOnSide","availableHeight","inboxRight","availableWidth","inboxLeft","diff","hasWebInboxSettingsInLS","_tr","isWebPopUpSpamControlDisabled","_device","_request","_logger","_wizCounter","doCampHouseKeeping","targetingMsgJson","incrCount","excludeFromFreqCaps","currentCount","totalCount","sessionStorage","campTypeObj","wtarget_type","wmc","wimc","campaignSessionLimit","campaignDailyLimit","campaignTotalLimit","totalDailyLimit","totalSessionLimit","totalInboxSessionLimit","efc","parseInt","mdc","tdc","campaignSessionCount","totalSessionCount","campaignDailyCount","totalDailyCount","campaignTotalCount","delay","campKey","newCampObj","getCookieParams","scookieObj","setupClickEvent","contentDiv","isLegacy","ctaElement","jsCTAElements","jsFunc","preview","onclick","invokeExternalJs","func","setupClickUrl","incrementImpression","renderPersonalisationBanner","divSelector","bannerEl","containerEl","querySelector","renderPersonalisationCarousel","renderPopUpImageOnly","popupImageOnly","renderFooterNotification","displayObj","inaObj","kvPairsEvent","CustomEvent","dispatchEvent","layout","showExitIntent","element","msgDiv","isBanner","viewHeight","viewWidth","legacy","marginBottom","contentHeight","bottomPosition","widthPerct","userAgent","proto","iFrameStyle","iframe","borderRadius","br","frameborder","marginheight","marginwidth","scrolling","pointerCss","bgColor","btnBg","leftTd","btColor","theme","titleText","descriptionText","imageTd","onClickStr","ifrm","contentWindow","contentDocument","doc","write","appendScriptForCustomEvent","close","adjustIFrameHeight","scrollHeight","margin","ua","onload","inDoc","_timer","script","_callBackCalled","showFooterNotification","notificationCallback","raiseNotificationClicked","raiseNotificationViewed","popupCurrentWzrkId","popupCallbacks","popupCallback","msgCTkv","wzrkPrefixKey","wzrkJson","raisePopupNotificationClicked","notificationData","eventData","wzrkPrefixObj","exitintentObj","targetObj","clientY","opacityDiv","ctaText","processNativeDisplayArr","arrInAppNotifs","map","elementId","addLoadListener","inapp_notifs","targetNotif","onmouseleave","mergeEventMap","newEvtMap","oldEvtObj","newEvtObj","handleInboxNotifications","msgArr","then","catch","staleDataUpdate","staledata","campType","evpr","eventsMap","events","profileMap","syncExpiry","expires_in","inapp_stale","inbox_stale","User","visitCount","prevSession","logLevels","DISABLE","ERROR","INFO","DEBUG","Logger","logLevel","wzrkError","code","level","WZRK_D","SessionManager","scookieStr","objStr","currentSessionInLS","sessionCount","sessionStart","seqNo","requestTime","RequestManager","backupEvent","fired","ignoreTrim","wzrk_error","pg","rc","lastSyncTime","expirySeconds","dsync","givenGUID","compressedData","registerToken","nowTs","evtDetail","Privacy","privacyArr","privacyObj","curr","optOut","shouldUseIP","NotificationHandler","displayArgs","enabled","applicationServerKey","subscriptionCallback","serviceWorkerPath","apnsWebPushId","apnsServiceUrl","safari","pushNotification","requestPermission","permission","subscriptionData","endpoint","deviceToken","browser","info","registrationScope","serviceWorker","register","registration","__wzrk_account_id","scope","rootDirRegex","isServiceWorkerAtRoot","ready","getRegistrations","serviceWorkerRegistration","subscribeObj","userVisibleOnly","pushManager","subscribe","getSubscription","unsubscribe","successful","scriptTag","bodyText","okButtonText","rejectButtonText","okButtonColor","skipDialog","askAgainTimeInSeconds","okCallback","rejectCallback","httpsPopupPath","httpsIframePath","apnsWebPushServiceUrl","notifObj","isHTTP","protocol","chromeAgent","firefoxAgent","safariAgent","Notification","httpsIframe","state","from","wzrkPermissionPopup","wizAlert","confirmButtonText","confirmButtonColor","CleverTap","isSpa","bind","enablePersonalization","_isPersonalisationActive","ReqestManager","onUserLogin","privacy","notifications","spa","dismissSpamControl","getTimeElapsed","getPageCount","logout","getCleverTapID","getAccountID","getSCDomain","setSCSDKVersion","ver","scSDKVersion","af","scv","getInboxMessageCount","getInboxMessageUnreadCount","getAllInboxMessages","getUnreadInboxMessages","getInboxMessageForId","messageId","deleteInboxMessage","markReadInboxMessage","unreadMsg","markReadAllInboxMessage","processNotificationEvent","eventDetail","setLogLevel","l","Number","handleIncrementValue","_handleIncrementDecrementValue","handleDecrementValue","setMultiValuesForKey","_handleMultiValueSet","addMultiValueForKey","_handleMultiValueAdd","addMultiValuesForKey","removeMultiValueForKey","_handleMultiValueRemove","removeMultiValuesForKey","removeValueForKey","_handleMultiValueDelete","_handleEmailSubscription","getLocation","lat","lng","Latitude","Longitude","geolocation","getCurrentPosition","showPosition","showError","position","coords","latitude","longitude","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","UNKNOWN_ERROR","api","enableWebPush","_enableWebPush","tr","is_onloadcalled","subEmail","getEmail","withGroups","unSubEmail","unsubEmailGroups","elements","isUnsubscribed","checked","setSubscriptionGroups","getSubscriptionGroups","changeSubscriptionGroups","updatedGroups","setUpdatedCategoryLong","$CLTP_WR","$WZRK_WR","currLocation","wzrk_ex","pageChanged","backupInterval","timeout","pgCount","referrerDomain","referrer","maxLen","utmSource","utm_source","wzrk_source","us","utmMedium","utm_medium","wzrk_medium","um","utmCampaign","utm_campaign","wzrk_campaign","uc","wm","cpg","lib","arg","callback","_processOldValues","debouncedPageChanged","debounce","wzrk_d","ping","Clevertap"],"mappings":"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"}

>>>>>>> 30b356831a1acea99c8cf87a6941f09e9de0f134
