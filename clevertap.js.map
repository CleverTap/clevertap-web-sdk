{"version":3,"file":"clevertap.js","sources":["src/options.js","src/modules/account.js","src/util/constants.js","src/util/datatypes.js","src/util/datetime.js","src/util/storage.js","src/util/lruCache.js","src/modules/api.js","src/modules/device.js","src/util/messages.js","src/util/validator.js","src/modules/event.js","src/util/url.js","src/util/encoder.js","src/util/requestDispatcher.js","src/util/clevertap.js","src/modules/profile.js","src/modules/userLogin.js","src/util/tr.js","src/modules/user.js","src/modules/logger.js","src/modules/session.js","src/modules/request.js","src/modules/privacy.js","src/modules/notification.js","src/clevertap.js","src/main.js"],"sourcesContent":["export const TARGET_DOMAIN = 'clevertap-prod.com'\nexport const TARGET_PROTOCOL = 'https:'\nexport const DEFAULT_REGION = 'eu1'\n","import { DEFAULT_REGION, TARGET_DOMAIN, TARGET_PROTOCOL } from '../options'\n\nexport default class Account {\n  #accountId\n  #region = ''\n  #targetDomain = TARGET_DOMAIN\n  #dcSdkversion = ''\n\n  constructor ({ id } = {}, region = '', targetDomain = TARGET_DOMAIN) {\n    this.id = id\n    if (region) {\n      this.region = region\n    }\n    if (targetDomain) {\n      this.targetDomain = targetDomain\n    }\n  }\n\n  get id () {\n    return this.#accountId\n  }\n\n  set id (accountId) {\n    this.#accountId = accountId\n  }\n\n  get region () {\n    return this.#region\n  }\n\n  set region (region) {\n    this.#region = region\n  }\n\n  get dcSDKVersion () {\n    return this.#dcSdkversion\n  }\n\n  set dcSDKVersion (dcSDKVersion) {\n    this.#dcSdkversion = dcSDKVersion\n  }\n\n  get targetDomain () {\n    return this.#targetDomain\n  }\n\n  set targetDomain (targetDomain) {\n    this.#targetDomain = targetDomain\n  }\n\n  get finalTargetDomain () {\n    if (this.region) {\n      return `${this.region}.${this.targetDomain}`\n    } else {\n      if (this.targetDomain === TARGET_DOMAIN) {\n        return `${DEFAULT_REGION}.${this.targetDomain}`\n      }\n      return this.targetDomain\n    }\n  }\n\n  get dataPostURL () {\n    return `${TARGET_PROTOCOL}//${this.finalTargetDomain}/a?t=96`\n  }\n\n  get recorderURL () {\n    return `${TARGET_PROTOCOL}//${this.finalTargetDomain}/r?r=1`\n  }\n\n  get emailURL () {\n    return `${TARGET_PROTOCOL}//${this.finalTargetDomain}/e?r=1`\n  }\n}\n","export const unsupportedKeyCharRegex = new RegExp('^\\\\s+|\\\\\\.|\\:|\\\\\\$|\\'|\\\"|\\\\\\\\|\\\\s+$', 'g')\nexport const unsupportedValueCharRegex = new RegExp(\"^\\\\s+|\\'|\\\"|\\\\\\\\|\\\\s+$\", 'g')\nexport const doubleQuoteRegex = new RegExp('\\\"', 'g')\nexport const singleQuoteRegex = new RegExp('\\'', 'g')\nexport const CLEAR = 'clear'\nexport const CHARGED_ID = 'Charged ID'\nexport const CHARGEDID_COOKIE_NAME = 'WZRK_CHARGED_ID'\nexport const GCOOKIE_NAME = 'WZRK_G'\nexport const KCOOKIE_NAME = 'WZRK_K'\nexport const CAMP_COOKIE_NAME = 'WZRK_CAMP'\nexport const SCOOKIE_PREFIX = 'WZRK_S'\nexport const SCOOKIE_EXP_TIME_IN_SECS = 60 * 20 // 20 mins\nexport const EV_COOKIE = 'WZRK_EV'\nexport const META_COOKIE = 'WZRK_META'\nexport const PR_COOKIE = 'WZRK_PR'\nexport const ARP_COOKIE = 'WZRK_ARP'\nexport const LCOOKIE_NAME = 'WZRK_L'\nexport const NOTIF_COOKIE_NAME = 'WZRK_N'\nexport const GLOBAL = 'global'\nexport const TOTAL_COUNT = 'tc'\nexport const DISPLAY = 'display'\nexport const UNDEFINED = 'undefined'\nexport const WEBPUSH_LS_KEY = 'WZRK_WPR'\nexport const OPTOUT_KEY = 'optOut'\nexport const CT_OPTOUT_KEY = 'ct_optout'\nexport const OPTOUT_COOKIE_ENDSWITH = ':OO'\nexport const USEIP_KEY = 'useIP'\nexport const LRU_CACHE = 'WZRK_X'\nexport const LRU_CACHE_SIZE = 100\nexport const IS_OUL = 'isOUL'\nexport const EVT_PUSH = 'push'\nexport const EVT_PING = 'ping'\nexport const COOKIE_EXPIRY = 86400 * 365 * 10 // 10 Years in seconds\nexport const MAX_TRIES = 50 // API tries\nexport const FIRST_PING_FREQ_IN_MILLIS = 2 * 60 * 1000 // 2 mins\nexport const CONTINUOUS_PING_FREQ_IN_MILLIS = 5 * 60 * 1000 // 5 mins\nexport const GROUP_SUBSCRIPTION_REQUEST_ID = '2'\nexport const categoryLongKey = 'cUsY'\nexport const WZRK_PREFIX = 'wzrk_'\nexport const WZRK_ID = 'wzrk_id'\nexport const NOTIFICATION_VIEWED = 'Notification Viewed'\nexport const NOTIFICATION_CLICKED = 'Notification Clicked'\nexport const FIRE_PUSH_UNREGISTERED = 'WZRK_FPU'\nexport const PUSH_SUBSCRIPTION_DATA = 'WZRK_PSD' // PUSH SUBSCRIPTION DATA FOR REGISTER/UNREGISTER TOKEN\n\nexport const SYSTEM_EVENTS = [\n  'Stayed',\n  'UTM Visited',\n  'App Launched',\n  'Notification Sent',\n  NOTIFICATION_VIEWED,\n  NOTIFICATION_CLICKED\n]\n","import {\n  unsupportedKeyCharRegex,\n  unsupportedValueCharRegex\n} from './constants'\n\nexport const isString = (input) => {\n  return (typeof input === 'string' || input instanceof String)\n}\n\nexport const isObject = (input) => {\n  // TODO: refine\n  return Object.prototype.toString.call(input) === '[object Object]'\n}\n\nexport const isDateObject = (input) => {\n  return typeof (input) === 'object' && (input instanceof Date)\n}\n\nexport const isObjectEmpty = (obj) => {\n  for (const prop in obj) {\n    if (obj.hasOwnProperty(prop)) { return false }\n  }\n  return true\n}\n\nexport const isConvertibleToNumber = (n) => {\n  return !isNaN(parseFloat(n)) && isFinite(n)\n}\n\nexport const isNumber = (n) => {\n  return /^-?[\\d.]+(?:e-?\\d+)?$/.test(n) && typeof n === 'number'\n}\n\nexport const isValueValid = (value) => {\n  if (value === null || value === undefined || value === 'undefined') {\n    return false\n  }\n  return true\n}\n\nexport const arrayContains = (arr, obj) => {\n  var i = arr.length\n  while (i--) {\n    if (arr[i] === obj) {\n      return true\n    }\n  }\n  return false\n}\n\nexport const removeUnsupportedChars = (o, logger) => {\n  // keys can't be greater than 1024 chars, values can't be greater than 1024 chars\n  if (typeof o === 'object') {\n    for (const key in o) {\n      if (o.hasOwnProperty(key)) {\n        const sanitizedVal = removeUnsupportedChars(o[key], logger)\n        let sanitizedKey\n        sanitizedKey = sanitize(key, unsupportedKeyCharRegex)\n        if (sanitizedKey.length > 1024) {\n          sanitizedKey = sanitizedKey.substring(0, 1024)\n          logger.reportError(520, sanitizedKey + '... length exceeded 1024 chars. Trimmed.')\n        }\n        delete o[key]\n        o[sanitizedKey] = sanitizedVal\n      }\n    }\n  } else {\n    let val\n\n    if (isString(o)) {\n      val = sanitize(o, unsupportedValueCharRegex)\n      if (val.length > 1024) {\n        val = val.substring(0, 1024)\n        logger.reportError(521, val + '... length exceeded 1024 chars. Trimmed.')\n      }\n    } else {\n      val = o\n    }\n    return val\n  }\n  return o\n}\n\nexport const sanitize = (input, regex) => {\n  return input.replace(regex, '')\n}\n","export const getToday = () => {\n  const today = new Date()\n  return today.getFullYear() + '' + today.getMonth() + '' + today.getDay()\n}\n\nexport const getNow = () => {\n  return Math.floor((new Date()).getTime() / 1000)\n}\n\nexport const convertToWZRKDate = (dateObj) => {\n  return ('$D_' + Math.round(dateObj.getTime() / 1000))\n}\n\nexport const setDate = (dt) => {\n  // expecting  yyyymmdd format either as a number or a string\n  if (isDateValid(dt)) {\n    return '$D_' + dt\n  }\n}\n\nexport const isDateValid = (date) => {\n  const matches = /^(\\d{4})(\\d{2})(\\d{2})$/.exec(date)\n  if (matches == null) return false\n  const d = matches[3]\n  const m = matches[2] - 1\n  const y = matches[1]\n  const composedDate = new Date(y, m, d)\n  // eslint-disable-next-line eqeqeq\n  return composedDate.getDate() == d && composedDate.getMonth() == m && composedDate.getFullYear() == y\n}\n","import {\n  GCOOKIE_NAME,\n  META_COOKIE,\n  KCOOKIE_NAME,\n  LCOOKIE_NAME\n} from './constants'\nexport class StorageManager {\n  static save (key, value) {\n    if (!key || !value) {\n      return false\n    }\n    if (this._isLocalStorageSupported()) {\n      localStorage.setItem(key, typeof value === 'string' ? value : JSON.stringify(value))\n      return true\n    }\n  }\n\n  static read (key) {\n    if (!key) {\n      return false\n    }\n    let data = null\n    if (this._isLocalStorageSupported()) {\n      data = localStorage.getItem(key)\n    }\n    if (data != null) {\n      try {\n        data = JSON.parse(data)\n      } catch (e) {}\n    }\n    return data\n  }\n\n  static remove (key) {\n    if (!key) {\n      return false\n    }\n    if (this._isLocalStorageSupported()) {\n      localStorage.removeItem(key)\n      return true\n    }\n  }\n\n  static removeCookie (name, domain) {\n    let cookieStr = name + '=; expires=Thu, 01 Jan 1970 00:00:01 GMT;'\n\n    if (domain) {\n      cookieStr = cookieStr + ' domain=' + domain + '; path=/'\n    }\n\n    document.cookie = cookieStr\n  }\n\n  static createCookie (name, value, seconds, domain) {\n    let expires = ''\n    let domainStr = ''\n    if (seconds) {\n      const date = new Date()\n      date.setTime(date.getTime() + (seconds * 1000))\n\n      expires = '; expires=' + date.toGMTString()\n    }\n\n    if (domain) {\n      domainStr = '; domain=' + domain\n    }\n\n    value = encodeURIComponent(value)\n\n    document.cookie = name + '=' + value + expires + domainStr + '; path=/'\n  }\n\n  static readCookie (name) {\n    const nameEQ = name + '='\n    const ca = document.cookie.split(';')\n    for (let idx = 0; idx < ca.length; idx++) {\n      let c = ca[idx]\n      while (c.charAt(0) === ' ') {\n        c = c.substring(1, c.length)\n      }\n      // eslint-disable-next-line eqeqeq\n      if (c.indexOf(nameEQ) == 0) {\n        return decodeURIComponent(c.substring(nameEQ.length, c.length))\n      }\n    }\n    return null\n  }\n\n  static _isLocalStorageSupported () {\n    return 'localStorage' in window && window.localStorage !== null && typeof window.localStorage.setItem === 'function'\n  }\n\n  static saveToLSorCookie (property, value) {\n    if (value == null) {\n      return\n    }\n    try {\n      if (this._isLocalStorageSupported()) {\n        this.save(property, encodeURIComponent(JSON.stringify(value)))\n      } else {\n        if (property === GCOOKIE_NAME) {\n          this.createCookie(property, encodeURIComponent(value), 0, window.location.hostname)\n        } else {\n          this.createCookie(property, encodeURIComponent(JSON.stringify(value)), 0, window.location.hostname)\n        }\n      }\n      $ct.globalCache[property] = value\n    } catch (e) {}\n  }\n\n  static readFromLSorCookie (property) {\n    let data\n    if ($ct.globalCache.hasOwnProperty(property)) {\n      return $ct.globalCache[property]\n    }\n    if (this._isLocalStorageSupported()) {\n      data = this.read(property)\n    } else {\n      data = this.readCookie(property)\n    }\n\n    if (data !== null && data !== undefined && !(typeof data.trim === 'function' && data.trim() === '')) {\n      let value\n      try {\n        value = JSON.parse(decodeURIComponent(data))\n      } catch (err) {\n        value = decodeURIComponent(data)\n      }\n      $ct.globalCache[property] = value\n      return value\n    }\n  }\n\n  static createBroadCookie (name, value, seconds, domain) {\n    // sets cookie on the base domain. e.g. if domain is baz.foo.bar.com, set cookie on \".bar.com\"\n    // To update an existing \"broad domain\" cookie, we need to know what domain it was actually set on.\n    // since a retrieved cookie never tells which domain it was set on, we need to set another test cookie\n    // to find out which \"broadest\" domain the cookie was set on. Then delete the test cookie, and use that domain\n    // for updating the actual cookie.\n\n    if (domain) {\n      let broadDomain = $ct.broadDomain\n      if (broadDomain == null) { // if we don't know the broadDomain yet, then find out\n        const domainParts = domain.split('.')\n        let testBroadDomain = ''\n        for (let idx = domainParts.length - 1; idx >= 0; idx--) {\n          if (idx === 0) {\n            testBroadDomain = domainParts[idx] + testBroadDomain\n          } else {\n            testBroadDomain = '.' + domainParts[idx] + testBroadDomain\n          }\n\n          // only needed if the cookie already exists and needs to be updated. See note above.\n          if (this.readCookie(name)) {\n            // no guarantee that browser will delete cookie, hence create short lived cookies\n            var testCookieName = 'test_' + name + idx\n            this.createCookie(testCookieName, value, 10, testBroadDomain) // self-destruct after 10 seconds\n            if (!this.readCookie(testCookieName)) { // if test cookie not set, then the actual cookie wouldn't have been set on this domain either.\n              continue\n            } else { // else if cookie set, then delete the test and the original cookie\n              this.removeCookie(testCookieName, testBroadDomain)\n            }\n          }\n\n          this.createCookie(name, value, seconds, testBroadDomain)\n          const tempCookie = this.readCookie(name)\n          // eslint-disable-next-line eqeqeq\n          if (tempCookie == value) {\n            broadDomain = testBroadDomain\n            $ct.broadDomain = broadDomain\n            break\n          }\n        }\n      } else {\n        this.createCookie(name, value, seconds, broadDomain)\n      }\n    } else {\n      this.createCookie(name, value, seconds, domain)\n    }\n  }\n\n  static getMetaProp (property) {\n    const metaObj = this.readFromLSorCookie(META_COOKIE)\n    if (metaObj != null) {\n      return metaObj[property]\n    }\n  }\n\n  static setMetaProp (property, value) {\n    if (this._isLocalStorageSupported()) {\n      let wzrkMetaObj = this.readFromLSorCookie(META_COOKIE)\n      if (wzrkMetaObj == null) {\n        wzrkMetaObj = {}\n      }\n      if (value === undefined) {\n        delete wzrkMetaObj[property]\n      } else {\n        wzrkMetaObj[property] = value\n      }\n      this.saveToLSorCookie(META_COOKIE, wzrkMetaObj)\n    }\n  }\n\n  static getAndClearMetaProp (property) {\n    const value = this.getMetaProp(property)\n    this.setMetaProp(property, undefined)\n    return value\n  }\n\n  static setInstantDeleteFlagInK () {\n    let k = this.readFromLSorCookie(KCOOKIE_NAME)\n    if (k == null) {\n      k = {}\n    }\n    k.flag = true\n    this.saveToLSorCookie(KCOOKIE_NAME, k)\n  }\n\n  static backupEvent (data, reqNo, logger) {\n    let backupArr = this.readFromLSorCookie(LCOOKIE_NAME)\n    if (typeof backupArr === 'undefined') {\n      backupArr = {}\n    }\n    backupArr[reqNo] = { q: data }\n    this.saveToLSorCookie(LCOOKIE_NAME, backupArr)\n    logger.debug(`stored in ${LCOOKIE_NAME} reqNo : ${reqNo} -> ${data}`)\n  }\n\n  static removeBackup (respNo, logger) {\n    const backupMap = this.readFromLSorCookie(LCOOKIE_NAME)\n    if (typeof backupMap !== 'undefined' && backupMap !== null && typeof backupMap[respNo] !== 'undefined') {\n      logger.debug(`del event: ${respNo} data-> ${backupMap[respNo].q}`)\n      delete backupMap[respNo]\n      this.saveToLSorCookie(LCOOKIE_NAME, backupMap)\n    }\n  }\n}\n\nexport const $ct = {\n  globalCache: {\n    gcookie: null,\n    REQ_N: 0,\n    RESP_N: 0\n  },\n  LRU_cache: null,\n  globalProfileMap: undefined,\n  globalEventsMap: undefined,\n  blockRequest: false,\n  isOptInRequest: false,\n  broadDomain: null,\n  webPushEnabled: null,\n  campaignDivMap: {},\n  currentSessionId: null,\n  wiz_counter: 0, // to keep track of number of times we load the body\n  notifApi: {\n    notifEnabledFromApi: false\n  }, // helper variable to handle race condition and check when notifications were called\n  unsubGroups: [],\n  updatedCategoryLong: null\n  // domain: window.location.hostname, url -> getHostName()\n  // gcookie: -> device\n}\n","import { StorageManager } from './storage'\nimport { LRU_CACHE } from './constants'\n\nexport default class LRUCache {\n  #keyOrder\n\n  constructor (max) {\n    this.max = max\n    let lruCache = StorageManager.readFromLSorCookie(LRU_CACHE)\n    if (lruCache) {\n      const tempLruCache = {}\n      this.#keyOrder = []\n      lruCache = lruCache.cache\n      for (const entry in lruCache) {\n        if (lruCache.hasOwnProperty(entry)) {\n          tempLruCache[lruCache[entry][0]] = lruCache[entry][1]\n          this.#keyOrder.push(lruCache[entry][0])\n        }\n      }\n      this.cache = tempLruCache\n    } else {\n      this.cache = {}\n      this.#keyOrder = []\n    }\n  }\n\n  get (key) {\n    const item = this.cache[key]\n    if (item) {\n      this.cache = this.#deleteFromObject(key, this.cache)\n      this.cache[key] = item\n      this.#keyOrder.push(key)\n    }\n    this.saveCacheToLS(this.cache)\n    return item\n  }\n\n  set (key, value) {\n    const item = this.cache[key]\n    const allKeys = this.#keyOrder\n    if (item != null) {\n      this.cache = this.#deleteFromObject(key, this.cache)\n    } else if (allKeys.length === this.max) {\n      this.cache = this.#deleteFromObject(allKeys[0], this.cache)\n    }\n    this.cache[key] = value\n    if (this.#keyOrder[this.#keyOrder - 1] !== key) {\n      this.#keyOrder.push(key)\n    }\n    this.saveCacheToLS(this.cache)\n  }\n\n  saveCacheToLS (cache) {\n    const objToArray = []\n    const allKeys = this.#keyOrder\n    for (const index in allKeys) {\n      if (allKeys.hasOwnProperty(index)) {\n        const temp = []\n        temp.push(allKeys[index])\n        temp.push(cache[allKeys[index]])\n        objToArray.push(temp)\n      }\n    }\n    StorageManager.saveToLSorCookie(LRU_CACHE, { cache: objToArray })\n  }\n\n  getKey (value) {\n    if (value === null) {\n      return null\n    }\n    const allKeys = this.#keyOrder\n    for (const index in allKeys) {\n      if (allKeys.hasOwnProperty(index)) {\n        if (this.cache[allKeys[index]] === value) {\n          return allKeys[index]\n        }\n      }\n    }\n    return null\n  }\n\n  getSecondLastKey () {\n    const keysArr = this.#keyOrder\n    if (keysArr != null && keysArr.length > 1) {\n      return keysArr[keysArr.length - 2]\n    }\n    return -1\n  }\n\n  getLastKey () {\n    const keysLength = this.#keyOrder.length\n    if (keysLength) {\n      return this.#keyOrder[keysLength - 1]\n    }\n  }\n\n  #deleteFromObject (key, obj) {\n    const allKeys = JSON.parse(JSON.stringify(this.#keyOrder))\n    const newCache = {}\n    let indexToDelete\n    for (const index in allKeys) {\n      if (allKeys.hasOwnProperty(index)) {\n        if (allKeys[index] !== key) {\n          newCache[allKeys[index]] = obj[allKeys[index]]\n        } else {\n          indexToDelete = index\n        }\n      }\n    }\n    allKeys.splice(indexToDelete, 1)\n    this.#keyOrder = JSON.parse(JSON.stringify(allKeys))\n    return newCache\n  }\n}\n","import { COOKIE_EXPIRY, FIRE_PUSH_UNREGISTERED, GCOOKIE_NAME, KCOOKIE_NAME, LRU_CACHE_SIZE, USEIP_KEY } from '../util/constants'\nimport { isValueValid } from '../util/datatypes'\nimport { getNow } from '../util/datetime'\nimport LRUCache from '../util/lruCache'\nimport { StorageManager, $ct } from '../util/storage'\n\nexport default class CleverTapAPI {\n  #logger\n  #request\n  #device\n  #session\n\n  constructor ({ logger, request, device, session }) {\n    this.#logger = logger\n    this.#request = request\n    this.#device = device\n    this.#session = session\n  }\n\n  s (global, session, resume, respNumber, optOutResponse) {\n    // call back function used to store global and session ids for the user\n    if (typeof respNumber === 'undefined') {\n      respNumber = 0\n    }\n\n    StorageManager.removeBackup(respNumber, this.#logger)\n\n    if (respNumber > $ct.globalCache.REQ_N) {\n      // request for some other user so ignore\n      return\n    }\n\n    if (!isValueValid(this.#device.gcookie) || resume || typeof optOutResponse === 'boolean') {\n      if (!isValueValid(this.#device.gcookie)) {\n        // clear useIP meta prop\n        StorageManager.getAndClearMetaProp(USEIP_KEY)\n      }\n      this.#logger.debug(`Cookie was ${this.#device.gcookie} set to ${global}`)\n      this.#device.gcookie = global\n\n      if (global && StorageManager._isLocalStorageSupported()) {\n        if ($ct.LRU_CACHE == null) {\n          $ct.LRU_CACHE = new LRUCache(LRU_CACHE_SIZE)\n        }\n\n        const kIdFromLS = StorageManager.readFromLSorCookie(KCOOKIE_NAME)\n        if (kIdFromLS != null && kIdFromLS.id && resume) {\n          const guidFromLRUCache = $ct.LRU_CACHE.cache[kIdFromLS.id]\n          if (!guidFromLRUCache) {\n            StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, true)\n            $ct.LRU_CACHE.set(kIdFromLS.id, global)\n          }\n        }\n\n        StorageManager.saveToLSorCookie(GCOOKIE_NAME, global)\n        const lastK = $ct.LRU_CACHE.getSecondLastKey()\n        if (StorageManager.readFromLSorCookie(FIRE_PUSH_UNREGISTERED) && lastK !== -1) {\n          const lastGUID = $ct.LRU_CACHE.cache[lastK]\n          this.#request.unregisterTokenForGuid(lastGUID)\n        }\n      }\n\n      StorageManager.createBroadCookie(GCOOKIE_NAME, global, COOKIE_EXPIRY, window.location.hostname)\n      StorageManager.saveToLSorCookie(GCOOKIE_NAME, global)\n    }\n\n    if (resume) {\n      $ct.blockRequest = false\n      this.#logger.debug('Resumed requests')\n    }\n\n    if (StorageManager._isLocalStorageSupported()) {\n      this.#session.manageSession(session)\n    }\n\n    // session cookie\n    const obj = this.#session.getSessionCookieObject()\n\n    // for the race-condition where two responses come back with different session ids. don't write the older session id.\n    if (typeof obj.s === 'undefined' || obj.s <= session) {\n      obj.s = session\n      obj.t = getNow() // time of last response from server\n      this.#session.setSessionCookieObject(obj)\n    }\n\n    if (resume && !this.#request.processingBackup) {\n      this.#request.processBackupEvents()\n    }\n\n    $ct.globalCache.RESP_N = respNumber\n  }\n}\n","import { isValueValid } from '../util/datatypes'\nimport { StorageManager } from '../util/storage'\nimport { GCOOKIE_NAME, COOKIE_EXPIRY } from '../util/constants'\n\nexport default class DeviceManager {\n  #logger\n  gcookie\n\n  constructor ({ logger }) {\n    this.#logger = logger\n    this.gcookie = this.getGuid()\n  }\n\n  getGuid () {\n    let guid = null\n    if (isValueValid(this.gcookie)) {\n      return this.gcookie\n    }\n    if (StorageManager._isLocalStorageSupported()) {\n      const value = StorageManager.read(GCOOKIE_NAME)\n      if (isValueValid(value)) {\n        try {\n          guid = JSON.parse(decodeURIComponent(value))\n        } catch (e) {\n          this.#logger.debug('Cannot parse Gcookie from localstorage - must be encoded ' + value)\n          // assumming guids are of size 32. supporting both formats.\n          // guid can have encodedURIComponent or be without it.\n          // 1.56e4078ed15749928c042479ec2b4d47 - breaks on JSON.parse(decodeURIComponent())\n          // 2.%2256e4078ed15749928c042479ec2b4d47%22\n          if (value.length === 32) {\n            guid = value\n            StorageManager.saveToLSorCookie(GCOOKIE_NAME, value)\n          } else {\n            this.#logger.error('Illegal guid ' + value)\n          }\n        }\n\n        // Persist to cookie storage if not present there.\n        if (isValueValid(guid)) {\n          StorageManager.createBroadCookie(GCOOKIE_NAME, guid, COOKIE_EXPIRY, window.location.hostname)\n        }\n      }\n    }\n\n    if (!isValueValid(guid)) {\n      guid = StorageManager.readCookie(GCOOKIE_NAME)\n      if (isValueValid(guid) && (guid.indexOf('%') === 0 || guid.indexOf('\\'') === 0 || guid.indexOf('\"') === 0)) {\n        guid = null\n      }\n      if (isValueValid(guid)) {\n        StorageManager.saveToLSorCookie(GCOOKIE_NAME, guid)\n      }\n    }\n\n    return guid\n  }\n}\n","export const DATA_NOT_SENT_TEXT = 'This property has been ignored.'\nexport const INVALID_ACCOUNT = 'Invalid account ID'\nexport const INVALID_EVENT = 'Event structure not valid. Unable to process event'\nexport const CLEVERTAP_ERROR_PREFIX = 'CleverTap error:' // Formerly wzrk_error_txt\nexport const EMBED_ERROR = `${CLEVERTAP_ERROR_PREFIX} Incorrect embed script.`\nexport const EVENT_ERROR = `${CLEVERTAP_ERROR_PREFIX} Event structure not valid. ${DATA_NOT_SENT_TEXT}`\nexport const GENDER_ERROR = `${CLEVERTAP_ERROR_PREFIX} Gender value should be either M or F. ${DATA_NOT_SENT_TEXT}`\nexport const EMPLOYED_ERROR = `${CLEVERTAP_ERROR_PREFIX} Employed value should be either Y or N. ${DATA_NOT_SENT_TEXT}`\nexport const MARRIED_ERROR = `${CLEVERTAP_ERROR_PREFIX} Married value should be either Y or N. ${DATA_NOT_SENT_TEXT}`\nexport const EDUCATION_ERROR = `${CLEVERTAP_ERROR_PREFIX} Education value should be either School, College or Graduate. ${DATA_NOT_SENT_TEXT}`\nexport const AGE_ERROR = `${CLEVERTAP_ERROR_PREFIX} Age value should be a number. ${DATA_NOT_SENT_TEXT}`\nexport const DOB_ERROR = `${CLEVERTAP_ERROR_PREFIX} DOB value should be a Date Object`\nexport const OBJECT_ARRAY_ERROR = `${CLEVERTAP_ERROR_PREFIX} Expecting Object array in profile`\nexport const DATE_FORMAT_ERROR = `${CLEVERTAP_ERROR_PREFIX} setDate(number). number should be formatted as yyyymmdd`\nexport const ENUM_FORMAT_ERROR = `${CLEVERTAP_ERROR_PREFIX} setEnum(value). value should be a string or a number`\nexport const PHONE_FORMAT_ERROR = `${CLEVERTAP_ERROR_PREFIX} Phone number should be formatted as +[country code][number]`\n","import { isObject, isDateObject, isString, isNumber } from './datatypes'\nimport { convertToWZRKDate } from './datetime'\nimport { CHARGED_ID, CHARGEDID_COOKIE_NAME } from './constants'\nimport { StorageManager } from './storage'\n\nlet _globalChargedId\n\nexport const isEventStructureFlat = (eventObj) => {\n  // Events cannot have nested structure or Arrays\n  if (isObject(eventObj)) {\n    for (var key in eventObj) {\n      if (eventObj.hasOwnProperty(key)) {\n        if (isObject(eventObj[key]) || Array.isArray(eventObj[key])) {\n          return false\n        } else if (isDateObject(eventObj[key])) {\n          eventObj[key] = convertToWZRKDate(eventObj[key])\n        }\n      }\n    }\n    return true\n  }\n  return false\n}\n\nexport const isChargedEventStructureValid = (chargedObj, logger) => {\n  if (isObject(chargedObj)) {\n    for (var key in chargedObj) {\n      if (chargedObj.hasOwnProperty(key)) {\n        if (key === 'Items') {\n          if (!Array.isArray(chargedObj[key])) {\n            return false\n          }\n\n          if (chargedObj[key].length > 16) {\n            logger.reportError(522, 'Charged Items exceed 16 limit. Actual count: ' + chargedObj[key].length + '. Additional items will be dropped.')\n          }\n\n          for (var itemKey in chargedObj[key]) {\n            if (chargedObj[key].hasOwnProperty(itemKey)) { // since default array implementation could be overridden - e.g. Teabox site\n              if (!isObject(chargedObj[key][itemKey]) || !isEventStructureFlat(chargedObj[key][itemKey])) {\n                return false\n              }\n            }\n          }\n        } else {\n          if (isObject(chargedObj[key]) || Array.isArray(chargedObj[key])) {\n            return false\n          } else if (isDateObject(chargedObj[key])) {\n            chargedObj[key] = convertToWZRKDate(chargedObj[key])\n          }\n        }\n      }\n    }\n\n    if (isString(chargedObj[CHARGED_ID]) || isNumber(chargedObj[CHARGED_ID])) {\n      // save charged Id\n      const chargedId = chargedObj[CHARGED_ID] + '' // casting chargedId to string\n\n      if (typeof _globalChargedId === 'undefined') {\n        _globalChargedId = StorageManager.readFromLSorCookie(CHARGEDID_COOKIE_NAME)\n      }\n      if (typeof _globalChargedId !== 'undefined' && _globalChargedId.trim() === chargedId.trim()) {\n        // drop event- duplicate charged id\n        logger.error('Duplicate charged Id - Dropped' + chargedObj)\n        return false\n      }\n      _globalChargedId = chargedId\n      StorageManager.saveToLSorCookie(CHARGEDID_COOKIE_NAME, chargedId)\n    }\n    return true\n  } // if object (chargedObject)\n  return false\n}\n","import { isString, isObject, sanitize } from '../util/datatypes'\nimport { EVENT_ERROR } from '../util/messages'\nimport { EV_COOKIE, SYSTEM_EVENTS, unsupportedKeyCharRegex } from '../util/constants'\nimport { isChargedEventStructureValid, isEventStructureFlat } from '../util/validator'\nimport { StorageManager, $ct } from '../util/storage'\n\nexport default class EventHandler extends Array {\n  #logger\n  #oldValues\n  #request\n  #isPersonalisationActive\n\n  constructor ({ logger, request, isPersonalisationActive }, values) {\n    super()\n    this.#logger = logger\n    this.#oldValues = values\n    this.#request = request\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  push (...eventsArr) {\n    this.#processEventArray(eventsArr)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processEventArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  #processEventArray (eventsArr) {\n    if (Array.isArray(eventsArr)) {\n      while (eventsArr.length > 0) {\n        var eventName = eventsArr.shift()\n        if (!isString(eventName)) {\n          this.#logger.error(EVENT_ERROR)\n          continue\n        }\n\n        if (eventName.length > 1024) {\n          eventName = eventName.substring(0, 1024)\n          this.#logger.reportError(510, eventName + '... length exceeded 1024 chars. Trimmed.')\n        }\n\n        if (SYSTEM_EVENTS.includes(eventName)) {\n          this.#logger.reportError(513, eventName + ' is a restricted system event. It cannot be used as an event name.')\n          continue\n        }\n\n        const data = {}\n        data.type = 'event'\n        data.evtName = sanitize(eventName, unsupportedKeyCharRegex)\n\n        if (eventsArr.length !== 0) {\n          const eventObj = eventsArr.shift()\n          if (!isObject(eventObj)) {\n            // put it back if it is not an object\n            eventsArr.unshift(eventObj)\n          } else {\n            // check Charged Event vs. other events.\n            if (eventName === 'Charged') {\n              if (!isChargedEventStructureValid(eventObj, this.#logger)) {\n                this.#logger.reportError(511, 'Charged event structure invalid. Not sent.')\n                continue\n              }\n            } else {\n              if (!isEventStructureFlat(eventObj)) {\n                this.#logger.reportError(512, eventName + ' event structure invalid. Not sent.')\n                continue\n              }\n            }\n            data.evtData = eventObj\n          }\n        }\n\n        this.#request.processEvent(data)\n      }\n    }\n  }\n\n  getDetails (evtName) {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    if (typeof $ct.globalEventsMap === 'undefined') {\n      $ct.globalEventsMap = StorageManager.readFromLSorCookie(EV_COOKIE)\n    }\n    if (typeof $ct.globalEventsMap === 'undefined') {\n      return\n    }\n    const evtObj = $ct.globalEventsMap[evtName]\n    const respObj = {}\n    if (typeof evtObj !== 'undefined') {\n      respObj.firstTime = new Date(evtObj[1] * 1000)\n      respObj.lastTime = new Date(evtObj[2] * 1000)\n      respObj.count = evtObj[0]\n      return respObj\n    }\n  }\n}\n","export const getURLParams = (url) => {\n  const urlParams = {}\n  const idx = url.indexOf('?')\n\n  if (idx > 1) {\n    const uri = url.substring(idx + 1)\n    let match\n    const pl = /\\+/g // Regex for replacing addition symbol with a space\n    const search = /([^&=]+)=?([^&]*)/g\n    const decode = function (s) {\n      let replacement = s.replace(pl, ' ')\n      try {\n        replacement = decodeURIComponent(replacement)\n      } catch (e) {\n        // eat\n      }\n      return replacement\n    }\n    match = search.exec(uri)\n    while (match) {\n      urlParams[decode(match[1])] = decode(match[2])\n      match = search.exec(uri)\n    }\n  }\n  return urlParams\n}\n\nexport const getDomain = (url) => {\n  if (url === '') return ''\n  var a = document.createElement('a')\n  a.href = url\n  return a.hostname\n}\n\nexport const addToURL = (url, k, v) => {\n  return url + '&' + k + '=' + encodeURIComponent(v)\n}\n\nexport const getHostName = () => {\n  return window.location.hostname\n}\n","/* eslint-disable */\nexport const urlBase64ToUint8Array = (base64String) => {\n  let padding = '='.repeat((4 - base64String.length % 4) % 4)\n  let base64 = (base64String + padding)\n      .replace(/\\-/g, '+')\n      .replace(/_/g, '/')\n\n  let rawData = window.atob(base64)\n  let processedData = []\n  for (let i=0; i<rawData.length; i++) {\n    processedData.push(rawData.charCodeAt(i))\n  }\n  return new Uint8Array(processedData)\n}\n\nexport const compressData = (dataObject, logger) => {\n  logger && typeof logger.debug === 'function' && logger.debug('dobj:' + dataObject)\n  return compressToBase64(dataObject)\n}\n\nexport const compress = (uncompressed) => {\n  if (uncompressed == null) return ''\n  let i, value,\n      context_dictionary = {},\n      context_dictionaryToCreate = {},\n      context_c = '',\n      context_wc = '',\n      context_w = '',\n      context_enlargeIn = 2, // Compensate for the first entry which should not count\n      context_dictSize = 3,\n      context_numBits = 2,\n      context_data_string = '',\n      context_data_val = 0,\n      context_data_position = 0,\n      ii,\n      f = String.fromCharCode\n\n  for (ii = 0; ii < uncompressed.length; ii += 1) {\n    context_c = uncompressed.charAt(ii)\n    if (!Object.prototype.hasOwnProperty.call(context_dictionary, context_c)) {\n      context_dictionary[context_c] = context_dictSize++\n      context_dictionaryToCreate[context_c] = true\n    }\n\n    context_wc = context_w + context_c\n    if (Object.prototype.hasOwnProperty.call(context_dictionary, context_wc)) {\n      context_w = context_wc\n    } else {\n      if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate, context_w)) {\n        if (context_w.charCodeAt(0) < 256) {\n          for (i = 0; i < context_numBits; i++) {\n            context_data_val = (context_data_val << 1)\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n          }\n          value = context_w.charCodeAt(0)\n          for (i = 0; i < 8; i++) {\n            context_data_val = (context_data_val << 1) | (value & 1)\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n            value = value >> 1\n          }\n        } else {\n          value = 1\n          for (i = 0; i < context_numBits; i++) {\n            context_data_val = (context_data_val << 1) | value\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n            value = 0\n          }\n          value = context_w.charCodeAt(0)\n          for (i = 0; i < 16; i++) {\n            context_data_val = (context_data_val << 1) | (value & 1)\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n            value = value >> 1\n          }\n        }\n        context_enlargeIn--\n        if (context_enlargeIn == 0) {\n          context_enlargeIn = Math.pow(2, context_numBits)\n          context_numBits++\n        }\n        delete context_dictionaryToCreate[context_w]\n      } else {\n        value = context_dictionary[context_w];\n        for (i = 0; i < context_numBits; i++) {\n          context_data_val = (context_data_val << 1) | (value & 1)\n          if (context_data_position == 15) {\n            context_data_position = 0;\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = value >> 1\n        }\n\n\n      }\n      context_enlargeIn--\n      if (context_enlargeIn == 0) {\n        context_enlargeIn = Math.pow(2, context_numBits)\n        context_numBits++\n      }\n      // Add wc to the dictionary.\n      context_dictionary[context_wc] = context_dictSize++\n      context_w = String(context_c)\n    }\n  }\n\n  // Output the code for w.\n  if (context_w !== '') {\n    if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate, context_w)) {\n      if (context_w.charCodeAt(0) < 256) {\n        for (i = 0; i < context_numBits; i++) {\n          context_data_val = (context_data_val << 1)\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n        }\n        value = context_w.charCodeAt(0)\n        for (i = 0; i < 8; i++) {\n          context_data_val = (context_data_val << 1) | (value & 1)\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = value >> 1\n        }\n      } else {\n        value = 1\n        for (i = 0; i < context_numBits; i++) {\n          context_data_val = (context_data_val << 1) | value\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = 0\n        }\n        value = context_w.charCodeAt(0);\n        for (i = 0; i < 16; i++) {\n          context_data_val = (context_data_val << 1) | (value & 1)\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = value >> 1\n        }\n      }\n      context_enlargeIn--\n      if (context_enlargeIn == 0) {\n        context_enlargeIn = Math.pow(2, context_numBits)\n        context_numBits++\n      }\n      delete context_dictionaryToCreate[context_w]\n    } else {\n      value = context_dictionary[context_w]\n      for (i = 0; i < context_numBits; i++) {\n        context_data_val = (context_data_val << 1) | (value & 1)\n        if (context_data_position == 15) {\n          context_data_position = 0\n          context_data_string += f(context_data_val)\n          context_data_val = 0\n        } else {\n          context_data_position++\n        }\n        value = value >> 1\n      }\n\n\n    }\n    context_enlargeIn--\n    if (context_enlargeIn == 0) {\n      context_enlargeIn = Math.pow(2, context_numBits)\n      context_numBits++\n    }\n  }\n\n  // Mark the end of the stream\n  value = 2\n  for (i = 0; i < context_numBits; i++) {\n    context_data_val = (context_data_val << 1) | (value & 1)\n    if (context_data_position == 15) {\n      context_data_position = 0\n      context_data_string += f(context_data_val)\n      context_data_val = 0\n    } else {\n      context_data_position++\n    }\n    value = value >> 1\n  }\n\n  // Flush the last char\n  while (true) {\n    context_data_val = (context_data_val << 1)\n    if (context_data_position == 15) {\n      context_data_string += f(context_data_val)\n      break\n    } else context_data_position++\n  }\n  return context_data_string\n}\n\nexport const getKeyStr = () => {\n  let key = ''\n  let i = 0\n\n  for (i = 0; i <= 25; i++) {\n    key = key + String.fromCharCode(i + 65)\n  }\n\n  for (i = 0; i <= 25; i++) {\n    key = key + String.fromCharCode(i + 97)\n  }\n\n  for (i = 0; i < 10; i++) {\n    key = key + i\n  }\n\n  return key + '+/='\n}\n\nconst _keyStr = getKeyStr()\n\nexport const convertToFormattedHex = (byte_arr) => {\n  let hex_str = '',\n      i,\n      len,\n      tmp_hex\n\n  if (!Array.isArray(byte_arr)) {\n    return false\n  }\n\n  len = byte_arr.length\n\n  for (i = 0; i < len; ++i) {\n    if (byte_arr[i] < 0) {\n      byte_arr[i] = byte_arr[i] + 256\n    }\n    if (byte_arr[i] === undefined) {\n      byte_arr[i] = 0\n    }\n    tmp_hex = byte_arr[i].toString(16)\n\n    if (tmp_hex.length == 1) tmp_hex = '0' + tmp_hex // Add leading zero.\n\n    //        beautification - needed if you're printing this in the console, else keep commented\n    //        if ((i + 1) % 16 === 0) {\n    //          tmp_hex += \"\\n\";\n    //        } else {\n    //          tmp_hex += \" \";\n    //        }\n\n    hex_str += tmp_hex\n  }\n\n  return hex_str.trim()\n}\n\nexport const convertStringToHex = (s) => {\n  let byte_arr = []\n  for (let i = 0; i < s.length; i++) {\n    let value = s.charCodeAt(i)\n    byte_arr.push(value & 255)\n    byte_arr.push((value >> 8) & 255)\n  }\n  return convertToFormattedHex(byte_arr)\n}\n\nexport const compressToBase64 = (input) => {\n  if (input == null) return ''\n  var output = ''\n  var chr1, chr2, chr3, enc1, enc2, enc3, enc4\n  var i = 0\n\n  input = compress(input)\n\n  while (i < input.length * 2) {\n\n    if (i % 2 == 0) {\n      chr1 = input.charCodeAt(i / 2) >> 8\n      chr2 = input.charCodeAt(i / 2) & 255\n      if (i / 2 + 1 < input.length)\n        chr3 = input.charCodeAt(i / 2 + 1) >> 8\n      else\n        chr3 = NaN\n    } else {\n      chr1 = input.charCodeAt((i - 1) / 2) & 255\n      if ((i + 1) / 2 < input.length) {\n        chr2 = input.charCodeAt((i + 1) / 2) >> 8\n        chr3 = input.charCodeAt((i + 1) / 2) & 255\n      } else\n        chr2 = chr3 = NaN\n    }\n    i += 3\n\n    enc1 = chr1 >> 2;\n    enc2 = ((chr1 & 3) << 4) | (chr2 >> 4)\n    enc3 = ((chr2 & 15) << 2) | (chr3 >> 6)\n    enc4 = chr3 & 63\n\n    if (isNaN(chr2)) {\n      enc3 = enc4 = 64\n    } else if (isNaN(chr3)) {\n      enc4 = 64\n    }\n\n    output = output +\n      _keyStr.charAt(enc1) + _keyStr.charAt(enc2) +\n      _keyStr.charAt(enc3) + _keyStr.charAt(enc4)\n\n  }\n\n  return output\n}\n","import { ARP_COOKIE, MAX_TRIES, OPTOUT_COOKIE_ENDSWITH, USEIP_KEY } from './constants'\nimport { isString, isValueValid } from './datatypes'\nimport { compressData } from './encoder'\nimport { StorageManager, $ct } from './storage'\nimport { addToURL } from './url'\n\nexport default class RequestDispatcher {\n  static logger\n  static device\n\n  static #fireRequest (url, tries, skipARP, sendOULFlag) {\n    if (this.#dropRequestDueToOptOut()) {\n      this.logger.debug('req dropped due to optout cookie: ' + this.device.gcookie)\n      return\n    }\n\n    if (!isValueValid(this.device.gcookie) &&\n    ($ct.globalCache.RESP_N < $ct.globalCache.REQ_N - 1) &&\n    tries < MAX_TRIES) {\n      setTimeout(() => {\n        this.logger.debug(`retrying fire request for url: ${url}, tries: ${tries}`)\n        this.#fireRequest(url, tries + 1, skipARP, sendOULFlag)\n      }, 50)\n      return\n    }\n\n    if (!sendOULFlag) {\n      if (isValueValid(this.device.gcookie)) {\n        // add cookie to url\n        url = addToURL(url, 'gc', this.device.gcookie)\n      }\n      url = this.#addARPToRequest(url, skipARP)\n    }\n\n    url = this.#addUseIPToRequest(url)\n    url = addToURL(url, 'r', new Date().getTime()) // add epoch to beat caching of the URL\n    // TODO: Figure out a better way to handle plugin check\n    if (window.clevertap?.hasOwnProperty('plugin') || window.wizrocket?.hasOwnProperty('plugin')) {\n      // used to add plugin name in request parameter\n      const plugin = window.clevertap.plugin || window.wizrocket.plugin\n      url = addToURL(url, 'ct_pl', plugin)\n    }\n    if (url.indexOf('chrome-extension:') !== -1) {\n      url = url.replace('chrome-extension:', 'https:')\n    }\n\n    // TODO: Try using Function constructor instead of appending script.\n    var ctCbScripts = document.getElementsByClassName('ct-jp-cb')\n    while (ctCbScripts[0]) {\n      ctCbScripts[0].parentNode.removeChild(ctCbScripts[0])\n    }\n    const s = document.createElement('script')\n    s.setAttribute('type', 'text/javascript')\n    s.setAttribute('src', url)\n    s.setAttribute('class', 'ct-jp-cb')\n    s.setAttribute('rel', 'nofollow')\n    s.async = true\n\n    document.getElementsByTagName('head')[0].appendChild(s)\n    this.logger.debug('req snt -> url: ' + url)\n  }\n\n  static fireRequest (url, skipARP, sendOULFlag) {\n    this.#fireRequest(url, 1, skipARP, sendOULFlag)\n  }\n\n  static #dropRequestDueToOptOut () {\n    if ($ct.isOptInRequest || !isValueValid(this.device.gcookie) || !isString(this.device.gcookie)) {\n      $ct.isOptInRequest = false\n      return false\n    }\n    return this.device.gcookie.slice(-3) === OPTOUT_COOKIE_ENDSWITH\n  }\n\n  static #addUseIPToRequest (pageLoadUrl) {\n    var useIP = StorageManager.getMetaProp(USEIP_KEY)\n    if (typeof useIP !== 'boolean') {\n      useIP = false\n    }\n    return addToURL(pageLoadUrl, USEIP_KEY, useIP ? 'true' : 'false')\n  };\n\n  static #addARPToRequest (url, skipResARP) {\n    if (skipResARP === true) {\n      const _arp = {}\n      _arp.skipResARP = true\n      return addToURL(url, 'arp', compressData(JSON.stringify(_arp), this.logger))\n    }\n    if (StorageManager._isLocalStorageSupported() && typeof localStorage.getItem(ARP_COOKIE) !== 'undefined' && localStorage.getItem(ARP_COOKIE) !== null) {\n      return addToURL(url, 'arp', compressData(JSON.stringify(StorageManager.readFromLSorCookie(ARP_COOKIE)), this.logger))\n    }\n    return url\n  }\n}\n","// CleverTap specific utilities\n\nimport {\n  StorageManager,\n  $ct\n} from './storage'\nimport {\n  CAMP_COOKIE_NAME,\n  singleQuoteRegex,\n  PR_COOKIE,\n  ARP_COOKIE,\n  IS_OUL,\n  categoryLongKey\n} from './constants'\nimport {\n  GENDER_ERROR,\n  EMPLOYED_ERROR,\n  MARRIED_ERROR,\n  EDUCATION_ERROR,\n  AGE_ERROR,\n  DOB_ERROR,\n  PHONE_FORMAT_ERROR,\n  ENUM_FORMAT_ERROR\n} from './messages'\nimport {\n  getToday,\n  convertToWZRKDate,\n  setDate,\n  getNow\n} from './datetime'\nimport {\n  isObject,\n  isDateObject,\n  isConvertibleToNumber,\n  isObjectEmpty,\n  isString,\n  isNumber\n} from './datatypes'\nimport { addToURL, getURLParams } from './url'\nimport { compressData } from './encoder'\nimport RequestDispatcher from './requestDispatcher'\n\nexport const getCampaignObject = () => {\n  let campObj = {}\n  if (StorageManager._isLocalStorageSupported()) {\n    campObj = StorageManager.read(CAMP_COOKIE_NAME)\n    if (campObj != null) {\n      campObj = JSON.parse(decodeURIComponent(campObj).replace(singleQuoteRegex, '\\\"'))\n    } else {\n      campObj = {}\n    }\n  }\n  return campObj\n}\n\nexport const saveCampaignObject = (campaignObj) => {\n  if (StorageManager._isLocalStorageSupported()) {\n    const campObj = JSON.stringify(campaignObj)\n    StorageManager.save(CAMP_COOKIE_NAME, encodeURIComponent(campObj))\n  }\n}\n\nexport const getCampaignObjForLc = () => {\n  let campObj = {}\n  if (StorageManager._isLocalStorageSupported()) {\n    campObj = getCampaignObject()\n    let resultObj = []\n    const globalObj = campObj.global\n    const today = getToday()\n    const dailyObj = campObj[today]\n    if (typeof globalObj !== 'undefined') {\n      const campaignIdArray = Object.keys(globalObj)\n      for (const index in campaignIdArray) {\n        if (campaignIdArray.hasOwnProperty(index)) {\n          let dailyC = 0\n          let totalC = 0\n          const campaignId = campaignIdArray[index]\n          if (campaignId === 'tc') {\n            continue\n          }\n          if (typeof dailyObj !== 'undefined' && typeof dailyObj[campaignId] !== 'undefined') {\n            dailyC = dailyObj[campaignId]\n          }\n          if (typeof globalObj !== 'undefined' && typeof globalObj[campaignId] !== 'undefined') {\n            totalC = globalObj[campaignId]\n          }\n          const element = [campaignId, dailyC, totalC]\n          resultObj.push(element)\n        }\n      }\n    }\n    let todayC = 0\n    if (typeof dailyObj !== 'undefined' && typeof dailyObj.tc !== 'undefined') {\n      todayC = dailyObj.tc\n    }\n    resultObj = {\n      wmp: todayC,\n      tlc: resultObj\n    }\n    return resultObj\n  }\n}\n\nexport const isProfileValid = (profileObj, { logger }) => {\n  let valid = false\n  if (isObject(profileObj)) {\n    for (const profileKey in profileObj) {\n      if (profileObj.hasOwnProperty(profileKey)) {\n        valid = true\n        let profileVal = profileObj[profileKey]\n\n        if (profileVal == null) {\n          delete profileObj[profileKey]\n          continue\n        }\n        if (profileKey === 'Gender' && !profileVal.match(/^M$|^F$/)) {\n          valid = false\n          logger.error(GENDER_ERROR)\n        }\n\n        if (profileKey === 'Employed' && !profileVal.match(/^Y$|^N$/)) {\n          valid = false\n          logger.error(EMPLOYED_ERROR)\n        }\n\n        if (profileKey === 'Married' && !profileVal.match(/^Y$|^N$/)) {\n          valid = false\n          logger.error(MARRIED_ERROR)\n        }\n\n        if (profileKey === 'Education' && !profileVal.match(/^School$|^College$|^Graduate$/)) {\n          valid = false\n          logger.error(EDUCATION_ERROR)\n        }\n\n        if (profileKey === 'Age' && profileVal != null) {\n          if (isConvertibleToNumber(profileVal)) {\n            profileObj.Age = +profileVal\n          } else {\n            valid = false\n            logger.error(AGE_ERROR)\n          }\n        }\n        // dob will come in like this - $dt_19470815 or dateObject\n        if (profileKey === 'DOB') {\n          if (((!(/^\\$D_/).test(profileVal) || (profileVal + '').length !== 11)) && !isDateObject(profileVal)) {\n            valid = false\n            logger.error(DOB_ERROR)\n          }\n\n          if (isDateObject(profileVal)) {\n            profileObj[profileKey] = convertToWZRKDate(profileVal)\n          }\n        } else if (isDateObject(profileVal)) {\n          profileObj[profileKey] = convertToWZRKDate(profileVal)\n        }\n\n        if (profileKey === 'Phone' && !isObjectEmpty(profileVal)) {\n          if (profileVal.length > 8 && (profileVal.charAt(0) === '+')) { // valid phone number\n            profileVal = profileVal.substring(1, profileVal.length)\n            if (isConvertibleToNumber(profileVal)) {\n              profileObj.Phone = +profileVal\n            } else {\n              valid = false\n              logger.error(PHONE_FORMAT_ERROR + '. Removed.')\n            }\n          } else {\n            valid = false\n            logger.error(PHONE_FORMAT_ERROR + '. Removed.')\n          }\n        }\n\n        if (!valid) {\n          delete profileObj[profileKey]\n        }\n      }\n    }\n  }\n  return valid\n}\n\nexport const processFBUserObj = (user) => {\n  const profileData = {}\n  profileData.Name = user.name\n  if (user.id != null) {\n    profileData.FBID = user.id + ''\n  }\n  // Feb 2014 - FB announced over 58 gender options, hence we specifically look for male or female. Rest we don't care.\n  if (user.gender === 'male') {\n    profileData.Gender = 'M'\n  } else if (user.gender === 'female') {\n    profileData.Gender = 'F'\n  } else {\n    profileData.Gender = 'O'\n  }\n\n  const getHighestEducation = function (eduArr) {\n    if (eduArr != null) {\n      let college = ''\n      let highschool = ''\n\n      for (let i = 0; i < eduArr.length; i++) {\n        const edu = eduArr[i]\n        if (edu.type != null) {\n          const type = edu.type\n          if (type === 'Graduate School') {\n            return 'Graduate'\n          } else if (type === 'College') {\n            college = '1'\n          } else if (type === 'High School') {\n            highschool = '1'\n          }\n        }\n      }\n\n      if (college === '1') {\n        return 'College'\n      } else if (highschool === '1') {\n        return 'School'\n      }\n    }\n  }\n\n  if (user.relationship_status != null) {\n    profileData.Married = 'N'\n    if (user.relationship_status === 'Married') {\n      profileData.Married = 'Y'\n    }\n  }\n\n  const edu = getHighestEducation(user.education)\n  if (edu != null) {\n    profileData.Education = edu\n  }\n\n  const work = (user.work != null) ? user.work.length : 0\n  if (work > 0) {\n    profileData.Employed = 'Y'\n  } else {\n    profileData.Employed = 'N'\n  }\n\n  if (user.email != null) {\n    profileData.Email = user.email\n  }\n\n  if (user.birthday != null) {\n    const mmddyy = user.birthday.split('/') // comes in as \"08/15/1947\"\n    profileData.DOB = setDate(mmddyy[2] + mmddyy[0] + mmddyy[1])\n  }\n  return profileData\n}\n\nexport const processGPlusUserObj = (user, { logger }) => {\n  const profileData = {}\n  if (user.displayName != null) {\n    profileData.Name = user.displayName\n  }\n  if (user.id != null) {\n    profileData.GPID = user.id + ''\n  }\n\n  if (user.gender != null) {\n    if (user.gender === 'male') {\n      profileData.Gender = 'M'\n    } else if (user.gender === 'female') {\n      profileData.Gender = 'F'\n    } else if (user.gender === 'other') {\n      profileData.Gender = 'O'\n    }\n  }\n\n  if (user.image != null) {\n    if (user.image.isDefault === false) {\n      profileData.Photo = user.image.url.split('?sz')[0]\n    }\n  }\n\n  if (user.emails != null) {\n    for (let emailIdx = 0; emailIdx < user.emails.length; emailIdx++) {\n      const emailObj = user.emails[emailIdx]\n      if (emailObj.type === 'account') {\n        profileData.Email = emailObj.value\n      }\n    }\n  }\n\n  if (user.organizations != null) {\n    profileData.Employed = 'N'\n    for (let i = 0; i < user.organizations.length; i++) {\n      const orgObj = user.organizations[i]\n      if (orgObj.type === 'work') {\n        profileData.Employed = 'Y'\n      }\n    }\n  }\n\n  if (user.birthday != null) {\n    const yyyymmdd = user.birthday.split('-') // comes in as \"1976-07-27\"\n    profileData.DOB = setDate(yyyymmdd[0] + yyyymmdd[1] + yyyymmdd[2])\n  }\n\n  if (user.relationshipStatus != null) {\n    profileData.Married = 'N'\n    if (user.relationshipStatus === 'married') {\n      profileData.Married = 'Y'\n    }\n  }\n  logger.debug('gplus usr profile ' + JSON.stringify(profileData))\n\n  return profileData\n}\n\nexport const addToLocalProfileMap = (profileObj, override) => {\n  if (StorageManager._isLocalStorageSupported()) {\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n      if ($ct.globalProfileMap == null) {\n        $ct.globalProfileMap = {}\n      }\n    }\n\n    // Move props from custom bucket to outside.\n    if (profileObj._custom != null) {\n      const keys = profileObj._custom\n      for (const key in keys) {\n        if (keys.hasOwnProperty(key)) {\n          profileObj[key] = keys[key]\n        }\n      }\n      delete profileObj._custom\n    }\n\n    for (const prop in profileObj) {\n      if (profileObj.hasOwnProperty(prop)) {\n        if ($ct.globalProfileMap.hasOwnProperty(prop) && !override) {\n          continue\n        }\n        $ct.globalProfileMap[prop] = profileObj[prop]\n      }\n    }\n    if ($ct.globalProfileMap._custom != null) {\n      delete $ct.globalProfileMap._custom\n    }\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n  }\n}\n\nexport const closeIframe = (campaignId, divIdIgnored, currentSessionId) => {\n  if (campaignId != null && campaignId !== '-1') {\n    if (StorageManager._isLocalStorageSupported()) {\n      const campaignObj = getCampaignObject()\n\n      let sessionCampaignObj = campaignObj[currentSessionId]\n      if (sessionCampaignObj == null) {\n        sessionCampaignObj = {}\n        campaignObj[currentSessionId] = sessionCampaignObj\n      }\n      sessionCampaignObj[campaignId] = 'dnd'\n      saveCampaignObject(campaignObj)\n    }\n  }\n  if ($ct.campaignDivMap != null) {\n    const divId = $ct.campaignDivMap[campaignId]\n    if (divId != null) {\n      document.getElementById(divId).style.display = 'none'\n      if (divId === 'intentPreview') {\n        if (document.getElementById('intentOpacityDiv') != null) {\n          document.getElementById('intentOpacityDiv').style.display = 'none'\n        }\n      }\n    }\n  }\n}\n\nexport const arp = (jsonMap) => {\n  // For unregister calls dont set arp in LS\n  if (jsonMap.skipResARP != null && jsonMap.skipResARP) {\n    console.debug('Update ARP Request rejected', jsonMap)\n    return null\n  }\n\n  const isOULARP = !!((jsonMap[IS_OUL] != null && jsonMap[IS_OUL] === true))\n\n  if (StorageManager._isLocalStorageSupported()) {\n    try {\n      let arpFromStorage = StorageManager.readFromLSorCookie(ARP_COOKIE)\n      if (arpFromStorage == null || isOULARP) {\n        arpFromStorage = {}\n      }\n\n      for (const key in jsonMap) {\n        if (jsonMap.hasOwnProperty(key)) {\n          if (jsonMap[key] === -1) {\n            delete arpFromStorage[key]\n          } else {\n            arpFromStorage[key] = jsonMap[key]\n          }\n        }\n      }\n      StorageManager.saveToLSorCookie(ARP_COOKIE, arpFromStorage)\n    } catch (e) {\n      console.error('Unable to parse ARP JSON: ' + e)\n    }\n  }\n}\n\nexport const getWrappedLink = (link, targetId, type, request, account, logger) => {\n  let data = {}\n  data.sendTo = link\n  data.targetId = targetId\n  data.epoch = getNow()\n\n  if (type != null) {\n    data.type = type\n  } else {\n    data.type = 'view'\n  }\n\n  data = request.addSystemDataToObject(data, undefined)\n  return addToURL(account.recorderURL, 'd', compressData(JSON.stringify(data), logger))\n}\n\nexport const getMessageTemplate = () => {\n  return `<div class=\"notice-message\">\n    <a href=\"[RECORDER_HREF]\" class=\"box\">\n      <div class=\"avatar\"><span class=\"fa [ICON] fa-4x fa-fw\"></span></div>\n      <div class=\"info\">\n        <div class=\"title\">[TITLE]</div>\n        <div class=\"clearfix\"></div>\n        <div class=\"text\">[TEXT]</div>\n      </div>\n      <div class=\"clearfix\"></div>\n    </a>\n  </div>\n  <div class=\"clearfix\"></div>`\n}\n\nexport const getMessageHeadTemplate = () => {\n  return `<head>\n    <base target=\"_parent\" />\n    <link rel=\"stylesheet\" href=\"http://static.clevertap.com/fa/font-awesome.css\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <style>\n    [STYLE]\n    </style>\n  </head>`\n}\n\nexport const setEnum = (enumVal, logger) => {\n  if (isString(enumVal) || isNumber(enumVal)) {\n    return '$E_' + enumVal\n  }\n  logger.error(ENUM_FORMAT_ERROR)\n}\n\nexport const handleEmailSubscription = (subscription, reEncoded, fetchGroups, account, logger) => {\n  const urlParamsAsIs = getURLParams(location.href) // can't use url_params as it is in lowercase above\n  const encodedEmailId = urlParamsAsIs.e\n  const encodedProfileProps = urlParamsAsIs.p\n\n  if (typeof encodedEmailId !== 'undefined') {\n    const data = {}\n    data.id = account.id // accountId\n    data.unsubGroups = $ct.unsubGroups // unsubscribe groups\n\n    if ($ct.updatedCategoryLong) {\n      data[categoryLongKey] = $ct.updatedCategoryLong\n    }\n\n    let url = account.emailURL\n    if (fetchGroups) {\n      url = addToURL(url, 'fetchGroups', fetchGroups)\n    }\n    if (reEncoded) {\n      url = addToURL(url, 'encoded', reEncoded)\n    }\n    url = addToURL(url, 'e', encodedEmailId)\n    url = addToURL(url, 'd', compressData(JSON.stringify(data), logger))\n    if (encodedProfileProps) {\n      url = addToURL(url, 'p', encodedProfileProps)\n    }\n\n    if (subscription !== '-1') {\n      url = addToURL(url, 'sub', subscription)\n    }\n\n    RequestDispatcher.fireRequest(url)\n  }\n}\n","import {\n  isObjectEmpty\n} from '../util/datatypes'\nimport {\n  isProfileValid,\n  processFBUserObj,\n  processGPlusUserObj,\n  addToLocalProfileMap\n} from '../util/clevertap'\nimport {\n  EVT_PUSH,\n  PR_COOKIE\n} from '../util/constants'\nimport {\n  addToURL\n} from '../util/url'\nimport {\n  $ct\n} from '../util/storage'\nimport { compressData } from '../util/encoder'\nexport default class ProfileHandler extends Array {\n  #logger\n  #request\n  #account\n  #oldValues\n  #isPersonalisationActive\n\n  constructor ({\n    logger,\n    request,\n    account,\n    isPersonalisationActive\n  }, values) {\n    super()\n    this.#logger = logger\n    this.#request = request\n    this.#account = account\n    this.#oldValues = values\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  push (...profilesArr) {\n    this.#processProfileArray(profilesArr)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processProfileArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  getAttribute (propName) {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n    }\n    if ($ct.globalProfileMap != null) {\n      return $ct.globalProfileMap[propName]\n    }\n  }\n\n  #processProfileArray (profileArr) {\n    if (Array.isArray(profileArr) && profileArr.length > 0) {\n      for (const index in profileArr) {\n        if (profileArr.hasOwnProperty(index)) {\n          const outerObj = profileArr[index]\n          let data = {}\n          let profileObj\n          if (outerObj.Site != null) { // organic data from the site\n            profileObj = outerObj.Site\n            if (isObjectEmpty(profileObj) || !isProfileValid(profileObj, {\n              logger: this.#logger\n            })) {\n              return\n            }\n          } else if (outerObj.Facebook != null) { // fb connect data\n            const FbProfileObj = outerObj.Facebook\n            // make sure that the object contains any data at all\n\n            if (!isObjectEmpty(FbProfileObj) && (!FbProfileObj.error)) {\n              profileObj = processFBUserObj(FbProfileObj)\n            }\n          } else if (outerObj['Google Plus'] != null) {\n            const GPlusProfileObj = outerObj['Google Plus']\n            if (!isObjectEmpty(GPlusProfileObj) && (!GPlusProfileObj.error)) {\n              profileObj = processGPlusUserObj(GPlusProfileObj, { logger: this.#logger })\n            }\n          }\n          if (profileObj != null && (!isObjectEmpty(profileObj))) { // profile got set from above\n            data.type = 'profile'\n            if (profileObj.tz == null) {\n              // try to auto capture user timezone if not present\n              profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n            }\n\n            data.profile = profileObj\n            addToLocalProfileMap(profileObj, true)\n            data = this.#request.addSystemDataToObject(data, undefined)\n\n            this.#request.addFlags(data)\n            const compressedData = compressData(JSON.stringify(data), this.#logger)\n\n            let pageLoadUrl = this.#account.dataPostURL\n            pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n            pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n            this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequeust)\n          }\n        }\n      }\n    }\n  }\n}\n","import {\n  isObject,\n  isObjectEmpty\n} from '../util/datatypes'\nimport {\n  KCOOKIE_NAME,\n  GCOOKIE_NAME,\n  EVT_PUSH,\n  LRU_CACHE_SIZE,\n  IS_OUL,\n  CAMP_COOKIE_NAME,\n  CHARGEDID_COOKIE_NAME,\n  PR_COOKIE,\n  EV_COOKIE,\n  ARP_COOKIE,\n  CLEAR,\n  META_COOKIE,\n  FIRE_PUSH_UNREGISTERED\n} from '../util/constants'\nimport {\n  StorageManager,\n  $ct\n} from '../util/storage'\nimport LRUCache from '../util/lruCache'\nimport {\n  compressData\n} from '../util/encoder'\nimport {\n  addToURL,\n  getHostName\n} from '../util/url'\nimport {\n  isProfileValid,\n  processFBUserObj,\n  processGPlusUserObj,\n  addToLocalProfileMap\n} from '../util/clevertap'\n\nexport default class UserLoginHandler extends Array {\n  #request\n  #logger\n  #account\n  #session\n  #oldValues\n  #device\n\n  constructor ({\n    request,\n    account,\n    session,\n    logger,\n    device\n  },\n  values) {\n    super()\n    this.#request = request\n    this.#account = account\n    this.#session = session\n    this.#logger = logger\n    this.#oldValues = values\n    this.#device = device\n  }\n\n  #processOUL (profileArr) {\n    let sendOULFlag = true\n    StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, sendOULFlag)\n    const addToK = (ids) => {\n      let k = StorageManager.readFromLSorCookie(KCOOKIE_NAME)\n      const g = StorageManager.readFromLSorCookie(GCOOKIE_NAME)\n      let kId\n      if (k == null) {\n        k = {}\n        kId = ids\n      } else { /* check if already exists */\n        kId = k.id\n        let anonymousUser = false\n        let foundInCache = false\n        if (kId == null) {\n          kId = ids[0]\n          anonymousUser = true\n        }\n\n        if ($ct.LRU_CACHE == null && StorageManager._isLocalStorageSupported()) {\n          $ct.LRU_CACHE = new LRUCache(LRU_CACHE_SIZE)\n        }\n\n        if (anonymousUser) {\n          if ((g) != null) {\n            $ct.LRU_CACHE.set(kId, g)\n            $ct.blockRequeust = false\n          }\n        } else {\n          for (const idx in ids) {\n            if (ids.hasOwnProperty(idx)) {\n              const id = ids[idx]\n              if ($ct.LRU_CACHE.cache[id]) {\n                kId = id\n                foundInCache = true\n                break\n              }\n            }\n          }\n        }\n\n        if (foundInCache) {\n          if (kId !== $ct.LRU_CACHE.getLastKey()) {\n            // New User found\n            this.#handleCookieFromCache()\n          } else {\n            sendOULFlag = false\n            StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, sendOULFlag)\n          }\n          const gFromCache = $ct.LRU_CACHE.get(kId)\n          $ct.LRU_CACHE.set(kId, gFromCache)\n          StorageManager.saveToLSorCookie(GCOOKIE_NAME, gFromCache)\n          this.#device.gcookie = gFromCache\n\n          const lastK = $ct.LRU_CACHE.getSecondLastKey()\n          if (StorageManager.readFromLSorCookie(FIRE_PUSH_UNREGISTERED) && lastK !== -1) {\n            // CACHED OLD USER FOUND. TRANSFER PUSH TOKEN TO THIS USER\n            const lastGUID = $ct.LRU_CACHE.cache[lastK]\n            this.#request.unregisterTokenForGuid(lastGUID)\n          }\n        } else {\n          if (!anonymousUser) {\n            this.clear()\n          } else {\n            if ((g) != null) {\n              this.#device.gcookie = g\n              StorageManager.saveToLSorCookie(GCOOKIE_NAME, g)\n              sendOULFlag = false\n            }\n          }\n          StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, false)\n          kId = ids[0]\n        }\n      }\n      k.id = kId\n      StorageManager.saveToLSorCookie(KCOOKIE_NAME, k)\n    }\n\n    if (Array.isArray(profileArr) && profileArr.length > 0) {\n      for (const index in profileArr) {\n        if (profileArr.hasOwnProperty(index)) {\n          const outerObj = profileArr[index]\n          let data = {}\n          let profileObj\n          if (outerObj.Site != null) { // organic data from the site\n            profileObj = outerObj.Site\n            if (isObjectEmpty(profileObj) || !isProfileValid(profileObj, {\n              logger: this.#logger\n            })) {\n              return\n            }\n          } else if (outerObj.Facebook != null) { // fb connect data\n            const FbProfileObj = outerObj.Facebook\n            // make sure that the object contains any data at all\n\n            if (!isObjectEmpty(FbProfileObj) && (!FbProfileObj.error)) {\n              profileObj = processFBUserObj(FbProfileObj)\n            }\n          } else if (outerObj['Google Plus'] != null) {\n            const GPlusProfileObj = outerObj['Google Plus']\n            if (isObjectEmpty(GPlusProfileObj) && (!GPlusProfileObj.error)) {\n              profileObj = processGPlusUserObj(GPlusProfileObj, { logger: this.#logger })\n            }\n          }\n          if (profileObj != null && (!isObjectEmpty(profileObj))) { // profile got set from above\n            data.type = 'profile'\n            if (profileObj.tz == null) {\n              // try to auto capture user timezone if not present\n              profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n            }\n\n            data.profile = profileObj\n            const ids = []\n            if (StorageManager._isLocalStorageSupported()) {\n              if (profileObj.Identity != null) {\n                ids.push(profileObj.Identity)\n              }\n              if (profileObj.Email != null) {\n                ids.push(profileObj.Email)\n              }\n              if (profileObj.GPID != null) {\n                ids.push('GP:' + profileObj.GPID)\n              }\n              if (profileObj.FBID != null) {\n                ids.push('FB:' + profileObj.FBID)\n              }\n              if (ids.length > 0) {\n                addToK(ids)\n              }\n            }\n            addToLocalProfileMap(profileObj, true)\n            data = this.#request.addSystemDataToObject(data, undefined)\n\n            this.#request.addFlags(data)\n            // Adding 'isOUL' flag in true for OUL cases which.\n            // This flag tells LC to create a new arp object.\n            // Also we will receive the same flag in response arp which tells to delete existing arp object.\n            if (sendOULFlag) {\n              data[IS_OUL] = true\n            }\n\n            const compressedData = compressData(JSON.stringify(data), this.#logger)\n\n            let pageLoadUrl = this.#account.dataPostURL\n            pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n            pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n            // Whenever sendOULFlag is true then dont send arp and gcookie (guid in memory in the request)\n            // Also when this flag is set we will get another flag from LC in arp which tells us to delete arp\n            // stored in the cache and replace it with the response arp.\n            this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequeust, sendOULFlag)\n          }\n        }\n      }\n    }\n  }\n\n  clear () {\n    this.#logger.debug('clear called. Reset flag has been set.')\n    this.#deleteUser()\n    StorageManager.setMetaProp(CLEAR, true)\n  }\n\n  #handleCookieFromCache () {\n    $ct.blockRequeust = false\n    console.debug('Block request is false')\n    if (StorageManager._isLocalStorageSupported()) {\n      delete localStorage[PR_COOKIE]\n      delete localStorage[EV_COOKIE]\n      delete localStorage[META_COOKIE]\n      delete localStorage[ARP_COOKIE]\n      delete localStorage[CAMP_COOKIE_NAME]\n      delete localStorage[CHARGEDID_COOKIE_NAME]\n    }\n    StorageManager.removeCookie(CAMP_COOKIE_NAME, getHostName())\n    StorageManager.removeCookie(this.#session.cookieName, $ct.broadDomain)\n    StorageManager.removeCookie(ARP_COOKIE, $ct.broadDomain)\n    this.#session.setSessionCookieObject('')\n  }\n\n  #deleteUser () {\n    $ct.blockRequeust = true\n    this.#logger.debug('Block request is true')\n    $ct.globalCache = {}\n    if (StorageManager._isLocalStorageSupported()) {\n      delete localStorage[GCOOKIE_NAME]\n      delete localStorage[KCOOKIE_NAME]\n      delete localStorage[PR_COOKIE]\n      delete localStorage[EV_COOKIE]\n      delete localStorage[META_COOKIE]\n      delete localStorage[ARP_COOKIE]\n      delete localStorage[CAMP_COOKIE_NAME]\n      delete localStorage[CHARGEDID_COOKIE_NAME]\n    }\n    StorageManager.removeCookie(GCOOKIE_NAME, $ct.broadDomain)\n    StorageManager.removeCookie(CAMP_COOKIE_NAME, getHostName())\n    StorageManager.removeCookie(KCOOKIE_NAME, getHostName())\n    StorageManager.removeCookie(this.#session.cookieName, $ct.broadDomain)\n    StorageManager.removeCookie(ARP_COOKIE, $ct.broadDomain)\n    this.#device.gcookie = null\n    this.#session.setSessionCookieObject('')\n  }\n\n  #processLoginArray (loginArr) {\n    if (Array.isArray(loginArr) && loginArr.length > 0) {\n      const profileObj = loginArr.pop()\n      const processProfile = profileObj != null && isObject(profileObj) &&\n          ((profileObj.Site != null && Object.keys(profileObj.Site).length > 0) ||\n              (profileObj.Facebook != null && Object.keys(profileObj.Facebook).length > 0) ||\n              (profileObj['Google Plus'] != null && Object.keys(profileObj['Google Plus']).length > 0))\n      if (processProfile) {\n        StorageManager.setInstantDeleteFlagInK()\n        try {\n          this.#processOUL([profileObj])\n        } catch (e) {\n          this.#logger.debug(e)\n        }\n      } else {\n        this.#logger.error('Profile object is in incorrect format')\n      }\n    }\n  }\n\n  push (...profilesArr) {\n    this.#processLoginArray(profilesArr)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processLoginArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n}\n","import {\n  addToLocalProfileMap,\n  arp,\n  getCampaignObject,\n  saveCampaignObject,\n  closeIframe\n} from './clevertap'\n\nimport {\n  CAMP_COOKIE_NAME,\n  DISPLAY,\n  GLOBAL,\n  EV_COOKIE,\n  NOTIFICATION_VIEWED,\n  NOTIFICATION_CLICKED,\n  WZRK_PREFIX,\n  WZRK_ID\n} from './constants'\n\nimport {\n  getNow,\n  getToday\n} from './datetime'\n\nimport {\n  compressToBase64\n} from './encoder'\n\nimport { StorageManager, $ct } from './storage'\nimport RequestDispatcher from './requestDispatcher'\n\nconst _tr = (msg, {\n  device,\n  session,\n  request,\n  logger\n}) => {\n  const _device = device\n  const _session = session\n  const _request = request\n  const _logger = logger\n  let _wizCounter = 0\n\n  const doCampHouseKeeping = (targetingMsgJson) => {\n    const campaignId = targetingMsgJson.wzrk_id.split('_')[0]\n    const today = getToday()\n\n    const incrCount = (obj, campaignId, excludeFromFreqCaps) => {\n      let currentCount = 0\n      let totalCount = 0\n      if (obj[campaignId] != null) {\n        currentCount = obj[campaignId]\n      }\n      currentCount++\n      if (obj.tc != null) {\n        totalCount = obj.tc\n      }\n      // if exclude from caps then dont add to total counts\n      if (excludeFromFreqCaps < 0) {\n        totalCount++\n      }\n\n      obj.tc = totalCount\n      obj[campaignId] = currentCount\n    }\n\n    if (StorageManager._isLocalStorageSupported()) {\n      delete sessionStorage[CAMP_COOKIE_NAME]\n      const campObj = getCampaignObject()\n\n      // global session limit. default is 1\n      if (targetingMsgJson[DISPLAY].wmc == null) {\n        targetingMsgJson[DISPLAY].wmc = 1\n      }\n\n      var excludeFromFreqCaps = -1\n      let campaignSessionLimit = -1\n      let campaignDailyLimit = -1\n      let campaignTotalLimit = -1\n      let totalDailyLimit = -1\n      let totalSessionLimit = -1\n\n      if (targetingMsgJson[DISPLAY].efc != null) {\n        excludeFromFreqCaps = parseInt(targetingMsgJson[DISPLAY].efc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].mdc != null) {\n        campaignSessionLimit = parseInt(targetingMsgJson[DISPLAY].mdc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].tdc != null) {\n        campaignDailyLimit = parseInt(targetingMsgJson[DISPLAY].tdc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].tlc != null) {\n        campaignTotalLimit = parseInt(targetingMsgJson[DISPLAY].tlc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].wmp != null) {\n        totalDailyLimit = parseInt(targetingMsgJson[DISPLAY].wmp, 10)\n      }\n      if (targetingMsgJson[DISPLAY].wmc != null) {\n        totalSessionLimit = parseInt(targetingMsgJson[DISPLAY].wmc, 10)\n      }\n\n      // session level capping\n      let sessionObj = campObj[_session.sessionId]\n      if (sessionObj) {\n        const campaignSessionCount = sessionObj[campaignId]\n        const totalSessionCount = sessionObj.tc\n        // dnd\n        if (campaignSessionCount === 'dnd') {\n          return false\n        }\n\n        // session\n        if (totalSessionLimit > 0 && totalSessionCount >= totalSessionLimit && excludeFromFreqCaps < 0) {\n          return false\n        }\n        // campaign session\n        if (campaignSessionLimit > 0 && campaignSessionCount >= campaignSessionLimit) {\n          return false\n        }\n      } else {\n        sessionObj = {}\n        campObj[_session.sessionId] = sessionObj\n      }\n\n      // daily level capping\n      var dailyObj = campObj[today]\n      if (dailyObj != null) {\n        const campaignDailyCount = dailyObj[campaignId]\n        const totalDailyCount = dailyObj.tc\n        // daily\n        if (totalDailyLimit > 0 && totalDailyCount >= totalDailyLimit && excludeFromFreqCaps < 0) {\n          return false\n        }\n        // campaign daily\n        if (campaignDailyLimit > 0 && campaignDailyCount >= campaignDailyLimit) {\n          return false\n        }\n      } else {\n        dailyObj = {}\n        campObj[today] = dailyObj\n      }\n\n      var globalObj = campObj[GLOBAL]\n      if (globalObj != null) {\n        const campaignTotalCount = globalObj[campaignId]\n        // campaign total\n        if (campaignTotalLimit > 0 && campaignTotalCount >= campaignTotalLimit) {\n          return false\n        }\n      } else {\n        globalObj = {}\n        campObj[GLOBAL] = globalObj\n      }\n    }\n    // delay\n    if (targetingMsgJson[DISPLAY].delay != null && targetingMsgJson[DISPLAY].delay > 0) {\n      const delay = targetingMsgJson[DISPLAY].delay\n      targetingMsgJson[DISPLAY].delay = 0\n      setTimeout(_tr, delay * 1000, msg, {\n        device: _device,\n        session: _session,\n        request: _request,\n        logger: _logger\n      })\n      return false\n    }\n    const sessionObj = _session.getSessionCookieObject()\n\n    incrCount(sessionObj, campaignId, excludeFromFreqCaps)\n    incrCount(dailyObj, campaignId, excludeFromFreqCaps)\n    incrCount(globalObj, campaignId, excludeFromFreqCaps)\n\n    // get ride of stale sessions and day entries\n    const newCampObj = {}\n    newCampObj[_session.sessionId] = sessionObj\n    newCampObj[today] = dailyObj\n    newCampObj[GLOBAL] = globalObj\n    saveCampaignObject(newCampObj)\n  }\n\n  const getCookieParams = () => {\n    const gcookie = _device.getGuid()\n    const scookieObj = _session.getSessionCookieObject()\n    return '&t=wc&d=' + encodeURIComponent(compressToBase64(gcookie + '|' + scookieObj.p + '|' + scookieObj.s))\n  }\n\n  const setupClickEvent = (onClick, targetingMsgJson, contentDiv, divId, isLegacy) => {\n    if (onClick !== '' && onClick != null) {\n      let ctaElement\n      let jsCTAElements\n      if (isLegacy) {\n        ctaElement = contentDiv\n      } else {\n        jsCTAElements = contentDiv.getElementsByClassName('jsCT_CTA')\n        if (jsCTAElements != null && jsCTAElements.length === 1) {\n          ctaElement = jsCTAElements[0]\n        }\n      }\n      const jsFunc = targetingMsgJson.display.jsFunc\n      const isPreview = targetingMsgJson.display.preview\n      if (isPreview == null) {\n        onClick += getCookieParams()\n      }\n\n      if (ctaElement != null) {\n        ctaElement.onclick = () => {\n          // invoke js function call\n          if (jsFunc != null) {\n            // track notification clicked event\n            if (isPreview == null) {\n              RequestDispatcher.fireRequest(onClick)\n            }\n            invokeExternalJs(jsFunc, targetingMsgJson)\n            // close iframe. using -1 for no campaignId\n            closeIframe('-1', divId, _session.sessionId)\n            return\n          }\n          // pass on the gcookie|page|scookieId for capturing the click event\n          if (targetingMsgJson.display.window === 1) {\n            window.open(onClick, '_blank')\n          } else {\n            window.location = onClick\n          }\n        }\n      }\n    }\n  }\n\n  const invokeExternalJs = (jsFunc, targetingMsgJson) => {\n    const func = window.parent[jsFunc]\n    if (typeof func === 'function') {\n      if (targetingMsgJson.display.kv != null) {\n        func(targetingMsgJson.display.kv)\n      } else {\n        func()\n      }\n    }\n  }\n\n  const setupClickUrl = (onClick, targetingMsgJson, contentDiv, divId, isLegacy) => {\n    incrementImpression(targetingMsgJson)\n    setupClickEvent(onClick, targetingMsgJson, contentDiv, divId, isLegacy)\n  }\n\n  const incrementImpression = (targetingMsgJson) => {\n    const data = {}\n    data.type = 'event'\n    data.evtName = NOTIFICATION_VIEWED\n    data.evtData = { [WZRK_ID]: targetingMsgJson.wzrk_id }\n    _request.processEvent(data)\n  }\n\n  const renderFooterNotification = (targetingMsgJson) => {\n    const campaignId = targetingMsgJson.wzrk_id.split('_')[0]\n    const displayObj = targetingMsgJson.display\n\n    if (displayObj.layout === 1) {\n      return showExitIntent(undefined, targetingMsgJson)\n    }\n    if (doCampHouseKeeping(targetingMsgJson) === false) {\n      return\n    }\n\n    const divId = 'wizParDiv' + displayObj.layout\n\n    if (document.getElementById(divId) != null) {\n      return\n    }\n    $ct.campaignDivMap[campaignId] = divId\n    const isBanner = displayObj.layout === 2\n    const msgDiv = document.createElement('div')\n    msgDiv.id = divId\n    const viewHeight = window.innerHeight\n    const viewWidth = window.innerWidth\n    let legacy = false\n\n    if (!isBanner) {\n      const marginBottom = viewHeight * 5 / 100\n      var contentHeight = 10\n      let right = viewWidth * 5 / 100\n      let bottomPosition = contentHeight + marginBottom\n      let width = viewWidth * 30 / 100 + 20\n      let widthPerct = 'width:30%;'\n      // for small devices  - mobile phones\n      if ((/mobile/i.test(navigator.userAgent) || (/mini/i.test(navigator.userAgent))) && /iPad/i.test(navigator.userAgent) === false) {\n        width = viewWidth * 85 / 100 + 20\n        right = viewWidth * 5 / 100\n        bottomPosition = viewHeight * 5 / 100\n        widthPerct = 'width:80%;'\n        // medium devices - tablets\n      } else if ('ontouchstart' in window || (/tablet/i.test(navigator.userAgent))) {\n        width = viewWidth * 50 / 100 + 20\n        right = viewWidth * 5 / 100\n        bottomPosition = viewHeight * 5 / 100\n        widthPerct = 'width:50%;'\n      }\n      // legacy footer notif\n      if (displayObj.proto == null) {\n        legacy = true\n        msgDiv.setAttribute('style', 'display:block;overflow:hidden; bottom:' + bottomPosition + 'px !important;width:' + width + 'px !important;right:' + right + 'px !important;position:fixed;z-index:2147483647;')\n      } else {\n        msgDiv.setAttribute('style', widthPerct + displayObj.iFrameStyle)\n      }\n    } else {\n      msgDiv.setAttribute('style', displayObj.iFrameStyle)\n    }\n    document.body.appendChild(msgDiv)\n    const iframe = document.createElement('iframe')\n\n    const borderRadius = displayObj.br === false ? '0' : '8'\n\n    iframe.frameborder = '0px'\n    iframe.marginheight = '0px'\n    iframe.marginwidth = '0px'\n    iframe.scrolling = 'no'\n    iframe.id = 'wiz-iframe'\n    const onClick = targetingMsgJson.display.onClick\n    let pointerCss = ''\n    if (onClick !== '' && onClick != null) {\n      pointerCss = 'cursor:pointer;'\n    }\n\n    let html\n    // direct html\n    if (targetingMsgJson.msgContent.type === 1) {\n      html = targetingMsgJson.msgContent.html\n      html = html.replace(/##campaignId##/g, campaignId)\n    } else {\n      const css = '' +\n        '<style type=\"text/css\">' +\n        'body{margin:0;padding:0;}' +\n        '#contentDiv.wzrk{overflow:hidden;padding:0;text-align:center;' + pointerCss + '}' +\n        '#contentDiv.wzrk td{padding:15px 10px;}' +\n        '.wzrkPPtitle{font-weight: bold;font-size: 16px;font-family:arial;padding-bottom:10px;word-break: break-word;}' +\n        '.wzrkPPdscr{font-size: 14px;font-family:arial;line-height:16px;word-break: break-word;display:inline-block;}' +\n        '.PL15{padding-left:15px;}' +\n        '.wzrkPPwarp{margin:20px 20px 0 5px;padding:0px;border-radius: ' + borderRadius + 'px;box-shadow: 1px 1px 5px #888888;}' +\n        'a.wzrkClose{cursor:pointer;position: absolute;top: 11px;right: 11px;z-index: 2147483647;font-size:19px;font-family:arial;font-weight:bold;text-decoration: none;width: 25px;/*height: 25px;*/text-align: center; -webkit-appearance: none; line-height: 25px;' +\n        'background: #353535;border: #fff 2px solid;border-radius: 100%;box-shadow: #777 2px 2px 2px;color:#fff;}' +\n        'a:hover.wzrkClose{background-color:#d1914a !important;color:#fff !important; -webkit-appearance: none;}' +\n        'td{vertical-align:top;}' +\n        'td.imgTd{border-top-left-radius:8px;border-bottom-left-radius:8px;}' +\n        '</style>'\n\n      let bgColor, textColor, btnBg, leftTd, btColor\n      if (targetingMsgJson.display.theme === 'dark') {\n        bgColor = '#2d2d2e'\n        textColor = '#eaeaea'\n        btnBg = '#353535'\n        leftTd = '#353535'\n        btColor = '#ffffff'\n      } else {\n        bgColor = '#ffffff'\n        textColor = '#000000'\n        leftTd = '#f4f4f4'\n        btnBg = '#a5a6a6'\n        btColor = '#ffffff'\n      }\n      const titleText = targetingMsgJson.msgContent.title\n      const descriptionText = targetingMsgJson.msgContent.description\n      let imageTd = ''\n      if (targetingMsgJson.msgContent.imageUrl != null && targetingMsgJson.msgContent.imageUrl !== '') {\n        imageTd = \"<td class='imgTd' style='background-color:\" + leftTd + \"'><img src='\" + targetingMsgJson.msgContent.imageUrl + \"' height='60' width='60'></td>\"\n      }\n      const onClickStr = 'parent.$WZRK_WR.closeIframe(' + campaignId + \",'\" + divId + \"');\"\n      const title = \"<div class='wzrkPPwarp' style='color:\" + textColor + ';background-color:' + bgColor + \";'>\" +\n        \"<a href='javascript:void(0);' onclick=\" + onClickStr + \" class='wzrkClose' style='background-color:\" + btnBg + ';color:' + btColor + \"'>&times;</a>\" +\n        \"<div id='contentDiv' class='wzrk'>\" +\n        \"<table cellpadding='0' cellspacing='0' border='0'>\" +\n        // \"<tr><td colspan='2'></td></tr>\"+\n        '<tr>' + imageTd + \"<td style='vertical-align:top;'>\" +\n        \"<div class='wzrkPPtitle' style='color:\" + textColor + \"'>\" + titleText + '</div>'\n      const body = \"<div class='wzrkPPdscr' style='color:\" + textColor + \"'>\" + descriptionText + '<div></td></tr></table></div>'\n      html = css + title + body\n    }\n\n    iframe.setAttribute('style', 'z-index: 2147483647; display:block; width: 100% !important; border:0px !important; border-color:none !important;')\n    msgDiv.appendChild(iframe)\n    const ifrm = (iframe.contentWindow) ? iframe.contentWindow : (iframe.contentDocument.document) ? iframe.contentDocument.document : iframe.contentDocument\n    const doc = ifrm.document\n\n    doc.open()\n    doc.write(html)\n    doc.close()\n\n    const adjustIFrameHeight = () => {\n      // adjust iframe and body height of html inside correctly\n      contentHeight = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv').scrollHeight\n      if (displayObj['custom-editor'] !== true && !isBanner) {\n        contentHeight += 25\n      }\n      document.getElementById('wiz-iframe').contentDocument.body.style.margin = '0px'\n      document.getElementById('wiz-iframe').style.height = contentHeight + 'px'\n    }\n\n    const ua = navigator.userAgent.toLowerCase()\n    if (ua.indexOf('safari') !== -1) {\n      if (ua.indexOf('chrome') > -1) {\n        iframe.onload = () => {\n          adjustIFrameHeight()\n          const contentDiv = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv')\n          setupClickUrl(onClick, targetingMsgJson, contentDiv, divId, legacy)\n        }\n      } else {\n        let inDoc = iframe.contentDocument || iframe.contentWindow\n        if (inDoc.document) inDoc = inDoc.document\n        // safari iphone 7+ needs this.\n        adjustIFrameHeight()\n        const _timer = setInterval(() => {\n          if (inDoc.readyState === 'complete') {\n            clearInterval(_timer)\n            // adjust iframe and body height of html inside correctly\n            adjustIFrameHeight()\n            const contentDiv = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv')\n            setupClickUrl(onClick, targetingMsgJson, contentDiv, divId, legacy)\n          }\n        }, 10)\n      }\n    } else {\n      iframe.onload = () => {\n        // adjust iframe and body height of html inside correctly\n        adjustIFrameHeight()\n        const contentDiv = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv')\n        setupClickUrl(onClick, targetingMsgJson, contentDiv, divId, legacy)\n      }\n    }\n  }\n\n  let _callBackCalled = false\n\n  const showFooterNotification = (targetingMsgJson) => {\n    let onClick = targetingMsgJson.display.onClick\n\n    // TODO: Needs wizrocket as a global variable\n    if (window.clevertap.hasOwnProperty('notificationCallback') &&\n      typeof window.clevertap.notificationCallback !== 'undefined' &&\n      typeof window.clevertap.notificationCallback === 'function') {\n      const notificationCallback = window.clevertap.notificationCallback\n\n      if (!_callBackCalled) {\n        const inaObj = {}\n        inaObj.msgContent = targetingMsgJson.msgContent\n        inaObj.msgId = targetingMsgJson.wzrk_id\n        if (targetingMsgJson.display.kv != null) {\n          inaObj.kv = targetingMsgJson.display.kv\n        }\n\n        window.clevertap.raiseNotificationClicked = () => {\n          if (onClick !== '' && onClick != null) {\n            const jsFunc = targetingMsgJson.display.jsFunc\n            onClick += getCookieParams()\n\n            // invoke js function call\n            if (jsFunc != null) {\n              // track notification clicked event\n              RequestDispatcher.fireRequest(onClick)\n              invokeExternalJs(jsFunc, targetingMsgJson)\n              return\n            }\n            // pass on the gcookie|page|scookieId for capturing the click event\n            if (targetingMsgJson.display.window === 1) {\n              window.open(onClick, '_blank')\n            } else {\n              window.location = onClick\n            }\n          }\n        }\n        window.clevertap.raiseNotificationViewed = () => {\n          incrementImpression(targetingMsgJson)\n        }\n        notificationCallback(inaObj)\n        _callBackCalled = true\n      }\n    } else {\n      renderFooterNotification(targetingMsgJson)\n\n      if (window.clevertap.hasOwnProperty('popupCallback') &&\n        typeof window.clevertap.popupCallback !== 'undefined' &&\n        typeof window.clevertap.popupCallback === 'function') {\n        const popupCallback = window.clevertap.popupCallback\n\n        const inaObj = {}\n        inaObj.msgContent = targetingMsgJson.msgContent\n        inaObj.msgId = targetingMsgJson.wzrk_id\n\n        var msgCTkv = []\n        for (var wzrkPrefixKey in targetingMsgJson) {\n          // ADD WZRK PREFIX KEY VALUE PAIRS\n          if (wzrkPrefixKey.startsWith(WZRK_PREFIX) && wzrkPrefixKey !== WZRK_ID) {\n            const wzrkJson = { [wzrkPrefixKey]: targetingMsgJson[wzrkPrefixKey] }\n            msgCTkv.push(wzrkJson)\n          }\n        }\n\n        if (msgCTkv.length > 0) {\n          inaObj.msgCTkv = msgCTkv\n        }\n        if (targetingMsgJson.display.kv != null) {\n          inaObj.kv = targetingMsgJson.display.kv\n        }\n\n        // PUBLIC API TO RECORD CLICKED EVENT\n        window.clevertap.raisePopupNotificationClicked = (notificationData) => {\n          if (!notificationData || !notificationData.msgId) { return }\n\n          const eventData = {}\n          eventData.type = 'event'\n          eventData.evtName = NOTIFICATION_CLICKED\n          eventData.evtData = { [WZRK_ID]: notificationData.msgId }\n\n          // WZRK PREFIX KEY VALUE PAIRS\n          if (notificationData.msgCTkv) {\n            for (var wzrkPrefixObj of notificationData.msgCTkv) {\n              eventData.evtData = { ...eventData.evtData, ...wzrkPrefixObj }\n            }\n          }\n\n          _request.processEvent(eventData)\n        }\n        popupCallback(inaObj)\n      }\n    }\n  }\n  let exitintentObj\n  const showExitIntent = (event, targetObj) => {\n    let targetingMsgJson\n    if (event != null && event.clientY > 0) {\n      return\n    }\n    if (targetObj == null) {\n      targetingMsgJson = exitintentObj\n    } else {\n      targetingMsgJson = targetObj\n    }\n\n    if (document.getElementById('intentPreview') != null) {\n      return\n    }\n    // dont show exit intent on tablet/mobile - only on desktop\n    if (targetingMsgJson.display.layout == null &&\n      ((/mobile/i.test(navigator.userAgent)) || (/mini/i.test(navigator.userAgent)) || (/iPad/i.test(navigator.userAgent)) ||\n        ('ontouchstart' in window) || (/tablet/i.test(navigator.userAgent)))) {\n      return\n    }\n\n    const campaignId = targetingMsgJson.wzrk_id.split('_')[0]\n    if (doCampHouseKeeping(targetingMsgJson) === false) {\n      return\n    }\n\n    $ct.campaignDivMap[campaignId] = 'intentPreview'\n    let legacy = false\n    const opacityDiv = document.createElement('div')\n    opacityDiv.id = 'intentOpacityDiv'\n    opacityDiv.setAttribute('style', 'position: fixed;top: 0;bottom: 0;left: 0;width: 100%;height: 100%;z-index: 2147483646;background: rgba(0,0,0,0.7);')\n    document.body.appendChild(opacityDiv)\n\n    const msgDiv = document.createElement('div')\n    msgDiv.id = 'intentPreview'\n\n    if (targetingMsgJson.display.proto == null) {\n      legacy = true\n      msgDiv.setAttribute('style', 'display:block;overflow:hidden;top:55% !important;left:50% !important;position:fixed;z-index:2147483647;width:600px !important;height:600px !important;margin:-300px 0 0 -300px !important;')\n    } else {\n      msgDiv.setAttribute('style', targetingMsgJson.display.iFrameStyle)\n    }\n    document.body.appendChild(msgDiv)\n    const iframe = document.createElement('iframe')\n    const borderRadius = targetingMsgJson.display.br === false ? '0' : '8'\n    iframe.frameborder = '0px'\n    iframe.marginheight = '0px'\n    iframe.marginwidth = '0px'\n    iframe.scrolling = 'no'\n    iframe.id = 'wiz-iframe-intent'\n    const onClick = targetingMsgJson.display.onClick\n    let pointerCss = ''\n    if (onClick !== '' && onClick != null) {\n      pointerCss = 'cursor:pointer;'\n    }\n    let html\n    // direct html\n    if (targetingMsgJson.msgContent.type === 1) {\n      html = targetingMsgJson.msgContent.html\n      html = html.replace(/##campaignId##/g, campaignId)\n    } else {\n      const css = '' +\n        '<style type=\"text/css\">' +\n        'body{margin:0;padding:0;}' +\n        '#contentDiv.wzrk{overflow:hidden;padding:0 0 20px 0;text-align:center;' + pointerCss + '}' +\n        '#contentDiv.wzrk td{padding:15px 10px;}' +\n        '.wzrkPPtitle{font-weight: bold;font-size: 24px;font-family:arial;word-break: break-word;padding-top:20px;}' +\n        '.wzrkPPdscr{font-size: 14px;font-family:arial;line-height:16px;word-break: break-word;display:inline-block;padding:20px 20px 0 20px;line-height:20px;}' +\n        '.PL15{padding-left:15px;}' +\n        '.wzrkPPwarp{margin:20px 20px 0 5px;padding:0px;border-radius: ' + borderRadius + 'px;box-shadow: 1px 1px 5px #888888;}' +\n        'a.wzrkClose{cursor:pointer;position: absolute;top: 11px;right: 11px;z-index: 2147483647;font-size:19px;font-family:arial;font-weight:bold;text-decoration: none;width: 25px;/*height: 25px;*/text-align: center; -webkit-appearance: none; line-height: 25px;' +\n        'background: #353535;border: #fff 2px solid;border-radius: 100%;box-shadow: #777 2px 2px 2px;color:#fff;}' +\n        'a:hover.wzrkClose{background-color:#d1914a !important;color:#fff !important; -webkit-appearance: none;}' +\n        '#contentDiv .button{padding-top:20px;}' +\n        '#contentDiv .button a{font-size: 14px;font-weight:bold;font-family:arial;text-align:center;display:inline-block;text-decoration:none;padding:0 30px;height:40px;line-height:40px;background:#ea693b;color:#fff;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;}' +\n        '</style>'\n\n      let bgColor, textColor, btnBg, btColor\n      if (targetingMsgJson.display.theme === 'dark') {\n        bgColor = '#2d2d2e'\n        textColor = '#eaeaea'\n        btnBg = '#353535'\n        btColor = '#ffffff'\n      } else {\n        bgColor = '#ffffff'\n        textColor = '#000000'\n        btnBg = '#a5a6a6'\n        btColor = '#ffffff'\n      }\n      const titleText = targetingMsgJson.msgContent.title\n      const descriptionText = targetingMsgJson.msgContent.description\n      let ctaText = ''\n      if (targetingMsgJson.msgContent.ctaText != null && targetingMsgJson.msgContent.ctaText !== '') {\n        ctaText = \"<div class='button'><a href='#'>\" + targetingMsgJson.msgContent.ctaText + '</a></div>'\n      }\n\n      let imageTd = ''\n      if (targetingMsgJson.msgContent.imageUrl != null && targetingMsgJson.msgContent.imageUrl !== '') {\n        imageTd = \"<div style='padding-top:20px;'><img src='\" + targetingMsgJson.msgContent.imageUrl + \"' width='500' alt=\" + titleText + ' /></div>'\n      }\n      const onClickStr = 'parent.$WZRK_WR.closeIframe(' + campaignId + \",'intentPreview');\"\n      const title = \"<div class='wzrkPPwarp' style='color:\" + textColor + ';background-color:' + bgColor + \";'>\" +\n        \"<a href='javascript:void(0);' onclick=\" + onClickStr + \" class='wzrkClose' style='background-color:\" + btnBg + ';color:' + btColor + \"'>&times;</a>\" +\n        \"<div id='contentDiv' class='wzrk'>\" +\n        \"<div class='wzrkPPtitle' style='color:\" + textColor + \"'>\" + titleText + '</div>'\n      const body = \"<div class='wzrkPPdscr' style='color:\" + textColor + \"'>\" + descriptionText + '</div>' + imageTd + ctaText +\n        '</div></div>'\n      html = css + title + body\n    }\n    iframe.setAttribute('style', 'z-index: 2147483647; display:block; height: 100% !important; width: 100% !important;min-height:80px !important;border:0px !important; border-color:none !important;')\n    msgDiv.appendChild(iframe)\n    const ifrm = (iframe.contentWindow) ? iframe.contentWindow : (iframe.contentDocument.document) ? iframe.contentDocument.document : iframe.contentDocument\n    const doc = ifrm.document\n\n    doc.open()\n    doc.write(html)\n    doc.close()\n\n    const contentDiv = document.getElementById('wiz-iframe-intent').contentDocument.getElementById('contentDiv')\n    setupClickUrl(onClick, targetingMsgJson, contentDiv, 'intentPreview', legacy)\n  }\n\n  if (!document.body) {\n    if (_wizCounter < 6) {\n      _wizCounter++\n      setTimeout(_tr, 1000, msg, {\n        device: _device,\n        session: _session,\n        request: _request,\n        logger: _logger\n      })\n    }\n    return\n  }\n  if (msg.inapp_notifs != null) {\n    for (let index = 0; index < msg.inapp_notifs.length; index++) {\n      const targetNotif = msg.inapp_notifs[index]\n      if (targetNotif.display.wtarget_type == null || targetNotif.display.wtarget_type === 0) {\n        showFooterNotification(targetNotif)\n      } else if (targetNotif.display.wtarget_type === 1) { // if display['wtarget_type']==1 then exit intent\n        exitintentObj = targetNotif\n        window.document.body.onmouseleave = showExitIntent\n      }\n    }\n  }\n\n  const mergeEventMap = (newEvtMap) => {\n    if ($ct.globalEventsMap == null) {\n      $ct.globalEventsMap = StorageManager.readFromLSorCookie(EV_COOKIE)\n      if ($ct.globalEventsMap == null) {\n        $ct.globalEventsMap = newEvtMap\n        return\n      }\n    }\n    for (const key in newEvtMap) {\n      if (newEvtMap.hasOwnProperty(key)) {\n        const oldEvtObj = $ct.globalEventsMap[key]\n        const newEvtObj = newEvtMap[key]\n        if ($ct.globalEventsMap[key] != null) {\n          if (newEvtObj[0] != null && newEvtObj[0] > oldEvtObj[0]) {\n            $ct.globalEventsMap[key] = newEvtObj\n          }\n        } else {\n          $ct.globalEventsMap[key] = newEvtObj\n        }\n      }\n    }\n  }\n\n  if (StorageManager._isLocalStorageSupported()) {\n    try {\n      if (msg.evpr != null) {\n        const eventsMap = msg.evpr.events\n        const profileMap = msg.evpr.profile\n        const syncExpiry = msg.evpr.expires_in\n        const now = getNow()\n        StorageManager.setMetaProp('lsTime', now)\n        StorageManager.setMetaProp('exTs', syncExpiry)\n        mergeEventMap(eventsMap)\n        StorageManager.saveToLSorCookie(EV_COOKIE, $ct.globalEventsMap)\n        if ($ct.globalProfileMap == null) {\n          addToLocalProfileMap(profileMap, true)\n        } else {\n          addToLocalProfileMap(profileMap, false)\n        }\n      }\n      if (msg.arp != null) {\n        arp(msg.arp)\n      }\n      if (msg.inapp_stale != null) {\n        const campObj = getCampaignObject()\n        const globalObj = campObj.global\n        if (globalObj != null) {\n          for (const idx in msg.inapp_stale) {\n            if (msg.inapp_stale.hasOwnProperty(idx)) {\n              delete globalObj[msg.inapp_stale[idx]]\n            }\n          }\n        }\n        saveCampaignObject(campObj)\n      }\n    } catch (e) {\n      _logger.error('Unable to persist evrp/arp: ' + e)\n    }\n  }\n}\n\nexport default _tr\n","import {\n  StorageManager\n} from '../util/storage'\nexport default class User {\n  #isPersonalisationActive\n\n  constructor ({\n    isPersonalisationActive\n  }) {\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  getTotalVisits () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    let visitCount = StorageManager.getMetaProp('sc')\n    if (visitCount == null) {\n      visitCount = 1\n    }\n    return visitCount\n  }\n\n  getLastVisit () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    const prevSession = StorageManager.getMetaProp('ps')\n    if (prevSession != null) {\n      return new Date(prevSession * 1000)\n    }\n  }\n}\n","import {\n  CLEVERTAP_ERROR_PREFIX\n} from '../util/messages'\n\nexport const logLevels = {\n  DISABLE: 0,\n  ERROR: 1,\n  INFO: 2,\n  DEBUG: 3\n}\n\nexport class Logger {\n  #logLevel\n  wzrkError = {}\n  constructor (logLevel) {\n    this.#logLevel = logLevel == null ? logLevel : logLevels.INFO\n    this.wzrkError = {}\n  }\n\n  get logLevel () {\n    return this.#logLevel\n  }\n\n  set logLevel (logLevel) {\n    this.#logLevel = logLevel\n  }\n\n  error (message) {\n    if (this.#logLevel >= logLevels.ERROR) {\n      this.#log('error', message)\n    }\n  }\n\n  info (message) {\n    if (this.#logLevel >= logLevels.INFO) {\n      this.#log('log', message)\n    }\n  }\n\n  debug (message) {\n    if (this.#logLevel >= logLevels.DEBUG || this.#isLegacyDebug) {\n      this.#log('debug', message)\n    }\n  }\n\n  reportError (code, description) {\n    this.wzrkError.c = code\n    this.wzrkError.d = description\n    this.error(`${CLEVERTAP_ERROR_PREFIX} ${code}: ${description}`)\n  }\n\n  #log (level, message) {\n    if (window.console) {\n      try {\n        const ts = new Date().getTime()\n        console[level](`CleverTap [${ts}]: ${message}`)\n      } catch (e) {}\n    }\n  }\n\n  get #isLegacyDebug () {\n    return (typeof sessionStorage !== 'undefined' && sessionStorage.WZRK_D === '')\n  }\n}\n\nexport default {\n  Logger,\n  logLevels\n}\n","import { singleQuoteRegex, SCOOKIE_EXP_TIME_IN_SECS } from '../util/constants'\nimport { isObject } from '../util/datatypes'\nimport { getNow } from '../util/datetime'\nimport { StorageManager } from '../util/storage'\nimport { getHostName } from '../util/url'\n\nexport default class SessionManager {\n  #logger\n  #sessionId\n  #isPersonalisationActive\n  cookieName // SCOOKIE_NAME\n  scookieObj\n\n  constructor ({\n    logger,\n    isPersonalisationActive\n  }) {\n    this.sessionId = StorageManager.getMetaProp('cs')\n    this.#logger = logger\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  get sessionId () {\n    return this.#sessionId\n  }\n\n  set sessionId (sessionId) {\n    this.#sessionId = sessionId\n  }\n\n  getSessionCookieObject () {\n    let scookieStr = StorageManager.readCookie(this.cookieName)\n    let obj = {}\n\n    if (scookieStr != null) {\n      // converting back single quotes to double for JSON parsing - http://www.iandevlin.com/blog/2012/04/html5/cookies-json-localstorage-and-opera\n      scookieStr = scookieStr.replace(singleQuoteRegex, '\"')\n\n      obj = JSON.parse(scookieStr)\n      if (!isObject(obj)) {\n        obj = {}\n      } else {\n        if (typeof obj.t !== 'undefined') { // check time elapsed since last request\n          const lastTime = obj.t\n          const now = getNow()\n          if ((now - lastTime) > (SCOOKIE_EXP_TIME_IN_SECS + 60)) {\n            // adding 60 seconds to compensate for in-journey requests\n            // ideally the cookie should've died after SCOOKIE_EXP_TIME_IN_SECS but it's still around as we can read\n            // hence we shouldn't use it.\n            obj = {}\n          }\n        }\n      }\n    }\n    this.scookieObj = obj\n    return obj\n  }\n\n  setSessionCookieObject (obj) {\n    const objStr = JSON.stringify(obj)\n    StorageManager.createBroadCookie(this.cookieName, objStr, SCOOKIE_EXP_TIME_IN_SECS, getHostName())\n  }\n\n  manageSession (session) {\n    // first time. check if current session id in localstorage is same\n    // if not same then prev = current and current = this new session\n    if (typeof this.sessionId === 'undefined' || this.sessionId !== session) {\n      const currentSessionInLS = StorageManager.getMetaProp('cs')\n      // if sessionId in meta is undefined - set current to both\n      if (typeof currentSessionInLS === 'undefined') {\n        StorageManager.setMetaProp('ps', session)\n        StorageManager.setMetaProp('cs', session)\n        StorageManager.setMetaProp('sc', 1)\n      } else if (currentSessionInLS !== session) {\n        // not same as session in local storage. new session\n        StorageManager.setMetaProp('ps', currentSessionInLS)\n        StorageManager.setMetaProp('cs', session)\n        let sessionCount = StorageManager.getMetaProp('sc')\n        if (typeof sessionCount === 'undefined') {\n          sessionCount = 0\n        }\n        StorageManager.setMetaProp('sc', sessionCount + 1)\n      }\n      this.sessionId = session\n    }\n  }\n\n  getTimeElapsed () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    if (this.scookieObj != null) { // TODO: check logic?\n      this.scookieObj = this.getSessionCookieObject()\n    }\n    const sessionStart = this.scookieObj.s\n    if (sessionStart != null) {\n      const ts = getNow()\n      return Math.floor(ts - sessionStart)\n    }\n  }\n\n  getPageCount () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n\n    if (this.scookieObj != null) { // TODO: check logic\n      this.scookieObj = this.getSessionCookieObject()\n    }\n    return this.scookieObj.p\n  }\n}\n","import { CAMP_COOKIE_NAME, CLEAR, EVT_PUSH, EV_COOKIE, FIRE_PUSH_UNREGISTERED, LCOOKIE_NAME, PUSH_SUBSCRIPTION_DATA, WEBPUSH_LS_KEY } from '../util/constants'\nimport { isObjectEmpty, isValueValid, removeUnsupportedChars } from '../util/datatypes'\nimport { getNow } from '../util/datetime'\nimport { compressData } from '../util/encoder'\nimport RequestDispatcher from '../util/requestDispatcher'\nimport { StorageManager, $ct } from '../util/storage'\nimport { addToURL } from '../util/url'\nimport { getCampaignObjForLc } from '../util/clevertap'\n\nlet seqNo = 0\nlet requestTime = 0\n\nexport default class RequestManager {\n  #logger\n  #account\n  #device\n  #session\n  #isPersonalisationActive\n  #clearCookie = false\n  processingBackup = false\n\n  constructor ({ logger, account, device, session, isPersonalisationActive }) {\n    this.#logger = logger\n    this.#account = account\n    this.#device = device\n    this.#session = session\n    this.#isPersonalisationActive = isPersonalisationActive\n\n    RequestDispatcher.logger = logger\n    RequestDispatcher.device = device\n  }\n\n  processBackupEvents () {\n    const backupMap = StorageManager.readFromLSorCookie(LCOOKIE_NAME)\n    if (typeof backupMap === 'undefined' || backupMap === null) {\n      return\n    }\n    this.processingBackup = true\n    for (const idx in backupMap) {\n      if (backupMap.hasOwnProperty(idx)) {\n        const backupEvent = backupMap[idx]\n        if (typeof backupEvent.fired === 'undefined') {\n          this.#logger.debug('Processing backup event : ' + backupEvent.q)\n          if (typeof backupEvent.q !== 'undefined') {\n            RequestDispatcher.fireRequest(backupEvent.q)\n          }\n          backupEvent.fired = true\n        }\n      }\n    }\n\n    StorageManager.saveToLSorCookie(LCOOKIE_NAME, backupMap)\n    this.processingBackup = false\n  }\n\n  addSystemDataToObject (dataObject, ignoreTrim) {\n    // ignore trim for chrome notifications; undefined everywhere else\n    if (typeof ignoreTrim === 'undefined') {\n      dataObject = removeUnsupportedChars(dataObject, this.#logger)\n    }\n\n    if (!isObjectEmpty(this.#logger.wzrkError)) {\n      dataObject.wzrk_error = this.#logger.wzrkError\n      this.#logger.wzrkError = {}\n    }\n\n    dataObject.id = this.#account.id\n\n    if (isValueValid(this.#device.gcookie)) {\n      dataObject.g = this.#device.gcookie\n    }\n\n    const obj = this.#session.getSessionCookieObject()\n    dataObject.s = obj.s // session cookie\n    dataObject.pg = (typeof obj.p === 'undefined') ? 1 : obj.p // Page count\n\n    return dataObject\n  }\n\n  addFlags (data) {\n    // check if cookie should be cleared.\n    this.#clearCookie = StorageManager.getAndClearMetaProp(CLEAR)\n    if (this.#clearCookie !== undefined && this.#clearCookie) {\n      data.rc = true\n      this.#logger.debug('reset cookie sent in request and cleared from meta for future requests.')\n    }\n    if (this.#isPersonalisationActive()) {\n      const lastSyncTime = StorageManager.getMetaProp('lsTime')\n      const expirySeconds = StorageManager.getMetaProp('exTs')\n\n      // dsync not found in local storage - get data from server\n      if (typeof lastSyncTime === 'undefined' || typeof expirySeconds === 'undefined') {\n        data.dsync = true\n        return\n      }\n      const now = getNow()\n      // last sync time has expired - get fresh data from server\n      if (lastSyncTime + expirySeconds < now) {\n        data.dsync = true\n      }\n    }\n  }\n\n  saveAndFireRequest (url, override, sendOULFlag) {\n    const now = getNow()\n    url = addToURL(url, 'rn', ++$ct.globalCache.REQ_N)\n    const data = url + '&i=' + now + '&sn=' + seqNo\n    StorageManager.backupEvent(data, $ct.globalCache.REQ_N, this.#logger)\n\n    if (!$ct.blockRequest || override || (this.#clearCookie !== undefined && this.#clearCookie)) {\n      if (now === requestTime) {\n        seqNo++\n      } else {\n        requestTime = now\n        seqNo = 0\n      }\n\n      RequestDispatcher.fireRequest(data, false, sendOULFlag)\n    } else {\n      this.#logger.debug(`Not fired due to block request - ${$ct.blockRequest} or clearCookie - ${this.#clearCookie}`)\n    }\n  }\n\n  unregisterTokenForGuid (givenGUID) {\n    const data = {}\n    data.type = 'data'\n    if (isValueValid(givenGUID)) {\n      data.g = givenGUID\n    }\n    data.action = 'unregister'\n    data.id = this.#account.id\n\n    const obj = this.#session.getSessionCookieObject()\n\n    data.s = obj.s // session cookie\n    const compressedData = compressData(JSON.stringify(data), this.#logger)\n\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', 'data')\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n    StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, false)\n    RequestDispatcher.fireRequest(pageLoadUrl, true)\n\n    // REGISTER TOKEN\n    const payload = StorageManager.readFromLSorCookie(PUSH_SUBSCRIPTION_DATA)\n    this.registerToken(payload)\n  }\n\n  registerToken (payload) {\n    if (!payload) return\n\n    payload = this.addSystemDataToObject(payload, true)\n    payload = JSON.stringify(payload)\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', 'data')\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(payload, this.#logger))\n    RequestDispatcher.fireRequest(pageLoadUrl)\n    // set in localstorage\n    StorageManager.save(WEBPUSH_LS_KEY, 'ok')\n  }\n\n  processEvent (data) {\n    this.#addToLocalEventMap(data.evtName)\n    data = this.addSystemDataToObject(data, undefined)\n    this.addFlags(data)\n    data[CAMP_COOKIE_NAME] = getCampaignObjForLc()\n    const compressedData = compressData(JSON.stringify(data), this.#logger)\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n    this.saveAndFireRequest(pageLoadUrl, false)\n  }\n\n  #addToLocalEventMap (evtName) {\n    if (StorageManager._isLocalStorageSupported()) {\n      if (typeof $ct.globalEventsMap === 'undefined') {\n        $ct.globalEventsMap = StorageManager.readFromLSorCookie(EV_COOKIE)\n        if (typeof $ct.globalEventsMap === 'undefined') {\n          $ct.globalEventsMap = {}\n        }\n      }\n\n      const nowTs = getNow()\n      let evtDetail = $ct.globalEventsMap[evtName]\n      if (typeof evtDetail !== 'undefined') {\n        evtDetail[2] = nowTs\n        evtDetail[0]++\n      } else {\n        evtDetail = []\n        evtDetail.push(1)\n        evtDetail.push(nowTs)\n        evtDetail.push(nowTs)\n      }\n      $ct.globalEventsMap[evtName] = evtDetail\n      StorageManager.saveToLSorCookie(EV_COOKIE, $ct.globalEventsMap)\n    }\n  }\n}\n","import {\n  isObjectEmpty\n} from '../util/datatypes'\nimport {\n  EVT_PUSH,\n  USEIP_KEY,\n  OPTOUT_KEY,\n  CT_OPTOUT_KEY\n} from '../util/constants'\nimport {\n  StorageManager,\n  $ct\n} from '../util/storage'\nimport {\n  compressData\n} from '../util/encoder'\nimport {\n  addToURL\n} from '../util/url'\n\nexport default class Privacy extends Array {\n  #request\n  #account\n  #oldValues\n  #logger\n\n  constructor ({\n    request,\n    account,\n    logger\n  },\n  values) {\n    super()\n    this.#logger = logger\n    this.#request = request\n    this.#account = account\n    this.#oldValues = values\n  }\n\n  push (...privacyArr) {\n    this.#processPrivacyArray(privacyArr)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processPrivacyArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  #processPrivacyArray (privacyArr) {\n    if (Array.isArray(privacyArr) && privacyArr.length > 0) {\n      const privacyObj = privacyArr[0]\n      let data = {}\n      const profileObj = {}\n      var optOut = false\n\n      if (privacyObj.hasOwnProperty(OPTOUT_KEY)) {\n        optOut = privacyObj[OPTOUT_KEY]\n        if (typeof optOut === 'boolean') {\n          profileObj[CT_OPTOUT_KEY] = optOut\n          // should be true when user wants to opt in\n          $ct.isOptInRequest = !optOut\n        }\n      }\n      if (privacyObj.hasOwnProperty(USEIP_KEY)) {\n        const useIP = privacyObj[USEIP_KEY]\n        const shouldUseIP = (typeof useIP === 'boolean') ? useIP : false\n        StorageManager.setMetaProp(USEIP_KEY, shouldUseIP)\n      }\n      if (!isObjectEmpty(profileObj)) {\n        data.type = 'profile'\n        data.profile = profileObj\n        data = this.#request.addSystemDataToObject(data, undefined)\n        const compressedData = compressData(JSON.stringify(data), this.#logger)\n        let pageLoadUrl = this.#account.dataPostURL\n        pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n        pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n        pageLoadUrl = addToURL(pageLoadUrl, OPTOUT_KEY, optOut ? 'true' : 'false')\n        this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequeust)\n      }\n    }\n  }\n}\n","import { StorageManager, $ct } from '../util/storage'\nimport { isObject } from '../util/datatypes'\nimport {\n  PUSH_SUBSCRIPTION_DATA\n} from '../util/constants'\nimport {\n  urlBase64ToUint8Array\n} from '../util/encoder'\n\nexport default class NotificationHandler extends Array {\n  #oldValues\n  #logger\n  #request\n  #account\n  #wizAlertJSPath\n  #fcmPublicKey\n\n  constructor ({\n    logger,\n    session,\n    request,\n    account\n  }, values) {\n    super()\n    this.#wizAlertJSPath = 'https://d2r1yp2w7bby2u.cloudfront.net/js/wzrk_dialog.min.js'\n    this.#fcmPublicKey = null\n    this.#oldValues = values\n    this.#logger = logger\n    this.#request = request\n    this.#account = account\n  }\n\n  push (...displayArgs) {\n    this.#setUpWebPush(displayArgs)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#setUpWebPush(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  #setUpWebPush (displayArgs) {\n    if ($ct.webPushEnabled && displayArgs.length > 0) {\n      this.#handleNotificationRegistration(displayArgs)\n    } else if ($ct.webPushEnabled == null && displayArgs.length > 0) {\n      $ct.notifApi.notifEnabledFromApi = true\n      $ct.notifApi.displayArgs = displayArgs.slice()\n    } else if ($ct.webPushEnabled === false && displayArgs.length > 0) {\n      this.#logger.error('Make sure push notifications are fully enabled and integrated')\n    }\n  }\n\n  #setUpWebPushNotifications (subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsServiceUrl) {\n    if (navigator.userAgent.indexOf('Chrome') !== -1 || navigator.userAgent.indexOf('Firefox') !== -1) {\n      this.#setUpChromeFirefoxNotifications(subscriptionCallback, serviceWorkerPath)\n    } else if (navigator.userAgent.indexOf('Safari') !== -1) {\n      this.#setUpSafariNotifications(subscriptionCallback, apnsWebPushId, apnsServiceUrl)\n    }\n  }\n\n  #setApplicationServerKey (applicationServerKey) {\n    this.#fcmPublicKey = applicationServerKey\n  }\n\n  #setUpSafariNotifications (subscriptionCallback, apnsWebPushId, apnsServiceUrl) {\n    // ensure that proper arguments are passed\n    if (typeof apnsWebPushId === 'undefined') {\n      this.#logger.error('Ensure that APNS Web Push ID is supplied')\n    }\n    if (typeof apnsServiceUrl === 'undefined') {\n      this.#logger.error('Ensure that APNS Web Push service path is supplied')\n    }\n    if ('safari' in window && 'pushNotification' in window.safari) {\n      window.safari.pushNotification.requestPermission(\n        apnsServiceUrl,\n        apnsWebPushId, {}, (subscription) => {\n          if (subscription.permission === 'granted') {\n            const subscriptionData = JSON.parse(JSON.stringify(subscription))\n            subscriptionData.endpoint = subscription.deviceToken\n            subscriptionData.browser = 'Safari'\n            StorageManager.saveToLSorCookie(PUSH_SUBSCRIPTION_DATA, subscriptionData)\n\n            this.#request.registerToken(subscriptionData)\n            this.#logger.info('Safari Web Push registered. Device Token: ' + subscription.deviceToken)\n          } else if (subscription.permission === 'denied') {\n            this.#logger.info('Error subscribing to Safari web push')\n          }\n        })\n    }\n  }\n\n  /**\n   * Sets up a service worker for WebPush(chrome/Firefox) push notifications and sends the data to LC\n   */\n  #setUpChromeFirefoxNotifications (subscriptionCallback, serviceWorkerPath) {\n    let registrationScope = ''\n\n    if ('serviceWorker' in navigator) {\n      navigator.serviceWorker.register(serviceWorkerPath).then((registration) => {\n        if (typeof __wzrk_account_id !== 'undefined') { // eslint-disable-line\n          // shopify accounts , since the service worker is not at root, serviceWorker.ready is never resolved.\n          // hence add a timeout and hope serviceWroker is ready within that time.\n          return new Promise(resolve => setTimeout(() => resolve(registration), 5000))\n        }\n        registrationScope = registration.scope\n\n        // IF SERVICE WORKER IS AT ROOT, RETURN THE READY PROMISE\n        // ELSE IF CHROME RETURN PROMISE AFTER 5 SECONDS\n        // OR getRegistrations PROMISE IF ITS FIREFOX\n        const rootDirRegex = /^(\\.?)(\\/?)([^/]*).js$/\n        const isServiceWorkerAtRoot = rootDirRegex.test(serviceWorkerPath)\n        if (isServiceWorkerAtRoot) {\n          return navigator.serviceWorker.ready\n        } else {\n          if (navigator.userAgent.indexOf('Chrome') !== -1) {\n            return new Promise(resolve => setTimeout(() => resolve(registration), 5000))\n          } else {\n            return navigator.serviceWorker.getRegistrations()\n          }\n        }\n      }).then((serviceWorkerRegistration) => {\n        // ITS AN ARRAY IN CASE OF FIREFOX, SO USE THE REGISTRATION WITH PROPER SCOPE\n        if (navigator.userAgent.indexOf('Firefox') !== -1 && Array.isArray(serviceWorkerRegistration)) {\n          serviceWorkerRegistration = serviceWorkerRegistration.filter((i) => i.scope === registrationScope)[0]\n        }\n        const subscribeObj = { userVisibleOnly: true }\n\n        if (this.#fcmPublicKey != null) {\n          subscribeObj.applicationServerKey = urlBase64ToUint8Array(this.#fcmPublicKey)\n        }\n\n        serviceWorkerRegistration.pushManager.subscribe(subscribeObj)\n          .then((subscription) => {\n            this.#logger.info('Service Worker registered. Endpoint: ' + subscription.endpoint)\n\n            // convert the subscription keys to strings; this sets it up nicely for pushing to LC\n            const subscriptionData = JSON.parse(JSON.stringify(subscription))\n\n            // remove the common chrome/firefox endpoint at the beginning of the token\n            if (navigator.userAgent.indexOf('Chrome') !== -1) {\n              subscriptionData.endpoint = subscriptionData.endpoint.split('/').pop()\n              subscriptionData.browser = 'Chrome'\n            } else if (navigator.userAgent.indexOf('Firefox') !== -1) {\n              subscriptionData.endpoint = subscriptionData.endpoint.split('/').pop()\n              subscriptionData.browser = 'Firefox'\n            }\n            StorageManager.saveToLSorCookie(PUSH_SUBSCRIPTION_DATA, subscriptionData)\n\n            // var shouldSendToken = typeof sessionObj['p'] === STRING_CONSTANTS.UNDEFINED || sessionObj['p'] === 1\n            //     || sessionObj['p'] === 2 || sessionObj['p'] === 3 || sessionObj['p'] === 4 || sessionObj['p'] === 5;\n            const shouldSendToken = true\n            if (shouldSendToken) {\n              this.#request.registerToken(subscriptionData)\n            }\n\n            if (typeof subscriptionCallback !== 'undefined' && typeof subscriptionCallback === 'function') {\n              subscriptionCallback()\n            }\n          }).catch((error) => {\n            this.#logger.error('Error subscribing: ' + error)\n            // unsubscribe from webpush if error\n            serviceWorkerRegistration.pushManager.getSubscription().then((subscription) => {\n              if (subscription !== null) {\n                subscription.unsubscribe().then((successful) => {\n                  // You've successfully unsubscribed\n                  this.#logger.info('Unsubscription successful')\n                }).catch((e) => {\n                  // Unsubscription failed\n                  this.#logger.error('Error unsubscribing: ' + e)\n                })\n              }\n            })\n          })\n      }).catch((err) => {\n        this.#logger.error('error registering service worker: ' + err)\n      })\n    }\n  }\n\n  #addWizAlertJS () {\n    const scriptTag = document.createElement('script')\n    scriptTag.setAttribute('type', 'text/javascript')\n    scriptTag.setAttribute('id', 'wzrk-alert-js')\n    scriptTag.setAttribute('src', this.#wizAlertJSPath)\n\n    // add the script tag to the end of the body\n    document.getElementsByTagName('body')[0].appendChild(scriptTag)\n\n    return scriptTag\n  }\n\n  #removeWizAlertJS () {\n    const scriptTag = document.getElementById('wzrk-alert-js')\n    scriptTag.parentNode.removeChild(scriptTag)\n  }\n\n  #handleNotificationRegistration (displayArgs) {\n    // make sure everything is specified\n    let titleText\n    let bodyText\n    let okButtonText\n    let rejectButtonText\n    let okButtonColor\n    let skipDialog\n    let askAgainTimeInSeconds\n    let okCallback\n    let rejectCallback\n    let subscriptionCallback\n    let hidePoweredByCT\n    let serviceWorkerPath\n    let httpsPopupPath\n    let httpsIframePath\n    let apnsWebPushId\n    let apnsWebPushServiceUrl\n\n    if (displayArgs.length === 1) {\n      if (isObject(displayArgs[0])) {\n        const notifObj = displayArgs[0]\n        titleText = notifObj.titleText\n        bodyText = notifObj.bodyText\n        okButtonText = notifObj.okButtonText\n        rejectButtonText = notifObj.rejectButtonText\n        okButtonColor = notifObj.okButtonColor\n        skipDialog = notifObj.skipDialog\n        askAgainTimeInSeconds = notifObj.askAgainTimeInSeconds\n        okCallback = notifObj.okCallback\n        rejectCallback = notifObj.rejectCallback\n        subscriptionCallback = notifObj.subscriptionCallback\n        hidePoweredByCT = notifObj.hidePoweredByCT\n        serviceWorkerPath = notifObj.serviceWorkerPath\n        httpsPopupPath = notifObj.httpsPopupPath\n        httpsIframePath = notifObj.httpsIframePath\n        apnsWebPushId = notifObj.apnsWebPushId\n        apnsWebPushServiceUrl = notifObj.apnsWebPushServiceUrl\n      }\n    } else {\n      titleText = displayArgs[0]\n      bodyText = displayArgs[1]\n      okButtonText = displayArgs[2]\n      rejectButtonText = displayArgs[3]\n      okButtonColor = displayArgs[4]\n      skipDialog = displayArgs[5]\n      askAgainTimeInSeconds = displayArgs[6]\n    }\n\n    if (skipDialog == null) {\n      skipDialog = false\n    }\n\n    if (hidePoweredByCT == null) {\n      hidePoweredByCT = false\n    }\n\n    if (serviceWorkerPath == null) {\n      serviceWorkerPath = '/clevertap_sw.js'\n    }\n\n    // ensure that the browser supports notifications\n    if (typeof navigator.serviceWorker === 'undefined') {\n      return\n    }\n\n    const isHTTP = httpsPopupPath != null && httpsIframePath != null\n\n    // make sure the site is on https for chrome notifications\n    if (window.location.protocol !== 'https:' && document.location.hostname !== 'localhost' && !isHTTP) {\n      this.#logger.error('Make sure you are https or localhost to register for notifications')\n      return\n    }\n\n    // right now, we only support Chrome V50 & higher & Firefox\n    if (navigator.userAgent.indexOf('Chrome') !== -1) {\n      const chromeAgent = navigator.userAgent.match(/Chrome\\/(\\d+)/)\n      if (chromeAgent == null || parseInt(chromeAgent[1], 10) < 50) { return }\n    } else if (navigator.userAgent.indexOf('Firefox') !== -1) {\n      const firefoxAgent = navigator.userAgent.match(/Firefox\\/(\\d+)/)\n      if (firefoxAgent == null || parseInt(firefoxAgent[1], 10) < 50) { return }\n    } else if (navigator.userAgent.indexOf('Safari') !== -1) {\n      const safariAgent = navigator.userAgent.match(/Safari\\/(\\d+)/)\n      if (safariAgent == null || parseInt(safariAgent[1], 10) < 50) { return }\n    } else {\n      return\n    }\n\n    // we check for the cookie in setUpChromeNotifications() the tokens may have changed\n\n    if (!isHTTP) {\n      if (Notification == null) {\n        return\n      }\n      // handle migrations from other services -> chrome notifications may have already been asked for before\n      if (Notification.permission === 'granted') {\n        // skip the dialog and register\n        this.#setUpWebPushNotifications(subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsWebPushServiceUrl)\n        return\n      } else if (Notification.permission === 'denied') {\n        // we've lost this profile :'(\n        return\n      }\n\n      if (skipDialog) {\n        this.#setUpWebPushNotifications(subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsWebPushServiceUrl)\n        return\n      }\n    }\n\n    // make sure the right parameters are passed\n    if (!titleText || !bodyText || !okButtonText || !rejectButtonText) {\n      this.#logger.error('Missing input parameters; please specify title, body, ok button and cancel button text')\n      return\n    }\n\n    // make sure okButtonColor is formatted properly\n    if (okButtonColor == null || !okButtonColor.match(/^#[a-f\\d]{6}$/i)) {\n      okButtonColor = '#f28046' // default color for positive button\n    }\n\n    // make sure the user isn't asked for notifications more than askAgainTimeInSeconds\n    const now = new Date().getTime() / 1000\n    if ((StorageManager.getMetaProp('notif_last_time')) == null) {\n      StorageManager.setMetaProp('notif_last_time', now)\n    } else {\n      if (askAgainTimeInSeconds == null) {\n        // 7 days by default\n        askAgainTimeInSeconds = 7 * 24 * 60 * 60\n      }\n\n      if (now - StorageManager.getMetaProp('notif_last_time') < askAgainTimeInSeconds) {\n        return\n      } else {\n        // continue asking\n        StorageManager.setMetaProp('notif_last_time', now)\n      }\n    }\n\n    if (isHTTP) {\n      // add the https iframe\n      const httpsIframe = document.createElement('iframe')\n      httpsIframe.setAttribute('style', 'display:none;')\n      httpsIframe.setAttribute('src', httpsIframePath)\n      document.body.appendChild(httpsIframe)\n      window.addEventListener('message', (event) => {\n        if (event.data != null) {\n          let obj = {}\n          try {\n            obj = JSON.parse(event.data)\n          } catch (e) {\n            // not a call from our iframe\n            return\n          }\n          if (obj.state != null) {\n            if (obj.from === 'ct' && obj.state === 'not') {\n              this.#addWizAlertJS().onload = () => {\n                // create our wizrocket popup\n                window.wzrkPermissionPopup.wizAlert({\n                  title: titleText,\n                  body: bodyText,\n                  confirmButtonText: okButtonText,\n                  confirmButtonColor: okButtonColor,\n                  rejectButtonText: rejectButtonText,\n                  hidePoweredByCT: hidePoweredByCT\n                }, (enabled) => { // callback function\n                  if (enabled) {\n                    // the user accepted on the dialog box\n                    if (typeof okCallback === 'function') {\n                      okCallback()\n                    }\n                    // redirect to popup.html\n                    window.open(httpsPopupPath)\n                  } else {\n                    if (typeof rejectCallback === 'function') {\n                      rejectCallback()\n                    }\n                  }\n                  this.#removeWizAlertJS()\n                })\n              }\n            }\n          }\n        }\n      }, false)\n    } else {\n      this.#addWizAlertJS().onload = () => {\n        // create our wizrocket popup\n        window.wzrkPermissionPopup.wizAlert({\n          title: titleText,\n          body: bodyText,\n          confirmButtonText: okButtonText,\n          confirmButtonColor: okButtonColor,\n          rejectButtonText: rejectButtonText,\n          hidePoweredByCT: hidePoweredByCT\n        }, (enabled) => { // callback function\n          if (enabled) {\n            // the user accepted on the dialog box\n            if (typeof okCallback === 'function') {\n              okCallback()\n            }\n            this.#setUpWebPushNotifications(subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsWebPushServiceUrl)\n          } else {\n            if (typeof rejectCallback === 'function') {\n              rejectCallback()\n            }\n          }\n          this.#removeWizAlertJS()\n        })\n      }\n    }\n  }\n\n  _enableWebPush (enabled, applicationServerKey) {\n    $ct.webPushEnabled = enabled\n    if (applicationServerKey != null) {\n      this.#setApplicationServerKey(applicationServerKey)\n    }\n    if ($ct.webPushEnabled && $ct.notifApi.notifEnabledFromApi) {\n      this.#handleNotificationRegistration($ct.notifApi.displayArgs)\n    } else if (!$ct.webPushEnabled && $ct.notifApi.notifEnabledFromApi) {\n      this.#logger.error('Ensure that web push notifications are fully enabled and integrated before requesting them')\n    }\n  }\n}\n","import Account from './modules/account'\nimport CleverTapAPI from './modules/api'\nimport DeviceManager from './modules/device'\nimport EventHandler from './modules/event'\nimport ProfileHandler from './modules/profile'\nimport UserLoginHandler from './modules/userLogin'\nimport _tr from './util/tr'\nimport User from './modules/user'\nimport { Logger, logLevels } from './modules/logger'\nimport SessionManager from './modules/session'\nimport ReqestManager from './modules/request'\nimport {\n  CAMP_COOKIE_NAME,\n  SCOOKIE_PREFIX,\n  EVT_PING,\n  FIRST_PING_FREQ_IN_MILLIS,\n  CONTINUOUS_PING_FREQ_IN_MILLIS,\n  GROUP_SUBSCRIPTION_REQUEST_ID,\n  categoryLongKey\n} from './util/constants'\nimport { EMBED_ERROR } from './util/messages'\nimport { StorageManager, $ct } from './util/storage'\nimport { addToURL, getDomain, getURLParams } from './util/url'\nimport { getCampaignObjForLc, setEnum, handleEmailSubscription, closeIframe } from './util/clevertap'\nimport { compressData } from './util/encoder'\nimport Privacy from './modules/privacy'\nimport NotificationHandler from './modules/notification'\n\nexport default class CleverTap {\n  #logger\n  #api\n  #onloadcalled\n  #device\n  #session\n  #account\n  #request\n  #isSpa\n  #previousUrl\n  #boundCheckPageChanged = this.#checkPageChanged.bind(this)\n  enablePersonalization\n\n  get spa () {\n    return this.#isSpa\n  }\n\n  set spa (value) {\n    const isSpa = value === true\n    if (this.#isSpa !== isSpa && this.#onloadcalled === 1) {\n      // if clevertap.spa is changed after init has been called then update the click listeners\n      if (isSpa) {\n        document.addEventListener('click', this.#boundCheckPageChanged)\n      } else {\n        document.removeEventListener('click', this.#boundCheckPageChanged)\n      }\n    }\n    this.#isSpa = isSpa\n  }\n\n  constructor (clevertap = {}) {\n    this.#onloadcalled = 0\n    this._isPersonalisationActive = this._isPersonalisationActive.bind(this)\n    this.raiseNotificationClicked = () => {}\n    this.#logger = new Logger(logLevels.INFO)\n    this.#account = new Account(clevertap.account?.[0], clevertap.region || clevertap.account?.[1], clevertap.targetDomain || clevertap.account?.[2])\n    this.#device = new DeviceManager({ logger: this.#logger })\n    this.#session = new SessionManager({\n      logger: this.#logger,\n      isPersonalisationActive: this._isPersonalisationActive\n    })\n    this.#request = new ReqestManager({\n      logger: this.#logger,\n      account: this.#account,\n      device: this.#device,\n      session: this.#session,\n      isPersonalisationActive: this._isPersonalisationActive\n    })\n    this.enablePersonalization = clevertap.enablePersonalization || false\n    this.event = new EventHandler({\n      logger: this.#logger,\n      request: this.#request,\n      isPersonalisationActive: this._isPersonalisationActive\n    }, clevertap.event)\n\n    this.profile = new ProfileHandler({\n      logger: this.#logger,\n      request: this.#request,\n      account: this.#account,\n      isPersonalisationActive: this._isPersonalisationActive\n    }, clevertap.profile)\n\n    this.onUserLogin = new UserLoginHandler({\n      request: this.#request,\n      account: this.#account,\n      session: this.#session,\n      logger: this.#logger,\n      device: this.#device\n    }, clevertap.onUserLogin)\n\n    this.privacy = new Privacy({\n      request: this.#request,\n      account: this.#account,\n      logger: this.#logger\n    }, clevertap.privacy)\n\n    this.notifications = new NotificationHandler({\n      logger: this.#logger,\n      request: this.#request,\n      account: this.#account\n    }, clevertap.notifications)\n\n    this.#api = new CleverTapAPI({\n      logger: this.#logger,\n      request: this.#request,\n      device: this.#device,\n      session: this.#session\n    })\n\n    this.spa = clevertap.spa\n\n    this.user = new User({\n      isPersonalisationActive: this._isPersonalisationActive\n    })\n\n    this.session = {\n      getTimeElapsed: () => {\n        return this.#session.getTimeElapsed()\n      },\n      getPageCount: () => {\n        return this.#session.getPageCount()\n      }\n    }\n\n    this.logout = () => {\n      this.#logger.debug('logout called')\n      StorageManager.setInstantDeleteFlagInK()\n    }\n\n    this.clear = () => {\n      this.onUserLogin.clear()\n    }\n\n    this.getCleverTapID = () => {\n      return this.#device.getGuid()\n    }\n\n    this.getAccountID = () => {\n      return this.#account.id\n    }\n\n    this.getDCDomain = () => {\n      return this.#account.finalTargetDomain\n    }\n\n    // Set the Direct Call sdk version and fire request\n    this.setDCSDKVersion = (ver) => {\n      this.#account.dcSDKVersion = ver\n      const data = {}\n      data.af = { dcv: 'dc-sdk-v' + this.#account.dcSDKVersion }\n      let pageLoadUrl = this.#account.dataPostURL\n      pageLoadUrl = addToURL(pageLoadUrl, 'type', 'page')\n      pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n      pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n\n      this.#request.saveAndFireRequest(pageLoadUrl, false)\n    }\n\n    this.setLogLevel = (l) => {\n      this.#logger.logLevel = Number(l)\n    }\n\n    const _handleEmailSubscription = (subscription, reEncoded, fetchGroups) => {\n      handleEmailSubscription(subscription, reEncoded, fetchGroups, this.#account, this.#logger)\n    }\n\n    const api = this.#api\n    api.logout = this.logout\n    api.clear = this.clear\n    api.closeIframe = (campaignId, divIdIgnored) => {\n      closeIframe(campaignId, divIdIgnored, this.#session.sessionId)\n    }\n    api.enableWebPush = (enabled, applicationServerKey) => {\n      this.notifications._enableWebPush(enabled, applicationServerKey)\n    }\n    api.tr = (msg) => {\n      _tr(msg, {\n        device: this.#device,\n        session: this.#session,\n        request: this.#request,\n        logger: this.#logger\n      })\n    }\n    api.setEnum = (enumVal) => {\n      setEnum(enumVal, this.#logger)\n    }\n    api.is_onloadcalled = () => {\n      return (this.#onloadcalled === 1)\n    }\n    api.subEmail = (reEncoded) => {\n      _handleEmailSubscription('1', reEncoded)\n    }\n    api.getEmail = (reEncoded, withGroups) => {\n      _handleEmailSubscription('-1', reEncoded, withGroups)\n    }\n    api.unSubEmail = (reEncoded) => {\n      _handleEmailSubscription('0', reEncoded)\n    }\n    api.unsubEmailGroups = (reEncoded) => {\n      $ct.unsubGroups = []\n      const elements = document.getElementsByClassName('ct-unsub-group-input-item')\n\n      for (let i = 0; i < elements.length; i++) {\n        const element = elements[i]\n        if (element.name) {\n          const data = { name: element.name, isUnsubscribed: element.checked }\n          $ct.unsubGroups.push(data)\n        }\n      }\n\n      _handleEmailSubscription(GROUP_SUBSCRIPTION_REQUEST_ID, reEncoded)\n    }\n    api.setSubscriptionGroups = (value) => {\n      $ct.unsubGroups = value\n    }\n    api.getSubscriptionGroups = () => {\n      return $ct.unsubGroups\n    }\n    api.changeSubscriptionGroups = (reEncoded, updatedGroups) => {\n      api.setSubscriptionGroups(updatedGroups)\n      _handleEmailSubscription(GROUP_SUBSCRIPTION_REQUEST_ID, reEncoded)\n    }\n    api.setUpdatedCategoryLong = (profile) => {\n      if (profile[categoryLongKey]) {\n        $ct.updatedCategoryLong = profile[categoryLongKey]\n      }\n    }\n    window.$CLTP_WR = window.$WZRK_WR = api\n\n    if (clevertap.account?.[0].id) {\n      // The accountId is present so can init with empty values.\n      // Needed to maintain backward compatability with legacy implementations.\n      // Npm imports/require will need to call init explictly with accountId\n      this.init()\n    }\n  }\n\n  raiseNotificationClicked () {\n\n  }\n\n  init (accountId, region, targetDomain) {\n    if (this.#onloadcalled === 1) {\n      // already initailsed\n      return\n    }\n    StorageManager.removeCookie('WZRK_P', window.location.hostname)\n    if (!this.#account.id) {\n      if (!accountId) {\n        this.#logger.error(EMBED_ERROR)\n        return\n      }\n      this.#account.id = accountId\n    }\n    this.#session.cookieName = SCOOKIE_PREFIX + '_' + this.#account.id\n\n    if (region) {\n      this.#account.region = region\n    }\n    if (targetDomain) {\n      this.#account.targetDomain = targetDomain\n    }\n\n    const currLocation = location.href\n    const urlParams = getURLParams(currLocation.toLowerCase())\n\n    // eslint-disable-next-line eqeqeq\n    if (typeof urlParams.e !== 'undefined' && urlParams.wzrk_ex == '0') {\n      return\n    }\n\n    this.#request.processBackupEvents()\n    this.#processOldValues()\n\n    this.pageChanged()\n\n    if (this.#isSpa) {\n      // listen to click on the document and check if URL has changed.\n      document.addEventListener('click', this.#boundCheckPageChanged)\n    } else {\n      // remove existing click listeners if any\n      document.removeEventListener('click', this.#boundCheckPageChanged)\n    }\n    this.#onloadcalled = 1\n  }\n\n  #processOldValues () {\n    this.onUserLogin._processOldValues()\n    this.privacy._processOldValues()\n    this.event._processOldValues()\n    this.profile._processOldValues()\n    this.notifications._processOldValues()\n  }\n\n  #checkPageChanged () {\n    if (this.#previousUrl !== location.href) {\n      this.pageChanged()\n    }\n  }\n\n  pageChanged () {\n    const currLocation = window.location.href\n    const urlParams = getURLParams(currLocation.toLowerCase())\n    // -- update page count\n    const obj = this.#session.getSessionCookieObject()\n    let pgCount = (typeof obj.p === 'undefined') ? 0 : obj.p\n    obj.p = ++pgCount\n    this.#session.setSessionCookieObject(obj)\n    // -- update page count\n\n    let data = {}\n    let referrerDomain = getDomain(document.referrer)\n\n    if (window.location.hostname !== referrerDomain) {\n      const maxLen = 120\n      if (referrerDomain !== '') {\n        referrerDomain = referrerDomain.length > maxLen ? referrerDomain.substring(0, maxLen) : referrerDomain\n        data.referrer = referrerDomain\n      }\n\n      let utmSource = urlParams.utm_source || urlParams.wzrk_source\n      if (typeof utmSource !== 'undefined') {\n        utmSource = utmSource.length > maxLen ? utmSource.substring(0, maxLen) : utmSource\n        data.us = utmSource // utm_source\n      }\n\n      let utmMedium = urlParams.utm_medium || urlParams.wzrk_medium\n      if (typeof utmMedium !== 'undefined') {\n        utmMedium = utmMedium.length > maxLen ? utmMedium.substring(0, maxLen) : utmMedium\n        data.um = utmMedium // utm_medium\n      }\n\n      let utmCampaign = urlParams.utm_campaign || urlParams.wzrk_campaign\n      if (typeof utmCampaign !== 'undefined') {\n        utmCampaign = utmCampaign.length > maxLen ? utmCampaign.substring(0, maxLen) : utmCampaign\n        data.uc = utmCampaign // utm_campaign\n      }\n\n      // also independently send wzrk_medium to the backend\n      if (typeof urlParams.wzrk_medium !== 'undefined') {\n        const wm = urlParams.wzrk_medium\n        if (wm.match(/^email$|^social$|^search$/)) {\n          data.wm = wm // wzrk_medium\n        }\n      }\n    }\n\n    data = this.#request.addSystemDataToObject(data, undefined)\n    data.cpg = currLocation\n\n    data[CAMP_COOKIE_NAME] = getCampaignObjForLc()\n    let pageLoadUrl = this.#account.dataPostURL\n    this.#request.addFlags(data)\n    // send dsync flag when page = 1\n    if (parseInt(data.pg) === 1) {\n      this.#overrideDSyncFlag(data)\n    }\n    data.af = { lib: 'web-sdk-v$$PACKAGE_VERSION$$' }\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', 'page')\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n\n    this.#request.saveAndFireRequest(pageLoadUrl, false)\n\n    this.#previousUrl = currLocation\n    setTimeout(() => {\n      if (pgCount <= 3) {\n        // send ping for up to 3 pages\n        this.#pingRequest()\n      }\n\n      if (this.#isPingContinuous()) {\n        setInterval(() => {\n          this.#pingRequest()\n        }, CONTINUOUS_PING_FREQ_IN_MILLIS)\n      }\n    }, FIRST_PING_FREQ_IN_MILLIS)\n  }\n\n  #pingRequest () {\n    let pageLoadUrl = this.#account.dataPostURL\n    let data = {}\n    data = this.#request.addSystemDataToObject(data, undefined)\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PING)\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n\n    this.#request.saveAndFireRequest(pageLoadUrl, false)\n  }\n\n  #isPingContinuous () {\n    return (typeof window.wzrk_d !== 'undefined' && window.wzrk_d.ping === 'continuous')\n  }\n\n  _isPersonalisationActive () {\n    return StorageManager._isLocalStorageSupported() && this.enablePersonalization\n  }\n\n  #overrideDSyncFlag (data) {\n    if (this._isPersonalisationActive()) {\n      data.dsync = true\n    }\n  }\n}\n","import Clevertap from './clevertap'\n\nconst clevertap = new Clevertap(window.clevertap)\n\nwindow.clevertap = window.wizrocket = clevertap\n\nexport default clevertap\n"],"names":["TARGET_DOMAIN","TARGET_PROTOCOL","DEFAULT_REGION","Account","id","region","targetDomain","accountId","dcSDKVersion","finalTargetDomain","unsupportedKeyCharRegex","RegExp","unsupportedValueCharRegex","singleQuoteRegex","CLEAR","CHARGED_ID","CHARGEDID_COOKIE_NAME","GCOOKIE_NAME","KCOOKIE_NAME","CAMP_COOKIE_NAME","SCOOKIE_PREFIX","SCOOKIE_EXP_TIME_IN_SECS","EV_COOKIE","META_COOKIE","PR_COOKIE","ARP_COOKIE","LCOOKIE_NAME","GLOBAL","DISPLAY","WEBPUSH_LS_KEY","OPTOUT_KEY","CT_OPTOUT_KEY","OPTOUT_COOKIE_ENDSWITH","USEIP_KEY","LRU_CACHE","LRU_CACHE_SIZE","IS_OUL","EVT_PUSH","EVT_PING","COOKIE_EXPIRY","MAX_TRIES","FIRST_PING_FREQ_IN_MILLIS","CONTINUOUS_PING_FREQ_IN_MILLIS","GROUP_SUBSCRIPTION_REQUEST_ID","categoryLongKey","WZRK_PREFIX","WZRK_ID","NOTIFICATION_VIEWED","NOTIFICATION_CLICKED","FIRE_PUSH_UNREGISTERED","PUSH_SUBSCRIPTION_DATA","SYSTEM_EVENTS","isString","input","String","isObject","Object","prototype","toString","call","isDateObject","Date","isObjectEmpty","obj","prop","hasOwnProperty","isConvertibleToNumber","n","isNaN","parseFloat","isFinite","isNumber","test","isValueValid","value","undefined","removeUnsupportedChars","o","logger","key","sanitizedVal","sanitizedKey","sanitize","length","substring","reportError","val","regex","replace","getToday","today","getFullYear","getMonth","getDay","getNow","Math","floor","getTime","convertToWZRKDate","dateObj","round","setDate","dt","isDateValid","date","matches","exec","d","m","y","composedDate","getDate","StorageManager","_isLocalStorageSupported","localStorage","setItem","JSON","stringify","data","getItem","parse","e","removeItem","name","domain","cookieStr","document","cookie","seconds","expires","domainStr","setTime","toGMTString","encodeURIComponent","nameEQ","ca","split","idx","c","charAt","indexOf","decodeURIComponent","window","property","save","createCookie","location","hostname","$ct","globalCache","read","readCookie","trim","err","broadDomain","domainParts","testBroadDomain","testCookieName","removeCookie","tempCookie","metaObj","readFromLSorCookie","wzrkMetaObj","saveToLSorCookie","getMetaProp","setMetaProp","k","flag","reqNo","backupArr","q","debug","respNo","backupMap","gcookie","REQ_N","RESP_N","LRU_cache","globalProfileMap","globalEventsMap","blockRequest","isOptInRequest","webPushEnabled","campaignDivMap","currentSessionId","wiz_counter","notifApi","notifEnabledFromApi","unsubGroups","updatedCategoryLong","LRUCache","max","lruCache","tempLruCache","cache","entry","push","item","saveCacheToLS","allKeys","objToArray","index","temp","keysArr","keysLength","newCache","indexToDelete","splice","CleverTapAPI","request","device","session","global","resume","respNumber","optOutResponse","removeBackup","getAndClearMetaProp","kIdFromLS","guidFromLRUCache","set","lastK","getSecondLastKey","lastGUID","unregisterTokenForGuid","createBroadCookie","manageSession","getSessionCookieObject","s","t","setSessionCookieObject","processingBackup","processBackupEvents","DeviceManager","getGuid","guid","error","DATA_NOT_SENT_TEXT","CLEVERTAP_ERROR_PREFIX","EMBED_ERROR","EVENT_ERROR","GENDER_ERROR","EMPLOYED_ERROR","MARRIED_ERROR","EDUCATION_ERROR","AGE_ERROR","DOB_ERROR","ENUM_FORMAT_ERROR","PHONE_FORMAT_ERROR","_globalChargedId","isEventStructureFlat","eventObj","Array","isArray","isChargedEventStructureValid","chargedObj","itemKey","chargedId","EventHandler","values","isPersonalisationActive","eventsArr","evtName","evtObj","respObj","firstTime","lastTime","count","eventName","shift","includes","type","unshift","evtData","processEvent","getURLParams","url","urlParams","uri","match","pl","search","decode","replacement","getDomain","a","createElement","href","addToURL","v","getHostName","urlBase64ToUint8Array","base64String","padding","repeat","base64","rawData","atob","processedData","i","charCodeAt","Uint8Array","compressData","dataObject","compressToBase64","compress","uncompressed","context_dictionary","context_dictionaryToCreate","context_c","context_wc","context_w","context_enlargeIn","context_dictSize","context_numBits","context_data_string","context_data_val","context_data_position","ii","f","fromCharCode","pow","getKeyStr","_keyStr","output","chr1","chr2","chr3","enc1","enc2","enc3","enc4","NaN","RequestDispatcher","skipARP","sendOULFlag","skipResARP","_arp","pageLoadUrl","useIP","slice","tries","setTimeout","clevertap","wizrocket","plugin","ctCbScripts","getElementsByClassName","parentNode","removeChild","setAttribute","async","getElementsByTagName","appendChild","getCampaignObject","campObj","saveCampaignObject","campaignObj","getCampaignObjForLc","resultObj","globalObj","dailyObj","campaignIdArray","keys","dailyC","totalC","campaignId","element","todayC","tc","wmp","tlc","isProfileValid","profileObj","valid","profileKey","profileVal","Age","Phone","processFBUserObj","user","profileData","Name","FBID","gender","Gender","getHighestEducation","eduArr","college","highschool","edu","relationship_status","Married","education","Education","work","Employed","email","Email","birthday","mmddyy","DOB","processGPlusUserObj","displayName","GPID","image","isDefault","Photo","emails","emailIdx","emailObj","organizations","orgObj","yyyymmdd","relationshipStatus","addToLocalProfileMap","override","_custom","closeIframe","divIdIgnored","sessionCampaignObj","divId","getElementById","style","display","arp","jsonMap","console","isOULARP","arpFromStorage","setEnum","enumVal","handleEmailSubscription","subscription","reEncoded","fetchGroups","account","urlParamsAsIs","encodedEmailId","encodedProfileProps","p","emailURL","fireRequest","ProfileHandler","profilesArr","propName","profileArr","outerObj","Site","Facebook","FbProfileObj","GPlusProfileObj","tz","profile","addSystemDataToObject","addFlags","compressedData","dataPostURL","saveAndFireRequest","blockRequeust","UserLoginHandler","addToK","ids","g","kId","anonymousUser","foundInCache","getLastKey","gFromCache","get","clear","Identity","cookieName","loginArr","pop","processProfile","setInstantDeleteFlagInK","_tr","msg","_device","_session","_request","_logger","_wizCounter","doCampHouseKeeping","targetingMsgJson","wzrk_id","incrCount","excludeFromFreqCaps","currentCount","totalCount","sessionStorage","wmc","campaignSessionLimit","campaignDailyLimit","campaignTotalLimit","totalDailyLimit","totalSessionLimit","efc","parseInt","mdc","tdc","sessionObj","sessionId","campaignSessionCount","totalSessionCount","campaignDailyCount","totalDailyCount","campaignTotalCount","delay","newCampObj","getCookieParams","scookieObj","setupClickEvent","onClick","contentDiv","isLegacy","ctaElement","jsCTAElements","jsFunc","isPreview","preview","onclick","invokeExternalJs","open","func","parent","kv","setupClickUrl","incrementImpression","renderFooterNotification","displayObj","layout","showExitIntent","isBanner","msgDiv","viewHeight","innerHeight","viewWidth","innerWidth","legacy","marginBottom","contentHeight","right","bottomPosition","width","widthPerct","navigator","userAgent","proto","iFrameStyle","body","iframe","borderRadius","br","frameborder","marginheight","marginwidth","scrolling","pointerCss","html","msgContent","css","bgColor","textColor","btnBg","leftTd","btColor","theme","titleText","title","descriptionText","description","imageTd","imageUrl","onClickStr","ifrm","contentWindow","contentDocument","doc","write","close","adjustIFrameHeight","scrollHeight","margin","height","ua","toLowerCase","onload","inDoc","_timer","setInterval","readyState","clearInterval","_callBackCalled","showFooterNotification","notificationCallback","inaObj","msgId","raiseNotificationClicked","raiseNotificationViewed","popupCallback","msgCTkv","wzrkPrefixKey","startsWith","wzrkJson","raisePopupNotificationClicked","notificationData","eventData","wzrkPrefixObj","exitintentObj","event","targetObj","clientY","opacityDiv","ctaText","inapp_notifs","targetNotif","wtarget_type","onmouseleave","mergeEventMap","newEvtMap","oldEvtObj","newEvtObj","evpr","eventsMap","events","profileMap","syncExpiry","expires_in","now","inapp_stale","User","visitCount","prevSession","logLevels","DISABLE","ERROR","INFO","DEBUG","Logger","logLevel","wzrkError","message","code","level","ts","WZRK_D","SessionManager","scookieStr","objStr","currentSessionInLS","sessionCount","sessionStart","seqNo","requestTime","RequestManager","backupEvent","fired","ignoreTrim","wzrk_error","pg","rc","lastSyncTime","expirySeconds","dsync","givenGUID","action","payload","registerToken","nowTs","evtDetail","Privacy","privacyArr","privacyObj","optOut","shouldUseIP","NotificationHandler","displayArgs","enabled","applicationServerKey","subscriptionCallback","serviceWorkerPath","apnsWebPushId","apnsServiceUrl","safari","pushNotification","requestPermission","permission","subscriptionData","endpoint","deviceToken","browser","info","registrationScope","serviceWorker","register","then","registration","__wzrk_account_id","Promise","resolve","scope","rootDirRegex","isServiceWorkerAtRoot","ready","getRegistrations","serviceWorkerRegistration","filter","subscribeObj","userVisibleOnly","pushManager","subscribe","catch","getSubscription","unsubscribe","successful","scriptTag","bodyText","okButtonText","rejectButtonText","okButtonColor","skipDialog","askAgainTimeInSeconds","okCallback","rejectCallback","hidePoweredByCT","httpsPopupPath","httpsIframePath","apnsWebPushServiceUrl","notifObj","isHTTP","protocol","chromeAgent","firefoxAgent","safariAgent","Notification","httpsIframe","addEventListener","state","from","wzrkPermissionPopup","wizAlert","confirmButtonText","confirmButtonColor","CleverTap","isSpa","removeEventListener","bind","enablePersonalization","_isPersonalisationActive","ReqestManager","onUserLogin","privacy","notifications","spa","getTimeElapsed","getPageCount","logout","getCleverTapID","getAccountID","getDCDomain","setDCSDKVersion","ver","af","dcv","setLogLevel","l","Number","_handleEmailSubscription","api","enableWebPush","_enableWebPush","tr","is_onloadcalled","subEmail","getEmail","withGroups","unSubEmail","unsubEmailGroups","elements","isUnsubscribed","checked","setSubscriptionGroups","getSubscriptionGroups","changeSubscriptionGroups","updatedGroups","setUpdatedCategoryLong","$CLTP_WR","$WZRK_WR","init","currLocation","wzrk_ex","pageChanged","pgCount","referrerDomain","referrer","maxLen","utmSource","utm_source","wzrk_source","us","utmMedium","utm_medium","wzrk_medium","um","utmCampaign","utm_campaign","wzrk_campaign","uc","wm","cpg","lib","_processOldValues","wzrk_d","ping","Clevertap"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAO,IAAMA,aAAa,GAAG,oBAAtB;EACA,IAAMC,eAAe,GAAG,QAAxB;EACA,IAAMC,cAAc,GAAG,KAAvB;;;;;;;;;;MCAcC;EAMnB,qBAAqE;EAAA,mFAA/C,EAA+C;EAAA,QAAtDC,EAAsD,QAAtDA,EAAsD;;EAAA,QAA3CC,MAA2C,uEAAlC,EAAkC;EAAA,QAA9BC,YAA8B,uEAAfN,aAAe;;EAAA;;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA,aAJ3D;EAI2D;EAAA;EAAA;EAAA,aAHrDA;EAGqD;EAAA;EAAA;EAAA,aAFrD;EAEqD;EACnE,SAAKI,EAAL,GAAUA,EAAV;;EACA,QAAIC,MAAJ,EAAY;EACV,WAAKA,MAAL,GAAcA,MAAd;EACD;;EACD,QAAIC,YAAJ,EAAkB;EAChB,WAAKA,YAAL,GAAoBA,YAApB;EACD;EACF;;;;0BAES;EACR,yCAAO,IAAP;EACD;wBAEOC,WAAW;EACjB,kEAAkBA,SAAlB;EACD;;;0BAEa;EACZ,yCAAO,IAAP;EACD;wBAEWF,QAAQ;EAClB,4DAAeA,MAAf;EACD;;;0BAEmB;EAClB,yCAAO,IAAP;EACD;wBAEiBG,cAAc;EAC9B,wEAAqBA,YAArB;EACD;;;0BAEmB;EAClB,yCAAO,IAAP;EACD;wBAEiBF,cAAc;EAC9B,wEAAqBA,YAArB;EACD;;;0BAEwB;EACvB,UAAI,KAAKD,MAAT,EAAiB;EACf,yBAAU,KAAKA,MAAf,cAAyB,KAAKC,YAA9B;EACD,OAFD,MAEO;EACL,YAAI,KAAKA,YAAL,KAAsBN,aAA1B,EAAyC;EACvC,2BAAUE,cAAV,cAA4B,KAAKI,YAAjC;EACD;;EACD,eAAO,KAAKA,YAAZ;EACD;EACF;;;0BAEkB;EACjB,uBAAUL,eAAV,eAA8B,KAAKQ,iBAAnC;EACD;;;0BAEkB;EACjB,uBAAUR,eAAV,eAA8B,KAAKQ,iBAAnC;EACD;;;0BAEe;EACd,uBAAUR,eAAV,eAA8B,KAAKQ,iBAAnC;EACD;;;;;;ECvEI,IAAMC,uBAAuB,GAAG,IAAIC,MAAJ,CAAW,qCAAX,EAAkD,GAAlD,CAAhC;EACA,IAAMC,yBAAyB,GAAG,IAAID,MAAJ,CAAW,wBAAX,EAAqC,GAArC,CAAlC;EAEA,IAAME,gBAAgB,GAAG,IAAIF,MAAJ,CAAW,IAAX,EAAiB,GAAjB,CAAzB;EACA,IAAMG,KAAK,GAAG,OAAd;EACA,IAAMC,UAAU,GAAG,YAAnB;EACA,IAAMC,qBAAqB,GAAG,iBAA9B;EACA,IAAMC,YAAY,GAAG,QAArB;EACA,IAAMC,YAAY,GAAG,QAArB;EACA,IAAMC,gBAAgB,GAAG,WAAzB;EACA,IAAMC,cAAc,GAAG,QAAvB;EACA,IAAMC,wBAAwB,GAAG,KAAK,EAAtC;;EACA,IAAMC,SAAS,GAAG,SAAlB;EACA,IAAMC,WAAW,GAAG,WAApB;EACA,IAAMC,SAAS,GAAG,SAAlB;EACA,IAAMC,UAAU,GAAG,UAAnB;EACA,IAAMC,YAAY,GAAG,QAArB;EAEA,IAAMC,MAAM,GAAG,QAAf;EAEA,IAAMC,OAAO,GAAG,SAAhB;EAEA,IAAMC,cAAc,GAAG,UAAvB;EACA,IAAMC,UAAU,GAAG,QAAnB;EACA,IAAMC,aAAa,GAAG,WAAtB;EACA,IAAMC,sBAAsB,GAAG,KAA/B;EACA,IAAMC,SAAS,GAAG,OAAlB;EACA,IAAMC,SAAS,GAAG,QAAlB;EACA,IAAMC,cAAc,GAAG,GAAvB;EACA,IAAMC,MAAM,GAAG,OAAf;EACA,IAAMC,QAAQ,GAAG,MAAjB;EACA,IAAMC,QAAQ,GAAG,MAAjB;EACA,IAAMC,aAAa,GAAG,QAAQ,GAAR,GAAc,EAApC;;EACA,IAAMC,SAAS,GAAG,EAAlB;;EACA,IAAMC,yBAAyB,GAAG,IAAI,EAAJ,GAAS,IAA3C;;EACA,IAAMC,8BAA8B,GAAG,IAAI,EAAJ,GAAS,IAAhD;;EACA,IAAMC,6BAA6B,GAAG,GAAtC;EACA,IAAMC,eAAe,GAAG,MAAxB;EACA,IAAMC,WAAW,GAAG,OAApB;EACA,IAAMC,OAAO,GAAG,SAAhB;EACA,IAAMC,mBAAmB,GAAG,qBAA5B;EACA,IAAMC,oBAAoB,GAAG,sBAA7B;EACA,IAAMC,sBAAsB,GAAG,UAA/B;EACA,IAAMC,sBAAsB,GAAG,UAA/B;;EAEA,IAAMC,aAAa,GAAG,CAC3B,QAD2B,EAE3B,aAF2B,EAG3B,cAH2B,EAI3B,mBAJ2B,EAK3BJ,mBAL2B,EAM3BC,oBAN2B,CAAtB;;ECxCA,IAAMI,QAAQ,GAAG,SAAXA,QAAW,CAACC,KAAD,EAAW;EACjC,SAAQ,OAAOA,KAAP,KAAiB,QAAjB,IAA6BA,KAAK,YAAYC,MAAtD;EACD,CAFM;EAIA,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAACF,KAAD,EAAW;EACjC;EACA,SAAOG,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+BN,KAA/B,MAA0C,iBAAjD;EACD,CAHM;EAKA,IAAMO,YAAY,GAAG,SAAfA,YAAe,CAACP,KAAD,EAAW;EACrC,SAAO,QAAQA,KAAR,MAAmB,QAAnB,IAAgCA,KAAK,YAAYQ,IAAxD;EACD,CAFM;EAIA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,GAAD,EAAS;EACpC,OAAK,IAAMC,IAAX,IAAmBD,GAAnB,EAAwB;EACtB,QAAIA,GAAG,CAACE,cAAJ,CAAmBD,IAAnB,CAAJ,EAA8B;EAAE,aAAO,KAAP;EAAc;EAC/C;;EACD,SAAO,IAAP;EACD,CALM;EAOA,IAAME,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACC,CAAD,EAAO;EAC1C,SAAO,CAACC,KAAK,CAACC,UAAU,CAACF,CAAD,CAAX,CAAN,IAAyBG,QAAQ,CAACH,CAAD,CAAxC;EACD,CAFM;EAIA,IAAMI,QAAQ,GAAG,SAAXA,QAAW,CAACJ,CAAD,EAAO;EAC7B,SAAO,wBAAwBK,IAAxB,CAA6BL,CAA7B,KAAmC,OAAOA,CAAP,KAAa,QAAvD;EACD,CAFM;EAIA,IAAMM,YAAY,GAAG,SAAfA,YAAe,CAACC,KAAD,EAAW;EACrC,MAAIA,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAKC,SAA5B,IAAyCD,KAAK,KAAK,WAAvD,EAAoE;EAClE,WAAO,KAAP;EACD;;EACD,SAAO,IAAP;EACD,CALM;EAiBA,IAAME,sBAAsB,GAAG,SAAzBA,sBAAyB,CAACC,CAAD,EAAIC,MAAJ,EAAe;EACnD;EACA,MAAI,QAAOD,CAAP,MAAa,QAAjB,EAA2B;EACzB,SAAK,IAAME,GAAX,IAAkBF,CAAlB,EAAqB;EACnB,UAAIA,CAAC,CAACZ,cAAF,CAAiBc,GAAjB,CAAJ,EAA2B;EACzB,YAAMC,YAAY,GAAGJ,sBAAsB,CAACC,CAAC,CAACE,GAAD,CAAF,EAASD,MAAT,CAA3C;EACA,YAAIG,YAAY,SAAhB;EACAA,QAAAA,YAAY,GAAGC,QAAQ,CAACH,GAAD,EAAMrE,uBAAN,CAAvB;;EACA,YAAIuE,YAAY,CAACE,MAAb,GAAsB,IAA1B,EAAgC;EAC9BF,UAAAA,YAAY,GAAGA,YAAY,CAACG,SAAb,CAAuB,CAAvB,EAA0B,IAA1B,CAAf;EACAN,UAAAA,MAAM,CAACO,WAAP,CAAmB,GAAnB,EAAwBJ,YAAY,GAAG,0CAAvC;EACD;;EACD,eAAOJ,CAAC,CAACE,GAAD,CAAR;EACAF,QAAAA,CAAC,CAACI,YAAD,CAAD,GAAkBD,YAAlB;EACD;EACF;EACF,GAdD,MAcO;EACL,QAAIM,GAAJ;;EAEA,QAAIlC,QAAQ,CAACyB,CAAD,CAAZ,EAAiB;EACfS,MAAAA,GAAG,GAAGJ,QAAQ,CAACL,CAAD,EAAIjE,yBAAJ,CAAd;;EACA,UAAI0E,GAAG,CAACH,MAAJ,GAAa,IAAjB,EAAuB;EACrBG,QAAAA,GAAG,GAAGA,GAAG,CAACF,SAAJ,CAAc,CAAd,EAAiB,IAAjB,CAAN;EACAN,QAAAA,MAAM,CAACO,WAAP,CAAmB,GAAnB,EAAwBC,GAAG,GAAG,0CAA9B;EACD;EACF,KAND,MAMO;EACLA,MAAAA,GAAG,GAAGT,CAAN;EACD;;EACD,WAAOS,GAAP;EACD;;EACD,SAAOT,CAAP;EACD,CA/BM;EAiCA,IAAMK,QAAQ,GAAG,SAAXA,QAAW,CAAC7B,KAAD,EAAQkC,KAAR,EAAkB;EACxC,SAAOlC,KAAK,CAACmC,OAAN,CAAcD,KAAd,EAAqB,EAArB,CAAP;EACD,CAFM;;ECnFA,IAAME,QAAQ,GAAG,SAAXA,QAAW,GAAM;EAC5B,MAAMC,KAAK,GAAG,IAAI7B,IAAJ,EAAd;EACA,SAAO6B,KAAK,CAACC,WAAN,KAAsB,EAAtB,GAA2BD,KAAK,CAACE,QAAN,EAA3B,GAA8C,EAA9C,GAAmDF,KAAK,CAACG,MAAN,EAA1D;EACD,CAHM;EAKA,IAAMC,MAAM,GAAG,SAATA,MAAS,GAAM;EAC1B,SAAOC,IAAI,CAACC,KAAL,CAAY,IAAInC,IAAJ,EAAD,CAAaoC,OAAb,KAAyB,IAApC,CAAP;EACD,CAFM;EAIA,IAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,OAAD,EAAa;EAC5C,SAAQ,QAAQJ,IAAI,CAACK,KAAL,CAAWD,OAAO,CAACF,OAAR,KAAoB,IAA/B,CAAhB;EACD,CAFM;EAIA,IAAMI,OAAO,GAAG,SAAVA,OAAU,CAACC,EAAD,EAAQ;EAC7B;EACA,MAAIC,WAAW,CAACD,EAAD,CAAf,EAAqB;EACnB,WAAO,QAAQA,EAAf;EACD;EACF,CALM;EAOA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,IAAD,EAAU;EACnC,MAAMC,OAAO,GAAG,0BAA0BC,IAA1B,CAA+BF,IAA/B,CAAhB;EACA,MAAIC,OAAO,IAAI,IAAf,EAAqB,OAAO,KAAP;EACrB,MAAME,CAAC,GAAGF,OAAO,CAAC,CAAD,CAAjB;EACA,MAAMG,CAAC,GAAGH,OAAO,CAAC,CAAD,CAAP,GAAa,CAAvB;EACA,MAAMI,CAAC,GAAGJ,OAAO,CAAC,CAAD,CAAjB;EACA,MAAMK,YAAY,GAAG,IAAIjD,IAAJ,CAASgD,CAAT,EAAYD,CAAZ,EAAeD,CAAf,CAArB,CANmC;;EAQnC,SAAOG,YAAY,CAACC,OAAb,MAA0BJ,CAA1B,IAA+BG,YAAY,CAAClB,QAAb,MAA2BgB,CAA1D,IAA+DE,YAAY,CAACnB,WAAb,MAA8BkB,CAApG;EACD,CATM;;MCdMG,gBAAb;EAAA;EAAA;EAAA;;EAAA;EAAA;EAAA,yBACejC,GADf,EACoBL,KADpB,EAC2B;EACvB,UAAI,CAACK,GAAD,IAAQ,CAACL,KAAb,EAAoB;EAClB,eAAO,KAAP;EACD;;EACD,UAAI,KAAKuC,wBAAL,EAAJ,EAAqC;EACnCC,QAAAA,YAAY,CAACC,OAAb,CAAqBpC,GAArB,EAA0B,OAAOL,KAAP,KAAiB,QAAjB,GAA4BA,KAA5B,GAAoC0C,IAAI,CAACC,SAAL,CAAe3C,KAAf,CAA9D;EACA,eAAO,IAAP;EACD;EACF;EATH;EAAA;EAAA,yBAWeK,GAXf,EAWoB;EAChB,UAAI,CAACA,GAAL,EAAU;EACR,eAAO,KAAP;EACD;;EACD,UAAIuC,IAAI,GAAG,IAAX;;EACA,UAAI,KAAKL,wBAAL,EAAJ,EAAqC;EACnCK,QAAAA,IAAI,GAAGJ,YAAY,CAACK,OAAb,CAAqBxC,GAArB,CAAP;EACD;;EACD,UAAIuC,IAAI,IAAI,IAAZ,EAAkB;EAChB,YAAI;EACFA,UAAAA,IAAI,GAAGF,IAAI,CAACI,KAAL,CAAWF,IAAX,CAAP;EACD,SAFD,CAEE,OAAOG,CAAP,EAAU;EACb;;EACD,aAAOH,IAAP;EACD;EAzBH;EAAA;EAAA,2BA2BiBvC,GA3BjB,EA2BsB;EAClB,UAAI,CAACA,GAAL,EAAU;EACR,eAAO,KAAP;EACD;;EACD,UAAI,KAAKkC,wBAAL,EAAJ,EAAqC;EACnCC,QAAAA,YAAY,CAACQ,UAAb,CAAwB3C,GAAxB;EACA,eAAO,IAAP;EACD;EACF;EAnCH;EAAA;EAAA,iCAqCuB4C,IArCvB,EAqC6BC,MArC7B,EAqCqC;EACjC,UAAIC,SAAS,GAAGF,IAAI,GAAG,2CAAvB;;EAEA,UAAIC,MAAJ,EAAY;EACVC,QAAAA,SAAS,GAAGA,SAAS,GAAG,UAAZ,GAAyBD,MAAzB,GAAkC,UAA9C;EACD;;EAEDE,MAAAA,QAAQ,CAACC,MAAT,GAAkBF,SAAlB;EACD;EA7CH;EAAA;EAAA,iCA+CuBF,IA/CvB,EA+C6BjD,KA/C7B,EA+CoCsD,OA/CpC,EA+C6CJ,MA/C7C,EA+CqD;EACjD,UAAIK,OAAO,GAAG,EAAd;EACA,UAAIC,SAAS,GAAG,EAAhB;;EACA,UAAIF,OAAJ,EAAa;EACX,YAAMxB,IAAI,GAAG,IAAI3C,IAAJ,EAAb;EACA2C,QAAAA,IAAI,CAAC2B,OAAL,CAAa3B,IAAI,CAACP,OAAL,KAAkB+B,OAAO,GAAG,IAAzC;EAEAC,QAAAA,OAAO,GAAG,eAAezB,IAAI,CAAC4B,WAAL,EAAzB;EACD;;EAED,UAAIR,MAAJ,EAAY;EACVM,QAAAA,SAAS,GAAG,cAAcN,MAA1B;EACD;;EAEDlD,MAAAA,KAAK,GAAG2D,kBAAkB,CAAC3D,KAAD,CAA1B;EAEAoD,MAAAA,QAAQ,CAACC,MAAT,GAAkBJ,IAAI,GAAG,GAAP,GAAajD,KAAb,GAAqBuD,OAArB,GAA+BC,SAA/B,GAA2C,UAA7D;EACD;EAhEH;EAAA;EAAA,+BAkEqBP,IAlErB,EAkE2B;EACvB,UAAMW,MAAM,GAAGX,IAAI,GAAG,GAAtB;EACA,UAAMY,EAAE,GAAGT,QAAQ,CAACC,MAAT,CAAgBS,KAAhB,CAAsB,GAAtB,CAAX;;EACA,WAAK,IAAIC,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAGF,EAAE,CAACpD,MAA3B,EAAmCsD,GAAG,EAAtC,EAA0C;EACxC,YAAIC,CAAC,GAAGH,EAAE,CAACE,GAAD,CAAV;;EACA,eAAOC,CAAC,CAACC,MAAF,CAAS,CAAT,MAAgB,GAAvB,EAA4B;EAC1BD,UAAAA,CAAC,GAAGA,CAAC,CAACtD,SAAF,CAAY,CAAZ,EAAesD,CAAC,CAACvD,MAAjB,CAAJ;EACD,SAJuC;;;EAMxC,YAAIuD,CAAC,CAACE,OAAF,CAAUN,MAAV,KAAqB,CAAzB,EAA4B;EAC1B,iBAAOO,kBAAkB,CAACH,CAAC,CAACtD,SAAF,CAAYkD,MAAM,CAACnD,MAAnB,EAA2BuD,CAAC,CAACvD,MAA7B,CAAD,CAAzB;EACD;EACF;;EACD,aAAO,IAAP;EACD;EAhFH;EAAA;EAAA,+CAkFqC;EACjC,aAAO,kBAAkB2D,MAAlB,IAA4BA,MAAM,CAAC5B,YAAP,KAAwB,IAApD,IAA4D,OAAO4B,MAAM,CAAC5B,YAAP,CAAoBC,OAA3B,KAAuC,UAA1G;EACD;EApFH;EAAA;EAAA,qCAsF2B4B,QAtF3B,EAsFqCrE,KAtFrC,EAsF4C;EACxC,UAAIA,KAAK,IAAI,IAAb,EAAmB;EACjB;EACD;;EACD,UAAI;EACF,YAAI,KAAKuC,wBAAL,EAAJ,EAAqC;EACnC,eAAK+B,IAAL,CAAUD,QAAV,EAAoBV,kBAAkB,CAACjB,IAAI,CAACC,SAAL,CAAe3C,KAAf,CAAD,CAAtC;EACD,SAFD,MAEO;EACL,cAAIqE,QAAQ,KAAK9H,YAAjB,EAA+B;EAC7B,iBAAKgI,YAAL,CAAkBF,QAAlB,EAA4BV,kBAAkB,CAAC3D,KAAD,CAA9C,EAAuD,CAAvD,EAA0DoE,MAAM,CAACI,QAAP,CAAgBC,QAA1E;EACD,WAFD,MAEO;EACL,iBAAKF,YAAL,CAAkBF,QAAlB,EAA4BV,kBAAkB,CAACjB,IAAI,CAACC,SAAL,CAAe3C,KAAf,CAAD,CAA9C,EAAuE,CAAvE,EAA0EoE,MAAM,CAACI,QAAP,CAAgBC,QAA1F;EACD;EACF;;EACDC,QAAAA,GAAG,CAACC,WAAJ,CAAgBN,QAAhB,IAA4BrE,KAA5B;EACD,OAXD,CAWE,OAAO+C,CAAP,EAAU;EACb;EAtGH;EAAA;EAAA,uCAwG6BsB,QAxG7B,EAwGuC;EACnC,UAAIzB,IAAJ;;EACA,UAAI8B,GAAG,CAACC,WAAJ,CAAgBpF,cAAhB,CAA+B8E,QAA/B,CAAJ,EAA8C;EAC5C,eAAOK,GAAG,CAACC,WAAJ,CAAgBN,QAAhB,CAAP;EACD;;EACD,UAAI,KAAK9B,wBAAL,EAAJ,EAAqC;EACnCK,QAAAA,IAAI,GAAG,KAAKgC,IAAL,CAAUP,QAAV,CAAP;EACD,OAFD,MAEO;EACLzB,QAAAA,IAAI,GAAG,KAAKiC,UAAL,CAAgBR,QAAhB,CAAP;EACD;;EAED,UAAIzB,IAAI,KAAK,IAAT,IAAiBA,IAAI,KAAK3C,SAA1B,IAAuC,EAAE,OAAO2C,IAAI,CAACkC,IAAZ,KAAqB,UAArB,IAAmClC,IAAI,CAACkC,IAAL,OAAgB,EAArD,CAA3C,EAAqG;EACnG,YAAI9E,KAAJ;;EACA,YAAI;EACFA,UAAAA,KAAK,GAAG0C,IAAI,CAACI,KAAL,CAAWqB,kBAAkB,CAACvB,IAAD,CAA7B,CAAR;EACD,SAFD,CAEE,OAAOmC,GAAP,EAAY;EACZ/E,UAAAA,KAAK,GAAGmE,kBAAkB,CAACvB,IAAD,CAA1B;EACD;;EACD8B,QAAAA,GAAG,CAACC,WAAJ,CAAgBN,QAAhB,IAA4BrE,KAA5B;EACA,eAAOA,KAAP;EACD;EACF;EA7HH;EAAA;EAAA,sCA+H4BiD,IA/H5B,EA+HkCjD,KA/HlC,EA+HyCsD,OA/HzC,EA+HkDJ,MA/HlD,EA+H0D;EACtD;EACA;EACA;EACA;EACA;EAEA,UAAIA,MAAJ,EAAY;EACV,YAAI8B,WAAW,GAAGN,GAAG,CAACM,WAAtB;;EACA,YAAIA,WAAW,IAAI,IAAnB,EAAyB;EAAE;EACzB,cAAMC,WAAW,GAAG/B,MAAM,CAACY,KAAP,CAAa,GAAb,CAApB;EACA,cAAIoB,eAAe,GAAG,EAAtB;;EACA,eAAK,IAAInB,GAAG,GAAGkB,WAAW,CAACxE,MAAZ,GAAqB,CAApC,EAAuCsD,GAAG,IAAI,CAA9C,EAAiDA,GAAG,EAApD,EAAwD;EACtD,gBAAIA,GAAG,KAAK,CAAZ,EAAe;EACbmB,cAAAA,eAAe,GAAGD,WAAW,CAAClB,GAAD,CAAX,GAAmBmB,eAArC;EACD,aAFD,MAEO;EACLA,cAAAA,eAAe,GAAG,MAAMD,WAAW,CAAClB,GAAD,CAAjB,GAAyBmB,eAA3C;EACD,aALqD;;;EAQtD,gBAAI,KAAKL,UAAL,CAAgB5B,IAAhB,CAAJ,EAA2B;EACzB;EACA,kBAAIkC,cAAc,GAAG,UAAUlC,IAAV,GAAiBc,GAAtC;EACA,mBAAKQ,YAAL,CAAkBY,cAAlB,EAAkCnF,KAAlC,EAAyC,EAAzC,EAA6CkF,eAA7C,EAHyB;;EAIzB,kBAAI,CAAC,KAAKL,UAAL,CAAgBM,cAAhB,CAAL,EAAsC;EAAE;EACtC;EACD,eAFD,MAEO;EAAE;EACP,qBAAKC,YAAL,CAAkBD,cAAlB,EAAkCD,eAAlC;EACD;EACF;;EAED,iBAAKX,YAAL,CAAkBtB,IAAlB,EAAwBjD,KAAxB,EAA+BsD,OAA/B,EAAwC4B,eAAxC;EACA,gBAAMG,UAAU,GAAG,KAAKR,UAAL,CAAgB5B,IAAhB,CAAnB,CApBsD;;EAsBtD,gBAAIoC,UAAU,IAAIrF,KAAlB,EAAyB;EACvBgF,cAAAA,WAAW,GAAGE,eAAd;EACAR,cAAAA,GAAG,CAACM,WAAJ,GAAkBA,WAAlB;EACA;EACD;EACF;EACF,SA/BD,MA+BO;EACL,eAAKT,YAAL,CAAkBtB,IAAlB,EAAwBjD,KAAxB,EAA+BsD,OAA/B,EAAwC0B,WAAxC;EACD;EACF,OApCD,MAoCO;EACL,aAAKT,YAAL,CAAkBtB,IAAlB,EAAwBjD,KAAxB,EAA+BsD,OAA/B,EAAwCJ,MAAxC;EACD;EACF;EA7KH;EAAA;EAAA,gCA+KsBmB,QA/KtB,EA+KgC;EAC5B,UAAMiB,OAAO,GAAG,KAAKC,kBAAL,CAAwB1I,WAAxB,CAAhB;;EACA,UAAIyI,OAAO,IAAI,IAAf,EAAqB;EACnB,eAAOA,OAAO,CAACjB,QAAD,CAAd;EACD;EACF;EApLH;EAAA;EAAA,gCAsLsBA,QAtLtB,EAsLgCrE,KAtLhC,EAsLuC;EACnC,UAAI,KAAKuC,wBAAL,EAAJ,EAAqC;EACnC,YAAIiD,WAAW,GAAG,KAAKD,kBAAL,CAAwB1I,WAAxB,CAAlB;;EACA,YAAI2I,WAAW,IAAI,IAAnB,EAAyB;EACvBA,UAAAA,WAAW,GAAG,EAAd;EACD;;EACD,YAAIxF,KAAK,KAAKC,SAAd,EAAyB;EACvB,iBAAOuF,WAAW,CAACnB,QAAD,CAAlB;EACD,SAFD,MAEO;EACLmB,UAAAA,WAAW,CAACnB,QAAD,CAAX,GAAwBrE,KAAxB;EACD;;EACD,aAAKyF,gBAAL,CAAsB5I,WAAtB,EAAmC2I,WAAnC;EACD;EACF;EAnMH;EAAA;EAAA,wCAqM8BnB,QArM9B,EAqMwC;EACpC,UAAMrE,KAAK,GAAG,KAAK0F,WAAL,CAAiBrB,QAAjB,CAAd;EACA,WAAKsB,WAAL,CAAiBtB,QAAjB,EAA2BpE,SAA3B;EACA,aAAOD,KAAP;EACD;EAzMH;EAAA;EAAA,8CA2MoC;EAChC,UAAI4F,CAAC,GAAG,KAAKL,kBAAL,CAAwB/I,YAAxB,CAAR;;EACA,UAAIoJ,CAAC,IAAI,IAAT,EAAe;EACbA,QAAAA,CAAC,GAAG,EAAJ;EACD;;EACDA,MAAAA,CAAC,CAACC,IAAF,GAAS,IAAT;EACA,WAAKJ,gBAAL,CAAsBjJ,YAAtB,EAAoCoJ,CAApC;EACD;EAlNH;EAAA;EAAA,gCAoNsBhD,IApNtB,EAoN4BkD,KApN5B,EAoNmC1F,MApNnC,EAoN2C;EACvC,UAAI2F,SAAS,GAAG,KAAKR,kBAAL,CAAwBvI,YAAxB,CAAhB;;EACA,UAAI,OAAO+I,SAAP,KAAqB,WAAzB,EAAsC;EACpCA,QAAAA,SAAS,GAAG,EAAZ;EACD;;EACDA,MAAAA,SAAS,CAACD,KAAD,CAAT,GAAmB;EAAEE,QAAAA,CAAC,EAAEpD;EAAL,OAAnB;EACA,WAAK6C,gBAAL,CAAsBzI,YAAtB,EAAoC+I,SAApC;EACA3F,MAAAA,MAAM,CAAC6F,KAAP,qBAA0BjJ,YAA1B,sBAAkD8I,KAAlD,iBAA8DlD,IAA9D;EACD;EA5NH;EAAA;EAAA,iCA8NuBsD,MA9NvB,EA8N+B9F,MA9N/B,EA8NuC;EACnC,UAAM+F,SAAS,GAAG,KAAKZ,kBAAL,CAAwBvI,YAAxB,CAAlB;;EACA,UAAI,OAAOmJ,SAAP,KAAqB,WAArB,IAAoCA,SAAS,KAAK,IAAlD,IAA0D,OAAOA,SAAS,CAACD,MAAD,CAAhB,KAA6B,WAA3F,EAAwG;EACtG9F,QAAAA,MAAM,CAAC6F,KAAP,sBAA2BC,MAA3B,qBAA4CC,SAAS,CAACD,MAAD,CAAT,CAAkBF,CAA9D;EACA,eAAOG,SAAS,CAACD,MAAD,CAAhB;EACA,aAAKT,gBAAL,CAAsBzI,YAAtB,EAAoCmJ,SAApC;EACD;EACF;EArOH;;EAAA;EAAA;EAwOO,IAAMzB,GAAG,GAAG;EACjBC,EAAAA,WAAW,EAAE;EACXyB,IAAAA,OAAO,EAAE,IADE;EAEXC,IAAAA,KAAK,EAAE,CAFI;EAGXC,IAAAA,MAAM,EAAE;EAHG,GADI;EAMjBC,EAAAA,SAAS,EAAE,IANM;EAOjBC,EAAAA,gBAAgB,EAAEvG,SAPD;EAQjBwG,EAAAA,eAAe,EAAExG,SARA;EASjByG,EAAAA,YAAY,EAAE,KATG;EAUjBC,EAAAA,cAAc,EAAE,KAVC;EAWjB3B,EAAAA,WAAW,EAAE,IAXI;EAYjB4B,EAAAA,cAAc,EAAE,IAZC;EAajBC,EAAAA,cAAc,EAAE,EAbC;EAcjBC,EAAAA,gBAAgB,EAAE,IAdD;EAejBC,EAAAA,WAAW,EAAE,CAfI;EAeD;EAChBC,EAAAA,QAAQ,EAAE;EACRC,IAAAA,mBAAmB,EAAE;EADb,GAhBO;EAkBd;EACHC,EAAAA,WAAW,EAAE,EAnBI;EAoBjBC,EAAAA,mBAAmB,EAAE,IApBJ;EAsBjB;;EAtBiB,CAAZ;;;;;;MC3OcC;EAGnB,oBAAaC,GAAb,EAAkB;EAAA;;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAChB,SAAKA,GAAL,GAAWA,GAAX;EACA,QAAIC,QAAQ,GAAGhF,gBAAc,CAACiD,kBAAf,CAAkC/H,SAAlC,CAAf;;EACA,QAAI8J,QAAJ,EAAc;EACZ,UAAMC,YAAY,GAAG,EAArB;EACA,gEAAiB,EAAjB;EACAD,MAAAA,QAAQ,GAAGA,QAAQ,CAACE,KAApB;;EACA,WAAK,IAAMC,KAAX,IAAoBH,QAApB,EAA8B;EAC5B,YAAIA,QAAQ,CAAC/H,cAAT,CAAwBkI,KAAxB,CAAJ,EAAoC;EAClCF,UAAAA,YAAY,CAACD,QAAQ,CAACG,KAAD,CAAR,CAAgB,CAAhB,CAAD,CAAZ,GAAmCH,QAAQ,CAACG,KAAD,CAAR,CAAgB,CAAhB,CAAnC;;EACA,kEAAeC,IAAf,CAAoBJ,QAAQ,CAACG,KAAD,CAAR,CAAgB,CAAhB,CAApB;EACD;EACF;;EACD,WAAKD,KAAL,GAAaD,YAAb;EACD,KAXD,MAWO;EACL,WAAKC,KAAL,GAAa,EAAb;EACA,gEAAiB,EAAjB;EACD;EACF;;;;0BAEInH,KAAK;EACR,UAAMsH,IAAI,GAAG,KAAKH,KAAL,CAAWnH,GAAX,CAAb;;EACA,UAAIsH,IAAJ,EAAU;EACR,aAAKH,KAAL,+BAAa,IAAb,wCAAoCnH,GAApC,EAAyC,KAAKmH,KAA9C;EACA,aAAKA,KAAL,CAAWnH,GAAX,IAAkBsH,IAAlB;;EACA,gEAAeD,IAAf,CAAoBrH,GAApB;EACD;;EACD,WAAKuH,aAAL,CAAmB,KAAKJ,KAAxB;EACA,aAAOG,IAAP;EACD;;;0BAEItH,KAAKL,OAAO;EACf,UAAM2H,IAAI,GAAG,KAAKH,KAAL,CAAWnH,GAAX,CAAb;;EACA,UAAMwH,OAAO,+BAAG,IAAH,uBAAb;;EACA,UAAIF,IAAI,IAAI,IAAZ,EAAkB;EAChB,aAAKH,KAAL,+BAAa,IAAb,wCAAoCnH,GAApC,EAAyC,KAAKmH,KAA9C;EACD,OAFD,MAEO,IAAIK,OAAO,CAACpH,MAAR,KAAmB,KAAK4G,GAA5B,EAAiC;EACtC,aAAKG,KAAL,+BAAa,IAAb,wCAAoCK,OAAO,CAAC,CAAD,CAA3C,EAAgD,KAAKL,KAArD;EACD;;EACD,WAAKA,KAAL,CAAWnH,GAAX,IAAkBL,KAAlB;;EACA,UAAI,wDAAe,0DAAiB,CAAhC,MAAuCK,GAA3C,EAAgD;EAC9C,gEAAeqH,IAAf,CAAoBrH,GAApB;EACD;;EACD,WAAKuH,aAAL,CAAmB,KAAKJ,KAAxB;EACD;;;oCAEcA,OAAO;EACpB,UAAMM,UAAU,GAAG,EAAnB;;EACA,UAAMD,OAAO,+BAAG,IAAH,uBAAb;;EACA,WAAK,IAAME,KAAX,IAAoBF,OAApB,EAA6B;EAC3B,YAAIA,OAAO,CAACtI,cAAR,CAAuBwI,KAAvB,CAAJ,EAAmC;EACjC,cAAMC,IAAI,GAAG,EAAb;EACAA,UAAAA,IAAI,CAACN,IAAL,CAAUG,OAAO,CAACE,KAAD,CAAjB;EACAC,UAAAA,IAAI,CAACN,IAAL,CAAUF,KAAK,CAACK,OAAO,CAACE,KAAD,CAAR,CAAf;EACAD,UAAAA,UAAU,CAACJ,IAAX,CAAgBM,IAAhB;EACD;EACF;;EACD1F,MAAAA,gBAAc,CAACmD,gBAAf,CAAgCjI,SAAhC,EAA2C;EAAEgK,QAAAA,KAAK,EAAEM;EAAT,OAA3C;EACD;;;6BAEO9H,OAAO;EACb,UAAIA,KAAK,KAAK,IAAd,EAAoB;EAClB,eAAO,IAAP;EACD;;EACD,UAAM6H,OAAO,+BAAG,IAAH,uBAAb;;EACA,WAAK,IAAME,KAAX,IAAoBF,OAApB,EAA6B;EAC3B,YAAIA,OAAO,CAACtI,cAAR,CAAuBwI,KAAvB,CAAJ,EAAmC;EACjC,cAAI,KAAKP,KAAL,CAAWK,OAAO,CAACE,KAAD,CAAlB,MAA+B/H,KAAnC,EAA0C;EACxC,mBAAO6H,OAAO,CAACE,KAAD,CAAd;EACD;EACF;EACF;;EACD,aAAO,IAAP;EACD;;;yCAEmB;EAClB,UAAME,OAAO,+BAAG,IAAH,uBAAb;;EACA,UAAIA,OAAO,IAAI,IAAX,IAAmBA,OAAO,CAACxH,MAAR,GAAiB,CAAxC,EAA2C;EACzC,eAAOwH,OAAO,CAACA,OAAO,CAACxH,MAAR,GAAiB,CAAlB,CAAd;EACD;;EACD,aAAO,CAAC,CAAR;EACD;;;mCAEa;EACZ,UAAMyH,UAAU,GAAG,wDAAezH,MAAlC;;EACA,UAAIyH,UAAJ,EAAgB;EACd,eAAO,wDAAeA,UAAU,GAAG,CAA5B,CAAP;EACD;EACF;;;;;;uDAEkB7H,KAAKhB,KAAK;EAC3B,MAAMwI,OAAO,GAAGnF,IAAI,CAACI,KAAL,CAAWJ,IAAI,CAACC,SAAL,6BAAe,IAAf,wBAAX,CAAhB;EACA,MAAMwF,QAAQ,GAAG,EAAjB;EACA,MAAIC,aAAJ;;EACA,OAAK,IAAML,KAAX,IAAoBF,OAApB,EAA6B;EAC3B,QAAIA,OAAO,CAACtI,cAAR,CAAuBwI,KAAvB,CAAJ,EAAmC;EACjC,UAAIF,OAAO,CAACE,KAAD,CAAP,KAAmB1H,GAAvB,EAA4B;EAC1B8H,QAAAA,QAAQ,CAACN,OAAO,CAACE,KAAD,CAAR,CAAR,GAA2B1I,GAAG,CAACwI,OAAO,CAACE,KAAD,CAAR,CAA9B;EACD,OAFD,MAEO;EACLK,QAAAA,aAAa,GAAGL,KAAhB;EACD;EACF;EACF;;EACDF,EAAAA,OAAO,CAACQ,MAAR,CAAeD,aAAf,EAA8B,CAA9B;EACA,4DAAiB1F,IAAI,CAACI,KAAL,CAAWJ,IAAI,CAACC,SAAL,CAAekF,OAAf,CAAX,CAAjB;EACA,SAAOM,QAAP;EACD;;;;;;;;;;MC1GkBG;EAMnB,8BAAmD;EAAA,QAApClI,MAAoC,QAApCA,MAAoC;EAAA,QAA5BmI,OAA4B,QAA5BA,OAA4B;EAAA,QAAnBC,MAAmB,QAAnBA,MAAmB;EAAA,QAAXC,OAAW,QAAXA,OAAW;;EAAA;;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EACjD,0DAAerI,MAAf;EACA,4DAAgBmI,OAAhB;EACA,0DAAeC,MAAf;EACA,4DAAgBC,OAAhB;EACD;;;;wBAEEC,QAAQD,SAASE,QAAQC,YAAYC,gBAAgB;EACtD;EACA,UAAI,OAAOD,UAAP,KAAsB,WAA1B,EAAuC;EACrCA,QAAAA,UAAU,GAAG,CAAb;EACD;;EAEDtG,MAAAA,gBAAc,CAACwG,YAAf,CAA4BF,UAA5B,8BAAwC,IAAxC;;EAEA,UAAIA,UAAU,GAAGlE,GAAG,CAACC,WAAJ,CAAgB0B,KAAjC,EAAwC;EACtC;EACA;EACD;;EAED,UAAI,CAACtG,YAAY,CAAC,oDAAaqG,OAAd,CAAb,IAAuCuC,MAAvC,IAAiD,OAAOE,cAAP,KAA0B,SAA/E,EAA0F;EACxF,YAAI,CAAC9I,YAAY,CAAC,oDAAaqG,OAAd,CAAjB,EAAyC;EACvC;EACA9D,UAAAA,gBAAc,CAACyG,mBAAf,CAAmCxL,SAAnC;EACD;;EACD,4DAAa0I,KAAb,sBAAiC,oDAAaG,OAA9C,qBAAgEsC,MAAhE;;EACA,4DAAatC,OAAb,GAAuBsC,MAAvB;;EAEA,YAAIA,MAAM,IAAIpG,gBAAc,CAACC,wBAAf,EAAd,EAAyD;EACvD,cAAImC,GAAG,CAAClH,SAAJ,IAAiB,IAArB,EAA2B;EACzBkH,YAAAA,GAAG,CAAClH,SAAJ,GAAgB,IAAI4J,QAAJ,CAAa3J,cAAb,CAAhB;EACD;;EAED,cAAMuL,SAAS,GAAG1G,gBAAc,CAACiD,kBAAf,CAAkC/I,YAAlC,CAAlB;;EACA,cAAIwM,SAAS,IAAI,IAAb,IAAqBA,SAAS,CAACtN,EAA/B,IAAqCiN,MAAzC,EAAiD;EAC/C,gBAAMM,gBAAgB,GAAGvE,GAAG,CAAClH,SAAJ,CAAcgK,KAAd,CAAoBwB,SAAS,CAACtN,EAA9B,CAAzB;;EACA,gBAAI,CAACuN,gBAAL,EAAuB;EACrB3G,cAAAA,gBAAc,CAACmD,gBAAf,CAAgClH,sBAAhC,EAAwD,IAAxD;EACAmG,cAAAA,GAAG,CAAClH,SAAJ,CAAc0L,GAAd,CAAkBF,SAAS,CAACtN,EAA5B,EAAgCgN,MAAhC;EACD;EACF;;EAEDpG,UAAAA,gBAAc,CAACmD,gBAAf,CAAgClJ,YAAhC,EAA8CmM,MAA9C;EACA,cAAMS,KAAK,GAAGzE,GAAG,CAAClH,SAAJ,CAAc4L,gBAAd,EAAd;;EACA,cAAI9G,gBAAc,CAACiD,kBAAf,CAAkChH,sBAAlC,KAA6D4K,KAAK,KAAK,CAAC,CAA5E,EAA+E;EAC7E,gBAAME,QAAQ,GAAG3E,GAAG,CAAClH,SAAJ,CAAcgK,KAAd,CAAoB2B,KAApB,CAAjB;;EACA,kEAAcG,sBAAd,CAAqCD,QAArC;EACD;EACF;;EAED/G,QAAAA,gBAAc,CAACiH,iBAAf,CAAiChN,YAAjC,EAA+CmM,MAA/C,EAAuD7K,aAAvD,EAAsEuG,MAAM,CAACI,QAAP,CAAgBC,QAAtF;EACAnC,QAAAA,gBAAc,CAACmD,gBAAf,CAAgClJ,YAAhC,EAA8CmM,MAA9C;EACD;;EAED,UAAIC,MAAJ,EAAY;EACVjE,QAAAA,GAAG,CAACgC,YAAJ,GAAmB,KAAnB;;EACA,4DAAaT,KAAb,CAAmB,kBAAnB;EACD;;EAED,UAAI3D,gBAAc,CAACC,wBAAf,EAAJ,EAA+C;EAC7C,8DAAciH,aAAd,CAA4Bf,OAA5B;EACD,OAtDqD;;;EAyDtD,UAAMpJ,GAAG,GAAG,sDAAcoK,sBAAd,EAAZ,CAzDsD;;;EA4DtD,UAAI,OAAOpK,GAAG,CAACqK,CAAX,KAAiB,WAAjB,IAAgCrK,GAAG,CAACqK,CAAJ,IAASjB,OAA7C,EAAsD;EACpDpJ,QAAAA,GAAG,CAACqK,CAAJ,GAAQjB,OAAR;EACApJ,QAAAA,GAAG,CAACsK,CAAJ,GAAQvI,MAAM,EAAd,CAFoD;;EAGpD,8DAAcwI,sBAAd,CAAqCvK,GAArC;EACD;;EAED,UAAIsJ,MAAM,IAAI,CAAC,sDAAckB,gBAA7B,EAA+C;EAC7C,8DAAcC,mBAAd;EACD;;EAEDpF,MAAAA,GAAG,CAACC,WAAJ,CAAgB2B,MAAhB,GAAyBsC,UAAzB;EACD;;;;;;;;MCtFkBmB;EAInB,+BAAyB;EAAA,QAAV3J,MAAU,QAAVA,MAAU;;EAAA;;EAAA;EAAA;EAAA;EAAA;EAAA,SAFzBgG,OAEyB;EACvB,8DAAehG,MAAf;EACA,SAAKgG,OAAL,GAAe,KAAK4D,OAAL,EAAf;EACD;;;;gCAEU;EACT,UAAIC,IAAI,GAAG,IAAX;;EACA,UAAIlK,YAAY,CAAC,KAAKqG,OAAN,CAAhB,EAAgC;EAC9B,eAAO,KAAKA,OAAZ;EACD;;EACD,UAAI9D,gBAAc,CAACC,wBAAf,EAAJ,EAA+C;EAC7C,YAAMvC,KAAK,GAAGsC,gBAAc,CAACsC,IAAf,CAAoBrI,YAApB,CAAd;;EACA,YAAIwD,YAAY,CAACC,KAAD,CAAhB,EAAyB;EACvB,cAAI;EACFiK,YAAAA,IAAI,GAAGvH,IAAI,CAACI,KAAL,CAAWqB,kBAAkB,CAACnE,KAAD,CAA7B,CAAP;EACD,WAFD,CAEE,OAAO+C,CAAP,EAAU;EACV,oEAAakD,KAAb,CAAmB,8DAA8DjG,KAAjF,EADU;EAGV;EACA;EACA;;;EACA,gBAAIA,KAAK,CAACS,MAAN,KAAiB,EAArB,EAAyB;EACvBwJ,cAAAA,IAAI,GAAGjK,KAAP;EACAsC,cAAAA,gBAAc,CAACmD,gBAAf,CAAgClJ,YAAhC,EAA8CyD,KAA9C;EACD,aAHD,MAGO;EACL,sEAAakK,KAAb,CAAmB,kBAAkBlK,KAArC;EACD;EACF,WAfsB;;;EAkBvB,cAAID,YAAY,CAACkK,IAAD,CAAhB,EAAwB;EACtB3H,YAAAA,gBAAc,CAACiH,iBAAf,CAAiChN,YAAjC,EAA+C0N,IAA/C,EAAqDpM,aAArD,EAAoEuG,MAAM,CAACI,QAAP,CAAgBC,QAApF;EACD;EACF;EACF;;EAED,UAAI,CAAC1E,YAAY,CAACkK,IAAD,CAAjB,EAAyB;EACvBA,QAAAA,IAAI,GAAG3H,gBAAc,CAACuC,UAAf,CAA0BtI,YAA1B,CAAP;;EACA,YAAIwD,YAAY,CAACkK,IAAD,CAAZ,KAAuBA,IAAI,CAAC/F,OAAL,CAAa,GAAb,MAAsB,CAAtB,IAA2B+F,IAAI,CAAC/F,OAAL,CAAa,IAAb,MAAuB,CAAlD,IAAuD+F,IAAI,CAAC/F,OAAL,CAAa,GAAb,MAAsB,CAApG,CAAJ,EAA4G;EAC1G+F,UAAAA,IAAI,GAAG,IAAP;EACD;;EACD,YAAIlK,YAAY,CAACkK,IAAD,CAAhB,EAAwB;EACtB3H,UAAAA,gBAAc,CAACmD,gBAAf,CAAgClJ,YAAhC,EAA8C0N,IAA9C;EACD;EACF;;EAED,aAAOA,IAAP;EACD;;;;;;ECvDI,IAAME,kBAAkB,GAAG,iCAA3B;EAGA,IAAMC,sBAAsB,GAAG,kBAA/B;;EACA,IAAMC,WAAW,aAAMD,sBAAN,6BAAjB;EACA,IAAME,WAAW,aAAMF,sBAAN,yCAA2DD,kBAA3D,CAAjB;EACA,IAAMI,YAAY,aAAMH,sBAAN,oDAAsED,kBAAtE,CAAlB;EACA,IAAMK,cAAc,aAAMJ,sBAAN,sDAAwED,kBAAxE,CAApB;EACA,IAAMM,aAAa,aAAML,sBAAN,qDAAuED,kBAAvE,CAAnB;EACA,IAAMO,eAAe,aAAMN,sBAAN,4EAA8FD,kBAA9F,CAArB;EACA,IAAMQ,SAAS,aAAMP,sBAAN,4CAA8DD,kBAA9D,CAAf;EACA,IAAMS,SAAS,aAAMR,sBAAN,uCAAf;EAGA,IAAMS,iBAAiB,aAAMT,sBAAN,0DAAvB;EACA,IAAMU,kBAAkB,aAAMV,sBAAN,iEAAxB;;ECVP,IAAIW,gBAAJ;;EAEO,IAAMC,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACC,QAAD,EAAc;EAChD;EACA,MAAIpM,QAAQ,CAACoM,QAAD,CAAZ,EAAwB;EACtB,SAAK,IAAI5K,GAAT,IAAgB4K,QAAhB,EAA0B;EACxB,UAAIA,QAAQ,CAAC1L,cAAT,CAAwBc,GAAxB,CAAJ,EAAkC;EAChC,YAAIxB,QAAQ,CAACoM,QAAQ,CAAC5K,GAAD,CAAT,CAAR,IAA2B6K,KAAK,CAACC,OAAN,CAAcF,QAAQ,CAAC5K,GAAD,CAAtB,CAA/B,EAA6D;EAC3D,iBAAO,KAAP;EACD,SAFD,MAEO,IAAInB,YAAY,CAAC+L,QAAQ,CAAC5K,GAAD,CAAT,CAAhB,EAAiC;EACtC4K,UAAAA,QAAQ,CAAC5K,GAAD,CAAR,GAAgBmB,iBAAiB,CAACyJ,QAAQ,CAAC5K,GAAD,CAAT,CAAjC;EACD;EACF;EACF;;EACD,WAAO,IAAP;EACD;;EACD,SAAO,KAAP;EACD,CAfM;EAiBA,IAAM+K,4BAA4B,GAAG,SAA/BA,4BAA+B,CAACC,UAAD,EAAajL,MAAb,EAAwB;EAClE,MAAIvB,QAAQ,CAACwM,UAAD,CAAZ,EAA0B;EACxB,SAAK,IAAIhL,GAAT,IAAgBgL,UAAhB,EAA4B;EAC1B,UAAIA,UAAU,CAAC9L,cAAX,CAA0Bc,GAA1B,CAAJ,EAAoC;EAClC,YAAIA,GAAG,KAAK,OAAZ,EAAqB;EACnB,cAAI,CAAC6K,KAAK,CAACC,OAAN,CAAcE,UAAU,CAAChL,GAAD,CAAxB,CAAL,EAAqC;EACnC,mBAAO,KAAP;EACD;;EAED,cAAIgL,UAAU,CAAChL,GAAD,CAAV,CAAgBI,MAAhB,GAAyB,EAA7B,EAAiC;EAC/BL,YAAAA,MAAM,CAACO,WAAP,CAAmB,GAAnB,EAAwB,kDAAkD0K,UAAU,CAAChL,GAAD,CAAV,CAAgBI,MAAlE,GAA2E,qCAAnG;EACD;;EAED,eAAK,IAAI6K,OAAT,IAAoBD,UAAU,CAAChL,GAAD,CAA9B,EAAqC;EACnC,gBAAIgL,UAAU,CAAChL,GAAD,CAAV,CAAgBd,cAAhB,CAA+B+L,OAA/B,CAAJ,EAA6C;EAAE;EAC7C,kBAAI,CAACzM,QAAQ,CAACwM,UAAU,CAAChL,GAAD,CAAV,CAAgBiL,OAAhB,CAAD,CAAT,IAAuC,CAACN,oBAAoB,CAACK,UAAU,CAAChL,GAAD,CAAV,CAAgBiL,OAAhB,CAAD,CAAhE,EAA4F;EAC1F,uBAAO,KAAP;EACD;EACF;EACF;EACF,SAhBD,MAgBO;EACL,cAAIzM,QAAQ,CAACwM,UAAU,CAAChL,GAAD,CAAX,CAAR,IAA6B6K,KAAK,CAACC,OAAN,CAAcE,UAAU,CAAChL,GAAD,CAAxB,CAAjC,EAAiE;EAC/D,mBAAO,KAAP;EACD,WAFD,MAEO,IAAInB,YAAY,CAACmM,UAAU,CAAChL,GAAD,CAAX,CAAhB,EAAmC;EACxCgL,YAAAA,UAAU,CAAChL,GAAD,CAAV,GAAkBmB,iBAAiB,CAAC6J,UAAU,CAAChL,GAAD,CAAX,CAAnC;EACD;EACF;EACF;EACF;;EAED,QAAI3B,QAAQ,CAAC2M,UAAU,CAAChP,UAAD,CAAX,CAAR,IAAoCwD,QAAQ,CAACwL,UAAU,CAAChP,UAAD,CAAX,CAAhD,EAA0E;EACxE;EACA,UAAMkP,SAAS,GAAGF,UAAU,CAAChP,UAAD,CAAV,GAAyB,EAA3C,CAFwE;;EAIxE,UAAI,OAAO0O,gBAAP,KAA4B,WAAhC,EAA6C;EAC3CA,QAAAA,gBAAgB,GAAGzI,gBAAc,CAACiD,kBAAf,CAAkCjJ,qBAAlC,CAAnB;EACD;;EACD,UAAI,OAAOyO,gBAAP,KAA4B,WAA5B,IAA2CA,gBAAgB,CAACjG,IAAjB,OAA4ByG,SAAS,CAACzG,IAAV,EAA3E,EAA6F;EAC3F;EACA1E,QAAAA,MAAM,CAAC8J,KAAP,CAAa,mCAAmCmB,UAAhD;EACA,eAAO,KAAP;EACD;;EACDN,MAAAA,gBAAgB,GAAGQ,SAAnB;EACAjJ,MAAAA,gBAAc,CAACmD,gBAAf,CAAgCnJ,qBAAhC,EAAuDiP,SAAvD;EACD;;EACD,WAAO,IAAP;EACD,GA9CiE;;;EA+ClE,SAAO,KAAP;EACD,CAhDM;;;;;;;;;;;;MClBcC;;;;;EAMnB,8BAA2DC,MAA3D,EAAmE;EAAA;;EAAA,QAApDrL,MAAoD,QAApDA,MAAoD;EAAA,QAA5CmI,OAA4C,QAA5CA,OAA4C;EAAA,QAAnCmD,uBAAmC,QAAnCA,uBAAmC;;EAAA;;EACjE;EADiE;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAEjE,uFAAetL,MAAf;EACA,yFAAkBqL,MAAlB;EACA,yFAAgBlD,OAAhB;EACA,qHAAgCmD,uBAAhC;EALiE;EAMlE;;;;6BAEmB;EAAA,wCAAXC,SAAW;EAAXA,QAAAA,SAAW;EAAA;;EAClB,gFAAwBA,SAAxB;;EACA,aAAO,CAAP;EACD;;;0CAEoB;EACnB,sCAAI,IAAJ,2BAAqB;EACnB,8GAAwB,IAAxB;EACD;;EACD,kEAAkB,IAAlB;EACD;;;iCAoDWC,SAAS;EACnB,UAAI,6BAAC,IAAD,uDAAJ,EAAsC;EACpC;EACD;;EACD,UAAI,OAAOlH,GAAG,CAAC+B,eAAX,KAA+B,WAAnC,EAAgD;EAC9C/B,QAAAA,GAAG,CAAC+B,eAAJ,GAAsBnE,gBAAc,CAACiD,kBAAf,CAAkC3I,SAAlC,CAAtB;EACD;;EACD,UAAI,OAAO8H,GAAG,CAAC+B,eAAX,KAA+B,WAAnC,EAAgD;EAC9C;EACD;;EACD,UAAMoF,MAAM,GAAGnH,GAAG,CAAC+B,eAAJ,CAAoBmF,OAApB,CAAf;EACA,UAAME,OAAO,GAAG,EAAhB;;EACA,UAAI,OAAOD,MAAP,KAAkB,WAAtB,EAAmC;EACjCC,QAAAA,OAAO,CAACC,SAAR,GAAoB,IAAI5M,IAAJ,CAAS0M,MAAM,CAAC,CAAD,CAAN,GAAY,IAArB,CAApB;EACAC,QAAAA,OAAO,CAACE,QAAR,GAAmB,IAAI7M,IAAJ,CAAS0M,MAAM,CAAC,CAAD,CAAN,GAAY,IAArB,CAAnB;EACAC,QAAAA,OAAO,CAACG,KAAR,GAAgBJ,MAAM,CAAC,CAAD,CAAtB;EACA,eAAOC,OAAP;EACD;EACF;;;;mCA9FuCZ;;yDA0BpBS,WAAW;EAC7B,MAAIT,KAAK,CAACC,OAAN,CAAcQ,SAAd,CAAJ,EAA8B;EAC5B,WAAOA,SAAS,CAAClL,MAAV,GAAmB,CAA1B,EAA6B;EAC3B,UAAIyL,SAAS,GAAGP,SAAS,CAACQ,KAAV,EAAhB;;EACA,UAAI,CAACzN,QAAQ,CAACwN,SAAD,CAAb,EAA0B;EACxB,gEAAahC,KAAb,CAAmBI,WAAnB;;EACA;EACD;;EAED,UAAI4B,SAAS,CAACzL,MAAV,GAAmB,IAAvB,EAA6B;EAC3ByL,QAAAA,SAAS,GAAGA,SAAS,CAACxL,SAAV,CAAoB,CAApB,EAAuB,IAAvB,CAAZ;;EACA,gEAAaC,WAAb,CAAyB,GAAzB,EAA8BuL,SAAS,GAAG,0CAA1C;EACD;;EAED,UAAIzN,aAAa,CAAC2N,QAAd,CAAuBF,SAAvB,CAAJ,EAAuC;EACrC,gEAAavL,WAAb,CAAyB,GAAzB,EAA8BuL,SAAS,GAAG,oEAA1C;;EACA;EACD;;EAED,UAAMtJ,IAAI,GAAG,EAAb;EACAA,MAAAA,IAAI,CAACyJ,IAAL,GAAY,OAAZ;EACAzJ,MAAAA,IAAI,CAACgJ,OAAL,GAAepL,QAAQ,CAAC0L,SAAD,EAAYlQ,uBAAZ,CAAvB;;EAEA,UAAI2P,SAAS,CAAClL,MAAV,KAAqB,CAAzB,EAA4B;EAC1B,YAAMwK,QAAQ,GAAGU,SAAS,CAACQ,KAAV,EAAjB;;EACA,YAAI,CAACtN,QAAQ,CAACoM,QAAD,CAAb,EAAyB;EACvB;EACAU,UAAAA,SAAS,CAACW,OAAV,CAAkBrB,QAAlB;EACD,SAHD,MAGO;EACL;EACA,cAAIiB,SAAS,KAAK,SAAlB,EAA6B;EAC3B,gBAAI,CAACd,4BAA4B,CAACH,QAAD,8BAAW,IAAX,wBAAjC,EAA2D;EACzD,sEAAatK,WAAb,CAAyB,GAAzB,EAA8B,4CAA9B;;EACA;EACD;EACF,WALD,MAKO;EACL,gBAAI,CAACqK,oBAAoB,CAACC,QAAD,CAAzB,EAAqC;EACnC,sEAAatK,WAAb,CAAyB,GAAzB,EAA8BuL,SAAS,GAAG,qCAA1C;;EACA;EACD;EACF;;EACDtJ,UAAAA,IAAI,CAAC2J,OAAL,GAAetB,QAAf;EACD;EACF;;EAED,gEAAcuB,YAAd,CAA2B5J,IAA3B;EACD;EACF;EACF;;EChFI,IAAM6J,YAAY,GAAG,SAAfA,YAAe,CAACC,GAAD,EAAS;EACnC,MAAMC,SAAS,GAAG,EAAlB;EACA,MAAM5I,GAAG,GAAG2I,GAAG,CAACxI,OAAJ,CAAY,GAAZ,CAAZ;;EAEA,MAAIH,GAAG,GAAG,CAAV,EAAa;EACX,QAAM6I,GAAG,GAAGF,GAAG,CAAChM,SAAJ,CAAcqD,GAAG,GAAG,CAApB,CAAZ;EACA,QAAI8I,KAAJ;EACA,QAAMC,EAAE,GAAG,KAAX,CAHW;;EAIX,QAAMC,MAAM,GAAG,oBAAf;;EACA,QAAMC,MAAM,GAAG,SAATA,MAAS,CAAUtD,CAAV,EAAa;EAC1B,UAAIuD,WAAW,GAAGvD,CAAC,CAAC5I,OAAF,CAAUgM,EAAV,EAAc,GAAd,CAAlB;;EACA,UAAI;EACFG,QAAAA,WAAW,GAAG9I,kBAAkB,CAAC8I,WAAD,CAAhC;EACD,OAFD,CAEE,OAAOlK,CAAP,EAAU;EAEX;;EACD,aAAOkK,WAAP;EACD,KARD;;EASAJ,IAAAA,KAAK,GAAGE,MAAM,CAAC/K,IAAP,CAAY4K,GAAZ,CAAR;;EACA,WAAOC,KAAP,EAAc;EACZF,MAAAA,SAAS,CAACK,MAAM,CAACH,KAAK,CAAC,CAAD,CAAN,CAAP,CAAT,GAA8BG,MAAM,CAACH,KAAK,CAAC,CAAD,CAAN,CAApC;EACAA,MAAAA,KAAK,GAAGE,MAAM,CAAC/K,IAAP,CAAY4K,GAAZ,CAAR;EACD;EACF;;EACD,SAAOD,SAAP;EACD,CAzBM;EA2BA,IAAMO,SAAS,GAAG,SAAZA,SAAY,CAACR,GAAD,EAAS;EAChC,MAAIA,GAAG,KAAK,EAAZ,EAAgB,OAAO,EAAP;EAChB,MAAIS,CAAC,GAAG/J,QAAQ,CAACgK,aAAT,CAAuB,GAAvB,CAAR;EACAD,EAAAA,CAAC,CAACE,IAAF,GAASX,GAAT;EACA,SAAOS,CAAC,CAAC1I,QAAT;EACD,CALM;EAOA,IAAM6I,QAAQ,GAAG,SAAXA,QAAW,CAACZ,GAAD,EAAM9G,CAAN,EAAS2H,CAAT,EAAe;EACrC,SAAOb,GAAG,GAAG,GAAN,GAAY9G,CAAZ,GAAgB,GAAhB,GAAsBjC,kBAAkB,CAAC4J,CAAD,CAA/C;EACD,CAFM;EAIA,IAAMC,WAAW,GAAG,SAAdA,WAAc,GAAM;EAC/B,SAAOpJ,MAAM,CAACI,QAAP,CAAgBC,QAAvB;EACD,CAFM;;ECtCP;EACO,IAAMgJ,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACC,YAAD,EAAkB;EACrD,MAAIC,OAAO,GAAG,IAAIC,MAAJ,CAAW,CAAC,IAAIF,YAAY,CAACjN,MAAb,GAAsB,CAA3B,IAAgC,CAA3C,CAAd;EACA,MAAIoN,MAAM,GAAG,CAACH,YAAY,GAAGC,OAAhB,EACR7M,OADQ,CACA,KADA,EACO,GADP,EAERA,OAFQ,CAEA,IAFA,EAEM,GAFN,CAAb;EAIA,MAAIgN,OAAO,GAAG1J,MAAM,CAAC2J,IAAP,CAAYF,MAAZ,CAAd;EACA,MAAIG,aAAa,GAAG,EAApB;;EACA,OAAK,IAAIC,CAAC,GAAC,CAAX,EAAcA,CAAC,GAACH,OAAO,CAACrN,MAAxB,EAAgCwN,CAAC,EAAjC,EAAqC;EACnCD,IAAAA,aAAa,CAACtG,IAAd,CAAmBoG,OAAO,CAACI,UAAR,CAAmBD,CAAnB,CAAnB;EACD;;EACD,SAAO,IAAIE,UAAJ,CAAeH,aAAf,CAAP;EACD,CAZM;EAcA,IAAMI,YAAY,GAAG,SAAfA,YAAe,CAACC,UAAD,EAAajO,MAAb,EAAwB;EAClDA,EAAAA,MAAM,IAAI,OAAOA,MAAM,CAAC6F,KAAd,KAAwB,UAAlC,IAAgD7F,MAAM,CAAC6F,KAAP,CAAa,UAAUoI,UAAvB,CAAhD;EACA,SAAOC,gBAAgB,CAACD,UAAD,CAAvB;EACD,CAHM;EAKA,IAAME,QAAQ,GAAG,SAAXA,QAAW,CAACC,YAAD,EAAkB;EACxC,MAAIA,YAAY,IAAI,IAApB,EAA0B,OAAO,EAAP;EAC1B,MAAIP,CAAJ;EAAA,MAAOjO,KAAP;EAAA,MACIyO,kBAAkB,GAAG,EADzB;EAAA,MAEIC,0BAA0B,GAAG,EAFjC;EAAA,MAGIC,SAAS,GAAG,EAHhB;EAAA,MAIIC,UAAU,GAAG,EAJjB;EAAA,MAKIC,SAAS,GAAG,EALhB;EAAA,MAMIC,iBAAiB,GAAG,CANxB;EAAA;EAOIC,EAAAA,gBAAgB,GAAG,CAPvB;EAAA,MAQIC,eAAe,GAAG,CARtB;EAAA,MASIC,mBAAmB,GAAG,EAT1B;EAAA,MAUIC,gBAAgB,GAAG,CAVvB;EAAA,MAWIC,qBAAqB,GAAG,CAX5B;EAAA,MAYIC,EAZJ;EAAA,MAaIC,CAAC,GAAGzQ,MAAM,CAAC0Q,YAbf;;EAeA,OAAKF,EAAE,GAAG,CAAV,EAAaA,EAAE,GAAGZ,YAAY,CAAC/N,MAA/B,EAAuC2O,EAAE,IAAI,CAA7C,EAAgD;EAC9CT,IAAAA,SAAS,GAAGH,YAAY,CAACvK,MAAb,CAAoBmL,EAApB,CAAZ;;EACA,QAAI,CAACtQ,MAAM,CAACC,SAAP,CAAiBQ,cAAjB,CAAgCN,IAAhC,CAAqCwP,kBAArC,EAAyDE,SAAzD,CAAL,EAA0E;EACxEF,MAAAA,kBAAkB,CAACE,SAAD,CAAlB,GAAgCI,gBAAgB,EAAhD;EACAL,MAAAA,0BAA0B,CAACC,SAAD,CAA1B,GAAwC,IAAxC;EACD;;EAEDC,IAAAA,UAAU,GAAGC,SAAS,GAAGF,SAAzB;;EACA,QAAI7P,MAAM,CAACC,SAAP,CAAiBQ,cAAjB,CAAgCN,IAAhC,CAAqCwP,kBAArC,EAAyDG,UAAzD,CAAJ,EAA0E;EACxEC,MAAAA,SAAS,GAAGD,UAAZ;EACD,KAFD,MAEO;EACL,UAAI9P,MAAM,CAACC,SAAP,CAAiBQ,cAAjB,CAAgCN,IAAhC,CAAqCyP,0BAArC,EAAiEG,SAAjE,CAAJ,EAAiF;EAC/E,YAAIA,SAAS,CAACX,UAAV,CAAqB,CAArB,IAA0B,GAA9B,EAAmC;EACjC,eAAKD,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGe,eAAhB,EAAiCf,CAAC,EAAlC,EAAsC;EACpCiB,YAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAAxC;;EACA,gBAAIC,qBAAqB,IAAI,EAA7B,EAAiC;EAC/BA,cAAAA,qBAAqB,GAAG,CAAxB;EACAF,cAAAA,mBAAmB,IAAII,CAAC,CAACH,gBAAD,CAAxB;EACAA,cAAAA,gBAAgB,GAAG,CAAnB;EACD,aAJD,MAIO;EACLC,cAAAA,qBAAqB;EACtB;EACF;;EACDnP,UAAAA,KAAK,GAAG6O,SAAS,CAACX,UAAV,CAAqB,CAArB,CAAR;;EACA,eAAKD,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,CAAhB,EAAmBA,CAAC,EAApB,EAAwB;EACtBiB,YAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAArB,GAA2BlP,KAAK,GAAG,CAAtD;;EACA,gBAAImP,qBAAqB,IAAI,EAA7B,EAAiC;EAC/BA,cAAAA,qBAAqB,GAAG,CAAxB;EACAF,cAAAA,mBAAmB,IAAII,CAAC,CAACH,gBAAD,CAAxB;EACAA,cAAAA,gBAAgB,GAAG,CAAnB;EACD,aAJD,MAIO;EACLC,cAAAA,qBAAqB;EACtB;;EACDnP,YAAAA,KAAK,GAAGA,KAAK,IAAI,CAAjB;EACD;EACF,SAvBD,MAuBO;EACLA,UAAAA,KAAK,GAAG,CAAR;;EACA,eAAKiO,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGe,eAAhB,EAAiCf,CAAC,EAAlC,EAAsC;EACpCiB,YAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAArB,GAA0BlP,KAA7C;;EACA,gBAAImP,qBAAqB,IAAI,EAA7B,EAAiC;EAC/BA,cAAAA,qBAAqB,GAAG,CAAxB;EACAF,cAAAA,mBAAmB,IAAII,CAAC,CAACH,gBAAD,CAAxB;EACAA,cAAAA,gBAAgB,GAAG,CAAnB;EACD,aAJD,MAIO;EACLC,cAAAA,qBAAqB;EACtB;;EACDnP,YAAAA,KAAK,GAAG,CAAR;EACD;;EACDA,UAAAA,KAAK,GAAG6O,SAAS,CAACX,UAAV,CAAqB,CAArB,CAAR;;EACA,eAAKD,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,EAAhB,EAAoBA,CAAC,EAArB,EAAyB;EACvBiB,YAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAArB,GAA2BlP,KAAK,GAAG,CAAtD;;EACA,gBAAImP,qBAAqB,IAAI,EAA7B,EAAiC;EAC/BA,cAAAA,qBAAqB,GAAG,CAAxB;EACAF,cAAAA,mBAAmB,IAAII,CAAC,CAACH,gBAAD,CAAxB;EACAA,cAAAA,gBAAgB,GAAG,CAAnB;EACD,aAJD,MAIO;EACLC,cAAAA,qBAAqB;EACtB;;EACDnP,YAAAA,KAAK,GAAGA,KAAK,IAAI,CAAjB;EACD;EACF;;EACD8O,QAAAA,iBAAiB;;EACjB,YAAIA,iBAAiB,IAAI,CAAzB,EAA4B;EAC1BA,UAAAA,iBAAiB,GAAGzN,IAAI,CAACkO,GAAL,CAAS,CAAT,EAAYP,eAAZ,CAApB;EACAA,UAAAA,eAAe;EAChB;;EACD,eAAON,0BAA0B,CAACG,SAAD,CAAjC;EACD,OAxDD,MAwDO;EACL7O,QAAAA,KAAK,GAAGyO,kBAAkB,CAACI,SAAD,CAA1B;;EACA,aAAKZ,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGe,eAAhB,EAAiCf,CAAC,EAAlC,EAAsC;EACpCiB,UAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAArB,GAA2BlP,KAAK,GAAG,CAAtD;;EACA,cAAImP,qBAAqB,IAAI,EAA7B,EAAiC;EAC/BA,YAAAA,qBAAqB,GAAG,CAAxB;EACAF,YAAAA,mBAAmB,IAAII,CAAC,CAACH,gBAAD,CAAxB;EACAA,YAAAA,gBAAgB,GAAG,CAAnB;EACD,WAJD,MAIO;EACLC,YAAAA,qBAAqB;EACtB;;EACDnP,UAAAA,KAAK,GAAGA,KAAK,IAAI,CAAjB;EACD;EAGF;;EACD8O,MAAAA,iBAAiB;;EACjB,UAAIA,iBAAiB,IAAI,CAAzB,EAA4B;EAC1BA,QAAAA,iBAAiB,GAAGzN,IAAI,CAACkO,GAAL,CAAS,CAAT,EAAYP,eAAZ,CAApB;EACAA,QAAAA,eAAe;EAChB,OA7EI;;;EA+ELP,MAAAA,kBAAkB,CAACG,UAAD,CAAlB,GAAiCG,gBAAgB,EAAjD;EACAF,MAAAA,SAAS,GAAGjQ,MAAM,CAAC+P,SAAD,CAAlB;EACD;EACF,GA7GuC;;;EAgHxC,MAAIE,SAAS,KAAK,EAAlB,EAAsB;EACpB,QAAI/P,MAAM,CAACC,SAAP,CAAiBQ,cAAjB,CAAgCN,IAAhC,CAAqCyP,0BAArC,EAAiEG,SAAjE,CAAJ,EAAiF;EAC/E,UAAIA,SAAS,CAACX,UAAV,CAAqB,CAArB,IAA0B,GAA9B,EAAmC;EACjC,aAAKD,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGe,eAAhB,EAAiCf,CAAC,EAAlC,EAAsC;EACpCiB,UAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAAxC;;EACA,cAAIC,qBAAqB,IAAI,EAA7B,EAAiC;EAC/BA,YAAAA,qBAAqB,GAAG,CAAxB;EACAF,YAAAA,mBAAmB,IAAII,CAAC,CAACH,gBAAD,CAAxB;EACAA,YAAAA,gBAAgB,GAAG,CAAnB;EACD,WAJD,MAIO;EACLC,YAAAA,qBAAqB;EACtB;EACF;;EACDnP,QAAAA,KAAK,GAAG6O,SAAS,CAACX,UAAV,CAAqB,CAArB,CAAR;;EACA,aAAKD,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,CAAhB,EAAmBA,CAAC,EAApB,EAAwB;EACtBiB,UAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAArB,GAA2BlP,KAAK,GAAG,CAAtD;;EACA,cAAImP,qBAAqB,IAAI,EAA7B,EAAiC;EAC/BA,YAAAA,qBAAqB,GAAG,CAAxB;EACAF,YAAAA,mBAAmB,IAAII,CAAC,CAACH,gBAAD,CAAxB;EACAA,YAAAA,gBAAgB,GAAG,CAAnB;EACD,WAJD,MAIO;EACLC,YAAAA,qBAAqB;EACtB;;EACDnP,UAAAA,KAAK,GAAGA,KAAK,IAAI,CAAjB;EACD;EACF,OAvBD,MAuBO;EACLA,QAAAA,KAAK,GAAG,CAAR;;EACA,aAAKiO,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGe,eAAhB,EAAiCf,CAAC,EAAlC,EAAsC;EACpCiB,UAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAArB,GAA0BlP,KAA7C;;EACA,cAAImP,qBAAqB,IAAI,EAA7B,EAAiC;EAC/BA,YAAAA,qBAAqB,GAAG,CAAxB;EACAF,YAAAA,mBAAmB,IAAII,CAAC,CAACH,gBAAD,CAAxB;EACAA,YAAAA,gBAAgB,GAAG,CAAnB;EACD,WAJD,MAIO;EACLC,YAAAA,qBAAqB;EACtB;;EACDnP,UAAAA,KAAK,GAAG,CAAR;EACD;;EACDA,QAAAA,KAAK,GAAG6O,SAAS,CAACX,UAAV,CAAqB,CAArB,CAAR;;EACA,aAAKD,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,EAAhB,EAAoBA,CAAC,EAArB,EAAyB;EACvBiB,UAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAArB,GAA2BlP,KAAK,GAAG,CAAtD;;EACA,cAAImP,qBAAqB,IAAI,EAA7B,EAAiC;EAC/BA,YAAAA,qBAAqB,GAAG,CAAxB;EACAF,YAAAA,mBAAmB,IAAII,CAAC,CAACH,gBAAD,CAAxB;EACAA,YAAAA,gBAAgB,GAAG,CAAnB;EACD,WAJD,MAIO;EACLC,YAAAA,qBAAqB;EACtB;;EACDnP,UAAAA,KAAK,GAAGA,KAAK,IAAI,CAAjB;EACD;EACF;;EACD8O,MAAAA,iBAAiB;;EACjB,UAAIA,iBAAiB,IAAI,CAAzB,EAA4B;EAC1BA,QAAAA,iBAAiB,GAAGzN,IAAI,CAACkO,GAAL,CAAS,CAAT,EAAYP,eAAZ,CAApB;EACAA,QAAAA,eAAe;EAChB;;EACD,aAAON,0BAA0B,CAACG,SAAD,CAAjC;EACD,KAxDD,MAwDO;EACL7O,MAAAA,KAAK,GAAGyO,kBAAkB,CAACI,SAAD,CAA1B;;EACA,WAAKZ,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGe,eAAhB,EAAiCf,CAAC,EAAlC,EAAsC;EACpCiB,QAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAArB,GAA2BlP,KAAK,GAAG,CAAtD;;EACA,YAAImP,qBAAqB,IAAI,EAA7B,EAAiC;EAC/BA,UAAAA,qBAAqB,GAAG,CAAxB;EACAF,UAAAA,mBAAmB,IAAII,CAAC,CAACH,gBAAD,CAAxB;EACAA,UAAAA,gBAAgB,GAAG,CAAnB;EACD,SAJD,MAIO;EACLC,UAAAA,qBAAqB;EACtB;;EACDnP,QAAAA,KAAK,GAAGA,KAAK,IAAI,CAAjB;EACD;EAGF;;EACD8O,IAAAA,iBAAiB;;EACjB,QAAIA,iBAAiB,IAAI,CAAzB,EAA4B;EAC1BA,MAAAA,iBAAiB,GAAGzN,IAAI,CAACkO,GAAL,CAAS,CAAT,EAAYP,eAAZ,CAApB;EACAA,MAAAA,eAAe;EAChB;EACF,GA9LuC;;;EAiMxChP,EAAAA,KAAK,GAAG,CAAR;;EACA,OAAKiO,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGe,eAAhB,EAAiCf,CAAC,EAAlC,EAAsC;EACpCiB,IAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAArB,GAA2BlP,KAAK,GAAG,CAAtD;;EACA,QAAImP,qBAAqB,IAAI,EAA7B,EAAiC;EAC/BA,MAAAA,qBAAqB,GAAG,CAAxB;EACAF,MAAAA,mBAAmB,IAAII,CAAC,CAACH,gBAAD,CAAxB;EACAA,MAAAA,gBAAgB,GAAG,CAAnB;EACD,KAJD,MAIO;EACLC,MAAAA,qBAAqB;EACtB;;EACDnP,IAAAA,KAAK,GAAGA,KAAK,IAAI,CAAjB;EACD,GA5MuC;;;EA+MxC,SAAO,IAAP,EAAa;EACXkP,IAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAAxC;;EACA,QAAIC,qBAAqB,IAAI,EAA7B,EAAiC;EAC/BF,MAAAA,mBAAmB,IAAII,CAAC,CAACH,gBAAD,CAAxB;EACA;EACD,KAHD,MAGOC,qBAAqB;EAC7B;;EACD,SAAOF,mBAAP;EACD,CAvNM;EAyNA,IAAMO,SAAS,GAAG,SAAZA,SAAY,GAAM;EAC7B,MAAInP,GAAG,GAAG,EAAV;EACA,MAAI4N,CAAC,GAAG,CAAR;;EAEA,OAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,IAAI,EAAjB,EAAqBA,CAAC,EAAtB,EAA0B;EACxB5N,IAAAA,GAAG,GAAGA,GAAG,GAAGzB,MAAM,CAAC0Q,YAAP,CAAoBrB,CAAC,GAAG,EAAxB,CAAZ;EACD;;EAED,OAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,IAAI,EAAjB,EAAqBA,CAAC,EAAtB,EAA0B;EACxB5N,IAAAA,GAAG,GAAGA,GAAG,GAAGzB,MAAM,CAAC0Q,YAAP,CAAoBrB,CAAC,GAAG,EAAxB,CAAZ;EACD;;EAED,OAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,EAAhB,EAAoBA,CAAC,EAArB,EAAyB;EACvB5N,IAAAA,GAAG,GAAGA,GAAG,GAAG4N,CAAZ;EACD;;EAED,SAAO5N,GAAG,GAAG,KAAb;EACD,CAjBM;;EAmBP,IAAMoP,OAAO,GAAGD,SAAS,EAAzB;EAgDO,IAAMlB,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAC3P,KAAD,EAAW;EACzC,MAAIA,KAAK,IAAI,IAAb,EAAmB,OAAO,EAAP;EACnB,MAAI+Q,MAAM,GAAG,EAAb;EACA,MAAIC,IAAJ,EAAUC,IAAV,EAAgBC,IAAhB,EAAsBC,IAAtB,EAA4BC,IAA5B,EAAkCC,IAAlC,EAAwCC,IAAxC;EACA,MAAIhC,CAAC,GAAG,CAAR;EAEAtP,EAAAA,KAAK,GAAG4P,QAAQ,CAAC5P,KAAD,CAAhB;;EAEA,SAAOsP,CAAC,GAAGtP,KAAK,CAAC8B,MAAN,GAAe,CAA1B,EAA6B;EAE3B,QAAIwN,CAAC,GAAG,CAAJ,IAAS,CAAb,EAAgB;EACd0B,MAAAA,IAAI,GAAGhR,KAAK,CAACuP,UAAN,CAAiBD,CAAC,GAAG,CAArB,KAA2B,CAAlC;EACA2B,MAAAA,IAAI,GAAGjR,KAAK,CAACuP,UAAN,CAAiBD,CAAC,GAAG,CAArB,IAA0B,GAAjC;EACA,UAAIA,CAAC,GAAG,CAAJ,GAAQ,CAAR,GAAYtP,KAAK,CAAC8B,MAAtB,EACEoP,IAAI,GAAGlR,KAAK,CAACuP,UAAN,CAAiBD,CAAC,GAAG,CAAJ,GAAQ,CAAzB,KAA+B,CAAtC,CADF,KAGE4B,IAAI,GAAGK,GAAP;EACH,KAPD,MAOO;EACLP,MAAAA,IAAI,GAAGhR,KAAK,CAACuP,UAAN,CAAiB,CAACD,CAAC,GAAG,CAAL,IAAU,CAA3B,IAAgC,GAAvC;;EACA,UAAI,CAACA,CAAC,GAAG,CAAL,IAAU,CAAV,GAActP,KAAK,CAAC8B,MAAxB,EAAgC;EAC9BmP,QAAAA,IAAI,GAAGjR,KAAK,CAACuP,UAAN,CAAiB,CAACD,CAAC,GAAG,CAAL,IAAU,CAA3B,KAAiC,CAAxC;EACA4B,QAAAA,IAAI,GAAGlR,KAAK,CAACuP,UAAN,CAAiB,CAACD,CAAC,GAAG,CAAL,IAAU,CAA3B,IAAgC,GAAvC;EACD,OAHD,MAIE2B,IAAI,GAAGC,IAAI,GAAGK,GAAd;EACH;;EACDjC,IAAAA,CAAC,IAAI,CAAL;EAEA6B,IAAAA,IAAI,GAAGH,IAAI,IAAI,CAAf;EACAI,IAAAA,IAAI,GAAI,CAACJ,IAAI,GAAG,CAAR,KAAc,CAAf,GAAqBC,IAAI,IAAI,CAApC;EACAI,IAAAA,IAAI,GAAI,CAACJ,IAAI,GAAG,EAAR,KAAe,CAAhB,GAAsBC,IAAI,IAAI,CAArC;EACAI,IAAAA,IAAI,GAAGJ,IAAI,GAAG,EAAd;;EAEA,QAAInQ,KAAK,CAACkQ,IAAD,CAAT,EAAiB;EACfI,MAAAA,IAAI,GAAGC,IAAI,GAAG,EAAd;EACD,KAFD,MAEO,IAAIvQ,KAAK,CAACmQ,IAAD,CAAT,EAAiB;EACtBI,MAAAA,IAAI,GAAG,EAAP;EACD;;EAEDP,IAAAA,MAAM,GAAGA,MAAM,GACbD,OAAO,CAACxL,MAAR,CAAe6L,IAAf,CADO,GACgBL,OAAO,CAACxL,MAAR,CAAe8L,IAAf,CADhB,GAEPN,OAAO,CAACxL,MAAR,CAAe+L,IAAf,CAFO,GAEgBP,OAAO,CAACxL,MAAR,CAAegM,IAAf,CAFzB;EAID;;EAED,SAAOP,MAAP;EACD,CA7CM;;;;;;;;;;MC1ScS;;;;;;;kCAwDCzD,KAAK0D,SAASC,aAAa;EAC7C,oEAAkB3D,GAAlB,EAAuB,CAAvB,EAA0B0D,OAA1B,EAAmCC,WAAnC;EACD;;;;;;qDAkBwB3D,KAAK4D,YAAY;EACxC,MAAIA,UAAU,KAAK,IAAnB,EAAyB;EACvB,QAAMC,IAAI,GAAG,EAAb;EACAA,IAAAA,IAAI,CAACD,UAAL,GAAkB,IAAlB;EACA,WAAOhD,QAAQ,CAACZ,GAAD,EAAM,KAAN,EAAa0B,YAAY,CAAC1L,IAAI,CAACC,SAAL,CAAe4N,IAAf,CAAD,EAAuB,KAAKnQ,MAA5B,CAAzB,CAAf;EACD;;EACD,MAAIkC,gBAAc,CAACC,wBAAf,MAA6C,OAAOC,YAAY,CAACK,OAAb,CAAqB9F,UAArB,CAAP,KAA4C,WAAzF,IAAwGyF,YAAY,CAACK,OAAb,CAAqB9F,UAArB,MAAqC,IAAjJ,EAAuJ;EACrJ,WAAOuQ,QAAQ,CAACZ,GAAD,EAAM,KAAN,EAAa0B,YAAY,CAAC1L,IAAI,CAACC,SAAL,CAAeL,gBAAc,CAACiD,kBAAf,CAAkCxI,UAAlC,CAAf,CAAD,EAAgE,KAAKqD,MAArE,CAAzB,CAAf;EACD;;EACD,SAAOsM,GAAP;EACD;;yDAlB0B8D,aAAa;EACtC,MAAIC,KAAK,GAAGnO,gBAAc,CAACoD,WAAf,CAA2BnI,SAA3B,CAAZ;;EACA,MAAI,OAAOkT,KAAP,KAAiB,SAArB,EAAgC;EAC9BA,IAAAA,KAAK,GAAG,KAAR;EACD;;EACD,SAAOnD,QAAQ,CAACkD,WAAD,EAAcjT,SAAd,EAAyBkT,KAAK,GAAG,MAAH,GAAY,OAA1C,CAAf;EACD;;qEAdiC;EAChC,MAAI/L,GAAG,CAACiC,cAAJ,IAAsB,CAAC5G,YAAY,CAAC,KAAKyI,MAAL,CAAYpC,OAAb,CAAnC,IAA4D,CAAC1H,QAAQ,CAAC,KAAK8J,MAAL,CAAYpC,OAAb,CAAzE,EAAgG;EAC9F1B,IAAAA,GAAG,CAACiC,cAAJ,GAAqB,KAArB;EACA,WAAO,KAAP;EACD;;EACD,SAAO,KAAK6B,MAAL,CAAYpC,OAAZ,CAAoBsK,KAApB,CAA0B,CAAC,CAA3B,MAAkCpT,sBAAzC;EACD;;6CA9DoBoP,KAAKiE,OAAOP,SAASC,aAAa;EAAA;EAAA;EAAA;;EACrD,kCAAI,IAAJ,uDAAoC;EAClC,SAAKjQ,MAAL,CAAY6F,KAAZ,CAAkB,uCAAuC,KAAKuC,MAAL,CAAYpC,OAArE;EACA;EACD;;EAED,MAAI,CAACrG,YAAY,CAAC,KAAKyI,MAAL,CAAYpC,OAAb,CAAb,IACH1B,GAAG,CAACC,WAAJ,CAAgB2B,MAAhB,GAAyB5B,GAAG,CAACC,WAAJ,CAAgB0B,KAAhB,GAAwB,CAD9C,IAEJsK,KAAK,GAAG7S,SAFR,EAEmB;EACjB8S,IAAAA,UAAU,CAAC,YAAM;EACf,MAAA,KAAI,CAACxQ,MAAL,CAAY6F,KAAZ,0CAAoDyG,GAApD,sBAAmEiE,KAAnE;;EACA,kCAAA,KAAI,eAAJ,eAAkBjE,GAAlB,EAAuBiE,KAAK,GAAG,CAA/B,EAAkCP,OAAlC,EAA2CC,WAA3C;EACD,KAHS,EAGP,EAHO,CAAV;EAIA;EACD;;EAED,MAAI,CAACA,WAAL,EAAkB;EAChB,QAAItQ,YAAY,CAAC,KAAKyI,MAAL,CAAYpC,OAAb,CAAhB,EAAuC;EACrC;EACAsG,MAAAA,GAAG,GAAGY,QAAQ,CAACZ,GAAD,EAAM,IAAN,EAAY,KAAKlE,MAAL,CAAYpC,OAAxB,CAAd;EACD;;EACDsG,IAAAA,GAAG,+BAAG,IAAH,sCAAyBA,GAAzB,EAA8B0D,OAA9B,CAAH;EACD;;EAED1D,EAAAA,GAAG,+BAAG,IAAH,0CAA2BA,GAA3B,CAAH;EACAA,EAAAA,GAAG,GAAGY,QAAQ,CAACZ,GAAD,EAAM,GAAN,EAAW,IAAIvN,IAAJ,GAAWoC,OAAX,EAAX,CAAd,CAzBqD;EA0BrD;;EACA,MAAI,sBAAA6C,MAAM,CAACyM,SAAP,wEAAkBtR,cAAlB,CAAiC,QAAjC,4BAA8C6E,MAAM,CAAC0M,SAArD,sDAA8C,kBAAkBvR,cAAlB,CAAiC,QAAjC,CAA9C,CAAJ,EAA8F;EAC5F;EACA,QAAMwR,MAAM,GAAG3M,MAAM,CAACyM,SAAP,CAAiBE,MAAjB,IAA2B3M,MAAM,CAAC0M,SAAP,CAAiBC,MAA3D;EACArE,IAAAA,GAAG,GAAGY,QAAQ,CAACZ,GAAD,EAAM,OAAN,EAAeqE,MAAf,CAAd;EACD;;EACD,MAAIrE,GAAG,CAACxI,OAAJ,CAAY,mBAAZ,MAAqC,CAAC,CAA1C,EAA6C;EAC3CwI,IAAAA,GAAG,GAAGA,GAAG,CAAC5L,OAAJ,CAAY,mBAAZ,EAAiC,QAAjC,CAAN;EACD,GAlCoD;;;EAqCrD,MAAIkQ,WAAW,GAAG5N,QAAQ,CAAC6N,sBAAT,CAAgC,UAAhC,CAAlB;;EACA,SAAOD,WAAW,CAAC,CAAD,CAAlB,EAAuB;EACrBA,IAAAA,WAAW,CAAC,CAAD,CAAX,CAAeE,UAAf,CAA0BC,WAA1B,CAAsCH,WAAW,CAAC,CAAD,CAAjD;EACD;;EACD,MAAMtH,CAAC,GAAGtG,QAAQ,CAACgK,aAAT,CAAuB,QAAvB,CAAV;EACA1D,EAAAA,CAAC,CAAC0H,YAAF,CAAe,MAAf,EAAuB,iBAAvB;EACA1H,EAAAA,CAAC,CAAC0H,YAAF,CAAe,KAAf,EAAsB1E,GAAtB;EACAhD,EAAAA,CAAC,CAAC0H,YAAF,CAAe,OAAf,EAAwB,UAAxB;EACA1H,EAAAA,CAAC,CAAC0H,YAAF,CAAe,KAAf,EAAsB,UAAtB;EACA1H,EAAAA,CAAC,CAAC2H,KAAF,GAAU,IAAV;EAEAjO,EAAAA,QAAQ,CAACkO,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,EAAyCC,WAAzC,CAAqD7H,CAArD;EACA,OAAKtJ,MAAL,CAAY6F,KAAZ,CAAkB,qBAAqByG,GAAvC;EACD;;EAtDkByD,kBACZ/P;EADY+P,kBAEZ3H;wBAFY2H;;;wBAAAA;;;wBAAAA;;;wBAAAA;;;;ECNrB;EA0CO,IAAMqB,iBAAiB,GAAG,SAApBA,iBAAoB,GAAM;EACrC,MAAIC,OAAO,GAAG,EAAd;;EACA,MAAInP,gBAAc,CAACC,wBAAf,EAAJ,EAA+C;EAC7CkP,IAAAA,OAAO,GAAGnP,gBAAc,CAACsC,IAAf,CAAoBnI,gBAApB,CAAV;;EACA,QAAIgV,OAAO,IAAI,IAAf,EAAqB;EACnBA,MAAAA,OAAO,GAAG/O,IAAI,CAACI,KAAL,CAAWqB,kBAAkB,CAACsN,OAAD,CAAlB,CAA4B3Q,OAA5B,CAAoC3E,gBAApC,EAAsD,IAAtD,CAAX,CAAV;EACD,KAFD,MAEO;EACLsV,MAAAA,OAAO,GAAG,EAAV;EACD;EACF;;EACD,SAAOA,OAAP;EACD,CAXM;EAaA,IAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,CAACC,WAAD,EAAiB;EACjD,MAAIrP,gBAAc,CAACC,wBAAf,EAAJ,EAA+C;EAC7C,QAAMkP,OAAO,GAAG/O,IAAI,CAACC,SAAL,CAAegP,WAAf,CAAhB;EACArP,IAAAA,gBAAc,CAACgC,IAAf,CAAoB7H,gBAApB,EAAsCkH,kBAAkB,CAAC8N,OAAD,CAAxD;EACD;EACF,CALM;EAOA,IAAMG,mBAAmB,GAAG,SAAtBA,mBAAsB,GAAM;EACvC,MAAIH,OAAO,GAAG,EAAd;;EACA,MAAInP,gBAAc,CAACC,wBAAf,EAAJ,EAA+C;EAC7CkP,IAAAA,OAAO,GAAGD,iBAAiB,EAA3B;EACA,QAAIK,SAAS,GAAG,EAAhB;EACA,QAAMC,SAAS,GAAGL,OAAO,CAAC/I,MAA1B;EACA,QAAM1H,KAAK,GAAGD,QAAQ,EAAtB;EACA,QAAMgR,QAAQ,GAAGN,OAAO,CAACzQ,KAAD,CAAxB;;EACA,QAAI,OAAO8Q,SAAP,KAAqB,WAAzB,EAAsC;EACpC,UAAME,eAAe,GAAGlT,MAAM,CAACmT,IAAP,CAAYH,SAAZ,CAAxB;;EACA,WAAK,IAAM/J,KAAX,IAAoBiK,eAApB,EAAqC;EACnC,YAAIA,eAAe,CAACzS,cAAhB,CAA+BwI,KAA/B,CAAJ,EAA2C;EACzC,cAAImK,MAAM,GAAG,CAAb;EACA,cAAIC,MAAM,GAAG,CAAb;EACA,cAAMC,UAAU,GAAGJ,eAAe,CAACjK,KAAD,CAAlC;;EACA,cAAIqK,UAAU,KAAK,IAAnB,EAAyB;EACvB;EACD;;EACD,cAAI,OAAOL,QAAP,KAAoB,WAApB,IAAmC,OAAOA,QAAQ,CAACK,UAAD,CAAf,KAAgC,WAAvE,EAAoF;EAClFF,YAAAA,MAAM,GAAGH,QAAQ,CAACK,UAAD,CAAjB;EACD;;EACD,cAAI,OAAON,SAAP,KAAqB,WAArB,IAAoC,OAAOA,SAAS,CAACM,UAAD,CAAhB,KAAiC,WAAzE,EAAsF;EACpFD,YAAAA,MAAM,GAAGL,SAAS,CAACM,UAAD,CAAlB;EACD;;EACD,cAAMC,OAAO,GAAG,CAACD,UAAD,EAAaF,MAAb,EAAqBC,MAArB,CAAhB;EACAN,UAAAA,SAAS,CAACnK,IAAV,CAAe2K,OAAf;EACD;EACF;EACF;;EACD,QAAIC,MAAM,GAAG,CAAb;;EACA,QAAI,OAAOP,QAAP,KAAoB,WAApB,IAAmC,OAAOA,QAAQ,CAACQ,EAAhB,KAAuB,WAA9D,EAA2E;EACzED,MAAAA,MAAM,GAAGP,QAAQ,CAACQ,EAAlB;EACD;;EACDV,IAAAA,SAAS,GAAG;EACVW,MAAAA,GAAG,EAAEF,MADK;EAEVG,MAAAA,GAAG,EAAEZ;EAFK,KAAZ;EAIA,WAAOA,SAAP;EACD;EACF,CAvCM;EAyCA,IAAMa,cAAc,GAAG,SAAjBA,cAAiB,CAACC,UAAD,QAA4B;EAAA,MAAbvS,MAAa,QAAbA,MAAa;EACxD,MAAIwS,KAAK,GAAG,KAAZ;;EACA,MAAI/T,QAAQ,CAAC8T,UAAD,CAAZ,EAA0B;EACxB,SAAK,IAAME,UAAX,IAAyBF,UAAzB,EAAqC;EACnC,UAAIA,UAAU,CAACpT,cAAX,CAA0BsT,UAA1B,CAAJ,EAA2C;EACzCD,QAAAA,KAAK,GAAG,IAAR;EACA,YAAIE,UAAU,GAAGH,UAAU,CAACE,UAAD,CAA3B;;EAEA,YAAIC,UAAU,IAAI,IAAlB,EAAwB;EACtB,iBAAOH,UAAU,CAACE,UAAD,CAAjB;EACA;EACD;;EACD,YAAIA,UAAU,KAAK,QAAf,IAA2B,CAACC,UAAU,CAACjG,KAAX,CAAiB,SAAjB,CAAhC,EAA6D;EAC3D+F,UAAAA,KAAK,GAAG,KAAR;EACAxS,UAAAA,MAAM,CAAC8J,KAAP,CAAaK,YAAb;EACD;;EAED,YAAIsI,UAAU,KAAK,UAAf,IAA6B,CAACC,UAAU,CAACjG,KAAX,CAAiB,SAAjB,CAAlC,EAA+D;EAC7D+F,UAAAA,KAAK,GAAG,KAAR;EACAxS,UAAAA,MAAM,CAAC8J,KAAP,CAAaM,cAAb;EACD;;EAED,YAAIqI,UAAU,KAAK,SAAf,IAA4B,CAACC,UAAU,CAACjG,KAAX,CAAiB,SAAjB,CAAjC,EAA8D;EAC5D+F,UAAAA,KAAK,GAAG,KAAR;EACAxS,UAAAA,MAAM,CAAC8J,KAAP,CAAaO,aAAb;EACD;;EAED,YAAIoI,UAAU,KAAK,WAAf,IAA8B,CAACC,UAAU,CAACjG,KAAX,CAAiB,+BAAjB,CAAnC,EAAsF;EACpF+F,UAAAA,KAAK,GAAG,KAAR;EACAxS,UAAAA,MAAM,CAAC8J,KAAP,CAAaQ,eAAb;EACD;;EAED,YAAImI,UAAU,KAAK,KAAf,IAAwBC,UAAU,IAAI,IAA1C,EAAgD;EAC9C,cAAItT,qBAAqB,CAACsT,UAAD,CAAzB,EAAuC;EACrCH,YAAAA,UAAU,CAACI,GAAX,GAAiB,CAACD,UAAlB;EACD,WAFD,MAEO;EACLF,YAAAA,KAAK,GAAG,KAAR;EACAxS,YAAAA,MAAM,CAAC8J,KAAP,CAAaS,SAAb;EACD;EACF,SAnCwC;;;EAqCzC,YAAIkI,UAAU,KAAK,KAAnB,EAA0B;EACxB,cAAI,CAAE,CAAE,OAAD,CAAU/S,IAAV,CAAegT,UAAf,CAAD,IAA+B,CAACA,UAAU,GAAG,EAAd,EAAkBrS,MAAlB,KAA6B,EAA9D,KAAsE,CAACvB,YAAY,CAAC4T,UAAD,CAAvF,EAAqG;EACnGF,YAAAA,KAAK,GAAG,KAAR;EACAxS,YAAAA,MAAM,CAAC8J,KAAP,CAAaU,SAAb;EACD;;EAED,cAAI1L,YAAY,CAAC4T,UAAD,CAAhB,EAA8B;EAC5BH,YAAAA,UAAU,CAACE,UAAD,CAAV,GAAyBrR,iBAAiB,CAACsR,UAAD,CAA1C;EACD;EACF,SATD,MASO,IAAI5T,YAAY,CAAC4T,UAAD,CAAhB,EAA8B;EACnCH,UAAAA,UAAU,CAACE,UAAD,CAAV,GAAyBrR,iBAAiB,CAACsR,UAAD,CAA1C;EACD;;EAED,YAAID,UAAU,KAAK,OAAf,IAA0B,CAACzT,aAAa,CAAC0T,UAAD,CAA5C,EAA0D;EACxD,cAAIA,UAAU,CAACrS,MAAX,GAAoB,CAApB,IAA0BqS,UAAU,CAAC7O,MAAX,CAAkB,CAAlB,MAAyB,GAAvD,EAA6D;EAAE;EAC7D6O,YAAAA,UAAU,GAAGA,UAAU,CAACpS,SAAX,CAAqB,CAArB,EAAwBoS,UAAU,CAACrS,MAAnC,CAAb;;EACA,gBAAIjB,qBAAqB,CAACsT,UAAD,CAAzB,EAAuC;EACrCH,cAAAA,UAAU,CAACK,KAAX,GAAmB,CAACF,UAApB;EACD,aAFD,MAEO;EACLF,cAAAA,KAAK,GAAG,KAAR;EACAxS,cAAAA,MAAM,CAAC8J,KAAP,CAAaY,kBAAkB,GAAG,YAAlC;EACD;EACF,WARD,MAQO;EACL8H,YAAAA,KAAK,GAAG,KAAR;EACAxS,YAAAA,MAAM,CAAC8J,KAAP,CAAaY,kBAAkB,GAAG,YAAlC;EACD;EACF;;EAED,YAAI,CAAC8H,KAAL,EAAY;EACV,iBAAOD,UAAU,CAACE,UAAD,CAAjB;EACD;EACF;EACF;EACF;;EACD,SAAOD,KAAP;EACD,CA5EM;EA8EA,IAAMK,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,IAAD,EAAU;EACxC,MAAMC,WAAW,GAAG,EAApB;EACAA,EAAAA,WAAW,CAACC,IAAZ,GAAmBF,IAAI,CAACjQ,IAAxB;;EACA,MAAIiQ,IAAI,CAACxX,EAAL,IAAW,IAAf,EAAqB;EACnByX,IAAAA,WAAW,CAACE,IAAZ,GAAmBH,IAAI,CAACxX,EAAL,GAAU,EAA7B;EACD,GALuC;;;EAOxC,MAAIwX,IAAI,CAACI,MAAL,KAAgB,MAApB,EAA4B;EAC1BH,IAAAA,WAAW,CAACI,MAAZ,GAAqB,GAArB;EACD,GAFD,MAEO,IAAIL,IAAI,CAACI,MAAL,KAAgB,QAApB,EAA8B;EACnCH,IAAAA,WAAW,CAACI,MAAZ,GAAqB,GAArB;EACD,GAFM,MAEA;EACLJ,IAAAA,WAAW,CAACI,MAAZ,GAAqB,GAArB;EACD;;EAED,MAAMC,mBAAmB,GAAG,SAAtBA,mBAAsB,CAAUC,MAAV,EAAkB;EAC5C,QAAIA,MAAM,IAAI,IAAd,EAAoB;EAClB,UAAIC,OAAO,GAAG,EAAd;EACA,UAAIC,UAAU,GAAG,EAAjB;;EAEA,WAAK,IAAI1F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwF,MAAM,CAAChT,MAA3B,EAAmCwN,CAAC,EAApC,EAAwC;EACtC,YAAM2F,IAAG,GAAGH,MAAM,CAACxF,CAAD,CAAlB;;EACA,YAAI2F,IAAG,CAACvH,IAAJ,IAAY,IAAhB,EAAsB;EACpB,cAAMA,IAAI,GAAGuH,IAAG,CAACvH,IAAjB;;EACA,cAAIA,IAAI,KAAK,iBAAb,EAAgC;EAC9B,mBAAO,UAAP;EACD,WAFD,MAEO,IAAIA,IAAI,KAAK,SAAb,EAAwB;EAC7BqH,YAAAA,OAAO,GAAG,GAAV;EACD,WAFM,MAEA,IAAIrH,IAAI,KAAK,aAAb,EAA4B;EACjCsH,YAAAA,UAAU,GAAG,GAAb;EACD;EACF;EACF;;EAED,UAAID,OAAO,KAAK,GAAhB,EAAqB;EACnB,eAAO,SAAP;EACD,OAFD,MAEO,IAAIC,UAAU,KAAK,GAAnB,EAAwB;EAC7B,eAAO,QAAP;EACD;EACF;EACF,GAzBD;;EA2BA,MAAIT,IAAI,CAACW,mBAAL,IAA4B,IAAhC,EAAsC;EACpCV,IAAAA,WAAW,CAACW,OAAZ,GAAsB,GAAtB;;EACA,QAAIZ,IAAI,CAACW,mBAAL,KAA6B,SAAjC,EAA4C;EAC1CV,MAAAA,WAAW,CAACW,OAAZ,GAAsB,GAAtB;EACD;EACF;;EAED,MAAMF,GAAG,GAAGJ,mBAAmB,CAACN,IAAI,CAACa,SAAN,CAA/B;;EACA,MAAIH,GAAG,IAAI,IAAX,EAAiB;EACfT,IAAAA,WAAW,CAACa,SAAZ,GAAwBJ,GAAxB;EACD;;EAED,MAAMK,IAAI,GAAIf,IAAI,CAACe,IAAL,IAAa,IAAd,GAAsBf,IAAI,CAACe,IAAL,CAAUxT,MAAhC,GAAyC,CAAtD;;EACA,MAAIwT,IAAI,GAAG,CAAX,EAAc;EACZd,IAAAA,WAAW,CAACe,QAAZ,GAAuB,GAAvB;EACD,GAFD,MAEO;EACLf,IAAAA,WAAW,CAACe,QAAZ,GAAuB,GAAvB;EACD;;EAED,MAAIhB,IAAI,CAACiB,KAAL,IAAc,IAAlB,EAAwB;EACtBhB,IAAAA,WAAW,CAACiB,KAAZ,GAAoBlB,IAAI,CAACiB,KAAzB;EACD;;EAED,MAAIjB,IAAI,CAACmB,QAAL,IAAiB,IAArB,EAA2B;EACzB,QAAMC,MAAM,GAAGpB,IAAI,CAACmB,QAAL,CAAcvQ,KAAd,CAAoB,GAApB,CAAf,CADyB;;EAEzBqP,IAAAA,WAAW,CAACoB,GAAZ,GAAkB5S,OAAO,CAAC2S,MAAM,CAAC,CAAD,CAAN,GAAYA,MAAM,CAAC,CAAD,CAAlB,GAAwBA,MAAM,CAAC,CAAD,CAA/B,CAAzB;EACD;;EACD,SAAOnB,WAAP;EACD,CAtEM;EAwEA,IAAMqB,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACtB,IAAD,SAAsB;EAAA,MAAb9S,MAAa,SAAbA,MAAa;EACvD,MAAM+S,WAAW,GAAG,EAApB;;EACA,MAAID,IAAI,CAACuB,WAAL,IAAoB,IAAxB,EAA8B;EAC5BtB,IAAAA,WAAW,CAACC,IAAZ,GAAmBF,IAAI,CAACuB,WAAxB;EACD;;EACD,MAAIvB,IAAI,CAACxX,EAAL,IAAW,IAAf,EAAqB;EACnByX,IAAAA,WAAW,CAACuB,IAAZ,GAAmBxB,IAAI,CAACxX,EAAL,GAAU,EAA7B;EACD;;EAED,MAAIwX,IAAI,CAACI,MAAL,IAAe,IAAnB,EAAyB;EACvB,QAAIJ,IAAI,CAACI,MAAL,KAAgB,MAApB,EAA4B;EAC1BH,MAAAA,WAAW,CAACI,MAAZ,GAAqB,GAArB;EACD,KAFD,MAEO,IAAIL,IAAI,CAACI,MAAL,KAAgB,QAApB,EAA8B;EACnCH,MAAAA,WAAW,CAACI,MAAZ,GAAqB,GAArB;EACD,KAFM,MAEA,IAAIL,IAAI,CAACI,MAAL,KAAgB,OAApB,EAA6B;EAClCH,MAAAA,WAAW,CAACI,MAAZ,GAAqB,GAArB;EACD;EACF;;EAED,MAAIL,IAAI,CAACyB,KAAL,IAAc,IAAlB,EAAwB;EACtB,QAAIzB,IAAI,CAACyB,KAAL,CAAWC,SAAX,KAAyB,KAA7B,EAAoC;EAClCzB,MAAAA,WAAW,CAAC0B,KAAZ,GAAoB3B,IAAI,CAACyB,KAAL,CAAWjI,GAAX,CAAe5I,KAAf,CAAqB,KAArB,EAA4B,CAA5B,CAApB;EACD;EACF;;EAED,MAAIoP,IAAI,CAAC4B,MAAL,IAAe,IAAnB,EAAyB;EACvB,SAAK,IAAIC,QAAQ,GAAG,CAApB,EAAuBA,QAAQ,GAAG7B,IAAI,CAAC4B,MAAL,CAAYrU,MAA9C,EAAsDsU,QAAQ,EAA9D,EAAkE;EAChE,UAAMC,QAAQ,GAAG9B,IAAI,CAAC4B,MAAL,CAAYC,QAAZ,CAAjB;;EACA,UAAIC,QAAQ,CAAC3I,IAAT,KAAkB,SAAtB,EAAiC;EAC/B8G,QAAAA,WAAW,CAACiB,KAAZ,GAAoBY,QAAQ,CAAChV,KAA7B;EACD;EACF;EACF;;EAED,MAAIkT,IAAI,CAAC+B,aAAL,IAAsB,IAA1B,EAAgC;EAC9B9B,IAAAA,WAAW,CAACe,QAAZ,GAAuB,GAAvB;;EACA,SAAK,IAAIjG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiF,IAAI,CAAC+B,aAAL,CAAmBxU,MAAvC,EAA+CwN,CAAC,EAAhD,EAAoD;EAClD,UAAMiH,MAAM,GAAGhC,IAAI,CAAC+B,aAAL,CAAmBhH,CAAnB,CAAf;;EACA,UAAIiH,MAAM,CAAC7I,IAAP,KAAgB,MAApB,EAA4B;EAC1B8G,QAAAA,WAAW,CAACe,QAAZ,GAAuB,GAAvB;EACD;EACF;EACF;;EAED,MAAIhB,IAAI,CAACmB,QAAL,IAAiB,IAArB,EAA2B;EACzB,QAAMc,QAAQ,GAAGjC,IAAI,CAACmB,QAAL,CAAcvQ,KAAd,CAAoB,GAApB,CAAjB,CADyB;;EAEzBqP,IAAAA,WAAW,CAACoB,GAAZ,GAAkB5S,OAAO,CAACwT,QAAQ,CAAC,CAAD,CAAR,GAAcA,QAAQ,CAAC,CAAD,CAAtB,GAA4BA,QAAQ,CAAC,CAAD,CAArC,CAAzB;EACD;;EAED,MAAIjC,IAAI,CAACkC,kBAAL,IAA2B,IAA/B,EAAqC;EACnCjC,IAAAA,WAAW,CAACW,OAAZ,GAAsB,GAAtB;;EACA,QAAIZ,IAAI,CAACkC,kBAAL,KAA4B,SAAhC,EAA2C;EACzCjC,MAAAA,WAAW,CAACW,OAAZ,GAAsB,GAAtB;EACD;EACF;;EACD1T,EAAAA,MAAM,CAAC6F,KAAP,CAAa,uBAAuBvD,IAAI,CAACC,SAAL,CAAewQ,WAAf,CAApC;EAEA,SAAOA,WAAP;EACD,CA1DM;EA4DA,IAAMkC,oBAAoB,GAAG,SAAvBA,oBAAuB,CAAC1C,UAAD,EAAa2C,QAAb,EAA0B;EAC5D,MAAIhT,gBAAc,CAACC,wBAAf,EAAJ,EAA+C;EAC7C,QAAImC,GAAG,CAAC8B,gBAAJ,IAAwB,IAA5B,EAAkC;EAChC9B,MAAAA,GAAG,CAAC8B,gBAAJ,GAAuBlE,gBAAc,CAACiD,kBAAf,CAAkCzI,SAAlC,CAAvB;;EACA,UAAI4H,GAAG,CAAC8B,gBAAJ,IAAwB,IAA5B,EAAkC;EAChC9B,QAAAA,GAAG,CAAC8B,gBAAJ,GAAuB,EAAvB;EACD;EACF,KAN4C;;;EAS7C,QAAImM,UAAU,CAAC4C,OAAX,IAAsB,IAA1B,EAAgC;EAC9B,UAAMtD,IAAI,GAAGU,UAAU,CAAC4C,OAAxB;;EACA,WAAK,IAAMlV,GAAX,IAAkB4R,IAAlB,EAAwB;EACtB,YAAIA,IAAI,CAAC1S,cAAL,CAAoBc,GAApB,CAAJ,EAA8B;EAC5BsS,UAAAA,UAAU,CAACtS,GAAD,CAAV,GAAkB4R,IAAI,CAAC5R,GAAD,CAAtB;EACD;EACF;;EACD,aAAOsS,UAAU,CAAC4C,OAAlB;EACD;;EAED,SAAK,IAAMjW,IAAX,IAAmBqT,UAAnB,EAA+B;EAC7B,UAAIA,UAAU,CAACpT,cAAX,CAA0BD,IAA1B,CAAJ,EAAqC;EACnC,YAAIoF,GAAG,CAAC8B,gBAAJ,CAAqBjH,cAArB,CAAoCD,IAApC,KAA6C,CAACgW,QAAlD,EAA4D;EAC1D;EACD;;EACD5Q,QAAAA,GAAG,CAAC8B,gBAAJ,CAAqBlH,IAArB,IAA6BqT,UAAU,CAACrT,IAAD,CAAvC;EACD;EACF;;EACD,QAAIoF,GAAG,CAAC8B,gBAAJ,CAAqB+O,OAArB,IAAgC,IAApC,EAA0C;EACxC,aAAO7Q,GAAG,CAAC8B,gBAAJ,CAAqB+O,OAA5B;EACD;;EACDjT,IAAAA,gBAAc,CAACmD,gBAAf,CAAgC3I,SAAhC,EAA2C4H,GAAG,CAAC8B,gBAA/C;EACD;EACF,CAjCM;EAmCA,IAAMgP,WAAW,GAAG,SAAdA,WAAc,CAACpD,UAAD,EAAaqD,YAAb,EAA2B3O,gBAA3B,EAAgD;EACzE,MAAIsL,UAAU,IAAI,IAAd,IAAsBA,UAAU,KAAK,IAAzC,EAA+C;EAC7C,QAAI9P,gBAAc,CAACC,wBAAf,EAAJ,EAA+C;EAC7C,UAAMoP,WAAW,GAAGH,iBAAiB,EAArC;EAEA,UAAIkE,kBAAkB,GAAG/D,WAAW,CAAC7K,gBAAD,CAApC;;EACA,UAAI4O,kBAAkB,IAAI,IAA1B,EAAgC;EAC9BA,QAAAA,kBAAkB,GAAG,EAArB;EACA/D,QAAAA,WAAW,CAAC7K,gBAAD,CAAX,GAAgC4O,kBAAhC;EACD;;EACDA,MAAAA,kBAAkB,CAACtD,UAAD,CAAlB,GAAiC,KAAjC;EACAV,MAAAA,kBAAkB,CAACC,WAAD,CAAlB;EACD;EACF;;EACD,MAAIjN,GAAG,CAACmC,cAAJ,IAAsB,IAA1B,EAAgC;EAC9B,QAAM8O,KAAK,GAAGjR,GAAG,CAACmC,cAAJ,CAAmBuL,UAAnB,CAAd;;EACA,QAAIuD,KAAK,IAAI,IAAb,EAAmB;EACjBvS,MAAAA,QAAQ,CAACwS,cAAT,CAAwBD,KAAxB,EAA+BE,KAA/B,CAAqCC,OAArC,GAA+C,MAA/C;;EACA,UAAIH,KAAK,KAAK,eAAd,EAA+B;EAC7B,YAAIvS,QAAQ,CAACwS,cAAT,CAAwB,kBAAxB,KAA+C,IAAnD,EAAyD;EACvDxS,UAAAA,QAAQ,CAACwS,cAAT,CAAwB,kBAAxB,EAA4CC,KAA5C,CAAkDC,OAAlD,GAA4D,MAA5D;EACD;EACF;EACF;EACF;EACF,CAzBM;EA2BA,IAAMC,GAAG,GAAG,SAANA,GAAM,CAACC,OAAD,EAAa;EAC9B;EACA,MAAIA,OAAO,CAAC1F,UAAR,IAAsB,IAAtB,IAA8B0F,OAAO,CAAC1F,UAA1C,EAAsD;EACpD2F,IAAAA,OAAO,CAAChQ,KAAR,CAAc,6BAAd,EAA6C+P,OAA7C;EACA,WAAO,IAAP;EACD;;EAED,MAAME,QAAQ,GAAG,CAAC,EAAGF,OAAO,CAACtY,MAAD,CAAP,IAAmB,IAAnB,IAA2BsY,OAAO,CAACtY,MAAD,CAAP,KAAoB,IAAlD,CAAlB;;EAEA,MAAI4E,gBAAc,CAACC,wBAAf,EAAJ,EAA+C;EAC7C,QAAI;EACF,UAAI4T,cAAc,GAAG7T,gBAAc,CAACiD,kBAAf,CAAkCxI,UAAlC,CAArB;;EACA,UAAIoZ,cAAc,IAAI,IAAlB,IAA0BD,QAA9B,EAAwC;EACtCC,QAAAA,cAAc,GAAG,EAAjB;EACD;;EAED,WAAK,IAAM9V,GAAX,IAAkB2V,OAAlB,EAA2B;EACzB,YAAIA,OAAO,CAACzW,cAAR,CAAuBc,GAAvB,CAAJ,EAAiC;EAC/B,cAAI2V,OAAO,CAAC3V,GAAD,CAAP,KAAiB,CAAC,CAAtB,EAAyB;EACvB,mBAAO8V,cAAc,CAAC9V,GAAD,CAArB;EACD,WAFD,MAEO;EACL8V,YAAAA,cAAc,CAAC9V,GAAD,CAAd,GAAsB2V,OAAO,CAAC3V,GAAD,CAA7B;EACD;EACF;EACF;;EACDiC,MAAAA,gBAAc,CAACmD,gBAAf,CAAgC1I,UAAhC,EAA4CoZ,cAA5C;EACD,KAhBD,CAgBE,OAAOpT,CAAP,EAAU;EACVkT,MAAAA,OAAO,CAAC/L,KAAR,CAAc,+BAA+BnH,CAA7C;EACD;EACF;EACF,CA9BM;EA0EA,IAAMqT,OAAO,GAAG,SAAVA,OAAU,CAACC,OAAD,EAAUjW,MAAV,EAAqB;EAC1C,MAAI1B,QAAQ,CAAC2X,OAAD,CAAR,IAAqBxW,QAAQ,CAACwW,OAAD,CAAjC,EAA4C;EAC1C,WAAO,QAAQA,OAAf;EACD;;EACDjW,EAAAA,MAAM,CAAC8J,KAAP,CAAaW,iBAAb;EACD,CALM;EAOA,IAAMyL,uBAAuB,GAAG,SAA1BA,uBAA0B,CAACC,YAAD,EAAeC,SAAf,EAA0BC,WAA1B,EAAuCC,OAAvC,EAAgDtW,MAAhD,EAA2D;EAChG,MAAMuW,aAAa,GAAGlK,YAAY,CAACjI,QAAQ,CAAC6I,IAAV,CAAlC,CADgG;;EAEhG,MAAMuJ,cAAc,GAAGD,aAAa,CAAC5T,CAArC;EACA,MAAM8T,mBAAmB,GAAGF,aAAa,CAACG,CAA1C;;EAEA,MAAI,OAAOF,cAAP,KAA0B,WAA9B,EAA2C;EACzC,QAAMhU,IAAI,GAAG,EAAb;EACAA,IAAAA,IAAI,CAAClH,EAAL,GAAUgb,OAAO,CAAChb,EAAlB,CAFyC;;EAGzCkH,IAAAA,IAAI,CAACsE,WAAL,GAAmBxC,GAAG,CAACwC,WAAvB,CAHyC;;EAKzC,QAAIxC,GAAG,CAACyC,mBAAR,EAA6B;EAC3BvE,MAAAA,IAAI,CAAC1E,eAAD,CAAJ,GAAwBwG,GAAG,CAACyC,mBAA5B;EACD;;EAED,QAAIuF,GAAG,GAAGgK,OAAO,CAACK,QAAlB;;EACA,QAAIN,WAAJ,EAAiB;EACf/J,MAAAA,GAAG,GAAGY,QAAQ,CAACZ,GAAD,EAAM,aAAN,EAAqB+J,WAArB,CAAd;EACD;;EACD,QAAID,SAAJ,EAAe;EACb9J,MAAAA,GAAG,GAAGY,QAAQ,CAACZ,GAAD,EAAM,SAAN,EAAiB8J,SAAjB,CAAd;EACD;;EACD9J,IAAAA,GAAG,GAAGY,QAAQ,CAACZ,GAAD,EAAM,GAAN,EAAWkK,cAAX,CAAd;EACAlK,IAAAA,GAAG,GAAGY,QAAQ,CAACZ,GAAD,EAAM,GAAN,EAAW0B,YAAY,CAAC1L,IAAI,CAACC,SAAL,CAAeC,IAAf,CAAD,EAAuBxC,MAAvB,CAAvB,CAAd;;EACA,QAAIyW,mBAAJ,EAAyB;EACvBnK,MAAAA,GAAG,GAAGY,QAAQ,CAACZ,GAAD,EAAM,GAAN,EAAWmK,mBAAX,CAAd;EACD;;EAED,QAAIN,YAAY,KAAK,IAArB,EAA2B;EACzB7J,MAAAA,GAAG,GAAGY,QAAQ,CAACZ,GAAD,EAAM,KAAN,EAAa6J,YAAb,CAAd;EACD;;EAEDpG,IAAAA,iBAAiB,CAAC6G,WAAlB,CAA8BtK,GAA9B;EACD;EACF,CAjCM;;;;;;;;;;;;;;MCpbcuK;;;;;EAOnB,gCAKGxL,MALH,EAKW;EAAA;;EAAA,QAJTrL,MAIS,QAJTA,MAIS;EAAA,QAHTmI,OAGS,QAHTA,OAGS;EAAA,QAFTmO,OAES,QAFTA,OAES;EAAA,QADThL,uBACS,QADTA,uBACS;;EAAA;;EACT;EADS;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAET,uFAAetL,MAAf;EACA,yFAAgBmI,OAAhB;EACA,qFAAgBmO,OAAhB;EACA,6FAAkBjL,MAAlB;EACA,yHAAgCC,uBAAhC;EANS;EAOV;;;;6BAEqB;EAAA,wCAAbwL,WAAa;EAAbA,QAAAA,WAAa;EAAA;;EACpB,oFAA0BA,WAA1B;;EACA,aAAO,CAAP;EACD;;;0CAEoB;EACnB,sCAAI,IAAJ,+BAAqB;EACnB,kHAA0B,IAA1B;EACD;;EACD,sEAAkB,IAAlB;EACD;;;mCAEaC,UAAU;EACtB,UAAI,6BAAC,IAAD,2DAAJ,EAAsC;EACpC;EACD;;EACD,UAAIzS,GAAG,CAAC8B,gBAAJ,IAAwB,IAA5B,EAAkC;EAChC9B,QAAAA,GAAG,CAAC8B,gBAAJ,GAAuBlE,cAAc,CAACiD,kBAAf,CAAkCzI,SAAlC,CAAvB;EACD;;EACD,UAAI4H,GAAG,CAAC8B,gBAAJ,IAAwB,IAA5B,EAAkC;EAChC,eAAO9B,GAAG,CAAC8B,gBAAJ,CAAqB2Q,QAArB,CAAP;EACD;EACF;;;;mCA3CyCjM;;6DA6CpBkM,YAAY;EAChC,MAAIlM,KAAK,CAACC,OAAN,CAAciM,UAAd,KAA6BA,UAAU,CAAC3W,MAAX,GAAoB,CAArD,EAAwD;EACtD,SAAK,IAAMsH,KAAX,IAAoBqP,UAApB,EAAgC;EAC9B,UAAIA,UAAU,CAAC7X,cAAX,CAA0BwI,KAA1B,CAAJ,EAAsC;EACpC,YAAMsP,QAAQ,GAAGD,UAAU,CAACrP,KAAD,CAA3B;EACA,YAAInF,IAAI,GAAG,EAAX;EACA,YAAI+P,UAAU,SAAd;;EACA,YAAI0E,QAAQ,CAACC,IAAT,IAAiB,IAArB,EAA2B;EAAE;EAC3B3E,UAAAA,UAAU,GAAG0E,QAAQ,CAACC,IAAtB;;EACA,cAAIlY,aAAa,CAACuT,UAAD,CAAb,IAA6B,CAACD,cAAc,CAACC,UAAD,EAAa;EAC3DvS,YAAAA,MAAM,8BAAE,IAAF;EADqD,WAAb,CAAhD,EAEI;EACF;EACD;EACF,SAPD,MAOO,IAAIiX,QAAQ,CAACE,QAAT,IAAqB,IAAzB,EAA+B;EAAE;EACtC,cAAMC,YAAY,GAAGH,QAAQ,CAACE,QAA9B,CADoC;;EAIpC,cAAI,CAACnY,aAAa,CAACoY,YAAD,CAAd,IAAiC,CAACA,YAAY,CAACtN,KAAnD,EAA2D;EACzDyI,YAAAA,UAAU,GAAGM,gBAAgB,CAACuE,YAAD,CAA7B;EACD;EACF,SAPM,MAOA,IAAIH,QAAQ,CAAC,aAAD,CAAR,IAA2B,IAA/B,EAAqC;EAC1C,cAAMI,eAAe,GAAGJ,QAAQ,CAAC,aAAD,CAAhC;;EACA,cAAI,CAACjY,aAAa,CAACqY,eAAD,CAAd,IAAoC,CAACA,eAAe,CAACvN,KAAzD,EAAiE;EAC/DyI,YAAAA,UAAU,GAAG6B,mBAAmB,CAACiD,eAAD,EAAkB;EAAErX,cAAAA,MAAM,8BAAE,IAAF;EAAR,aAAlB,CAAhC;EACD;EACF;;EACD,YAAIuS,UAAU,IAAI,IAAd,IAAuB,CAACvT,aAAa,CAACuT,UAAD,CAAzC,EAAwD;EAAE;EACxD/P,UAAAA,IAAI,CAACyJ,IAAL,GAAY,SAAZ;;EACA,cAAIsG,UAAU,CAAC+E,EAAX,IAAiB,IAArB,EAA2B;EACzB;EACA/E,YAAAA,UAAU,CAAC+E,EAAX,GAAgB,IAAIvY,IAAJ,GAAWH,QAAX,GAAsB6N,KAAtB,CAA4B,qBAA5B,EAAmD,CAAnD,CAAhB;EACD;;EAEDjK,UAAAA,IAAI,CAAC+U,OAAL,GAAehF,UAAf;EACA0C,UAAAA,oBAAoB,CAAC1C,UAAD,EAAa,IAAb,CAApB;EACA/P,UAAAA,IAAI,GAAG,0DAAcgV,qBAAd,CAAoChV,IAApC,EAA0C3C,SAA1C,CAAP;;EAEA,oEAAc4X,QAAd,CAAuBjV,IAAvB;;EACA,cAAMkV,cAAc,GAAG1J,YAAY,CAAC1L,IAAI,CAACC,SAAL,CAAeC,IAAf,CAAD,8BAAuB,IAAvB,wBAAnC;;EAEA,cAAI4N,WAAW,GAAG,sDAAcuH,WAAhC;;EACAvH,UAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,MAAd,EAAsB7S,QAAtB,CAAtB;EACA6S,UAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,GAAd,EAAmBsH,cAAnB,CAAtB;;EAEA,oEAAcE,kBAAd,CAAiCxH,WAAjC,EAA8C9L,GAAG,CAACuT,aAAlD;EACD;EACF;EACF;EACF;EACF;;;;;;;;;;;;;;;;;;;;;;MC7EkBC;;;;;EAQnB,kCAOAzM,MAPA,EAOQ;EAAA;;EAAA,QANNlD,OAMM,QANNA,OAMM;EAAA,QALNmO,OAKM,QALNA,OAKM;EAAA,QAJNjO,OAIM,QAJNA,OAIM;EAAA,QAHNrI,MAGM,QAHNA,MAGM;EAAA,QAFNoI,MAEM,QAFNA,MAEM;;EAAA;;EACN;EADM;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAEN,yFAAgBD,OAAhB;EACA,yFAAgBmO,OAAhB;EACA,yFAAgBjO,OAAhB;EACA,uFAAerI,MAAf;EACA,6FAAkBqL,MAAlB;EACA,uFAAejD,MAAf;EAPM;EAQP;;;;8BA+JQ;EACP,8DAAavC,KAAb,CAAmB,wCAAnB;;EACA;;EACA3D,MAAAA,gBAAc,CAACqD,WAAf,CAA2BvJ,KAA3B,EAAkC,IAAlC;EACD;;;6BA8DqB;EAAA,wCAAb8a,WAAa;EAAbA,QAAAA,WAAa;EAAA;;EACpB,gFAAwBA,WAAxB;;EACA,aAAO,CAAP;EACD;;;0CAEoB;EACnB,sCAAI,IAAJ,+BAAqB;EACnB,8GAAwB,IAAxB;EACD;;EACD,sEAAkB,IAAlB;EACD;;;;mCAlQ2ChM;;2CAyB/BkM,YAAY;EAAA;;EACvB,MAAI/G,WAAW,GAAG,IAAlB;EACA/N,EAAAA,gBAAc,CAACmD,gBAAf,CAAgClH,sBAAhC,EAAwD8R,WAAxD;;EACA,MAAM8H,MAAM,GAAG,SAATA,MAAS,CAACC,GAAD,EAAS;EACtB,QAAIxS,CAAC,GAAGtD,gBAAc,CAACiD,kBAAf,CAAkC/I,YAAlC,CAAR;EACA,QAAM6b,CAAC,GAAG/V,gBAAc,CAACiD,kBAAf,CAAkChJ,YAAlC,CAAV;EACA,QAAI+b,GAAJ;;EACA,QAAI1S,CAAC,IAAI,IAAT,EAAe;EACbA,MAAAA,CAAC,GAAG,EAAJ;EACA0S,MAAAA,GAAG,GAAGF,GAAN;EACD,KAHD,MAGO;EAAE;EACPE,MAAAA,GAAG,GAAG1S,CAAC,CAAClK,EAAR;EACA,UAAI6c,aAAa,GAAG,KAApB;EACA,UAAIC,YAAY,GAAG,KAAnB;;EACA,UAAIF,GAAG,IAAI,IAAX,EAAiB;EACfA,QAAAA,GAAG,GAAGF,GAAG,CAAC,CAAD,CAAT;EACAG,QAAAA,aAAa,GAAG,IAAhB;EACD;;EAED,UAAI7T,GAAG,CAAClH,SAAJ,IAAiB,IAAjB,IAAyB8E,gBAAc,CAACC,wBAAf,EAA7B,EAAwE;EACtEmC,QAAAA,GAAG,CAAClH,SAAJ,GAAgB,IAAI4J,QAAJ,CAAa3J,cAAb,CAAhB;EACD;;EAED,UAAI8a,aAAJ,EAAmB;EACjB,YAAKF,CAAD,IAAO,IAAX,EAAiB;EACf3T,UAAAA,GAAG,CAAClH,SAAJ,CAAc0L,GAAd,CAAkBoP,GAAlB,EAAuBD,CAAvB;EACA3T,UAAAA,GAAG,CAACuT,aAAJ,GAAoB,KAApB;EACD;EACF,OALD,MAKO;EACL,aAAK,IAAMlU,GAAX,IAAkBqU,GAAlB,EAAuB;EACrB,cAAIA,GAAG,CAAC7Y,cAAJ,CAAmBwE,GAAnB,CAAJ,EAA6B;EAC3B,gBAAMrI,EAAE,GAAG0c,GAAG,CAACrU,GAAD,CAAd;;EACA,gBAAIW,GAAG,CAAClH,SAAJ,CAAcgK,KAAd,CAAoB9L,EAApB,CAAJ,EAA6B;EAC3B4c,cAAAA,GAAG,GAAG5c,EAAN;EACA8c,cAAAA,YAAY,GAAG,IAAf;EACA;EACD;EACF;EACF;EACF;;EAED,UAAIA,YAAJ,EAAkB;EAChB,YAAIF,GAAG,KAAK5T,GAAG,CAAClH,SAAJ,CAAcib,UAAd,EAAZ,EAAwC;EACtC;EACA,sCAAA,MAAI,yBAAJ;EACD,SAHD,MAGO;EACLpI,UAAAA,WAAW,GAAG,KAAd;EACA/N,UAAAA,gBAAc,CAACmD,gBAAf,CAAgClH,sBAAhC,EAAwD8R,WAAxD;EACD;;EACD,YAAMqI,UAAU,GAAGhU,GAAG,CAAClH,SAAJ,CAAcmb,GAAd,CAAkBL,GAAlB,CAAnB;EACA5T,QAAAA,GAAG,CAAClH,SAAJ,CAAc0L,GAAd,CAAkBoP,GAAlB,EAAuBI,UAAvB;EACApW,QAAAA,gBAAc,CAACmD,gBAAf,CAAgClJ,YAAhC,EAA8Cmc,UAA9C;EACA,oCAAA,MAAI,YAAJ,YAAatS,OAAb,GAAuBsS,UAAvB;EAEA,YAAMvP,KAAK,GAAGzE,GAAG,CAAClH,SAAJ,CAAc4L,gBAAd,EAAd;;EACA,YAAI9G,gBAAc,CAACiD,kBAAf,CAAkChH,sBAAlC,KAA6D4K,KAAK,KAAK,CAAC,CAA5E,EAA+E;EAC7E;EACA,cAAME,QAAQ,GAAG3E,GAAG,CAAClH,SAAJ,CAAcgK,KAAd,CAAoB2B,KAApB,CAAjB;;EACA,sCAAA,MAAI,aAAJ,aAAcG,sBAAd,CAAqCD,QAArC;EACD;EACF,OAnBD,MAmBO;EACL,YAAI,CAACkP,aAAL,EAAoB;EAClB,UAAA,MAAI,CAACK,KAAL;EACD,SAFD,MAEO;EACL,cAAKP,CAAD,IAAO,IAAX,EAAiB;EACf,wCAAA,MAAI,YAAJ,YAAajS,OAAb,GAAuBiS,CAAvB;EACA/V,YAAAA,gBAAc,CAACmD,gBAAf,CAAgClJ,YAAhC,EAA8C8b,CAA9C;EACAhI,YAAAA,WAAW,GAAG,KAAd;EACD;EACF;;EACD/N,QAAAA,gBAAc,CAACmD,gBAAf,CAAgClH,sBAAhC,EAAwD,KAAxD;EACA+Z,QAAAA,GAAG,GAAGF,GAAG,CAAC,CAAD,CAAT;EACD;EACF;;EACDxS,IAAAA,CAAC,CAAClK,EAAF,GAAO4c,GAAP;EACAhW,IAAAA,gBAAc,CAACmD,gBAAf,CAAgCjJ,YAAhC,EAA8CoJ,CAA9C;EACD,GAzED;;EA2EA,MAAIsF,KAAK,CAACC,OAAN,CAAciM,UAAd,KAA6BA,UAAU,CAAC3W,MAAX,GAAoB,CAArD,EAAwD;EACtD,SAAK,IAAMsH,KAAX,IAAoBqP,UAApB,EAAgC;EAC9B,UAAIA,UAAU,CAAC7X,cAAX,CAA0BwI,KAA1B,CAAJ,EAAsC;EACpC,YAAMsP,QAAQ,GAAGD,UAAU,CAACrP,KAAD,CAA3B;EACA,YAAInF,IAAI,GAAG,EAAX;EACA,YAAI+P,UAAU,SAAd;;EACA,YAAI0E,QAAQ,CAACC,IAAT,IAAiB,IAArB,EAA2B;EAAE;EAC3B3E,UAAAA,UAAU,GAAG0E,QAAQ,CAACC,IAAtB;;EACA,cAAIlY,aAAa,CAACuT,UAAD,CAAb,IAA6B,CAACD,cAAc,CAACC,UAAD,EAAa;EAC3DvS,YAAAA,MAAM,8BAAE,IAAF;EADqD,WAAb,CAAhD,EAEI;EACF;EACD;EACF,SAPD,MAOO,IAAIiX,QAAQ,CAACE,QAAT,IAAqB,IAAzB,EAA+B;EAAE;EACtC,cAAMC,YAAY,GAAGH,QAAQ,CAACE,QAA9B,CADoC;;EAIpC,cAAI,CAACnY,aAAa,CAACoY,YAAD,CAAd,IAAiC,CAACA,YAAY,CAACtN,KAAnD,EAA2D;EACzDyI,YAAAA,UAAU,GAAGM,gBAAgB,CAACuE,YAAD,CAA7B;EACD;EACF,SAPM,MAOA,IAAIH,QAAQ,CAAC,aAAD,CAAR,IAA2B,IAA/B,EAAqC;EAC1C,cAAMI,eAAe,GAAGJ,QAAQ,CAAC,aAAD,CAAhC;;EACA,cAAIjY,aAAa,CAACqY,eAAD,CAAb,IAAmC,CAACA,eAAe,CAACvN,KAAxD,EAAgE;EAC9DyI,YAAAA,UAAU,GAAG6B,mBAAmB,CAACiD,eAAD,EAAkB;EAAErX,cAAAA,MAAM,8BAAE,IAAF;EAAR,aAAlB,CAAhC;EACD;EACF;;EACD,YAAIuS,UAAU,IAAI,IAAd,IAAuB,CAACvT,aAAa,CAACuT,UAAD,CAAzC,EAAwD;EAAE;EACxD/P,UAAAA,IAAI,CAACyJ,IAAL,GAAY,SAAZ;;EACA,cAAIsG,UAAU,CAAC+E,EAAX,IAAiB,IAArB,EAA2B;EACzB;EACA/E,YAAAA,UAAU,CAAC+E,EAAX,GAAgB,IAAIvY,IAAJ,GAAWH,QAAX,GAAsB6N,KAAtB,CAA4B,qBAA5B,EAAmD,CAAnD,CAAhB;EACD;;EAEDjK,UAAAA,IAAI,CAAC+U,OAAL,GAAehF,UAAf;EACA,cAAMyF,GAAG,GAAG,EAAZ;;EACA,cAAI9V,gBAAc,CAACC,wBAAf,EAAJ,EAA+C;EAC7C,gBAAIoQ,UAAU,CAACkG,QAAX,IAAuB,IAA3B,EAAiC;EAC/BT,cAAAA,GAAG,CAAC1Q,IAAJ,CAASiL,UAAU,CAACkG,QAApB;EACD;;EACD,gBAAIlG,UAAU,CAACyB,KAAX,IAAoB,IAAxB,EAA8B;EAC5BgE,cAAAA,GAAG,CAAC1Q,IAAJ,CAASiL,UAAU,CAACyB,KAApB;EACD;;EACD,gBAAIzB,UAAU,CAAC+B,IAAX,IAAmB,IAAvB,EAA6B;EAC3B0D,cAAAA,GAAG,CAAC1Q,IAAJ,CAAS,QAAQiL,UAAU,CAAC+B,IAA5B;EACD;;EACD,gBAAI/B,UAAU,CAACU,IAAX,IAAmB,IAAvB,EAA6B;EAC3B+E,cAAAA,GAAG,CAAC1Q,IAAJ,CAAS,QAAQiL,UAAU,CAACU,IAA5B;EACD;;EACD,gBAAI+E,GAAG,CAAC3X,MAAJ,GAAa,CAAjB,EAAoB;EAClB0X,cAAAA,MAAM,CAACC,GAAD,CAAN;EACD;EACF;;EACD/C,UAAAA,oBAAoB,CAAC1C,UAAD,EAAa,IAAb,CAApB;EACA/P,UAAAA,IAAI,GAAG,0DAAcgV,qBAAd,CAAoChV,IAApC,EAA0C3C,SAA1C,CAAP;;EAEA,oEAAc4X,QAAd,CAAuBjV,IAAvB,EA7BsD;EA+BtD;EACA;;;EACA,cAAIyN,WAAJ,EAAiB;EACfzN,YAAAA,IAAI,CAAClF,MAAD,CAAJ,GAAe,IAAf;EACD;;EAED,cAAMoa,cAAc,GAAG1J,YAAY,CAAC1L,IAAI,CAACC,SAAL,CAAeC,IAAf,CAAD,8BAAuB,IAAvB,wBAAnC;;EAEA,cAAI4N,WAAW,GAAG,0DAAcuH,WAAhC;;EACAvH,UAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,MAAd,EAAsB7S,QAAtB,CAAtB;EACA6S,UAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,GAAd,EAAmBsH,cAAnB,CAAtB,CAzCsD;EA4CtD;EACA;;EACA,oEAAcE,kBAAd,CAAiCxH,WAAjC,EAA8C9L,GAAG,CAACuT,aAAlD,EAAiE5H,WAAjE;EACD;EACF;EACF;EACF;EACF;;mEAQyB;EACxB3L,EAAAA,GAAG,CAACuT,aAAJ,GAAoB,KAApB;EACAhC,EAAAA,OAAO,CAAChQ,KAAR,CAAc,wBAAd;;EACA,MAAI3D,gBAAc,CAACC,wBAAf,EAAJ,EAA+C;EAC7C,WAAOC,YAAY,CAAC1F,SAAD,CAAnB;EACA,WAAO0F,YAAY,CAAC5F,SAAD,CAAnB;EACA,WAAO4F,YAAY,CAAC3F,WAAD,CAAnB;EACA,WAAO2F,YAAY,CAACzF,UAAD,CAAnB;EACA,WAAOyF,YAAY,CAAC/F,gBAAD,CAAnB;EACA,WAAO+F,YAAY,CAAClG,qBAAD,CAAnB;EACD;;EACDgG,EAAAA,gBAAc,CAAC8C,YAAf,CAA4B3I,gBAA5B,EAA8C+Q,WAAW,EAAzD;EACAlL,EAAAA,gBAAc,CAAC8C,YAAf,CAA4B,0DAAc0T,UAA1C,EAAsDpU,GAAG,CAACM,WAA1D;EACA1C,EAAAA,gBAAc,CAAC8C,YAAf,CAA4BrI,UAA5B,EAAwC2H,GAAG,CAACM,WAA5C;;EACA,4DAAc4E,sBAAd,CAAqC,EAArC;EACD;;6CAEc;EACblF,EAAAA,GAAG,CAACuT,aAAJ,GAAoB,IAApB;;EACA,0DAAahS,KAAb,CAAmB,uBAAnB;;EACAvB,EAAAA,GAAG,CAACC,WAAJ,GAAkB,EAAlB;;EACA,MAAIrC,gBAAc,CAACC,wBAAf,EAAJ,EAA+C;EAC7C,WAAOC,YAAY,CAACjG,YAAD,CAAnB;EACA,WAAOiG,YAAY,CAAChG,YAAD,CAAnB;EACA,WAAOgG,YAAY,CAAC1F,SAAD,CAAnB;EACA,WAAO0F,YAAY,CAAC5F,SAAD,CAAnB;EACA,WAAO4F,YAAY,CAAC3F,WAAD,CAAnB;EACA,WAAO2F,YAAY,CAACzF,UAAD,CAAnB;EACA,WAAOyF,YAAY,CAAC/F,gBAAD,CAAnB;EACA,WAAO+F,YAAY,CAAClG,qBAAD,CAAnB;EACD;;EACDgG,EAAAA,gBAAc,CAAC8C,YAAf,CAA4B7I,YAA5B,EAA0CmI,GAAG,CAACM,WAA9C;EACA1C,EAAAA,gBAAc,CAAC8C,YAAf,CAA4B3I,gBAA5B,EAA8C+Q,WAAW,EAAzD;EACAlL,EAAAA,gBAAc,CAAC8C,YAAf,CAA4B5I,YAA5B,EAA0CgR,WAAW,EAArD;EACAlL,EAAAA,gBAAc,CAAC8C,YAAf,CAA4B,0DAAc0T,UAA1C,EAAsDpU,GAAG,CAACM,WAA1D;EACA1C,EAAAA,gBAAc,CAAC8C,YAAf,CAA4BrI,UAA5B,EAAwC2H,GAAG,CAACM,WAA5C;EACA,0DAAaoB,OAAb,GAAuB,IAAvB;;EACA,4DAAcwD,sBAAd,CAAqC,EAArC;EACD;;yDAEmBmP,UAAU;EAC5B,MAAI7N,KAAK,CAACC,OAAN,CAAc4N,QAAd,KAA2BA,QAAQ,CAACtY,MAAT,GAAkB,CAAjD,EAAoD;EAClD,QAAMkS,UAAU,GAAGoG,QAAQ,CAACC,GAAT,EAAnB;EACA,QAAMC,cAAc,GAAGtG,UAAU,IAAI,IAAd,IAAsB9T,QAAQ,CAAC8T,UAAD,CAA9B,KACjBA,UAAU,CAAC2E,IAAX,IAAmB,IAAnB,IAA2BxY,MAAM,CAACmT,IAAP,CAAYU,UAAU,CAAC2E,IAAvB,EAA6B7W,MAA7B,GAAsC,CAAlE,IACIkS,UAAU,CAAC4E,QAAX,IAAuB,IAAvB,IAA+BzY,MAAM,CAACmT,IAAP,CAAYU,UAAU,CAAC4E,QAAvB,EAAiC9W,MAAjC,GAA0C,CAD7E,IAEIkS,UAAU,CAAC,aAAD,CAAV,IAA6B,IAA7B,IAAqC7T,MAAM,CAACmT,IAAP,CAAYU,UAAU,CAAC,aAAD,CAAtB,EAAuClS,MAAvC,GAAgD,CAHvE,CAAvB;;EAIA,QAAIwY,cAAJ,EAAoB;EAClB3W,MAAAA,gBAAc,CAAC4W,uBAAf;;EACA,UAAI;EACF,oEAAiB,CAACvG,UAAD,CAAjB;EACD,OAFD,CAEE,OAAO5P,CAAP,EAAU;EACV,gEAAakD,KAAb,CAAmBlD,CAAnB;EACD;EACF,KAPD,MAOO;EACL,8DAAamH,KAAb,CAAmB,uCAAnB;EACD;EACF;EACF;;EC7PH,IAAMiP,GAAG,GAAG,SAANA,GAAM,CAACC,GAAD,QAKN;EAAA,MAJJ5Q,MAII,QAJJA,MAII;EAAA,MAHJC,OAGI,QAHJA,OAGI;EAAA,MAFJF,OAEI,QAFJA,OAEI;EAAA,MADJnI,MACI,QADJA,MACI;EACJ,MAAMiZ,OAAO,GAAG7Q,MAAhB;EACA,MAAM8Q,QAAQ,GAAG7Q,OAAjB;EACA,MAAM8Q,QAAQ,GAAGhR,OAAjB;EACA,MAAMiR,OAAO,GAAGpZ,MAAhB;EACA,MAAIqZ,WAAW,GAAG,CAAlB;;EAEA,MAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,CAACC,gBAAD,EAAsB;EAC/C,QAAMvH,UAAU,GAAGuH,gBAAgB,CAACC,OAAjB,CAAyB9V,KAAzB,CAA+B,GAA/B,EAAoC,CAApC,CAAnB;EACA,QAAM9C,KAAK,GAAGD,QAAQ,EAAtB;;EAEA,QAAM8Y,SAAS,GAAG,SAAZA,SAAY,CAACxa,GAAD,EAAM+S,UAAN,EAAkB0H,mBAAlB,EAA0C;EAC1D,UAAIC,YAAY,GAAG,CAAnB;EACA,UAAIC,UAAU,GAAG,CAAjB;;EACA,UAAI3a,GAAG,CAAC+S,UAAD,CAAH,IAAmB,IAAvB,EAA6B;EAC3B2H,QAAAA,YAAY,GAAG1a,GAAG,CAAC+S,UAAD,CAAlB;EACD;;EACD2H,MAAAA,YAAY;;EACZ,UAAI1a,GAAG,CAACkT,EAAJ,IAAU,IAAd,EAAoB;EAClByH,QAAAA,UAAU,GAAG3a,GAAG,CAACkT,EAAjB;EACD,OATyD;;;EAW1D,UAAIuH,mBAAmB,GAAG,CAA1B,EAA6B;EAC3BE,QAAAA,UAAU;EACX;;EAED3a,MAAAA,GAAG,CAACkT,EAAJ,GAASyH,UAAT;EACA3a,MAAAA,GAAG,CAAC+S,UAAD,CAAH,GAAkB2H,YAAlB;EACD,KAjBD;;EAmBA,QAAIzX,gBAAc,CAACC,wBAAf,EAAJ,EAA+C;EAC7C,aAAO0X,cAAc,CAACxd,gBAAD,CAArB;EACA,UAAMgV,OAAO,GAAGD,iBAAiB,EAAjC,CAF6C;;EAK7C,UAAImI,gBAAgB,CAACzc,OAAD,CAAhB,CAA0Bgd,GAA1B,IAAiC,IAArC,EAA2C;EACzCP,QAAAA,gBAAgB,CAACzc,OAAD,CAAhB,CAA0Bgd,GAA1B,GAAgC,CAAhC;EACD;;EAED,UAAIJ,mBAAmB,GAAG,CAAC,CAA3B;EACA,UAAIK,oBAAoB,GAAG,CAAC,CAA5B;EACA,UAAIC,kBAAkB,GAAG,CAAC,CAA1B;EACA,UAAIC,kBAAkB,GAAG,CAAC,CAA1B;EACA,UAAIC,eAAe,GAAG,CAAC,CAAvB;EACA,UAAIC,iBAAiB,GAAG,CAAC,CAAzB;;EAEA,UAAIZ,gBAAgB,CAACzc,OAAD,CAAhB,CAA0Bsd,GAA1B,IAAiC,IAArC,EAA2C;EACzCV,QAAAA,mBAAmB,GAAGW,QAAQ,CAACd,gBAAgB,CAACzc,OAAD,CAAhB,CAA0Bsd,GAA3B,EAAgC,EAAhC,CAA9B;EACD;;EACD,UAAIb,gBAAgB,CAACzc,OAAD,CAAhB,CAA0Bwd,GAA1B,IAAiC,IAArC,EAA2C;EACzCP,QAAAA,oBAAoB,GAAGM,QAAQ,CAACd,gBAAgB,CAACzc,OAAD,CAAhB,CAA0Bwd,GAA3B,EAAgC,EAAhC,CAA/B;EACD;;EACD,UAAIf,gBAAgB,CAACzc,OAAD,CAAhB,CAA0Byd,GAA1B,IAAiC,IAArC,EAA2C;EACzCP,QAAAA,kBAAkB,GAAGK,QAAQ,CAACd,gBAAgB,CAACzc,OAAD,CAAhB,CAA0Byd,GAA3B,EAAgC,EAAhC,CAA7B;EACD;;EACD,UAAIhB,gBAAgB,CAACzc,OAAD,CAAhB,CAA0BuV,GAA1B,IAAiC,IAArC,EAA2C;EACzC4H,QAAAA,kBAAkB,GAAGI,QAAQ,CAACd,gBAAgB,CAACzc,OAAD,CAAhB,CAA0BuV,GAA3B,EAAgC,EAAhC,CAA7B;EACD;;EACD,UAAIkH,gBAAgB,CAACzc,OAAD,CAAhB,CAA0BsV,GAA1B,IAAiC,IAArC,EAA2C;EACzC8H,QAAAA,eAAe,GAAGG,QAAQ,CAACd,gBAAgB,CAACzc,OAAD,CAAhB,CAA0BsV,GAA3B,EAAgC,EAAhC,CAA1B;EACD;;EACD,UAAImH,gBAAgB,CAACzc,OAAD,CAAhB,CAA0Bgd,GAA1B,IAAiC,IAArC,EAA2C;EACzCK,QAAAA,iBAAiB,GAAGE,QAAQ,CAACd,gBAAgB,CAACzc,OAAD,CAAhB,CAA0Bgd,GAA3B,EAAgC,EAAhC,CAA5B;EACD,OAjC4C;;;EAoC7C,UAAIU,WAAU,GAAGnJ,OAAO,CAAC6H,QAAQ,CAACuB,SAAV,CAAxB;;EACA,UAAID,WAAJ,EAAgB;EACd,YAAME,oBAAoB,GAAGF,WAAU,CAACxI,UAAD,CAAvC;EACA,YAAM2I,iBAAiB,GAAGH,WAAU,CAACrI,EAArC,CAFc;;EAId,YAAIuI,oBAAoB,KAAK,KAA7B,EAAoC;EAClC,iBAAO,KAAP;EACD,SANa;;;EASd,YAAIP,iBAAiB,GAAG,CAApB,IAAyBQ,iBAAiB,IAAIR,iBAA9C,IAAmET,mBAAmB,GAAG,CAA7F,EAAgG;EAC9F,iBAAO,KAAP;EACD,SAXa;;;EAad,YAAIK,oBAAoB,GAAG,CAAvB,IAA4BW,oBAAoB,IAAIX,oBAAxD,EAA8E;EAC5E,iBAAO,KAAP;EACD;EACF,OAhBD,MAgBO;EACLS,QAAAA,WAAU,GAAG,EAAb;EACAnJ,QAAAA,OAAO,CAAC6H,QAAQ,CAACuB,SAAV,CAAP,GAA8BD,WAA9B;EACD,OAxD4C;;;EA2D7C,UAAI7I,QAAQ,GAAGN,OAAO,CAACzQ,KAAD,CAAtB;;EACA,UAAI+Q,QAAQ,IAAI,IAAhB,EAAsB;EACpB,YAAMiJ,kBAAkB,GAAGjJ,QAAQ,CAACK,UAAD,CAAnC;EACA,YAAM6I,eAAe,GAAGlJ,QAAQ,CAACQ,EAAjC,CAFoB;;EAIpB,YAAI+H,eAAe,GAAG,CAAlB,IAAuBW,eAAe,IAAIX,eAA1C,IAA6DR,mBAAmB,GAAG,CAAvF,EAA0F;EACxF,iBAAO,KAAP;EACD,SANmB;;;EAQpB,YAAIM,kBAAkB,GAAG,CAArB,IAA0BY,kBAAkB,IAAIZ,kBAApD,EAAwE;EACtE,iBAAO,KAAP;EACD;EACF,OAXD,MAWO;EACLrI,QAAAA,QAAQ,GAAG,EAAX;EACAN,QAAAA,OAAO,CAACzQ,KAAD,CAAP,GAAiB+Q,QAAjB;EACD;;EAED,UAAID,SAAS,GAAGL,OAAO,CAACxU,MAAD,CAAvB;;EACA,UAAI6U,SAAS,IAAI,IAAjB,EAAuB;EACrB,YAAMoJ,kBAAkB,GAAGpJ,SAAS,CAACM,UAAD,CAApC,CADqB;;EAGrB,YAAIiI,kBAAkB,GAAG,CAArB,IAA0Ba,kBAAkB,IAAIb,kBAApD,EAAwE;EACtE,iBAAO,KAAP;EACD;EACF,OAND,MAMO;EACLvI,QAAAA,SAAS,GAAG,EAAZ;EACAL,QAAAA,OAAO,CAACxU,MAAD,CAAP,GAAkB6U,SAAlB;EACD;EACF,KA9G8C;;;EAgH/C,QAAI6H,gBAAgB,CAACzc,OAAD,CAAhB,CAA0Bie,KAA1B,IAAmC,IAAnC,IAA2CxB,gBAAgB,CAACzc,OAAD,CAAhB,CAA0Bie,KAA1B,GAAkC,CAAjF,EAAoF;EAClF,UAAMA,KAAK,GAAGxB,gBAAgB,CAACzc,OAAD,CAAhB,CAA0Bie,KAAxC;EACAxB,MAAAA,gBAAgB,CAACzc,OAAD,CAAhB,CAA0Bie,KAA1B,GAAkC,CAAlC;EACAvK,MAAAA,UAAU,CAACuI,GAAD,EAAMgC,KAAK,GAAG,IAAd,EAAoB/B,GAApB,EAAyB;EACjC5Q,QAAAA,MAAM,EAAE6Q,OADyB;EAEjC5Q,QAAAA,OAAO,EAAE6Q,QAFwB;EAGjC/Q,QAAAA,OAAO,EAAEgR,QAHwB;EAIjCnZ,QAAAA,MAAM,EAAEoZ;EAJyB,OAAzB,CAAV;EAMA,aAAO,KAAP;EACD;;EACD,QAAMoB,UAAU,GAAGtB,QAAQ,CAAC7P,sBAAT,EAAnB;;EAEAoQ,IAAAA,SAAS,CAACe,UAAD,EAAaxI,UAAb,EAAyB0H,mBAAzB,CAAT;EACAD,IAAAA,SAAS,CAAC9H,QAAD,EAAWK,UAAX,EAAuB0H,mBAAvB,CAAT;EACAD,IAAAA,SAAS,CAAC/H,SAAD,EAAYM,UAAZ,EAAwB0H,mBAAxB,CAAT,CA/H+C;;EAkI/C,QAAMsB,UAAU,GAAG,EAAnB;EACAA,IAAAA,UAAU,CAAC9B,QAAQ,CAACuB,SAAV,CAAV,GAAiCD,UAAjC;EACAQ,IAAAA,UAAU,CAACpa,KAAD,CAAV,GAAoB+Q,QAApB;EACAqJ,IAAAA,UAAU,CAACne,MAAD,CAAV,GAAqB6U,SAArB;EACAJ,IAAAA,kBAAkB,CAAC0J,UAAD,CAAlB;EACD,GAvID;;EAyIA,MAAMC,eAAe,GAAG,SAAlBA,eAAkB,GAAM;EAC5B,QAAMjV,OAAO,GAAGiT,OAAO,CAACrP,OAAR,EAAhB;;EACA,QAAMsR,UAAU,GAAGhC,QAAQ,CAAC7P,sBAAT,EAAnB;;EACA,WAAO,aAAa9F,kBAAkB,CAAC2K,gBAAgB,CAAClI,OAAO,GAAG,GAAV,GAAgBkV,UAAU,CAACxE,CAA3B,GAA+B,GAA/B,GAAqCwE,UAAU,CAAC5R,CAAjD,CAAjB,CAAtC;EACD,GAJD;;EAMA,MAAM6R,eAAe,GAAG,SAAlBA,eAAkB,CAACC,OAAD,EAAU7B,gBAAV,EAA4B8B,UAA5B,EAAwC9F,KAAxC,EAA+C+F,QAA/C,EAA4D;EAClF,QAAIF,OAAO,KAAK,EAAZ,IAAkBA,OAAO,IAAI,IAAjC,EAAuC;EACrC,UAAIG,UAAJ;EACA,UAAIC,aAAJ;;EACA,UAAIF,QAAJ,EAAc;EACZC,QAAAA,UAAU,GAAGF,UAAb;EACD,OAFD,MAEO;EACLG,QAAAA,aAAa,GAAGH,UAAU,CAACxK,sBAAX,CAAkC,UAAlC,CAAhB;;EACA,YAAI2K,aAAa,IAAI,IAAjB,IAAyBA,aAAa,CAACnb,MAAd,KAAyB,CAAtD,EAAyD;EACvDkb,UAAAA,UAAU,GAAGC,aAAa,CAAC,CAAD,CAA1B;EACD;EACF;;EACD,UAAMC,MAAM,GAAGlC,gBAAgB,CAAC7D,OAAjB,CAAyB+F,MAAxC;EACA,UAAMC,SAAS,GAAGnC,gBAAgB,CAAC7D,OAAjB,CAAyBiG,OAA3C;;EACA,UAAID,SAAS,IAAI,IAAjB,EAAuB;EACrBN,QAAAA,OAAO,IAAIH,eAAe,EAA1B;EACD;;EAED,UAAIM,UAAU,IAAI,IAAlB,EAAwB;EACtBA,QAAAA,UAAU,CAACK,OAAX,GAAqB,YAAM;EACzB;EACA,cAAIH,MAAM,IAAI,IAAd,EAAoB;EAClB;EACA,gBAAIC,SAAS,IAAI,IAAjB,EAAuB;EACrB3L,cAAAA,iBAAiB,CAAC6G,WAAlB,CAA8BwE,OAA9B;EACD;;EACDS,YAAAA,gBAAgB,CAACJ,MAAD,EAASlC,gBAAT,CAAhB,CALkB;;EAOlBnE,YAAAA,WAAW,CAAC,IAAD,EAAOG,KAAP,EAAc2D,QAAQ,CAACuB,SAAvB,CAAX;EACA;EACD,WAXwB;;;EAazB,cAAIlB,gBAAgB,CAAC7D,OAAjB,CAAyB1R,MAAzB,KAAoC,CAAxC,EAA2C;EACzCA,YAAAA,MAAM,CAAC8X,IAAP,CAAYV,OAAZ,EAAqB,QAArB;EACD,WAFD,MAEO;EACLpX,YAAAA,MAAM,CAACI,QAAP,GAAkBgX,OAAlB;EACD;EACF,SAlBD;EAmBD;EACF;EACF,GAxCD;;EA0CA,MAAMS,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACJ,MAAD,EAASlC,gBAAT,EAA8B;EACrD,QAAMwC,IAAI,GAAG/X,MAAM,CAACgY,MAAP,CAAcP,MAAd,CAAb;;EACA,QAAI,OAAOM,IAAP,KAAgB,UAApB,EAAgC;EAC9B,UAAIxC,gBAAgB,CAAC7D,OAAjB,CAAyBuG,EAAzB,IAA+B,IAAnC,EAAyC;EACvCF,QAAAA,IAAI,CAACxC,gBAAgB,CAAC7D,OAAjB,CAAyBuG,EAA1B,CAAJ;EACD,OAFD,MAEO;EACLF,QAAAA,IAAI;EACL;EACF;EACF,GATD;;EAWA,MAAMG,aAAa,GAAG,SAAhBA,aAAgB,CAACd,OAAD,EAAU7B,gBAAV,EAA4B8B,UAA5B,EAAwC9F,KAAxC,EAA+C+F,QAA/C,EAA4D;EAChFa,IAAAA,mBAAmB,CAAC5C,gBAAD,CAAnB;EACA4B,IAAAA,eAAe,CAACC,OAAD,EAAU7B,gBAAV,EAA4B8B,UAA5B,EAAwC9F,KAAxC,EAA+C+F,QAA/C,CAAf;EACD,GAHD;;EAKA,MAAMa,mBAAmB,GAAG,SAAtBA,mBAAsB,CAAC5C,gBAAD,EAAsB;EAChD,QAAM/W,IAAI,GAAG,EAAb;EACAA,IAAAA,IAAI,CAACyJ,IAAL,GAAY,OAAZ;EACAzJ,IAAAA,IAAI,CAACgJ,OAAL,GAAevN,mBAAf;EACAuE,IAAAA,IAAI,CAAC2J,OAAL,uBAAkBnO,OAAlB,EAA4Bub,gBAAgB,CAACC,OAA7C;;EACAL,IAAAA,QAAQ,CAAC/M,YAAT,CAAsB5J,IAAtB;EACD,GAND;;EAQA,MAAM4Z,wBAAwB,GAAG,SAA3BA,wBAA2B,CAAC7C,gBAAD,EAAsB;EACrD,QAAMvH,UAAU,GAAGuH,gBAAgB,CAACC,OAAjB,CAAyB9V,KAAzB,CAA+B,GAA/B,EAAoC,CAApC,CAAnB;EACA,QAAM2Y,UAAU,GAAG9C,gBAAgB,CAAC7D,OAApC;;EAEA,QAAI2G,UAAU,CAACC,MAAX,KAAsB,CAA1B,EAA6B;EAC3B,aAAOC,cAAc,CAAC1c,SAAD,EAAY0Z,gBAAZ,CAArB;EACD;;EACD,QAAID,kBAAkB,CAACC,gBAAD,CAAlB,KAAyC,KAA7C,EAAoD;EAClD;EACD;;EAED,QAAMhE,KAAK,GAAG,cAAc8G,UAAU,CAACC,MAAvC;;EAEA,QAAItZ,QAAQ,CAACwS,cAAT,CAAwBD,KAAxB,KAAkC,IAAtC,EAA4C;EAC1C;EACD;;EACDjR,IAAAA,GAAG,CAACmC,cAAJ,CAAmBuL,UAAnB,IAAiCuD,KAAjC;EACA,QAAMiH,QAAQ,GAAGH,UAAU,CAACC,MAAX,KAAsB,CAAvC;EACA,QAAMG,MAAM,GAAGzZ,QAAQ,CAACgK,aAAT,CAAuB,KAAvB,CAAf;EACAyP,IAAAA,MAAM,CAACnhB,EAAP,GAAYia,KAAZ;EACA,QAAMmH,UAAU,GAAG1Y,MAAM,CAAC2Y,WAA1B;EACA,QAAMC,SAAS,GAAG5Y,MAAM,CAAC6Y,UAAzB;EACA,QAAIC,MAAM,GAAG,KAAb;;EAEA,QAAI,CAACN,QAAL,EAAe;EACb,UAAMO,YAAY,GAAGL,UAAU,GAAG,CAAb,GAAiB,GAAtC;EACA,UAAIM,aAAa,GAAG,EAApB;EACA,UAAIC,KAAK,GAAGL,SAAS,GAAG,CAAZ,GAAgB,GAA5B;EACA,UAAIM,cAAc,GAAGF,aAAa,GAAGD,YAArC;EACA,UAAII,KAAK,GAAGP,SAAS,GAAG,EAAZ,GAAiB,GAAjB,GAAuB,EAAnC;EACA,UAAIQ,UAAU,GAAG,YAAjB,CANa;;EAQb,UAAI,CAAC,UAAU1d,IAAV,CAAe2d,SAAS,CAACC,SAAzB,KAAwC,QAAQ5d,IAAR,CAAa2d,SAAS,CAACC,SAAvB,CAAzC,KAAgF,QAAQ5d,IAAR,CAAa2d,SAAS,CAACC,SAAvB,MAAsC,KAA1H,EAAiI;EAC/HH,QAAAA,KAAK,GAAGP,SAAS,GAAG,EAAZ,GAAiB,GAAjB,GAAuB,EAA/B;EACAK,QAAAA,KAAK,GAAGL,SAAS,GAAG,CAAZ,GAAgB,GAAxB;EACAM,QAAAA,cAAc,GAAGR,UAAU,GAAG,CAAb,GAAiB,GAAlC;EACAU,QAAAA,UAAU,GAAG,YAAb,CAJ+H;EAMhI,OAND,MAMO,IAAI,kBAAkBpZ,MAAlB,IAA6B,UAAUtE,IAAV,CAAe2d,SAAS,CAACC,SAAzB,CAAjC,EAAuE;EAC5EH,QAAAA,KAAK,GAAGP,SAAS,GAAG,EAAZ,GAAiB,GAAjB,GAAuB,EAA/B;EACAK,QAAAA,KAAK,GAAGL,SAAS,GAAG,CAAZ,GAAgB,GAAxB;EACAM,QAAAA,cAAc,GAAGR,UAAU,GAAG,CAAb,GAAiB,GAAlC;EACAU,QAAAA,UAAU,GAAG,YAAb;EACD,OAnBY;;;EAqBb,UAAIf,UAAU,CAACkB,KAAX,IAAoB,IAAxB,EAA8B;EAC5BT,QAAAA,MAAM,GAAG,IAAT;EACAL,QAAAA,MAAM,CAACzL,YAAP,CAAoB,OAApB,EAA6B,2CAA2CkM,cAA3C,GAA4D,sBAA5D,GAAqFC,KAArF,GAA6F,sBAA7F,GAAsHF,KAAtH,GAA8H,kDAA3J;EACD,OAHD,MAGO;EACLR,QAAAA,MAAM,CAACzL,YAAP,CAAoB,OAApB,EAA6BoM,UAAU,GAAGf,UAAU,CAACmB,WAArD;EACD;EACF,KA3BD,MA2BO;EACLf,MAAAA,MAAM,CAACzL,YAAP,CAAoB,OAApB,EAA6BqL,UAAU,CAACmB,WAAxC;EACD;;EACDxa,IAAAA,QAAQ,CAACya,IAAT,CAActM,WAAd,CAA0BsL,MAA1B;EACA,QAAMiB,MAAM,GAAG1a,QAAQ,CAACgK,aAAT,CAAuB,QAAvB,CAAf;EAEA,QAAM2Q,YAAY,GAAGtB,UAAU,CAACuB,EAAX,KAAkB,KAAlB,GAA0B,GAA1B,GAAgC,GAArD;EAEAF,IAAAA,MAAM,CAACG,WAAP,GAAqB,KAArB;EACAH,IAAAA,MAAM,CAACI,YAAP,GAAsB,KAAtB;EACAJ,IAAAA,MAAM,CAACK,WAAP,GAAqB,KAArB;EACAL,IAAAA,MAAM,CAACM,SAAP,GAAmB,IAAnB;EACAN,IAAAA,MAAM,CAACpiB,EAAP,GAAY,YAAZ;EACA,QAAM8f,OAAO,GAAG7B,gBAAgB,CAAC7D,OAAjB,CAAyB0F,OAAzC;EACA,QAAI6C,UAAU,GAAG,EAAjB;;EACA,QAAI7C,OAAO,KAAK,EAAZ,IAAkBA,OAAO,IAAI,IAAjC,EAAuC;EACrC6C,MAAAA,UAAU,GAAG,iBAAb;EACD;;EAED,QAAIC,IAAJ,CAtEqD;;EAwErD,QAAI3E,gBAAgB,CAAC4E,UAAjB,CAA4BlS,IAA5B,KAAqC,CAAzC,EAA4C;EAC1CiS,MAAAA,IAAI,GAAG3E,gBAAgB,CAAC4E,UAAjB,CAA4BD,IAAnC;EACAA,MAAAA,IAAI,GAAGA,IAAI,CAACxd,OAAL,CAAa,iBAAb,EAAgCsR,UAAhC,CAAP;EACD,KAHD,MAGO;EACL,UAAMoM,GAAG,GAAG,KACV,yBADU,GAEV,2BAFU,GAGV,+DAHU,GAGwDH,UAHxD,GAGqE,GAHrE,GAIV,yCAJU,GAKV,+GALU,GAMV,8GANU,GAOV,2BAPU,GAQV,gEARU,GAQyDN,YARzD,GAQwE,sCARxE,GASV,+PATU,GAUV,0GAVU,GAWV,yGAXU,GAYV,yBAZU,GAaV,qEAbU,GAcV,UAdF;EAgBA,UAAIU,OAAJ,EAAaC,SAAb,EAAwBC,KAAxB,EAA+BC,MAA/B,EAAuCC,OAAvC;;EACA,UAAIlF,gBAAgB,CAAC7D,OAAjB,CAAyBgJ,KAAzB,KAAmC,MAAvC,EAA+C;EAC7CL,QAAAA,OAAO,GAAG,SAAV;EACAC,QAAAA,SAAS,GAAG,SAAZ;EACAC,QAAAA,KAAK,GAAG,SAAR;EACAC,QAAAA,MAAM,GAAG,SAAT;EACAC,QAAAA,OAAO,GAAG,SAAV;EACD,OAND,MAMO;EACLJ,QAAAA,OAAO,GAAG,SAAV;EACAC,QAAAA,SAAS,GAAG,SAAZ;EACAE,QAAAA,MAAM,GAAG,SAAT;EACAD,QAAAA,KAAK,GAAG,SAAR;EACAE,QAAAA,OAAO,GAAG,SAAV;EACD;;EACD,UAAME,SAAS,GAAGpF,gBAAgB,CAAC4E,UAAjB,CAA4BS,KAA9C;EACA,UAAMC,eAAe,GAAGtF,gBAAgB,CAAC4E,UAAjB,CAA4BW,WAApD;EACA,UAAIC,OAAO,GAAG,EAAd;;EACA,UAAIxF,gBAAgB,CAAC4E,UAAjB,CAA4Ba,QAA5B,IAAwC,IAAxC,IAAgDzF,gBAAgB,CAAC4E,UAAjB,CAA4Ba,QAA5B,KAAyC,EAA7F,EAAiG;EAC/FD,QAAAA,OAAO,GAAG,+CAA+CP,MAA/C,GAAwD,cAAxD,GAAyEjF,gBAAgB,CAAC4E,UAAjB,CAA4Ba,QAArG,GAAgH,gCAA1H;EACD;;EACD,UAAMC,UAAU,GAAG,iCAAiCjN,UAAjC,GAA8C,IAA9C,GAAqDuD,KAArD,GAA6D,KAAhF;EACA,UAAMqJ,KAAK,GAAG,0CAA0CN,SAA1C,GAAsD,oBAAtD,GAA6ED,OAA7E,GAAuF,KAAvF,GACZ,wCADY,GAC+BY,UAD/B,GAC4C,6CAD5C,GAC4FV,KAD5F,GACoG,SADpG,GACgHE,OADhH,GAC0H,eAD1H,GAEZ,oCAFY,GAGZ,oDAHY;EAKZ,YALY,GAKHM,OALG,GAKO,kCALP,GAMZ,wCANY,GAM+BT,SAN/B,GAM2C,IAN3C,GAMkDK,SANlD,GAM8D,QAN5E;EAOA,UAAMlB,IAAI,GAAG,0CAA0Ca,SAA1C,GAAsD,IAAtD,GAA6DO,eAA7D,GAA+E,+BAA5F;EACAX,MAAAA,IAAI,GAAGE,GAAG,GAAGQ,KAAN,GAAcnB,IAArB;EACD;;EAEDC,IAAAA,MAAM,CAAC1M,YAAP,CAAoB,OAApB,EAA6B,kHAA7B;EACAyL,IAAAA,MAAM,CAACtL,WAAP,CAAmBuM,MAAnB;EACA,QAAMwB,IAAI,GAAIxB,MAAM,CAACyB,aAAR,GAAyBzB,MAAM,CAACyB,aAAhC,GAAiDzB,MAAM,CAAC0B,eAAP,CAAuBpc,QAAxB,GAAoC0a,MAAM,CAAC0B,eAAP,CAAuBpc,QAA3D,GAAsE0a,MAAM,CAAC0B,eAA1I;EACA,QAAMC,GAAG,GAAGH,IAAI,CAAClc,QAAjB;EAEAqc,IAAAA,GAAG,CAACvD,IAAJ;EACAuD,IAAAA,GAAG,CAACC,KAAJ,CAAUpB,IAAV;EACAmB,IAAAA,GAAG,CAACE,KAAJ;;EAEA,QAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,GAAM;EAC/B;EACAxC,MAAAA,aAAa,GAAGha,QAAQ,CAACwS,cAAT,CAAwB,YAAxB,EAAsC4J,eAAtC,CAAsD5J,cAAtD,CAAqE,YAArE,EAAmFiK,YAAnG;;EACA,UAAIpD,UAAU,CAAC,eAAD,CAAV,KAAgC,IAAhC,IAAwC,CAACG,QAA7C,EAAuD;EACrDQ,QAAAA,aAAa,IAAI,EAAjB;EACD;;EACDha,MAAAA,QAAQ,CAACwS,cAAT,CAAwB,YAAxB,EAAsC4J,eAAtC,CAAsD3B,IAAtD,CAA2DhI,KAA3D,CAAiEiK,MAAjE,GAA0E,KAA1E;EACA1c,MAAAA,QAAQ,CAACwS,cAAT,CAAwB,YAAxB,EAAsCC,KAAtC,CAA4CkK,MAA5C,GAAqD3C,aAAa,GAAG,IAArE;EACD,KARD;;EAUA,QAAM4C,EAAE,GAAGvC,SAAS,CAACC,SAAV,CAAoBuC,WAApB,EAAX;;EACA,QAAID,EAAE,CAAC9b,OAAH,CAAW,QAAX,MAAyB,CAAC,CAA9B,EAAiC;EAC/B,UAAI8b,EAAE,CAAC9b,OAAH,CAAW,QAAX,IAAuB,CAAC,CAA5B,EAA+B;EAC7B4Z,QAAAA,MAAM,CAACoC,MAAP,GAAgB,YAAM;EACpBN,UAAAA,kBAAkB;EAClB,cAAMnE,UAAU,GAAGrY,QAAQ,CAACwS,cAAT,CAAwB,YAAxB,EAAsC4J,eAAtC,CAAsD5J,cAAtD,CAAqE,YAArE,CAAnB;EACA0G,UAAAA,aAAa,CAACd,OAAD,EAAU7B,gBAAV,EAA4B8B,UAA5B,EAAwC9F,KAAxC,EAA+CuH,MAA/C,CAAb;EACD,SAJD;EAKD,OAND,MAMO;EACL,YAAIiD,KAAK,GAAGrC,MAAM,CAAC0B,eAAP,IAA0B1B,MAAM,CAACyB,aAA7C;EACA,YAAIY,KAAK,CAAC/c,QAAV,EAAoB+c,KAAK,GAAGA,KAAK,CAAC/c,QAAd,CAFf;;EAILwc,QAAAA,kBAAkB;;EAClB,YAAMQ,MAAM,GAAGC,WAAW,CAAC,YAAM;EAC/B,cAAIF,KAAK,CAACG,UAAN,KAAqB,UAAzB,EAAqC;EACnCC,YAAAA,aAAa,CAACH,MAAD,CAAb,CADmC;;EAGnCR,YAAAA,kBAAkB;EAClB,gBAAMnE,UAAU,GAAGrY,QAAQ,CAACwS,cAAT,CAAwB,YAAxB,EAAsC4J,eAAtC,CAAsD5J,cAAtD,CAAqE,YAArE,CAAnB;EACA0G,YAAAA,aAAa,CAACd,OAAD,EAAU7B,gBAAV,EAA4B8B,UAA5B,EAAwC9F,KAAxC,EAA+CuH,MAA/C,CAAb;EACD;EACF,SARyB,EAQvB,EARuB,CAA1B;EASD;EACF,KAtBD,MAsBO;EACLY,MAAAA,MAAM,CAACoC,MAAP,GAAgB,YAAM;EACpB;EACAN,QAAAA,kBAAkB;EAClB,YAAMnE,UAAU,GAAGrY,QAAQ,CAACwS,cAAT,CAAwB,YAAxB,EAAsC4J,eAAtC,CAAsD5J,cAAtD,CAAqE,YAArE,CAAnB;EACA0G,QAAAA,aAAa,CAACd,OAAD,EAAU7B,gBAAV,EAA4B8B,UAA5B,EAAwC9F,KAAxC,EAA+CuH,MAA/C,CAAb;EACD,OALD;EAMD;EACF,GA9KD;;EAgLA,MAAIsD,eAAe,GAAG,KAAtB;;EAEA,MAAMC,sBAAsB,GAAG,SAAzBA,sBAAyB,CAAC9G,gBAAD,EAAsB;EACnD,QAAI6B,OAAO,GAAG7B,gBAAgB,CAAC7D,OAAjB,CAAyB0F,OAAvC,CADmD;;EAInD,QAAIpX,MAAM,CAACyM,SAAP,CAAiBtR,cAAjB,CAAgC,sBAAhC,KACF,OAAO6E,MAAM,CAACyM,SAAP,CAAiB6P,oBAAxB,KAAiD,WAD/C,IAEF,OAAOtc,MAAM,CAACyM,SAAP,CAAiB6P,oBAAxB,KAAiD,UAFnD,EAE+D;EAC7D,UAAMA,oBAAoB,GAAGtc,MAAM,CAACyM,SAAP,CAAiB6P,oBAA9C;;EAEA,UAAI,CAACF,eAAL,EAAsB;EACpB,YAAMG,MAAM,GAAG,EAAf;EACAA,QAAAA,MAAM,CAACpC,UAAP,GAAoB5E,gBAAgB,CAAC4E,UAArC;EACAoC,QAAAA,MAAM,CAACC,KAAP,GAAejH,gBAAgB,CAACC,OAAhC;;EACA,YAAID,gBAAgB,CAAC7D,OAAjB,CAAyBuG,EAAzB,IAA+B,IAAnC,EAAyC;EACvCsE,UAAAA,MAAM,CAACtE,EAAP,GAAY1C,gBAAgB,CAAC7D,OAAjB,CAAyBuG,EAArC;EACD;;EAEDjY,QAAAA,MAAM,CAACyM,SAAP,CAAiBgQ,wBAAjB,GAA4C,YAAM;EAChD,cAAIrF,OAAO,KAAK,EAAZ,IAAkBA,OAAO,IAAI,IAAjC,EAAuC;EACrC,gBAAMK,MAAM,GAAGlC,gBAAgB,CAAC7D,OAAjB,CAAyB+F,MAAxC;EACAL,YAAAA,OAAO,IAAIH,eAAe,EAA1B,CAFqC;;EAKrC,gBAAIQ,MAAM,IAAI,IAAd,EAAoB;EAClB;EACA1L,cAAAA,iBAAiB,CAAC6G,WAAlB,CAA8BwE,OAA9B;EACAS,cAAAA,gBAAgB,CAACJ,MAAD,EAASlC,gBAAT,CAAhB;EACA;EACD,aAVoC;;;EAYrC,gBAAIA,gBAAgB,CAAC7D,OAAjB,CAAyB1R,MAAzB,KAAoC,CAAxC,EAA2C;EACzCA,cAAAA,MAAM,CAAC8X,IAAP,CAAYV,OAAZ,EAAqB,QAArB;EACD,aAFD,MAEO;EACLpX,cAAAA,MAAM,CAACI,QAAP,GAAkBgX,OAAlB;EACD;EACF;EACF,SAnBD;;EAoBApX,QAAAA,MAAM,CAACyM,SAAP,CAAiBiQ,uBAAjB,GAA2C,YAAM;EAC/CvE,UAAAA,mBAAmB,CAAC5C,gBAAD,CAAnB;EACD,SAFD;;EAGA+G,QAAAA,oBAAoB,CAACC,MAAD,CAApB;EACAH,QAAAA,eAAe,GAAG,IAAlB;EACD;EACF,KAvCD,MAuCO;EACLhE,MAAAA,wBAAwB,CAAC7C,gBAAD,CAAxB;;EAEA,UAAIvV,MAAM,CAACyM,SAAP,CAAiBtR,cAAjB,CAAgC,eAAhC,KACF,OAAO6E,MAAM,CAACyM,SAAP,CAAiBkQ,aAAxB,KAA0C,WADxC,IAEF,OAAO3c,MAAM,CAACyM,SAAP,CAAiBkQ,aAAxB,KAA0C,UAF5C,EAEwD;EACtD,YAAMA,aAAa,GAAG3c,MAAM,CAACyM,SAAP,CAAiBkQ,aAAvC;EAEA,YAAMJ,OAAM,GAAG,EAAf;EACAA,QAAAA,OAAM,CAACpC,UAAP,GAAoB5E,gBAAgB,CAAC4E,UAArC;EACAoC,QAAAA,OAAM,CAACC,KAAP,GAAejH,gBAAgB,CAACC,OAAhC;EAEA,YAAIoH,OAAO,GAAG,EAAd;;EACA,aAAK,IAAIC,aAAT,IAA0BtH,gBAA1B,EAA4C;EAC1C;EACA,cAAIsH,aAAa,CAACC,UAAd,CAAyB/iB,WAAzB,KAAyC8iB,aAAa,KAAK7iB,OAA/D,EAAwE;EACtE,gBAAM+iB,QAAQ,uBAAMF,aAAN,EAAsBtH,gBAAgB,CAACsH,aAAD,CAAtC,CAAd;;EACAD,YAAAA,OAAO,CAACtZ,IAAR,CAAayZ,QAAb;EACD;EACF;;EAED,YAAIH,OAAO,CAACvgB,MAAR,GAAiB,CAArB,EAAwB;EACtBkgB,UAAAA,OAAM,CAACK,OAAP,GAAiBA,OAAjB;EACD;;EACD,YAAIrH,gBAAgB,CAAC7D,OAAjB,CAAyBuG,EAAzB,IAA+B,IAAnC,EAAyC;EACvCsE,UAAAA,OAAM,CAACtE,EAAP,GAAY1C,gBAAgB,CAAC7D,OAAjB,CAAyBuG,EAArC;EACD,SArBqD;;;EAwBtDjY,QAAAA,MAAM,CAACyM,SAAP,CAAiBuQ,6BAAjB,GAAiD,UAACC,gBAAD,EAAsB;EACrE,cAAI,CAACA,gBAAD,IAAqB,CAACA,gBAAgB,CAACT,KAA3C,EAAkD;EAAE;EAAQ;;EAE5D,cAAMU,SAAS,GAAG,EAAlB;EACAA,UAAAA,SAAS,CAACjV,IAAV,GAAiB,OAAjB;EACAiV,UAAAA,SAAS,CAAC1V,OAAV,GAAoBtN,oBAApB;EACAgjB,UAAAA,SAAS,CAAC/U,OAAV,uBAAuBnO,OAAvB,EAAiCijB,gBAAgB,CAACT,KAAlD,EANqE;;EASrE,cAAIS,gBAAgB,CAACL,OAArB,EAA8B;EAAA,uDACFK,gBAAgB,CAACL,OADf;EAAA;;EAAA;EAC5B,kEAAoD;EAAA,oBAA3CO,aAA2C;EAClDD,gBAAAA,SAAS,CAAC/U,OAAV,qCAAyB+U,SAAS,CAAC/U,OAAnC,GAA+CgV,aAA/C;EACD;EAH2B;EAAA;EAAA;EAAA;EAAA;EAI7B;;EAEDhI,UAAAA,QAAQ,CAAC/M,YAAT,CAAsB8U,SAAtB;EACD,SAhBD;;EAiBAP,QAAAA,aAAa,CAACJ,OAAD,CAAb;EACD;EACF;EACF,GA5FD;;EA6FA,MAAIa,aAAJ;;EACA,MAAM7E,cAAc,GAAG,SAAjBA,cAAiB,CAAC8E,KAAD,EAAQC,SAAR,EAAsB;EAC3C,QAAI/H,gBAAJ;;EACA,QAAI8H,KAAK,IAAI,IAAT,IAAiBA,KAAK,CAACE,OAAN,GAAgB,CAArC,EAAwC;EACtC;EACD;;EACD,QAAID,SAAS,IAAI,IAAjB,EAAuB;EACrB/H,MAAAA,gBAAgB,GAAG6H,aAAnB;EACD,KAFD,MAEO;EACL7H,MAAAA,gBAAgB,GAAG+H,SAAnB;EACD;;EAED,QAAIte,QAAQ,CAACwS,cAAT,CAAwB,eAAxB,KAA4C,IAAhD,EAAsD;EACpD;EACD,KAb0C;;;EAe3C,QAAI+D,gBAAgB,CAAC7D,OAAjB,CAAyB4G,MAAzB,IAAmC,IAAnC,KACA,UAAU5c,IAAV,CAAe2d,SAAS,CAACC,SAAzB,CAAD,IAA0C,QAAQ5d,IAAR,CAAa2d,SAAS,CAACC,SAAvB,CAA1C,IAAiF,QAAQ5d,IAAR,CAAa2d,SAAS,CAACC,SAAvB,CAAjF,IACE,kBAAkBtZ,MADpB,IACgC,UAAUtE,IAAV,CAAe2d,SAAS,CAACC,SAAzB,CAF/B,CAAJ,EAE0E;EACxE;EACD;;EAED,QAAMtL,UAAU,GAAGuH,gBAAgB,CAACC,OAAjB,CAAyB9V,KAAzB,CAA+B,GAA/B,EAAoC,CAApC,CAAnB;;EACA,QAAI4V,kBAAkB,CAACC,gBAAD,CAAlB,KAAyC,KAA7C,EAAoD;EAClD;EACD;;EAEDjV,IAAAA,GAAG,CAACmC,cAAJ,CAAmBuL,UAAnB,IAAiC,eAAjC;EACA,QAAI8K,MAAM,GAAG,KAAb;EACA,QAAM0E,UAAU,GAAGxe,QAAQ,CAACgK,aAAT,CAAuB,KAAvB,CAAnB;EACAwU,IAAAA,UAAU,CAAClmB,EAAX,GAAgB,kBAAhB;EACAkmB,IAAAA,UAAU,CAACxQ,YAAX,CAAwB,OAAxB,EAAiC,oHAAjC;EACAhO,IAAAA,QAAQ,CAACya,IAAT,CAActM,WAAd,CAA0BqQ,UAA1B;EAEA,QAAM/E,MAAM,GAAGzZ,QAAQ,CAACgK,aAAT,CAAuB,KAAvB,CAAf;EACAyP,IAAAA,MAAM,CAACnhB,EAAP,GAAY,eAAZ;;EAEA,QAAIie,gBAAgB,CAAC7D,OAAjB,CAAyB6H,KAAzB,IAAkC,IAAtC,EAA4C;EAC1CT,MAAAA,MAAM,GAAG,IAAT;EACAL,MAAAA,MAAM,CAACzL,YAAP,CAAoB,OAApB,EAA6B,4LAA7B;EACD,KAHD,MAGO;EACLyL,MAAAA,MAAM,CAACzL,YAAP,CAAoB,OAApB,EAA6BuI,gBAAgB,CAAC7D,OAAjB,CAAyB8H,WAAtD;EACD;;EACDxa,IAAAA,QAAQ,CAACya,IAAT,CAActM,WAAd,CAA0BsL,MAA1B;EACA,QAAMiB,MAAM,GAAG1a,QAAQ,CAACgK,aAAT,CAAuB,QAAvB,CAAf;EACA,QAAM2Q,YAAY,GAAGpE,gBAAgB,CAAC7D,OAAjB,CAAyBkI,EAAzB,KAAgC,KAAhC,GAAwC,GAAxC,GAA8C,GAAnE;EACAF,IAAAA,MAAM,CAACG,WAAP,GAAqB,KAArB;EACAH,IAAAA,MAAM,CAACI,YAAP,GAAsB,KAAtB;EACAJ,IAAAA,MAAM,CAACK,WAAP,GAAqB,KAArB;EACAL,IAAAA,MAAM,CAACM,SAAP,GAAmB,IAAnB;EACAN,IAAAA,MAAM,CAACpiB,EAAP,GAAY,mBAAZ;EACA,QAAM8f,OAAO,GAAG7B,gBAAgB,CAAC7D,OAAjB,CAAyB0F,OAAzC;EACA,QAAI6C,UAAU,GAAG,EAAjB;;EACA,QAAI7C,OAAO,KAAK,EAAZ,IAAkBA,OAAO,IAAI,IAAjC,EAAuC;EACrC6C,MAAAA,UAAU,GAAG,iBAAb;EACD;;EACD,QAAIC,IAAJ,CAvD2C;;EAyD3C,QAAI3E,gBAAgB,CAAC4E,UAAjB,CAA4BlS,IAA5B,KAAqC,CAAzC,EAA4C;EAC1CiS,MAAAA,IAAI,GAAG3E,gBAAgB,CAAC4E,UAAjB,CAA4BD,IAAnC;EACAA,MAAAA,IAAI,GAAGA,IAAI,CAACxd,OAAL,CAAa,iBAAb,EAAgCsR,UAAhC,CAAP;EACD,KAHD,MAGO;EACL,UAAMoM,GAAG,GAAG,KACV,yBADU,GAEV,2BAFU,GAGV,wEAHU,GAGiEH,UAHjE,GAG8E,GAH9E,GAIV,yCAJU,GAKV,4GALU,GAMV,wJANU,GAOV,2BAPU,GAQV,gEARU,GAQyDN,YARzD,GAQwE,sCARxE,GASV,+PATU,GAUV,0GAVU,GAWV,yGAXU,GAYV,wCAZU,GAaV,qRAbU,GAcV,UAdF;EAgBA,UAAIU,OAAJ,EAAaC,SAAb,EAAwBC,KAAxB,EAA+BE,OAA/B;;EACA,UAAIlF,gBAAgB,CAAC7D,OAAjB,CAAyBgJ,KAAzB,KAAmC,MAAvC,EAA+C;EAC7CL,QAAAA,OAAO,GAAG,SAAV;EACAC,QAAAA,SAAS,GAAG,SAAZ;EACAC,QAAAA,KAAK,GAAG,SAAR;EACAE,QAAAA,OAAO,GAAG,SAAV;EACD,OALD,MAKO;EACLJ,QAAAA,OAAO,GAAG,SAAV;EACAC,QAAAA,SAAS,GAAG,SAAZ;EACAC,QAAAA,KAAK,GAAG,SAAR;EACAE,QAAAA,OAAO,GAAG,SAAV;EACD;;EACD,UAAME,SAAS,GAAGpF,gBAAgB,CAAC4E,UAAjB,CAA4BS,KAA9C;EACA,UAAMC,eAAe,GAAGtF,gBAAgB,CAAC4E,UAAjB,CAA4BW,WAApD;EACA,UAAI2C,OAAO,GAAG,EAAd;;EACA,UAAIlI,gBAAgB,CAAC4E,UAAjB,CAA4BsD,OAA5B,IAAuC,IAAvC,IAA+ClI,gBAAgB,CAAC4E,UAAjB,CAA4BsD,OAA5B,KAAwC,EAA3F,EAA+F;EAC7FA,QAAAA,OAAO,GAAG,qCAAqClI,gBAAgB,CAAC4E,UAAjB,CAA4BsD,OAAjE,GAA2E,YAArF;EACD;;EAED,UAAI1C,OAAO,GAAG,EAAd;;EACA,UAAIxF,gBAAgB,CAAC4E,UAAjB,CAA4Ba,QAA5B,IAAwC,IAAxC,IAAgDzF,gBAAgB,CAAC4E,UAAjB,CAA4Ba,QAA5B,KAAyC,EAA7F,EAAiG;EAC/FD,QAAAA,OAAO,GAAG,8CAA8CxF,gBAAgB,CAAC4E,UAAjB,CAA4Ba,QAA1E,GAAqF,oBAArF,GAA4GL,SAA5G,GAAwH,WAAlI;EACD;;EACD,UAAMM,UAAU,GAAG,iCAAiCjN,UAAjC,GAA8C,oBAAjE;EACA,UAAM4M,KAAK,GAAG,0CAA0CN,SAA1C,GAAsD,oBAAtD,GAA6ED,OAA7E,GAAuF,KAAvF,GACZ,wCADY,GAC+BY,UAD/B,GAC4C,6CAD5C,GAC4FV,KAD5F,GACoG,SADpG,GACgHE,OADhH,GAC0H,eAD1H,GAEZ,oCAFY,GAGZ,wCAHY,GAG+BH,SAH/B,GAG2C,IAH3C,GAGkDK,SAHlD,GAG8D,QAH5E;EAIA,UAAMlB,IAAI,GAAG,0CAA0Ca,SAA1C,GAAsD,IAAtD,GAA6DO,eAA7D,GAA+E,QAA/E,GAA0FE,OAA1F,GAAoG0C,OAApG,GACX,cADF;EAEAvD,MAAAA,IAAI,GAAGE,GAAG,GAAGQ,KAAN,GAAcnB,IAArB;EACD;;EACDC,IAAAA,MAAM,CAAC1M,YAAP,CAAoB,OAApB,EAA6B,qKAA7B;EACAyL,IAAAA,MAAM,CAACtL,WAAP,CAAmBuM,MAAnB;EACA,QAAMwB,IAAI,GAAIxB,MAAM,CAACyB,aAAR,GAAyBzB,MAAM,CAACyB,aAAhC,GAAiDzB,MAAM,CAAC0B,eAAP,CAAuBpc,QAAxB,GAAoC0a,MAAM,CAAC0B,eAAP,CAAuBpc,QAA3D,GAAsE0a,MAAM,CAAC0B,eAA1I;EACA,QAAMC,GAAG,GAAGH,IAAI,CAAClc,QAAjB;EAEAqc,IAAAA,GAAG,CAACvD,IAAJ;EACAuD,IAAAA,GAAG,CAACC,KAAJ,CAAUpB,IAAV;EACAmB,IAAAA,GAAG,CAACE,KAAJ;EAEA,QAAMlE,UAAU,GAAGrY,QAAQ,CAACwS,cAAT,CAAwB,mBAAxB,EAA6C4J,eAA7C,CAA6D5J,cAA7D,CAA4E,YAA5E,CAAnB;EACA0G,IAAAA,aAAa,CAACd,OAAD,EAAU7B,gBAAV,EAA4B8B,UAA5B,EAAwC,eAAxC,EAAyDyB,MAAzD,CAAb;EACD,GAxHD;;EA0HA,MAAI,CAAC9Z,QAAQ,CAACya,IAAd,EAAoB;EAClB,QAAIpE,WAAW,GAAG,CAAlB,EAAqB;EACnBA,MAAAA,WAAW;EACX7I,MAAAA,UAAU,CAACuI,GAAD,EAAM,IAAN,EAAYC,GAAZ,EAAiB;EACzB5Q,QAAAA,MAAM,EAAE6Q,OADiB;EAEzB5Q,QAAAA,OAAO,EAAE6Q,QAFgB;EAGzB/Q,QAAAA,OAAO,EAAEgR,QAHgB;EAIzBnZ,QAAAA,MAAM,EAAEoZ;EAJiB,OAAjB,CAAV;EAMD;;EACD;EACD;;EACD,MAAIJ,GAAG,CAAC0I,YAAJ,IAAoB,IAAxB,EAA8B;EAC5B,SAAK,IAAI/Z,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGqR,GAAG,CAAC0I,YAAJ,CAAiBrhB,MAA7C,EAAqDsH,KAAK,EAA1D,EAA8D;EAC5D,UAAMga,WAAW,GAAG3I,GAAG,CAAC0I,YAAJ,CAAiB/Z,KAAjB,CAApB;;EACA,UAAIga,WAAW,CAACjM,OAAZ,CAAoBkM,YAApB,IAAoC,IAApC,IAA4CD,WAAW,CAACjM,OAAZ,CAAoBkM,YAApB,KAAqC,CAArF,EAAwF;EACtFvB,QAAAA,sBAAsB,CAACsB,WAAD,CAAtB;EACD,OAFD,MAEO,IAAIA,WAAW,CAACjM,OAAZ,CAAoBkM,YAApB,KAAqC,CAAzC,EAA4C;EAAE;EACnDR,QAAAA,aAAa,GAAGO,WAAhB;EACA3d,QAAAA,MAAM,CAAChB,QAAP,CAAgBya,IAAhB,CAAqBoE,YAArB,GAAoCtF,cAApC;EACD;EACF;EACF;;EAED,MAAMuF,aAAa,GAAG,SAAhBA,aAAgB,CAACC,SAAD,EAAe;EACnC,QAAIzd,GAAG,CAAC+B,eAAJ,IAAuB,IAA3B,EAAiC;EAC/B/B,MAAAA,GAAG,CAAC+B,eAAJ,GAAsBnE,gBAAc,CAACiD,kBAAf,CAAkC3I,SAAlC,CAAtB;;EACA,UAAI8H,GAAG,CAAC+B,eAAJ,IAAuB,IAA3B,EAAiC;EAC/B/B,QAAAA,GAAG,CAAC+B,eAAJ,GAAsB0b,SAAtB;EACA;EACD;EACF;;EACD,SAAK,IAAM9hB,GAAX,IAAkB8hB,SAAlB,EAA6B;EAC3B,UAAIA,SAAS,CAAC5iB,cAAV,CAAyBc,GAAzB,CAAJ,EAAmC;EACjC,YAAM+hB,SAAS,GAAG1d,GAAG,CAAC+B,eAAJ,CAAoBpG,GAApB,CAAlB;EACA,YAAMgiB,SAAS,GAAGF,SAAS,CAAC9hB,GAAD,CAA3B;;EACA,YAAIqE,GAAG,CAAC+B,eAAJ,CAAoBpG,GAApB,KAA4B,IAAhC,EAAsC;EACpC,cAAIgiB,SAAS,CAAC,CAAD,CAAT,IAAgB,IAAhB,IAAwBA,SAAS,CAAC,CAAD,CAAT,GAAeD,SAAS,CAAC,CAAD,CAApD,EAAyD;EACvD1d,YAAAA,GAAG,CAAC+B,eAAJ,CAAoBpG,GAApB,IAA2BgiB,SAA3B;EACD;EACF,SAJD,MAIO;EACL3d,UAAAA,GAAG,CAAC+B,eAAJ,CAAoBpG,GAApB,IAA2BgiB,SAA3B;EACD;EACF;EACF;EACF,GArBD;;EAuBA,MAAI/f,gBAAc,CAACC,wBAAf,EAAJ,EAA+C;EAC7C,QAAI;EACF,UAAI6W,GAAG,CAACkJ,IAAJ,IAAY,IAAhB,EAAsB;EACpB,YAAMC,SAAS,GAAGnJ,GAAG,CAACkJ,IAAJ,CAASE,MAA3B;EACA,YAAMC,UAAU,GAAGrJ,GAAG,CAACkJ,IAAJ,CAAS3K,OAA5B;EACA,YAAM+K,UAAU,GAAGtJ,GAAG,CAACkJ,IAAJ,CAASK,UAA5B;EACA,YAAMC,GAAG,GAAGxhB,MAAM,EAAlB;EACAkB,QAAAA,gBAAc,CAACqD,WAAf,CAA2B,QAA3B,EAAqCid,GAArC;EACAtgB,QAAAA,gBAAc,CAACqD,WAAf,CAA2B,MAA3B,EAAmC+c,UAAnC;EACAR,QAAAA,aAAa,CAACK,SAAD,CAAb;EACAjgB,QAAAA,gBAAc,CAACmD,gBAAf,CAAgC7I,SAAhC,EAA2C8H,GAAG,CAAC+B,eAA/C;;EACA,YAAI/B,GAAG,CAAC8B,gBAAJ,IAAwB,IAA5B,EAAkC;EAChC6O,UAAAA,oBAAoB,CAACoN,UAAD,EAAa,IAAb,CAApB;EACD,SAFD,MAEO;EACLpN,UAAAA,oBAAoB,CAACoN,UAAD,EAAa,KAAb,CAApB;EACD;EACF;;EACD,UAAIrJ,GAAG,CAACrD,GAAJ,IAAW,IAAf,EAAqB;EACnBA,QAAAA,GAAG,CAACqD,GAAG,CAACrD,GAAL,CAAH;EACD;;EACD,UAAIqD,GAAG,CAACyJ,WAAJ,IAAmB,IAAvB,EAA6B;EAC3B,YAAMpR,OAAO,GAAGD,iBAAiB,EAAjC;EACA,YAAMM,SAAS,GAAGL,OAAO,CAAC/I,MAA1B;;EACA,YAAIoJ,SAAS,IAAI,IAAjB,EAAuB;EACrB,eAAK,IAAM/N,GAAX,IAAkBqV,GAAG,CAACyJ,WAAtB,EAAmC;EACjC,gBAAIzJ,GAAG,CAACyJ,WAAJ,CAAgBtjB,cAAhB,CAA+BwE,GAA/B,CAAJ,EAAyC;EACvC,qBAAO+N,SAAS,CAACsH,GAAG,CAACyJ,WAAJ,CAAgB9e,GAAhB,CAAD,CAAhB;EACD;EACF;EACF;;EACD2N,QAAAA,kBAAkB,CAACD,OAAD,CAAlB;EACD;EACF,KA/BD,CA+BE,OAAO1O,CAAP,EAAU;EACVyW,MAAAA,OAAO,CAACtP,KAAR,CAAc,iCAAiCnH,CAA/C;EACD;EACF;EACF,CA1rBD;;;;MC5BqB+f;EAGnB,sBAEG;EAAA,QADDpX,uBACC,QADDA,uBACC;;EAAA;;EAAA;EAAA;EAAA;EAAA;EACD,gGAAgCA,uBAAhC;EACD;;;;uCAEiB;EAChB,UAAI,6BAAC,IAAD,2DAAJ,EAAsC;EACpC;EACD;;EACD,UAAIqX,UAAU,GAAGzgB,gBAAc,CAACoD,WAAf,CAA2B,IAA3B,CAAjB;;EACA,UAAIqd,UAAU,IAAI,IAAlB,EAAwB;EACtBA,QAAAA,UAAU,GAAG,CAAb;EACD;;EACD,aAAOA,UAAP;EACD;;;qCAEe;EACd,UAAI,6BAAC,IAAD,2DAAJ,EAAsC;EACpC;EACD;;EACD,UAAMC,WAAW,GAAG1gB,gBAAc,CAACoD,WAAf,CAA2B,IAA3B,CAApB;;EACA,UAAIsd,WAAW,IAAI,IAAnB,EAAyB;EACvB,eAAO,IAAI7jB,IAAJ,CAAS6jB,WAAW,GAAG,IAAvB,CAAP;EACD;EACF;;;;;;EC3BI,IAAMC,SAAS,GAAG;EACvBC,EAAAA,OAAO,EAAE,CADc;EAEvBC,EAAAA,KAAK,EAAE,CAFgB;EAGvBC,EAAAA,IAAI,EAAE,CAHiB;EAIvBC,EAAAA,KAAK,EAAE;EAJgB,CAAlB;;;;;;;;MAOMC,MAAb;EAGE,kBAAaC,QAAb,EAAuB;EAAA;;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA,SADvBC,SACuB,GADX,EACW;EACrB,8DAAiBD,QAAQ,IAAI,IAAZ,GAAmBA,QAAnB,GAA8BN,SAAS,CAACG,IAAzD;EACA,SAAKI,SAAL,GAAiB,EAAjB;EACD;;EANH;EAAA;EAAA,0BAgBSC,OAhBT,EAgBkB;EACd,UAAI,2DAAkBR,SAAS,CAACE,KAAhC,EAAuC;EACrC,sDAAU,OAAV,EAAmBM,OAAnB;EACD;EACF;EApBH;EAAA;EAAA,yBAsBQA,OAtBR,EAsBiB;EACb,UAAI,2DAAkBR,SAAS,CAACG,IAAhC,EAAsC;EACpC,sDAAU,KAAV,EAAiBK,OAAjB;EACD;EACF;EA1BH;EAAA;EAAA,0BA4BSA,OA5BT,EA4BkB;EACd,UAAI,2DAAkBR,SAAS,CAACI,KAA5B,gCAAqC,IAArC,iCAAJ,EAA8D;EAC5D,sDAAU,OAAV,EAAmBI,OAAnB;EACD;EACF;EAhCH;EAAA;EAAA,gCAkCeC,IAlCf,EAkCqBxE,WAlCrB,EAkCkC;EAC9B,WAAKsE,SAAL,CAAexf,CAAf,GAAmB0f,IAAnB;EACA,WAAKF,SAAL,CAAevhB,CAAf,GAAmBid,WAAnB;EACA,WAAKhV,KAAL,WAAcE,sBAAd,cAAwCsZ,IAAxC,eAAiDxE,WAAjD;EACD;EAtCH;EAAA;EAAA,wBAQkB;EACd,yCAAO,IAAP;EACD,KAVH;EAAA,sBAYgBqE,QAZhB,EAY0B;EACtB,gEAAiBA,QAAjB;EACD;EAdH;;EAAA;EAAA;;6BAwCQI,OAAOF,SAAS;EACpB,MAAIrf,MAAM,CAAC6R,OAAX,EAAoB;EAClB,QAAI;EACF,UAAM2N,EAAE,GAAG,IAAIzkB,IAAJ,GAAWoC,OAAX,EAAX;EACA0U,MAAAA,OAAO,CAAC0N,KAAD,CAAP,sBAA6BC,EAA7B,gBAAqCH,OAArC;EACD,KAHD,CAGE,OAAO1gB,CAAP,EAAU;EACb;EACF;;yDAEqB;EACpB,SAAQ,OAAOkX,cAAP,KAA0B,WAA1B,IAAyCA,cAAc,CAAC4J,MAAf,KAA0B,EAA3E;EACD;;;;;;;;MCxDkBC;EAIR;EAGX,gCAGG;EAAA,QAFD1jB,MAEC,QAFDA,MAEC;EAAA,QADDsL,uBACC,QADDA,uBACC;;EAAA;;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA,SANHoN,UAMG;EAAA,SALHwC,UAKG;EACD,SAAKT,SAAL,GAAiBvY,gBAAc,CAACoD,WAAf,CAA2B,IAA3B,CAAjB;EACA,8DAAetF,MAAf;EACA,gGAAgCsL,uBAAhC;EACD;;;;+CAUyB;EACxB,UAAIqY,UAAU,GAAGzhB,gBAAc,CAACuC,UAAf,CAA0B,KAAKiU,UAA/B,CAAjB;EACA,UAAIzZ,GAAG,GAAG,EAAV;;EAEA,UAAI0kB,UAAU,IAAI,IAAlB,EAAwB;EACtB;EACAA,QAAAA,UAAU,GAAGA,UAAU,CAACjjB,OAAX,CAAmB3E,gBAAnB,EAAqC,GAArC,CAAb;EAEAkD,QAAAA,GAAG,GAAGqD,IAAI,CAACI,KAAL,CAAWihB,UAAX,CAAN;;EACA,YAAI,CAACllB,QAAQ,CAACQ,GAAD,CAAb,EAAoB;EAClBA,UAAAA,GAAG,GAAG,EAAN;EACD,SAFD,MAEO;EACL,cAAI,OAAOA,GAAG,CAACsK,CAAX,KAAiB,WAArB,EAAkC;EAAE;EAClC,gBAAMqC,QAAQ,GAAG3M,GAAG,CAACsK,CAArB;EACA,gBAAMiZ,GAAG,GAAGxhB,MAAM,EAAlB;;EACA,gBAAKwhB,GAAG,GAAG5W,QAAP,GAAoBrP,wBAAwB,GAAG,EAAnD,EAAwD;EACtD;EACA;EACA;EACA0C,cAAAA,GAAG,GAAG,EAAN;EACD;EACF;EACF;EACF;;EACD,WAAKic,UAAL,GAAkBjc,GAAlB;EACA,aAAOA,GAAP;EACD;;;6CAEuBA,KAAK;EAC3B,UAAM2kB,MAAM,GAAGthB,IAAI,CAACC,SAAL,CAAetD,GAAf,CAAf;EACAiD,MAAAA,gBAAc,CAACiH,iBAAf,CAAiC,KAAKuP,UAAtC,EAAkDkL,MAAlD,EAA0DrnB,wBAA1D,EAAoF6Q,WAAW,EAA/F;EACD;;;oCAEc/E,SAAS;EACtB;EACA;EACA,UAAI,OAAO,KAAKoS,SAAZ,KAA0B,WAA1B,IAAyC,KAAKA,SAAL,KAAmBpS,OAAhE,EAAyE;EACvE,YAAMwb,kBAAkB,GAAG3hB,gBAAc,CAACoD,WAAf,CAA2B,IAA3B,CAA3B,CADuE;;EAGvE,YAAI,OAAOue,kBAAP,KAA8B,WAAlC,EAA+C;EAC7C3hB,UAAAA,gBAAc,CAACqD,WAAf,CAA2B,IAA3B,EAAiC8C,OAAjC;EACAnG,UAAAA,gBAAc,CAACqD,WAAf,CAA2B,IAA3B,EAAiC8C,OAAjC;EACAnG,UAAAA,gBAAc,CAACqD,WAAf,CAA2B,IAA3B,EAAiC,CAAjC;EACD,SAJD,MAIO,IAAIse,kBAAkB,KAAKxb,OAA3B,EAAoC;EACzC;EACAnG,UAAAA,gBAAc,CAACqD,WAAf,CAA2B,IAA3B,EAAiCse,kBAAjC;EACA3hB,UAAAA,gBAAc,CAACqD,WAAf,CAA2B,IAA3B,EAAiC8C,OAAjC;EACA,cAAIyb,YAAY,GAAG5hB,gBAAc,CAACoD,WAAf,CAA2B,IAA3B,CAAnB;;EACA,cAAI,OAAOwe,YAAP,KAAwB,WAA5B,EAAyC;EACvCA,YAAAA,YAAY,GAAG,CAAf;EACD;;EACD5hB,UAAAA,gBAAc,CAACqD,WAAf,CAA2B,IAA3B,EAAiCue,YAAY,GAAG,CAAhD;EACD;;EACD,aAAKrJ,SAAL,GAAiBpS,OAAjB;EACD;EACF;;;uCAEiB;EAChB,UAAI,6BAAC,IAAD,2DAAJ,EAAsC;EACpC;EACD;;EACD,UAAI,KAAK6S,UAAL,IAAmB,IAAvB,EAA6B;EAAE;EAC7B,aAAKA,UAAL,GAAkB,KAAK7R,sBAAL,EAAlB;EACD;;EACD,UAAM0a,YAAY,GAAG,KAAK7I,UAAL,CAAgB5R,CAArC;;EACA,UAAIya,YAAY,IAAI,IAApB,EAA0B;EACxB,YAAMP,EAAE,GAAGxiB,MAAM,EAAjB;EACA,eAAOC,IAAI,CAACC,KAAL,CAAWsiB,EAAE,GAAGO,YAAhB,CAAP;EACD;EACF;;;qCAEe;EACd,UAAI,6BAAC,IAAD,2DAAJ,EAAsC;EACpC;EACD;;EAED,UAAI,KAAK7I,UAAL,IAAmB,IAAvB,EAA6B;EAAE;EAC7B,aAAKA,UAAL,GAAkB,KAAK7R,sBAAL,EAAlB;EACD;;EACD,aAAO,KAAK6R,UAAL,CAAgBxE,CAAvB;EACD;;;0BAxFgB;EACf,yCAAO,IAAP;EACD;wBAEc+D,WAAW;EACxB,kEAAkBA,SAAlB;EACD;;;;;;ECnBH,IAAIuJ,KAAK,GAAG,CAAZ;EACA,IAAIC,WAAW,GAAG,CAAlB;;;;;;;;;;;;;;;;MAEqBC;EASnB,gCAA4E;EAAA,QAA7DlkB,MAA6D,QAA7DA,MAA6D;EAAA,QAArDsW,OAAqD,QAArDA,OAAqD;EAAA,QAA5ClO,MAA4C,QAA5CA,MAA4C;EAAA,QAApCC,OAAoC,QAApCA,OAAoC;EAAA,QAA3BiD,uBAA2B,QAA3BA,uBAA2B;;EAAA;;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA,aAH7D;EAG6D;EAAA,SAF5E7B,gBAE4E,GAFzD,KAEyD;EAC1E,8DAAezJ,MAAf;EACA,gEAAgBsW,OAAhB;EACA,8DAAelO,MAAf;EACA,gEAAgBC,OAAhB;EACA,gGAAgCiD,uBAAhC;EAEAyE,IAAAA,iBAAiB,CAAC/P,MAAlB,GAA2BA,MAA3B;EACA+P,IAAAA,iBAAiB,CAAC3H,MAAlB,GAA2BA,MAA3B;EACD;;;;4CAEsB;EACrB,UAAMrC,SAAS,GAAG7D,gBAAc,CAACiD,kBAAf,CAAkCvI,YAAlC,CAAlB;;EACA,UAAI,OAAOmJ,SAAP,KAAqB,WAArB,IAAoCA,SAAS,KAAK,IAAtD,EAA4D;EAC1D;EACD;;EACD,WAAK0D,gBAAL,GAAwB,IAAxB;;EACA,WAAK,IAAM9F,GAAX,IAAkBoC,SAAlB,EAA6B;EAC3B,YAAIA,SAAS,CAAC5G,cAAV,CAAyBwE,GAAzB,CAAJ,EAAmC;EACjC,cAAMwgB,WAAW,GAAGpe,SAAS,CAACpC,GAAD,CAA7B;;EACA,cAAI,OAAOwgB,WAAW,CAACC,KAAnB,KAA6B,WAAjC,EAA8C;EAC5C,oEAAave,KAAb,CAAmB,+BAA+Bse,WAAW,CAACve,CAA9D;;EACA,gBAAI,OAAOue,WAAW,CAACve,CAAnB,KAAyB,WAA7B,EAA0C;EACxCmK,cAAAA,iBAAiB,CAAC6G,WAAlB,CAA8BuN,WAAW,CAACve,CAA1C;EACD;;EACDue,YAAAA,WAAW,CAACC,KAAZ,GAAoB,IAApB;EACD;EACF;EACF;;EAEDliB,MAAAA,gBAAc,CAACmD,gBAAf,CAAgCzI,YAAhC,EAA8CmJ,SAA9C;EACA,WAAK0D,gBAAL,GAAwB,KAAxB;EACD;;;4CAEsBwE,YAAYoW,YAAY;EAC7C;EACA,UAAI,OAAOA,UAAP,KAAsB,WAA1B,EAAuC;EACrCpW,QAAAA,UAAU,GAAGnO,sBAAsB,CAACmO,UAAD,8BAAa,IAAb,wBAAnC;EACD;;EAED,UAAI,CAACjP,aAAa,CAAC,wDAAaokB,SAAd,CAAlB,EAA4C;EAC1CnV,QAAAA,UAAU,CAACqW,UAAX,GAAwB,wDAAalB,SAArC;EACA,gEAAaA,SAAb,GAAyB,EAAzB;EACD;;EAEDnV,MAAAA,UAAU,CAAC3S,EAAX,GAAgB,0DAAcA,EAA9B;;EAEA,UAAIqE,YAAY,CAAC,wDAAaqG,OAAd,CAAhB,EAAwC;EACtCiI,QAAAA,UAAU,CAACgK,CAAX,GAAe,wDAAajS,OAA5B;EACD;;EAED,UAAM/G,GAAG,GAAG,0DAAcoK,sBAAd,EAAZ;;EACA4E,MAAAA,UAAU,CAAC3E,CAAX,GAAerK,GAAG,CAACqK,CAAnB,CAlB6C;;EAmB7C2E,MAAAA,UAAU,CAACsW,EAAX,GAAiB,OAAOtlB,GAAG,CAACyX,CAAX,KAAiB,WAAlB,GAAiC,CAAjC,GAAqCzX,GAAG,CAACyX,CAAzD,CAnB6C;;EAqB7C,aAAOzI,UAAP;EACD;;;+BAESzL,MAAM;EACd;EACA,sEAAoBN,gBAAc,CAACyG,mBAAf,CAAmC3M,KAAnC,CAApB;;EACA,UAAI,kEAAsB6D,SAAtB,gCAAmC,IAAnC,6BAAJ,EAA0D;EACxD2C,QAAAA,IAAI,CAACgiB,EAAL,GAAU,IAAV;;EACA,gEAAa3e,KAAb,CAAmB,yEAAnB;EACD;;EACD,sCAAI,IAAJ,6DAAqC;EACnC,YAAM4e,YAAY,GAAGviB,gBAAc,CAACoD,WAAf,CAA2B,QAA3B,CAArB;EACA,YAAMof,aAAa,GAAGxiB,gBAAc,CAACoD,WAAf,CAA2B,MAA3B,CAAtB,CAFmC;;EAKnC,YAAI,OAAOmf,YAAP,KAAwB,WAAxB,IAAuC,OAAOC,aAAP,KAAyB,WAApE,EAAiF;EAC/EliB,UAAAA,IAAI,CAACmiB,KAAL,GAAa,IAAb;EACA;EACD;;EACD,YAAMnC,GAAG,GAAGxhB,MAAM,EAAlB,CATmC;;EAWnC,YAAIyjB,YAAY,GAAGC,aAAf,GAA+BlC,GAAnC,EAAwC;EACtChgB,UAAAA,IAAI,CAACmiB,KAAL,GAAa,IAAb;EACD;EACF;EACF;;;yCAEmBrY,KAAK4I,UAAUjF,aAAa;EAC9C,UAAMuS,GAAG,GAAGxhB,MAAM,EAAlB;EACAsL,MAAAA,GAAG,GAAGY,QAAQ,CAACZ,GAAD,EAAM,IAAN,EAAY,EAAEhI,GAAG,CAACC,WAAJ,CAAgB0B,KAA9B,CAAd;EACA,UAAMzD,IAAI,GAAG8J,GAAG,GAAG,KAAN,GAAckW,GAAd,GAAoB,MAApB,GAA6BwB,KAA1C;EACA9hB,MAAAA,gBAAc,CAACiiB,WAAf,CAA2B3hB,IAA3B,EAAiC8B,GAAG,CAACC,WAAJ,CAAgB0B,KAAjD,8BAAwD,IAAxD;;EAEA,UAAI,CAAC3B,GAAG,CAACgC,YAAL,IAAqB4O,QAArB,IAAkC,kEAAsBrV,SAAtB,gCAAmC,IAAnC,6BAAtC,EAA6F;EAC3F,YAAI2iB,GAAG,KAAKyB,WAAZ,EAAyB;EACvBD,UAAAA,KAAK;EACN,SAFD,MAEO;EACLC,UAAAA,WAAW,GAAGzB,GAAd;EACAwB,UAAAA,KAAK,GAAG,CAAR;EACD;;EAEDjU,QAAAA,iBAAiB,CAAC6G,WAAlB,CAA8BpU,IAA9B,EAAoC,KAApC,EAA2CyN,WAA3C;EACD,OATD,MASO;EACL,gEAAapK,KAAb,4CAAuDvB,GAAG,CAACgC,YAA3D,2DAA4F,IAA5F;EACD;EACF;;;6CAEuBse,WAAW;EACjC,UAAMpiB,IAAI,GAAG,EAAb;EACAA,MAAAA,IAAI,CAACyJ,IAAL,GAAY,MAAZ;;EACA,UAAItM,YAAY,CAACilB,SAAD,CAAhB,EAA6B;EAC3BpiB,QAAAA,IAAI,CAACyV,CAAL,GAAS2M,SAAT;EACD;;EACDpiB,MAAAA,IAAI,CAACqiB,MAAL,GAAc,YAAd;EACAriB,MAAAA,IAAI,CAAClH,EAAL,GAAU,0DAAcA,EAAxB;;EAEA,UAAM2D,GAAG,GAAG,0DAAcoK,sBAAd,EAAZ;;EAEA7G,MAAAA,IAAI,CAAC8G,CAAL,GAASrK,GAAG,CAACqK,CAAb,CAXiC;;EAYjC,UAAMoO,cAAc,GAAG1J,YAAY,CAAC1L,IAAI,CAACC,SAAL,CAAeC,IAAf,CAAD,8BAAuB,IAAvB,wBAAnC;;EAEA,UAAI4N,WAAW,GAAG,0DAAcuH,WAAhC;;EACAvH,MAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,MAAd,EAAsB,MAAtB,CAAtB;EACAA,MAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,GAAd,EAAmBsH,cAAnB,CAAtB;EAEAxV,MAAAA,gBAAc,CAACmD,gBAAf,CAAgClH,sBAAhC,EAAwD,KAAxD;EACA4R,MAAAA,iBAAiB,CAAC6G,WAAlB,CAA8BxG,WAA9B,EAA2C,IAA3C,EAnBiC;;EAsBjC,UAAM0U,OAAO,GAAG5iB,gBAAc,CAACiD,kBAAf,CAAkC/G,sBAAlC,CAAhB;EACA,WAAK2mB,aAAL,CAAmBD,OAAnB;EACD;;;oCAEcA,SAAS;EACtB,UAAI,CAACA,OAAL,EAAc;EAEdA,MAAAA,OAAO,GAAG,KAAKtN,qBAAL,CAA2BsN,OAA3B,EAAoC,IAApC,CAAV;EACAA,MAAAA,OAAO,GAAGxiB,IAAI,CAACC,SAAL,CAAeuiB,OAAf,CAAV;;EACA,UAAI1U,WAAW,GAAG,0DAAcuH,WAAhC;;EACAvH,MAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,MAAd,EAAsB,MAAtB,CAAtB;EACAA,MAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,GAAd,EAAmBpC,YAAY,CAAC8W,OAAD,8BAAU,IAAV,wBAA/B,CAAtB;EACA/U,MAAAA,iBAAiB,CAAC6G,WAAlB,CAA8BxG,WAA9B,EARsB;;EAUtBlO,MAAAA,gBAAc,CAACgC,IAAf,CAAoBnH,cAApB,EAAoC,IAApC;EACD;;;mCAEayF,MAAM;EAClB,kFAAyBA,IAAI,CAACgJ,OAA9B;;EACAhJ,MAAAA,IAAI,GAAG,KAAKgV,qBAAL,CAA2BhV,IAA3B,EAAiC3C,SAAjC,CAAP;EACA,WAAK4X,QAAL,CAAcjV,IAAd;EACAA,MAAAA,IAAI,CAACnG,gBAAD,CAAJ,GAAyBmV,mBAAmB,EAA5C;EACA,UAAMkG,cAAc,GAAG1J,YAAY,CAAC1L,IAAI,CAACC,SAAL,CAAeC,IAAf,CAAD,8BAAuB,IAAvB,wBAAnC;;EACA,UAAI4N,WAAW,GAAG,0DAAcuH,WAAhC;;EACAvH,MAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,MAAd,EAAsB7S,QAAtB,CAAtB;EACA6S,MAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,GAAd,EAAmBsH,cAAnB,CAAtB;EAEA,WAAKE,kBAAL,CAAwBxH,WAAxB,EAAqC,KAArC;EACD;;;;;;2DAEoB5E,SAAS;EAC5B,MAAItJ,gBAAc,CAACC,wBAAf,EAAJ,EAA+C;EAC7C,QAAI,OAAOmC,GAAG,CAAC+B,eAAX,KAA+B,WAAnC,EAAgD;EAC9C/B,MAAAA,GAAG,CAAC+B,eAAJ,GAAsBnE,gBAAc,CAACiD,kBAAf,CAAkC3I,SAAlC,CAAtB;;EACA,UAAI,OAAO8H,GAAG,CAAC+B,eAAX,KAA+B,WAAnC,EAAgD;EAC9C/B,QAAAA,GAAG,CAAC+B,eAAJ,GAAsB,EAAtB;EACD;EACF;;EAED,QAAM2e,KAAK,GAAGhkB,MAAM,EAApB;EACA,QAAIikB,SAAS,GAAG3gB,GAAG,CAAC+B,eAAJ,CAAoBmF,OAApB,CAAhB;;EACA,QAAI,OAAOyZ,SAAP,KAAqB,WAAzB,EAAsC;EACpCA,MAAAA,SAAS,CAAC,CAAD,CAAT,GAAeD,KAAf;EACAC,MAAAA,SAAS,CAAC,CAAD,CAAT;EACD,KAHD,MAGO;EACLA,MAAAA,SAAS,GAAG,EAAZ;EACAA,MAAAA,SAAS,CAAC3d,IAAV,CAAe,CAAf;EACA2d,MAAAA,SAAS,CAAC3d,IAAV,CAAe0d,KAAf;EACAC,MAAAA,SAAS,CAAC3d,IAAV,CAAe0d,KAAf;EACD;;EACD1gB,IAAAA,GAAG,CAAC+B,eAAJ,CAAoBmF,OAApB,IAA+ByZ,SAA/B;EACA/iB,IAAAA,gBAAc,CAACmD,gBAAf,CAAgC7I,SAAhC,EAA2C8H,GAAG,CAAC+B,eAA/C;EACD;EACF;;;;;;;;;;;;MClLkB6e;;;;;EAMnB,yBAKA7Z,MALA,EAKQ;EAAA;;EAAA,QAJNlD,OAIM,QAJNA,OAIM;EAAA,QAHNmO,OAGM,QAHNA,OAGM;EAAA,QAFNtW,MAEM,QAFNA,MAEM;;EAAA;;EACN;EADM;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAEN,uFAAeA,MAAf;EACA,yFAAgBmI,OAAhB;EACA,yFAAgBmO,OAAhB;EACA,6FAAkBjL,MAAlB;EALM;EAMP;;;;6BAEoB;EAAA,wCAAZ8Z,UAAY;EAAZA,QAAAA,UAAY;EAAA;;EACnB,oFAA0BA,UAA1B;;EACA,aAAO,CAAP;EACD;;;0CAEoB;EACnB,sCAAI,IAAJ,+BAAqB;EACnB,kHAA0B,IAA1B;EACD;;EACD,sEAAkB,IAAlB;EACD;;;;mCA7BkCra;;6DA+Bbqa,YAAY;EAChC,MAAIra,KAAK,CAACC,OAAN,CAAcoa,UAAd,KAA6BA,UAAU,CAAC9kB,MAAX,GAAoB,CAArD,EAAwD;EACtD,QAAM+kB,UAAU,GAAGD,UAAU,CAAC,CAAD,CAA7B;EACA,QAAI3iB,IAAI,GAAG,EAAX;EACA,QAAM+P,UAAU,GAAG,EAAnB;EACA,QAAI8S,MAAM,GAAG,KAAb;;EAEA,QAAID,UAAU,CAACjmB,cAAX,CAA0BnC,UAA1B,CAAJ,EAA2C;EACzCqoB,MAAAA,MAAM,GAAGD,UAAU,CAACpoB,UAAD,CAAnB;;EACA,UAAI,OAAOqoB,MAAP,KAAkB,SAAtB,EAAiC;EAC/B9S,QAAAA,UAAU,CAACtV,aAAD,CAAV,GAA4BooB,MAA5B,CAD+B;;EAG/B/gB,QAAAA,GAAG,CAACiC,cAAJ,GAAqB,CAAC8e,MAAtB;EACD;EACF;;EACD,QAAID,UAAU,CAACjmB,cAAX,CAA0BhC,SAA1B,CAAJ,EAA0C;EACxC,UAAMkT,KAAK,GAAG+U,UAAU,CAACjoB,SAAD,CAAxB;EACA,UAAMmoB,WAAW,GAAI,OAAOjV,KAAP,KAAiB,SAAlB,GAA+BA,KAA/B,GAAuC,KAA3D;EACAnO,MAAAA,gBAAc,CAACqD,WAAf,CAA2BpI,SAA3B,EAAsCmoB,WAAtC;EACD;;EACD,QAAI,CAACtmB,aAAa,CAACuT,UAAD,CAAlB,EAAgC;EAC9B/P,MAAAA,IAAI,CAACyJ,IAAL,GAAY,SAAZ;EACAzJ,MAAAA,IAAI,CAAC+U,OAAL,GAAehF,UAAf;EACA/P,MAAAA,IAAI,GAAG,0DAAcgV,qBAAd,CAAoChV,IAApC,EAA0C3C,SAA1C,CAAP;EACA,UAAM6X,cAAc,GAAG1J,YAAY,CAAC1L,IAAI,CAACC,SAAL,CAAeC,IAAf,CAAD,8BAAuB,IAAvB,wBAAnC;;EACA,UAAI4N,WAAW,GAAG,0DAAcuH,WAAhC;;EACAvH,MAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,MAAd,EAAsB7S,QAAtB,CAAtB;EACA6S,MAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,GAAd,EAAmBsH,cAAnB,CAAtB;EACAtH,MAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAcpT,UAAd,EAA0BqoB,MAAM,GAAG,MAAH,GAAY,OAA5C,CAAtB;;EACA,gEAAczN,kBAAd,CAAiCxH,WAAjC,EAA8C9L,GAAG,CAACuT,aAAlD;EACD;EACF;EACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MC1EkB0N;;;;;EAQnB,qCAKGla,MALH,EAKW;EAAA;;EAAA,QAJTrL,MAIS,QAJTA,MAIS;EAAA,QAHTqI,OAGS,QAHTA,OAGS;EAAA,QAFTF,OAES,QAFTA,OAES;EAAA,QADTmO,OACS,QADTA,OACS;;EAAA;;EACT;EADS;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAET,mGAAuB,6DAAvB;EACA,+FAAqB,IAArB;EACA,6FAAkBjL,MAAlB;EACA,uFAAerL,MAAf;EACA,yFAAgBmI,OAAhB;EACA,yFAAgBmO,OAAhB;EAPS;EAQV;;;;6BAEqB;EAAA,wCAAbkP,WAAa;EAAbA,QAAAA,WAAa;EAAA;;EACpB,sEAAmBA,WAAnB;;EACA,aAAO,CAAP;EACD;;;0CAEoB;EACnB,sCAAI,IAAJ,+BAAqB;EACnB,oGAAmB,IAAnB;EACD;;EACD,sEAAkB,IAAlB;EACD;;;qCAkXeC,SAASC,sBAAsB;EAC7CphB,MAAAA,GAAG,CAACkC,cAAJ,GAAqBif,OAArB;;EACA,UAAIC,oBAAoB,IAAI,IAA5B,EAAkC;EAChC,8FAA8BA,oBAA9B;EACD;;EACD,UAAIphB,GAAG,CAACkC,cAAJ,IAAsBlC,GAAG,CAACsC,QAAJ,CAAaC,mBAAvC,EAA4D;EAC1D,4GAAqCvC,GAAG,CAACsC,QAAJ,CAAa4e,WAAlD;EACD,OAFD,MAEO,IAAI,CAAClhB,GAAG,CAACkC,cAAL,IAAuBlC,GAAG,CAACsC,QAAJ,CAAaC,mBAAxC,EAA6D;EAClE,gEAAaiD,KAAb,CAAmB,4FAAnB;EACD;EACF;;;;mCA7Z8CgB;;+CAmChC0a,aAAa;EAC1B,MAAIlhB,GAAG,CAACkC,cAAJ,IAAsBgf,WAAW,CAACnlB,MAAZ,GAAqB,CAA/C,EAAkD;EAChD,wGAAqCmlB,WAArC;EACD,GAFD,MAEO,IAAIlhB,GAAG,CAACkC,cAAJ,IAAsB,IAAtB,IAA8Bgf,WAAW,CAACnlB,MAAZ,GAAqB,CAAvD,EAA0D;EAC/DiE,IAAAA,GAAG,CAACsC,QAAJ,CAAaC,mBAAb,GAAmC,IAAnC;EACAvC,IAAAA,GAAG,CAACsC,QAAJ,CAAa4e,WAAb,GAA2BA,WAAW,CAAClV,KAAZ,EAA3B;EACD,GAHM,MAGA,IAAIhM,GAAG,CAACkC,cAAJ,KAAuB,KAAvB,IAAgCgf,WAAW,CAACnlB,MAAZ,GAAqB,CAAzD,EAA4D;EACjE,4DAAayJ,KAAb,CAAmB,+DAAnB;EACD;EACF;;yEAE2B6b,sBAAsBC,mBAAmBC,eAAeC,gBAAgB;EAClG,MAAIzI,SAAS,CAACC,SAAV,CAAoBxZ,OAApB,CAA4B,QAA5B,MAA0C,CAAC,CAA3C,IAAgDuZ,SAAS,CAACC,SAAV,CAAoBxZ,OAApB,CAA4B,SAA5B,MAA2C,CAAC,CAAhG,EAAmG;EACjG,0GAAsC6hB,oBAAtC,EAA4DC,iBAA5D;EACD,GAFD,MAEO,IAAIvI,SAAS,CAACC,SAAV,CAAoBxZ,OAApB,CAA4B,QAA5B,MAA0C,CAAC,CAA/C,EAAkD;EACvD,4FAA+B6hB,oBAA/B,EAAqDE,aAArD,EAAoEC,cAApE;EACD;EACF;;qEAEyBJ,sBAAsB;EAC9C,oEAAqBA,oBAArB;EACD;;uEAE0BC,sBAAsBE,eAAeC,gBAAgB;EAAA;;EAC9E;EACA,MAAI,OAAOD,aAAP,KAAyB,WAA7B,EAA0C;EACxC,4DAAa/b,KAAb,CAAmB,0CAAnB;EACD;;EACD,MAAI,OAAOgc,cAAP,KAA0B,WAA9B,EAA2C;EACzC,4DAAahc,KAAb,CAAmB,oDAAnB;EACD;;EACD,MAAI,YAAY9F,MAAZ,IAAsB,sBAAsBA,MAAM,CAAC+hB,MAAvD,EAA+D;EAC7D/hB,IAAAA,MAAM,CAAC+hB,MAAP,CAAcC,gBAAd,CAA+BC,iBAA/B,CACEH,cADF,EAEED,aAFF,EAEiB,EAFjB,EAEqB,UAAC1P,YAAD,EAAkB;EACnC,UAAIA,YAAY,CAAC+P,UAAb,KAA4B,SAAhC,EAA2C;EACzC,YAAMC,gBAAgB,GAAG7jB,IAAI,CAACI,KAAL,CAAWJ,IAAI,CAACC,SAAL,CAAe4T,YAAf,CAAX,CAAzB;EACAgQ,QAAAA,gBAAgB,CAACC,QAAjB,GAA4BjQ,YAAY,CAACkQ,WAAzC;EACAF,QAAAA,gBAAgB,CAACG,OAAjB,GAA2B,QAA3B;EACApkB,QAAAA,gBAAc,CAACmD,gBAAf,CAAgCjH,sBAAhC,EAAwD+nB,gBAAxD;;EAEA,oCAAA,MAAI,aAAJ,aAAcpB,aAAd,CAA4BoB,gBAA5B;;EACA,oCAAA,MAAI,YAAJ,YAAaI,IAAb,CAAkB,+CAA+CpQ,YAAY,CAACkQ,WAA9E;EACD,OARD,MAQO,IAAIlQ,YAAY,CAAC+P,UAAb,KAA4B,QAAhC,EAA0C;EAC/C,oCAAA,MAAI,YAAJ,YAAaK,IAAb,CAAkB,sCAAlB;EACD;EACF,KAdH;EAeD;EACF;;qFAKiCZ,sBAAsBC,mBAAmB;EAAA;;EACzE,MAAIY,iBAAiB,GAAG,EAAxB;;EAEA,MAAI,mBAAmBnJ,SAAvB,EAAkC;EAChCA,IAAAA,SAAS,CAACoJ,aAAV,CAAwBC,QAAxB,CAAiCd,iBAAjC,EAAoDe,IAApD,CAAyD,UAACC,YAAD,EAAkB;EACzE,UAAI,OAAOC,iBAAP,KAA6B,WAAjC,EAA8C;EAAE;EAC9C;EACA;EACA,eAAO,IAAIC,OAAJ,CAAY,UAAAC,OAAO;EAAA,iBAAIvW,UAAU,CAAC;EAAA,mBAAMuW,OAAO,CAACH,YAAD,CAAb;EAAA,WAAD,EAA8B,IAA9B,CAAd;EAAA,SAAnB,CAAP;EACD;;EACDJ,MAAAA,iBAAiB,GAAGI,YAAY,CAACI,KAAjC,CANyE;EASzE;EACA;;EACA,UAAMC,YAAY,GAAG,wBAArB;EACA,UAAMC,qBAAqB,GAAGD,YAAY,CAACvnB,IAAb,CAAkBkmB,iBAAlB,CAA9B;;EACA,UAAIsB,qBAAJ,EAA2B;EACzB,eAAO7J,SAAS,CAACoJ,aAAV,CAAwBU,KAA/B;EACD,OAFD,MAEO;EACL,YAAI9J,SAAS,CAACC,SAAV,CAAoBxZ,OAApB,CAA4B,QAA5B,MAA0C,CAAC,CAA/C,EAAkD;EAChD,iBAAO,IAAIgjB,OAAJ,CAAY,UAAAC,OAAO;EAAA,mBAAIvW,UAAU,CAAC;EAAA,qBAAMuW,OAAO,CAACH,YAAD,CAAb;EAAA,aAAD,EAA8B,IAA9B,CAAd;EAAA,WAAnB,CAAP;EACD,SAFD,MAEO;EACL,iBAAOvJ,SAAS,CAACoJ,aAAV,CAAwBW,gBAAxB,EAAP;EACD;EACF;EACF,KAtBD,EAsBGT,IAtBH,CAsBQ,UAACU,yBAAD,EAA+B;EACrC;EACA,UAAIhK,SAAS,CAACC,SAAV,CAAoBxZ,OAApB,CAA4B,SAA5B,MAA2C,CAAC,CAA5C,IAAiDgH,KAAK,CAACC,OAAN,CAAcsc,yBAAd,CAArD,EAA+F;EAC7FA,QAAAA,yBAAyB,GAAGA,yBAAyB,CAACC,MAA1B,CAAiC,UAACzZ,CAAD;EAAA,iBAAOA,CAAC,CAACmZ,KAAF,KAAYR,iBAAnB;EAAA,SAAjC,EAAuE,CAAvE,CAA5B;EACD;;EACD,UAAMe,YAAY,GAAG;EAAEC,QAAAA,eAAe,EAAE;EAAnB,OAArB;;EAEA,UAAI,4BAAA,MAAI,gBAAJ,mBAAsB,IAA1B,EAAgC;EAC9BD,QAAAA,YAAY,CAAC7B,oBAAb,GAAoCrY,qBAAqB,6BAAC,MAAD,gCAAzD;EACD;;EAEDga,MAAAA,yBAAyB,CAACI,WAA1B,CAAsCC,SAAtC,CAAgDH,YAAhD,EACGZ,IADH,CACQ,UAACxQ,YAAD,EAAkB;EACtB,oCAAA,MAAI,YAAJ,YAAaoQ,IAAb,CAAkB,0CAA0CpQ,YAAY,CAACiQ,QAAzE,EADsB;;;EAItB,YAAMD,gBAAgB,GAAG7jB,IAAI,CAACI,KAAL,CAAWJ,IAAI,CAACC,SAAL,CAAe4T,YAAf,CAAX,CAAzB,CAJsB;;EAOtB,YAAIkH,SAAS,CAACC,SAAV,CAAoBxZ,OAApB,CAA4B,QAA5B,MAA0C,CAAC,CAA/C,EAAkD;EAChDqiB,UAAAA,gBAAgB,CAACC,QAAjB,GAA4BD,gBAAgB,CAACC,QAAjB,CAA0B1iB,KAA1B,CAAgC,GAAhC,EAAqCkV,GAArC,EAA5B;EACAuN,UAAAA,gBAAgB,CAACG,OAAjB,GAA2B,QAA3B;EACD,SAHD,MAGO,IAAIjJ,SAAS,CAACC,SAAV,CAAoBxZ,OAApB,CAA4B,SAA5B,MAA2C,CAAC,CAAhD,EAAmD;EACxDqiB,UAAAA,gBAAgB,CAACC,QAAjB,GAA4BD,gBAAgB,CAACC,QAAjB,CAA0B1iB,KAA1B,CAAgC,GAAhC,EAAqCkV,GAArC,EAA5B;EACAuN,UAAAA,gBAAgB,CAACG,OAAjB,GAA2B,SAA3B;EACD;;EACDpkB,QAAAA,gBAAc,CAACmD,gBAAf,CAAgCjH,sBAAhC,EAAwD+nB,gBAAxD,EAdsB;;EAmBtB,QAAqB;EACnB,sCAAA,MAAI,aAAJ,aAAcpB,aAAd,CAA4BoB,gBAA5B;EACD;;EAED,YAAI,OAAOR,oBAAP,KAAgC,WAAhC,IAA+C,OAAOA,oBAAP,KAAgC,UAAnF,EAA+F;EAC7FA,UAAAA,oBAAoB;EACrB;EACF,OA3BH,EA2BKgC,KA3BL,CA2BW,UAAC7d,KAAD,EAAW;EAClB,oCAAA,MAAI,YAAJ,YAAaA,KAAb,CAAmB,wBAAwBA,KAA3C,EADkB;;;EAGlBud,QAAAA,yBAAyB,CAACI,WAA1B,CAAsCG,eAAtC,GAAwDjB,IAAxD,CAA6D,UAACxQ,YAAD,EAAkB;EAC7E,cAAIA,YAAY,KAAK,IAArB,EAA2B;EACzBA,YAAAA,YAAY,CAAC0R,WAAb,GAA2BlB,IAA3B,CAAgC,UAACmB,UAAD,EAAgB;EAC9C;EACA,0CAAA,MAAI,YAAJ,YAAavB,IAAb,CAAkB,2BAAlB;EACD,aAHD,EAGGoB,KAHH,CAGS,UAAChlB,CAAD,EAAO;EACd;EACA,0CAAA,MAAI,YAAJ,YAAamH,KAAb,CAAmB,0BAA0BnH,CAA7C;EACD,aAND;EAOD;EACF,SAVD;EAWD,OAzCH;EA0CD,KA3ED,EA2EGglB,KA3EH,CA2ES,UAAChjB,GAAD,EAAS;EAChB,kCAAA,MAAI,YAAJ,YAAamF,KAAb,CAAmB,uCAAuCnF,GAA1D;EACD,KA7ED;EA8ED;EACF;;mDAEiB;EAChB,MAAMojB,SAAS,GAAG/kB,QAAQ,CAACgK,aAAT,CAAuB,QAAvB,CAAlB;EACA+a,EAAAA,SAAS,CAAC/W,YAAV,CAAuB,MAAvB,EAA+B,iBAA/B;EACA+W,EAAAA,SAAS,CAAC/W,YAAV,CAAuB,IAAvB,EAA6B,eAA7B;EACA+W,EAAAA,SAAS,CAAC/W,YAAV,CAAuB,KAAvB,8BAA8B,IAA9B,qCAJgB;;EAOhBhO,EAAAA,QAAQ,CAACkO,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,EAAyCC,WAAzC,CAAqD4W,SAArD;EAEA,SAAOA,SAAP;EACD;;yDAEoB;EACnB,MAAMA,SAAS,GAAG/kB,QAAQ,CAACwS,cAAT,CAAwB,eAAxB,CAAlB;EACAuS,EAAAA,SAAS,CAACjX,UAAV,CAAqBC,WAArB,CAAiCgX,SAAjC;EACD;;mFAEgCvC,aAAa;EAAA;;EAC5C;EACA,MAAI7G,SAAJ;EACA,MAAIqJ,QAAJ;EACA,MAAIC,YAAJ;EACA,MAAIC,gBAAJ;EACA,MAAIC,aAAJ;EACA,MAAIC,UAAJ;EACA,MAAIC,qBAAJ;EACA,MAAIC,UAAJ;EACA,MAAIC,cAAJ;EACA,MAAI5C,oBAAJ;EACA,MAAI6C,eAAJ;EACA,MAAI5C,iBAAJ;EACA,MAAI6C,cAAJ;EACA,MAAIC,eAAJ;EACA,MAAI7C,aAAJ;EACA,MAAI8C,qBAAJ;;EAEA,MAAInD,WAAW,CAACnlB,MAAZ,KAAuB,CAA3B,EAA8B;EAC5B,QAAI5B,QAAQ,CAAC+mB,WAAW,CAAC,CAAD,CAAZ,CAAZ,EAA8B;EAC5B,UAAMoD,QAAQ,GAAGpD,WAAW,CAAC,CAAD,CAA5B;EACA7G,MAAAA,SAAS,GAAGiK,QAAQ,CAACjK,SAArB;EACAqJ,MAAAA,QAAQ,GAAGY,QAAQ,CAACZ,QAApB;EACAC,MAAAA,YAAY,GAAGW,QAAQ,CAACX,YAAxB;EACAC,MAAAA,gBAAgB,GAAGU,QAAQ,CAACV,gBAA5B;EACAC,MAAAA,aAAa,GAAGS,QAAQ,CAACT,aAAzB;EACAC,MAAAA,UAAU,GAAGQ,QAAQ,CAACR,UAAtB;EACAC,MAAAA,qBAAqB,GAAGO,QAAQ,CAACP,qBAAjC;EACAC,MAAAA,UAAU,GAAGM,QAAQ,CAACN,UAAtB;EACAC,MAAAA,cAAc,GAAGK,QAAQ,CAACL,cAA1B;EACA5C,MAAAA,oBAAoB,GAAGiD,QAAQ,CAACjD,oBAAhC;EACA6C,MAAAA,eAAe,GAAGI,QAAQ,CAACJ,eAA3B;EACA5C,MAAAA,iBAAiB,GAAGgD,QAAQ,CAAChD,iBAA7B;EACA6C,MAAAA,cAAc,GAAGG,QAAQ,CAACH,cAA1B;EACAC,MAAAA,eAAe,GAAGE,QAAQ,CAACF,eAA3B;EACA7C,MAAAA,aAAa,GAAG+C,QAAQ,CAAC/C,aAAzB;EACA8C,MAAAA,qBAAqB,GAAGC,QAAQ,CAACD,qBAAjC;EACD;EACF,GApBD,MAoBO;EACLhK,IAAAA,SAAS,GAAG6G,WAAW,CAAC,CAAD,CAAvB;EACAwC,IAAAA,QAAQ,GAAGxC,WAAW,CAAC,CAAD,CAAtB;EACAyC,IAAAA,YAAY,GAAGzC,WAAW,CAAC,CAAD,CAA1B;EACA0C,IAAAA,gBAAgB,GAAG1C,WAAW,CAAC,CAAD,CAA9B;EACA2C,IAAAA,aAAa,GAAG3C,WAAW,CAAC,CAAD,CAA3B;EACA4C,IAAAA,UAAU,GAAG5C,WAAW,CAAC,CAAD,CAAxB;EACA6C,IAAAA,qBAAqB,GAAG7C,WAAW,CAAC,CAAD,CAAnC;EACD;;EAED,MAAI4C,UAAU,IAAI,IAAlB,EAAwB;EACtBA,IAAAA,UAAU,GAAG,KAAb;EACD;;EAED,MAAII,eAAe,IAAI,IAAvB,EAA6B;EAC3BA,IAAAA,eAAe,GAAG,KAAlB;EACD;;EAED,MAAI5C,iBAAiB,IAAI,IAAzB,EAA+B;EAC7BA,IAAAA,iBAAiB,GAAG,kBAApB;EACD,GA3D2C;;;EA8D5C,MAAI,OAAOvI,SAAS,CAACoJ,aAAjB,KAAmC,WAAvC,EAAoD;EAClD;EACD;;EAED,MAAMoC,MAAM,GAAGJ,cAAc,IAAI,IAAlB,IAA0BC,eAAe,IAAI,IAA5D,CAlE4C;;EAqE5C,MAAI1kB,MAAM,CAACI,QAAP,CAAgB0kB,QAAhB,KAA6B,QAA7B,IAAyC9lB,QAAQ,CAACoB,QAAT,CAAkBC,QAAlB,KAA+B,WAAxE,IAAuF,CAACwkB,MAA5F,EAAoG;EAClG,4DAAa/e,KAAb,CAAmB,oEAAnB;;EACA;EACD,GAxE2C;;;EA2E5C,MAAIuT,SAAS,CAACC,SAAV,CAAoBxZ,OAApB,CAA4B,QAA5B,MAA0C,CAAC,CAA/C,EAAkD;EAChD,QAAMilB,WAAW,GAAG1L,SAAS,CAACC,SAAV,CAAoB7Q,KAApB,CAA0B,eAA1B,CAApB;;EACA,QAAIsc,WAAW,IAAI,IAAf,IAAuB1O,QAAQ,CAAC0O,WAAW,CAAC,CAAD,CAAZ,EAAiB,EAAjB,CAAR,GAA+B,EAA1D,EAA8D;EAAE;EAAQ;EACzE,GAHD,MAGO,IAAI1L,SAAS,CAACC,SAAV,CAAoBxZ,OAApB,CAA4B,SAA5B,MAA2C,CAAC,CAAhD,EAAmD;EACxD,QAAMklB,YAAY,GAAG3L,SAAS,CAACC,SAAV,CAAoB7Q,KAApB,CAA0B,gBAA1B,CAArB;;EACA,QAAIuc,YAAY,IAAI,IAAhB,IAAwB3O,QAAQ,CAAC2O,YAAY,CAAC,CAAD,CAAb,EAAkB,EAAlB,CAAR,GAAgC,EAA5D,EAAgE;EAAE;EAAQ;EAC3E,GAHM,MAGA,IAAI3L,SAAS,CAACC,SAAV,CAAoBxZ,OAApB,CAA4B,QAA5B,MAA0C,CAAC,CAA/C,EAAkD;EACvD,QAAMmlB,WAAW,GAAG5L,SAAS,CAACC,SAAV,CAAoB7Q,KAApB,CAA0B,eAA1B,CAApB;;EACA,QAAIwc,WAAW,IAAI,IAAf,IAAuB5O,QAAQ,CAAC4O,WAAW,CAAC,CAAD,CAAZ,EAAiB,EAAjB,CAAR,GAA+B,EAA1D,EAA8D;EAAE;EAAQ;EACzE,GAHM,MAGA;EACL;EACD,GAtF2C;;;EA0F5C,MAAI,CAACJ,MAAL,EAAa;EACX,QAAIK,YAAY,IAAI,IAApB,EAA0B;EACxB;EACD,KAHU;;;EAKX,QAAIA,YAAY,CAAChD,UAAb,KAA4B,SAAhC,EAA2C;EACzC;EACA,gGAAgCP,oBAAhC,EAAsDC,iBAAtD,EAAyEC,aAAzE,EAAwF8C,qBAAxF;;EACA;EACD,KAJD,MAIO,IAAIO,YAAY,CAAChD,UAAb,KAA4B,QAAhC,EAA0C;EAC/C;EACA;EACD;;EAED,QAAIkC,UAAJ,EAAgB;EACd,gGAAgCzC,oBAAhC,EAAsDC,iBAAtD,EAAyEC,aAAzE,EAAwF8C,qBAAxF;;EACA;EACD;EACF,GA5G2C;;;EA+G5C,MAAI,CAAChK,SAAD,IAAc,CAACqJ,QAAf,IAA2B,CAACC,YAA5B,IAA4C,CAACC,gBAAjD,EAAmE;EACjE,4DAAape,KAAb,CAAmB,wFAAnB;;EACA;EACD,GAlH2C;;;EAqH5C,MAAIqe,aAAa,IAAI,IAAjB,IAAyB,CAACA,aAAa,CAAC1b,KAAd,CAAoB,gBAApB,CAA9B,EAAqE;EACnE0b,IAAAA,aAAa,GAAG,SAAhB,CADmE;EAEpE,GAvH2C;;;EA0H5C,MAAM3F,GAAG,GAAG,IAAIzjB,IAAJ,GAAWoC,OAAX,KAAuB,IAAnC;;EACA,MAAKe,gBAAc,CAACoD,WAAf,CAA2B,iBAA3B,CAAD,IAAmD,IAAvD,EAA6D;EAC3DpD,IAAAA,gBAAc,CAACqD,WAAf,CAA2B,iBAA3B,EAA8Cid,GAA9C;EACD,GAFD,MAEO;EACL,QAAI6F,qBAAqB,IAAI,IAA7B,EAAmC;EACjC;EACAA,MAAAA,qBAAqB,GAAG,IAAI,EAAJ,GAAS,EAAT,GAAc,EAAtC;EACD;;EAED,QAAI7F,GAAG,GAAGtgB,gBAAc,CAACoD,WAAf,CAA2B,iBAA3B,CAAN,GAAsD+iB,qBAA1D,EAAiF;EAC/E;EACD,KAFD,MAEO;EACL;EACAnmB,MAAAA,gBAAc,CAACqD,WAAf,CAA2B,iBAA3B,EAA8Cid,GAA9C;EACD;EACF;;EAED,MAAIqG,MAAJ,EAAY;EACV;EACA,QAAMM,WAAW,GAAGnmB,QAAQ,CAACgK,aAAT,CAAuB,QAAvB,CAApB;EACAmc,IAAAA,WAAW,CAACnY,YAAZ,CAAyB,OAAzB,EAAkC,eAAlC;EACAmY,IAAAA,WAAW,CAACnY,YAAZ,CAAyB,KAAzB,EAAgC0X,eAAhC;EACA1lB,IAAAA,QAAQ,CAACya,IAAT,CAActM,WAAd,CAA0BgY,WAA1B;EACAnlB,IAAAA,MAAM,CAAColB,gBAAP,CAAwB,SAAxB,EAAmC,UAAC/H,KAAD,EAAW;EAC5C,UAAIA,KAAK,CAAC7e,IAAN,IAAc,IAAlB,EAAwB;EACtB,YAAIvD,GAAG,GAAG,EAAV;;EACA,YAAI;EACFA,UAAAA,GAAG,GAAGqD,IAAI,CAACI,KAAL,CAAW2e,KAAK,CAAC7e,IAAjB,CAAN;EACD,SAFD,CAEE,OAAOG,CAAP,EAAU;EACV;EACA;EACD;;EACD,YAAI1D,GAAG,CAACoqB,KAAJ,IAAa,IAAjB,EAAuB;EACrB,cAAIpqB,GAAG,CAACqqB,IAAJ,KAAa,IAAb,IAAqBrqB,GAAG,CAACoqB,KAAJ,KAAc,KAAvC,EAA8C;EAC5C,wCAAA,MAAI,iBAAJ,mBAAsBvJ,MAAtB,GAA+B,YAAM;EACnC;EACA9b,cAAAA,MAAM,CAACulB,mBAAP,CAA2BC,QAA3B,CAAoC;EAClC5K,gBAAAA,KAAK,EAAED,SAD2B;EAElClB,gBAAAA,IAAI,EAAEuK,QAF4B;EAGlCyB,gBAAAA,iBAAiB,EAAExB,YAHe;EAIlCyB,gBAAAA,kBAAkB,EAAEvB,aAJc;EAKlCD,gBAAAA,gBAAgB,EAAEA,gBALgB;EAMlCM,gBAAAA,eAAe,EAAEA;EANiB,eAApC,EAOG,UAAC/C,OAAD,EAAa;EAAE;EAChB,oBAAIA,OAAJ,EAAa;EACX;EACA,sBAAI,OAAO6C,UAAP,KAAsB,UAA1B,EAAsC;EACpCA,oBAAAA,UAAU;EACX,mBAJU;;;EAMXtkB,kBAAAA,MAAM,CAAC8X,IAAP,CAAY2M,cAAZ;EACD,iBAPD,MAOO;EACL,sBAAI,OAAOF,cAAP,KAA0B,UAA9B,EAA0C;EACxCA,oBAAAA,cAAc;EACf;EACF;;EACD,4CAAA,MAAI,oBAAJ;EACD,eArBD;EAsBD,aAxBD;EAyBD;EACF;EACF;EACF,KAvCD,EAuCG,KAvCH;EAwCD,GA9CD,MA8CO;EACL,wEAAsBzI,MAAtB,GAA+B,YAAM;EACnC;EACA9b,MAAAA,MAAM,CAACulB,mBAAP,CAA2BC,QAA3B,CAAoC;EAClC5K,QAAAA,KAAK,EAAED,SAD2B;EAElClB,QAAAA,IAAI,EAAEuK,QAF4B;EAGlCyB,QAAAA,iBAAiB,EAAExB,YAHe;EAIlCyB,QAAAA,kBAAkB,EAAEvB,aAJc;EAKlCD,QAAAA,gBAAgB,EAAEA,gBALgB;EAMlCM,QAAAA,eAAe,EAAEA;EANiB,OAApC,EAOG,UAAC/C,OAAD,EAAa;EAAE;EAChB,YAAIA,OAAJ,EAAa;EACX;EACA,cAAI,OAAO6C,UAAP,KAAsB,UAA1B,EAAsC;EACpCA,YAAAA,UAAU;EACX;;EACD,sCAAA,MAAI,6BAAJ,6BAAgC3C,oBAAhC,EAAsDC,iBAAtD,EAAyEC,aAAzE,EAAwF8C,qBAAxF;EACD,SAND,MAMO;EACL,cAAI,OAAOJ,cAAP,KAA0B,UAA9B,EAA0C;EACxCA,YAAAA,cAAc;EACf;EACF;;EACD,oCAAA,MAAI,oBAAJ;EACD,OApBD;EAqBD,KAvBD;EAwBD;EACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MC9XkBoB;;;0BAaR;EACT,yCAAO,IAAP;EACD;wBAEQ/pB,OAAO;EACd,UAAMgqB,KAAK,GAAGhqB,KAAK,KAAK,IAAxB;;EACA,UAAI,sDAAgBgqB,KAAhB,IAAyB,oEAAuB,CAApD,EAAuD;EACrD;EACA,YAAIA,KAAJ,EAAW;EACT5mB,UAAAA,QAAQ,CAAComB,gBAAT,CAA0B,OAA1B,8BAAmC,IAAnC;EACD,SAFD,MAEO;EACLpmB,UAAAA,QAAQ,CAAC6mB,mBAAT,CAA6B,OAA7B,8BAAsC,IAAtC;EACD;EACF;;EACD,0DAAcD,KAAd;EACD;;;EAED,uBAA6B;EAAA;EAAA;EAAA;EAAA;EAAA;;EAAA,QAAhBnZ,SAAgB,uEAAJ,EAAI;;EAAA;;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA,aApBJ,wEAAuBqZ,IAAvB,CAA4B,IAA5B;EAoBI;EAAA,SAnB7BC,qBAmB6B;EAC3B,sEAAqB,CAArB;EACA,SAAKC,wBAAL,GAAgC,KAAKA,wBAAL,CAA8BF,IAA9B,CAAmC,IAAnC,CAAhC;;EACA,SAAKrJ,wBAAL,GAAgC,YAAM,EAAtC;;EACA,8DAAe,IAAIyC,MAAJ,CAAWL,SAAS,CAACG,IAArB,CAAf;EACA,gEAAgB,IAAI3nB,OAAJ,uBAAYoV,SAAS,CAAC6F,OAAtB,uDAAY,mBAAoB,CAApB,CAAZ,EAAoC7F,SAAS,CAAClV,MAAV,4BAAoBkV,SAAS,CAAC6F,OAA9B,wDAAoB,oBAAoB,CAApB,CAApB,CAApC,EAAgF7F,SAAS,CAACjV,YAAV,4BAA0BiV,SAAS,CAAC6F,OAApC,wDAA0B,oBAAoB,CAApB,CAA1B,CAAhF,CAAhB;EACA,8DAAe,IAAI3M,aAAJ,CAAkB;EAAE3J,MAAAA,MAAM,8BAAE,IAAF;EAAR,KAAlB,CAAf;EACA,gEAAgB,IAAI0jB,cAAJ,CAAmB;EACjC1jB,MAAAA,MAAM,8BAAE,IAAF,uBAD2B;EAEjCsL,MAAAA,uBAAuB,EAAE,KAAK0e;EAFG,KAAnB,CAAhB;EAIA,gEAAgB,IAAIC,cAAJ,CAAkB;EAChCjqB,MAAAA,MAAM,8BAAE,IAAF,uBAD0B;EAEhCsW,MAAAA,OAAO,8BAAE,IAAF,yBAFyB;EAGhClO,MAAAA,MAAM,8BAAE,IAAF,uBAH0B;EAIhCC,MAAAA,OAAO,8BAAE,IAAF,yBAJyB;EAKhCiD,MAAAA,uBAAuB,EAAE,KAAK0e;EALE,KAAlB,CAAhB;EAOA,SAAKD,qBAAL,GAA6BtZ,SAAS,CAACsZ,qBAAV,IAAmC,KAAhE;EACA,SAAK1I,KAAL,GAAa,IAAIjW,YAAJ,CAAiB;EAC5BpL,MAAAA,MAAM,8BAAE,IAAF,uBADsB;EAE5BmI,MAAAA,OAAO,8BAAE,IAAF,yBAFqB;EAG5BmD,MAAAA,uBAAuB,EAAE,KAAK0e;EAHF,KAAjB,EAIVvZ,SAAS,CAAC4Q,KAJA,CAAb;EAMA,SAAK9J,OAAL,GAAe,IAAIV,cAAJ,CAAmB;EAChC7W,MAAAA,MAAM,8BAAE,IAAF,uBAD0B;EAEhCmI,MAAAA,OAAO,8BAAE,IAAF,yBAFyB;EAGhCmO,MAAAA,OAAO,8BAAE,IAAF,yBAHyB;EAIhChL,MAAAA,uBAAuB,EAAE,KAAK0e;EAJE,KAAnB,EAKZvZ,SAAS,CAAC8G,OALE,CAAf;EAOA,SAAK2S,WAAL,GAAmB,IAAIpS,gBAAJ,CAAqB;EACtC3P,MAAAA,OAAO,8BAAE,IAAF,yBAD+B;EAEtCmO,MAAAA,OAAO,8BAAE,IAAF,yBAF+B;EAGtCjO,MAAAA,OAAO,8BAAE,IAAF,yBAH+B;EAItCrI,MAAAA,MAAM,8BAAE,IAAF,uBAJgC;EAKtCoI,MAAAA,MAAM,8BAAE,IAAF;EALgC,KAArB,EAMhBqI,SAAS,CAACyZ,WANM,CAAnB;EAQA,SAAKC,OAAL,GAAe,IAAIjF,OAAJ,CAAY;EACzB/c,MAAAA,OAAO,8BAAE,IAAF,yBADkB;EAEzBmO,MAAAA,OAAO,8BAAE,IAAF,yBAFkB;EAGzBtW,MAAAA,MAAM,8BAAE,IAAF;EAHmB,KAAZ,EAIZyQ,SAAS,CAAC0Z,OAJE,CAAf;EAMA,SAAKC,aAAL,GAAqB,IAAI7E,mBAAJ,CAAwB;EAC3CvlB,MAAAA,MAAM,8BAAE,IAAF,uBADqC;EAE3CmI,MAAAA,OAAO,8BAAE,IAAF,yBAFoC;EAG3CmO,MAAAA,OAAO,8BAAE,IAAF;EAHoC,KAAxB,EAIlB7F,SAAS,CAAC2Z,aAJQ,CAArB;EAMA,oDAAY,IAAIliB,YAAJ,CAAiB;EAC3BlI,MAAAA,MAAM,8BAAE,IAAF,uBADqB;EAE3BmI,MAAAA,OAAO,8BAAE,IAAF,yBAFoB;EAG3BC,MAAAA,MAAM,8BAAE,IAAF,uBAHqB;EAI3BC,MAAAA,OAAO,8BAAE,IAAF;EAJoB,KAAjB,CAAZ;EAOA,SAAKgiB,GAAL,GAAW5Z,SAAS,CAAC4Z,GAArB;EAEA,SAAKvX,IAAL,GAAY,IAAI4P,IAAJ,CAAS;EACnBpX,MAAAA,uBAAuB,EAAE,KAAK0e;EADX,KAAT,CAAZ;EAIA,SAAK3hB,OAAL,GAAe;EACbiiB,MAAAA,cAAc,EAAE,0BAAM;EACpB,eAAO,4BAAA,KAAI,aAAJ,aAAcA,cAAd,EAAP;EACD,OAHY;EAIbC,MAAAA,YAAY,EAAE,wBAAM;EAClB,eAAO,4BAAA,KAAI,aAAJ,aAAcA,YAAd,EAAP;EACD;EANY,KAAf;;EASA,SAAKC,MAAL,GAAc,YAAM;EAClB,kCAAA,KAAI,YAAJ,YAAa3kB,KAAb,CAAmB,eAAnB;;EACA3D,MAAAA,gBAAc,CAAC4W,uBAAf;EACD,KAHD;;EAKA,SAAKN,KAAL,GAAa,YAAM;EACjB,MAAA,KAAI,CAAC0R,WAAL,CAAiB1R,KAAjB;EACD,KAFD;;EAIA,SAAKiS,cAAL,GAAsB,YAAM;EAC1B,aAAO,4BAAA,KAAI,YAAJ,YAAa7gB,OAAb,EAAP;EACD,KAFD;;EAIA,SAAK8gB,YAAL,GAAoB,YAAM;EACxB,aAAO,4BAAA,KAAI,aAAJ,aAAcpvB,EAArB;EACD,KAFD;;EAIA,SAAKqvB,WAAL,GAAmB,YAAM;EACvB,aAAO,4BAAA,KAAI,aAAJ,aAAchvB,iBAArB;EACD,KAFD,CA3F2B;;;EAgG3B,SAAKivB,eAAL,GAAuB,UAACC,GAAD,EAAS;EAC9B,kCAAA,KAAI,aAAJ,aAAcnvB,YAAd,GAA6BmvB,GAA7B;EACA,UAAMroB,IAAI,GAAG,EAAb;EACAA,MAAAA,IAAI,CAACsoB,EAAL,GAAU;EAAEC,QAAAA,GAAG,EAAE,aAAa,4BAAA,KAAI,aAAJ,aAAcrvB;EAAlC,OAAV;;EACA,UAAI0U,WAAW,GAAG,4BAAA,KAAI,aAAJ,aAAcuH,WAAhC;;EACAvH,MAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,MAAd,EAAsB,MAAtB,CAAtB;EACAA,MAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,GAAd,EAAmBpC,YAAY,CAAC1L,IAAI,CAACC,SAAL,CAAeC,IAAf,CAAD,8BAAuB,KAAvB,wBAA/B,CAAtB;EACA4N,MAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,GAAd,EAAmBpC,YAAY,CAAC1L,IAAI,CAACC,SAAL,CAAeC,IAAf,CAAD,8BAAuB,KAAvB,wBAA/B,CAAtB;;EAEA,kCAAA,KAAI,aAAJ,aAAcoV,kBAAd,CAAiCxH,WAAjC,EAA8C,KAA9C;EACD,KAVD;;EAYA,SAAK4a,WAAL,GAAmB,UAACC,CAAD,EAAO;EACxB,kCAAA,KAAI,YAAJ,YAAa9H,QAAb,GAAwB+H,MAAM,CAACD,CAAD,CAA9B;EACD,KAFD;;EAIA,QAAME,wBAAwB,GAAG,SAA3BA,wBAA2B,CAAChV,YAAD,EAAeC,SAAf,EAA0BC,WAA1B,EAA0C;EACzEH,MAAAA,uBAAuB,CAACC,YAAD,EAAeC,SAAf,EAA0BC,WAA1B,8BAAuC,KAAvC,uDAAsD,KAAtD,wBAAvB;EACD,KAFD;;EAIA,QAAM+U,GAAG,+BAAG,IAAH,aAAT;;EACAA,IAAAA,GAAG,CAACZ,MAAJ,GAAa,KAAKA,MAAlB;EACAY,IAAAA,GAAG,CAAC5S,KAAJ,GAAY,KAAKA,KAAjB;;EACA4S,IAAAA,GAAG,CAAChW,WAAJ,GAAkB,UAACpD,UAAD,EAAaqD,YAAb,EAA8B;EAC9CD,MAAAA,WAAW,CAACpD,UAAD,EAAaqD,YAAb,EAA2B,4BAAA,KAAI,aAAJ,aAAcoF,SAAzC,CAAX;EACD,KAFD;;EAGA2Q,IAAAA,GAAG,CAACC,aAAJ,GAAoB,UAAC5F,OAAD,EAAUC,oBAAV,EAAmC;EACrD,MAAA,KAAI,CAAC0E,aAAL,CAAmBkB,cAAnB,CAAkC7F,OAAlC,EAA2CC,oBAA3C;EACD,KAFD;;EAGA0F,IAAAA,GAAG,CAACG,EAAJ,GAAS,UAACvS,GAAD,EAAS;EAChBD,MAAAA,GAAG,CAACC,GAAD,EAAM;EACP5Q,QAAAA,MAAM,8BAAE,KAAF,uBADC;EAEPC,QAAAA,OAAO,8BAAE,KAAF,yBAFA;EAGPF,QAAAA,OAAO,8BAAE,KAAF,yBAHA;EAIPnI,QAAAA,MAAM,8BAAE,KAAF;EAJC,OAAN,CAAH;EAMD,KAPD;;EAQAorB,IAAAA,GAAG,CAACpV,OAAJ,GAAc,UAACC,OAAD,EAAa;EACzBD,MAAAA,OAAO,CAACC,OAAD,8BAAU,KAAV,wBAAP;EACD,KAFD;;EAGAmV,IAAAA,GAAG,CAACI,eAAJ,GAAsB,YAAM;EAC1B,aAAQ,4BAAA,KAAI,gBAAJ,oBAAuB,CAA/B;EACD,KAFD;;EAGAJ,IAAAA,GAAG,CAACK,QAAJ,GAAe,UAACrV,SAAD,EAAe;EAC5B+U,MAAAA,wBAAwB,CAAC,GAAD,EAAM/U,SAAN,CAAxB;EACD,KAFD;;EAGAgV,IAAAA,GAAG,CAACM,QAAJ,GAAe,UAACtV,SAAD,EAAYuV,UAAZ,EAA2B;EACxCR,MAAAA,wBAAwB,CAAC,IAAD,EAAO/U,SAAP,EAAkBuV,UAAlB,CAAxB;EACD,KAFD;;EAGAP,IAAAA,GAAG,CAACQ,UAAJ,GAAiB,UAACxV,SAAD,EAAe;EAC9B+U,MAAAA,wBAAwB,CAAC,GAAD,EAAM/U,SAAN,CAAxB;EACD,KAFD;;EAGAgV,IAAAA,GAAG,CAACS,gBAAJ,GAAuB,UAACzV,SAAD,EAAe;EACpC9R,MAAAA,GAAG,CAACwC,WAAJ,GAAkB,EAAlB;EACA,UAAMglB,QAAQ,GAAG9oB,QAAQ,CAAC6N,sBAAT,CAAgC,2BAAhC,CAAjB;;EAEA,WAAK,IAAIhD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGie,QAAQ,CAACzrB,MAA7B,EAAqCwN,CAAC,EAAtC,EAA0C;EACxC,YAAMoE,OAAO,GAAG6Z,QAAQ,CAACje,CAAD,CAAxB;;EACA,YAAIoE,OAAO,CAACpP,IAAZ,EAAkB;EAChB,cAAML,IAAI,GAAG;EAAEK,YAAAA,IAAI,EAAEoP,OAAO,CAACpP,IAAhB;EAAsBkpB,YAAAA,cAAc,EAAE9Z,OAAO,CAAC+Z;EAA9C,WAAb;EACA1nB,UAAAA,GAAG,CAACwC,WAAJ,CAAgBQ,IAAhB,CAAqB9E,IAArB;EACD;EACF;;EAED2oB,MAAAA,wBAAwB,CAACttB,6BAAD,EAAgCuY,SAAhC,CAAxB;EACD,KAbD;;EAcAgV,IAAAA,GAAG,CAACa,qBAAJ,GAA4B,UAACrsB,KAAD,EAAW;EACrC0E,MAAAA,GAAG,CAACwC,WAAJ,GAAkBlH,KAAlB;EACD,KAFD;;EAGAwrB,IAAAA,GAAG,CAACc,qBAAJ,GAA4B,YAAM;EAChC,aAAO5nB,GAAG,CAACwC,WAAX;EACD,KAFD;;EAGAskB,IAAAA,GAAG,CAACe,wBAAJ,GAA+B,UAAC/V,SAAD,EAAYgW,aAAZ,EAA8B;EAC3DhB,MAAAA,GAAG,CAACa,qBAAJ,CAA0BG,aAA1B;;EACAjB,MAAAA,wBAAwB,CAACttB,6BAAD,EAAgCuY,SAAhC,CAAxB;EACD,KAHD;;EAIAgV,IAAAA,GAAG,CAACiB,sBAAJ,GAA6B,UAAC9U,OAAD,EAAa;EACxC,UAAIA,OAAO,CAACzZ,eAAD,CAAX,EAA8B;EAC5BwG,QAAAA,GAAG,CAACyC,mBAAJ,GAA0BwQ,OAAO,CAACzZ,eAAD,CAAjC;EACD;EACF,KAJD;;EAKAkG,IAAAA,MAAM,CAACsoB,QAAP,GAAkBtoB,MAAM,CAACuoB,QAAP,GAAkBnB,GAApC;;EAEA,+BAAI3a,SAAS,CAAC6F,OAAd,wDAAI,oBAAoB,CAApB,EAAuBhb,EAA3B,EAA+B;EAC7B;EACA;EACA;EACA,WAAKkxB,IAAL;EACD;EACF;;;;iDAE2B;;;2BAItB/wB,WAAWF,QAAQC,cAAc;EACrC,UAAI,oEAAuB,CAA3B,EAA8B;EAC5B;EACA;EACD;;EACD0G,MAAAA,gBAAc,CAAC8C,YAAf,CAA4B,QAA5B,EAAsChB,MAAM,CAACI,QAAP,CAAgBC,QAAtD;;EACA,UAAI,CAAC,0DAAc/I,EAAnB,EAAuB;EACrB,YAAI,CAACG,SAAL,EAAgB;EACd,kEAAaqO,KAAb,CAAmBG,WAAnB;;EACA;EACD;;EACD,kEAAc3O,EAAd,GAAmBG,SAAnB;EACD;;EACD,gEAAcid,UAAd,GAA2Bpc,cAAc,GAAG,GAAjB,GAAuB,0DAAchB,EAAhE;;EAEA,UAAIC,MAAJ,EAAY;EACV,kEAAcA,MAAd,GAAuBA,MAAvB;EACD;;EACD,UAAIC,YAAJ,EAAkB;EAChB,kEAAcA,YAAd,GAA6BA,YAA7B;EACD;;EAED,UAAMixB,YAAY,GAAGroB,QAAQ,CAAC6I,IAA9B;EACA,UAAMV,SAAS,GAAGF,YAAY,CAACogB,YAAY,CAAC5M,WAAb,EAAD,CAA9B,CAvBqC;;EA0BrC,UAAI,OAAOtT,SAAS,CAAC5J,CAAjB,KAAuB,WAAvB,IAAsC4J,SAAS,CAACmgB,OAAV,IAAqB,GAA/D,EAAoE;EAClE;EACD;;EAED,gEAAchjB,mBAAd;;EACA;;EAEA,WAAKijB,WAAL;;EAEA,sCAAI,IAAJ,mBAAiB;EACf;EACA3pB,QAAAA,QAAQ,CAAComB,gBAAT,CAA0B,OAA1B,8BAAmC,IAAnC;EACD,OAHD,MAGO;EACL;EACApmB,QAAAA,QAAQ,CAAC6mB,mBAAT,CAA6B,OAA7B,8BAAsC,IAAtC;EACD;;EACD,wEAAqB,CAArB;EACD;;;oCAgBc;EAAA;;EACb,UAAM4C,YAAY,GAAGzoB,MAAM,CAACI,QAAP,CAAgB6I,IAArC;EACA,UAAMV,SAAS,GAAGF,YAAY,CAACogB,YAAY,CAAC5M,WAAb,EAAD,CAA9B,CAFa;;EAIb,UAAM5gB,GAAG,GAAG,0DAAcoK,sBAAd,EAAZ;;EACA,UAAIujB,OAAO,GAAI,OAAO3tB,GAAG,CAACyX,CAAX,KAAiB,WAAlB,GAAiC,CAAjC,GAAqCzX,GAAG,CAACyX,CAAvD;EACAzX,MAAAA,GAAG,CAACyX,CAAJ,GAAQ,EAAEkW,OAAV;;EACA,gEAAcpjB,sBAAd,CAAqCvK,GAArC,EAPa;;;EAUb,UAAIuD,IAAI,GAAG,EAAX;EACA,UAAIqqB,cAAc,GAAG/f,SAAS,CAAC9J,QAAQ,CAAC8pB,QAAV,CAA9B;;EAEA,UAAI9oB,MAAM,CAACI,QAAP,CAAgBC,QAAhB,KAA6BwoB,cAAjC,EAAiD;EAC/C,YAAME,MAAM,GAAG,GAAf;;EACA,YAAIF,cAAc,KAAK,EAAvB,EAA2B;EACzBA,UAAAA,cAAc,GAAGA,cAAc,CAACxsB,MAAf,GAAwB0sB,MAAxB,GAAiCF,cAAc,CAACvsB,SAAf,CAAyB,CAAzB,EAA4BysB,MAA5B,CAAjC,GAAuEF,cAAxF;EACArqB,UAAAA,IAAI,CAACsqB,QAAL,GAAgBD,cAAhB;EACD;;EAED,YAAIG,SAAS,GAAGzgB,SAAS,CAAC0gB,UAAV,IAAwB1gB,SAAS,CAAC2gB,WAAlD;;EACA,YAAI,OAAOF,SAAP,KAAqB,WAAzB,EAAsC;EACpCA,UAAAA,SAAS,GAAGA,SAAS,CAAC3sB,MAAV,GAAmB0sB,MAAnB,GAA4BC,SAAS,CAAC1sB,SAAV,CAAoB,CAApB,EAAuBysB,MAAvB,CAA5B,GAA6DC,SAAzE;EACAxqB,UAAAA,IAAI,CAAC2qB,EAAL,GAAUH,SAAV,CAFoC;EAGrC;;EAED,YAAII,SAAS,GAAG7gB,SAAS,CAAC8gB,UAAV,IAAwB9gB,SAAS,CAAC+gB,WAAlD;;EACA,YAAI,OAAOF,SAAP,KAAqB,WAAzB,EAAsC;EACpCA,UAAAA,SAAS,GAAGA,SAAS,CAAC/sB,MAAV,GAAmB0sB,MAAnB,GAA4BK,SAAS,CAAC9sB,SAAV,CAAoB,CAApB,EAAuBysB,MAAvB,CAA5B,GAA6DK,SAAzE;EACA5qB,UAAAA,IAAI,CAAC+qB,EAAL,GAAUH,SAAV,CAFoC;EAGrC;;EAED,YAAII,WAAW,GAAGjhB,SAAS,CAACkhB,YAAV,IAA0BlhB,SAAS,CAACmhB,aAAtD;;EACA,YAAI,OAAOF,WAAP,KAAuB,WAA3B,EAAwC;EACtCA,UAAAA,WAAW,GAAGA,WAAW,CAACntB,MAAZ,GAAqB0sB,MAArB,GAA8BS,WAAW,CAACltB,SAAZ,CAAsB,CAAtB,EAAyBysB,MAAzB,CAA9B,GAAiES,WAA/E;EACAhrB,UAAAA,IAAI,CAACmrB,EAAL,GAAUH,WAAV,CAFsC;EAGvC,SAvB8C;;;EA0B/C,YAAI,OAAOjhB,SAAS,CAAC+gB,WAAjB,KAAiC,WAArC,EAAkD;EAChD,cAAMM,EAAE,GAAGrhB,SAAS,CAAC+gB,WAArB;;EACA,cAAIM,EAAE,CAACnhB,KAAH,CAAS,2BAAT,CAAJ,EAA2C;EACzCjK,YAAAA,IAAI,CAACorB,EAAL,GAAUA,EAAV,CADyC;EAE1C;EACF;EACF;;EAEDprB,MAAAA,IAAI,GAAG,0DAAcgV,qBAAd,CAAoChV,IAApC,EAA0C3C,SAA1C,CAAP;EACA2C,MAAAA,IAAI,CAACqrB,GAAL,GAAWpB,YAAX;EAEAjqB,MAAAA,IAAI,CAACnG,gBAAD,CAAJ,GAAyBmV,mBAAmB,EAA5C;;EACA,UAAIpB,WAAW,GAAG,0DAAcuH,WAAhC;;EACA,gEAAcF,QAAd,CAAuBjV,IAAvB,EApDa;;;EAsDb,UAAI6X,QAAQ,CAAC7X,IAAI,CAAC+hB,EAAN,CAAR,KAAsB,CAA1B,EAA6B;EAC3B,kFAAwB/hB,IAAxB;EACD;;EACDA,MAAAA,IAAI,CAACsoB,EAAL,GAAU;EAAEgD,QAAAA,GAAG,EAAE;EAAP,OAAV;EACA1d,MAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,MAAd,EAAsB,MAAtB,CAAtB;EACAA,MAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,GAAd,EAAmBpC,YAAY,CAAC1L,IAAI,CAACC,SAAL,CAAeC,IAAf,CAAD,8BAAuB,IAAvB,wBAA/B,CAAtB;;EAEA,gEAAcoV,kBAAd,CAAiCxH,WAAjC,EAA8C,KAA9C;;EAEA,sEAAoBqc,YAApB;EACAjc,MAAAA,UAAU,CAAC,YAAM;EACf,YAAIoc,OAAO,IAAI,CAAf,EAAkB;EAChB;EACA,sCAAA,MAAI,eAAJ;EACD;;EAED,wCAAI,MAAJ,2CAA8B;EAC5B3M,UAAAA,WAAW,CAAC,YAAM;EAChB,wCAAA,MAAI,eAAJ;EACD,WAFU,EAERriB,8BAFQ,CAAX;EAGD;EACF,OAXS,EAWPD,yBAXO,CAAV;EAYD;;;iDAgB2B;EAC1B,aAAOuE,gBAAc,CAACC,wBAAf,MAA6C,KAAK4nB,qBAAzD;EACD;;;;;;yDA5GoB;EACnB,OAAKG,WAAL,CAAiB6D,iBAAjB;;EACA,OAAK5D,OAAL,CAAa4D,iBAAb;;EACA,OAAK1M,KAAL,CAAW0M,iBAAX;;EACA,OAAKxW,OAAL,CAAawW,iBAAb;;EACA,OAAK3D,aAAL,CAAmB2D,iBAAnB;EACD;;yDAEoB;EACnB,MAAI,kEAAsB3pB,QAAQ,CAAC6I,IAAnC,EAAyC;EACvC,SAAK0f,WAAL;EACD;EACF;;+CAgFe;EACd,MAAIvc,WAAW,GAAG,0DAAcuH,WAAhC;;EACA,MAAInV,IAAI,GAAG,EAAX;EACAA,EAAAA,IAAI,GAAG,0DAAcgV,qBAAd,CAAoChV,IAApC,EAA0C3C,SAA1C,CAAP;EACAuQ,EAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,MAAd,EAAsB5S,QAAtB,CAAtB;EACA4S,EAAAA,WAAW,GAAGlD,QAAQ,CAACkD,WAAD,EAAc,GAAd,EAAmBpC,YAAY,CAAC1L,IAAI,CAACC,SAAL,CAAeC,IAAf,CAAD,8BAAuB,IAAvB,wBAA/B,CAAtB;;EAEA,4DAAcoV,kBAAd,CAAiCxH,WAAjC,EAA8C,KAA9C;EACD;;yDAEoB;EACnB,SAAQ,OAAOpM,MAAM,CAACgqB,MAAd,KAAyB,WAAzB,IAAwChqB,MAAM,CAACgqB,MAAP,CAAcC,IAAd,KAAuB,YAAvE;EACD;;yDAMmBzrB,MAAM;EACxB,MAAI,KAAKwnB,wBAAL,EAAJ,EAAqC;EACnCxnB,IAAAA,IAAI,CAACmiB,KAAL,GAAa,IAAb;EACD;EACF;;MCtZGlU,SAAS,GAAG,IAAIyd,SAAJ,CAAclqB,MAAM,CAACyM,SAArB;EAElBzM,MAAM,CAACyM,SAAP,GAAmBzM,MAAM,CAAC0M,SAAP,GAAmBD,SAAtC;;;;;;;;"}
