{"version":3,"file":"clevertap.js","sources":["node_modules/regenerator-runtime/runtime.js","src/options.js","src/modules/account.js","src/util/constants.js","src/util/datatypes.js","src/util/datetime.js","src/util/storage.js","src/util/lruCache.js","src/modules/api.js","src/modules/device.js","src/util/messages.js","src/util/validator.js","src/modules/event.js","src/util/url.js","src/util/encoder.js","src/util/requestDispatcher.js","src/util/clevertap.js","src/modules/profile.js","src/modules/userLogin.js","src/util/web-personalisation/banner.js","src/util/web-personalisation/carousel.js","src/util/web-popupImageonly/popupImageonly.js","src/modules/web-inbox/Message.js","src/modules/web-inbox/inboxStyles.js","src/modules/web-inbox/WebInbox.js","src/modules/web-inbox/helper.js","src/util/tr.js","src/modules/user.js","src/modules/logger.js","src/modules/session.js","src/modules/request.js","src/modules/privacy.js","src/modules/notification.js","src/modules/variables/variable.js","src/modules/variables/variableStore.js","src/clevertap.js","src/main.js"],"sourcesContent":["/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var defineProperty = Object.defineProperty || function (obj, key, desc) { obj[key] = desc.value; };\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    defineProperty(generator, \"_invoke\", { value: makeInvokeMethod(innerFn, self, context) });\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = GeneratorFunctionPrototype;\n  defineProperty(Gp, \"constructor\", { value: GeneratorFunctionPrototype, configurable: true });\n  defineProperty(\n    GeneratorFunctionPrototype,\n    \"constructor\",\n    { value: GeneratorFunction, configurable: true }\n  );\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    defineProperty(this, \"_invoke\", { value: enqueue });\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  });\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per GeneratorResume behavior specified since ES2015:\n        // ES2015 spec, step 3: https://262.ecma-international.org/6.0/#sec-generatorresume\n        // Latest spec, step 2: https://tc39.es/ecma262/#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var methodName = context.method;\n    var method = delegate.iterator[methodName];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method, or a missing .next method, always terminate the\n      // yield* loop.\n      context.delegate = null;\n\n      // Note: [\"return\"] must be used for ES3 parsing compatibility.\n      if (methodName === \"throw\" && delegate.iterator[\"return\"]) {\n        // If the delegate iterator has a return method, give it a\n        // chance to clean up.\n        context.method = \"return\";\n        context.arg = undefined;\n        maybeInvokeDelegate(delegate, context);\n\n        if (context.method === \"throw\") {\n          // If maybeInvokeDelegate(context) changed context.method from\n          // \"return\" to \"throw\", let that override the TypeError below.\n          return ContinueSentinel;\n        }\n      }\n      if (methodName !== \"return\") {\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a '\" + methodName + \"' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  define(Gp, iteratorSymbol, function() {\n    return this;\n  });\n\n  define(Gp, \"toString\", function() {\n    return \"[object Generator]\";\n  });\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(val) {\n    var object = Object(val);\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable != null) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    throw new TypeError(typeof iterable + \" is not iterable\");\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, in modern engines\n  // we can explicitly access globalThis. In older engines we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","export const TARGET_DOMAIN = 'clevertap-prod.com'\nexport const TARGET_PROTOCOL = 'https:'\nexport const DEFAULT_REGION = 'eu1'\n","import { DEFAULT_REGION, TARGET_DOMAIN, TARGET_PROTOCOL } from '../options'\n\nexport default class Account {\n  #accountId\n  #region = ''\n  #targetDomain = TARGET_DOMAIN\n  #dcSdkversion = ''\n  #token = ''\n\n  constructor ({ id } = {}, region = '', targetDomain = TARGET_DOMAIN, token = '') {\n    this.id = id\n    if (region) {\n      this.region = region\n    }\n    if (targetDomain) {\n      this.targetDomain = targetDomain\n    }\n    if (token) {\n      this.token = token\n    }\n  }\n\n  get id () {\n    return this.#accountId\n  }\n\n  set id (accountId) {\n    this.#accountId = accountId\n  }\n\n  get region () {\n    return this.#region\n  }\n\n  set region (region) {\n    this.#region = region\n  }\n\n  get dcSDKVersion () {\n    return this.#dcSdkversion\n  }\n\n  set dcSDKVersion (dcSDKVersion) {\n    this.#dcSdkversion = dcSDKVersion\n  }\n\n  get targetDomain () {\n    return this.#targetDomain\n  }\n\n  set targetDomain (targetDomain) {\n    this.#targetDomain = targetDomain\n  }\n\n  get token () {\n    return this.#token\n  }\n\n  set token (token) {\n    this.#token = token\n  }\n\n  get finalTargetDomain () {\n    if (this.region) {\n      return `${this.region}.${this.targetDomain}`\n    } else {\n      if (this.targetDomain === TARGET_DOMAIN) {\n        return `${DEFAULT_REGION}.${this.targetDomain}`\n      }\n      return this.targetDomain\n    }\n  }\n\n  get dataPostPEURL () {\n    return `${TARGET_PROTOCOL}//${this.finalTargetDomain}/defineVars`\n  }\n\n  get dataPostURL () {\n    return `${TARGET_PROTOCOL}//${this.finalTargetDomain}/a?t=96`\n  }\n\n  get recorderURL () {\n    return `${TARGET_PROTOCOL}//${this.finalTargetDomain}/r?r=1`\n  }\n\n  get emailURL () {\n    return `${TARGET_PROTOCOL}//${this.finalTargetDomain}/e?r=1`\n  }\n}\n","export const unsupportedKeyCharRegex = new RegExp('^\\\\s+|\\\\\\.|\\:|\\\\\\$|\\'|\\\"|\\\\\\\\|\\\\s+$', 'g')\nexport const unsupportedValueCharRegex = new RegExp(\"^\\\\s+|\\'|\\\"|\\\\\\\\|\\\\s+$\", 'g')\nexport const doubleQuoteRegex = new RegExp('\\\"', 'g')\nexport const singleQuoteRegex = new RegExp('\\'', 'g')\nexport const CLEAR = 'clear'\nexport const CHARGED_ID = 'Charged ID'\nexport const CHARGEDID_COOKIE_NAME = 'WZRK_CHARGED_ID'\nexport const GCOOKIE_NAME = 'WZRK_G'\nexport const KCOOKIE_NAME = 'WZRK_K'\nexport const CAMP_COOKIE_NAME = 'WZRK_CAMP'\nexport const CAMP_COOKIE_G = 'WZRK_CAMP_G'// cookie for storing campaign details against guid\nexport const SCOOKIE_PREFIX = 'WZRK_S'\nexport const SCOOKIE_EXP_TIME_IN_SECS = 60 * 20 // 20 mins\nexport const EV_COOKIE = 'WZRK_EV'\nexport const META_COOKIE = 'WZRK_META'\nexport const PR_COOKIE = 'WZRK_PR'\nexport const ARP_COOKIE = 'WZRK_ARP'\nexport const LCOOKIE_NAME = 'WZRK_L'\nexport const NOTIF_COOKIE_NAME = 'WZRK_N'\nexport const GLOBAL = 'global' // used for email unsubscribe also\nexport const TOTAL_COUNT = 'tc'\nexport const DISPLAY = 'display'\nexport const UNDEFINED = 'undefined'\nexport const WEBPUSH_LS_KEY = 'WZRK_WPR'\nexport const OPTOUT_KEY = 'optOut'\nexport const CT_OPTOUT_KEY = 'ct_optout'\nexport const OPTOUT_COOKIE_ENDSWITH = ':OO'\nexport const USEIP_KEY = 'useIP'\nexport const LRU_CACHE = 'WZRK_X'\nexport const LRU_CACHE_SIZE = 100\nexport const IS_OUL = 'isOUL'\nexport const EVT_PUSH = 'push'\nexport const EVT_PING = 'ping'\nexport const COOKIE_EXPIRY = 86400 * 365 // 1 Year in seconds\nexport const MAX_TRIES = 200 // API tries\nexport const FIRST_PING_FREQ_IN_MILLIS = 2 * 60 * 1000 // 2 mins\nexport const CONTINUOUS_PING_FREQ_IN_MILLIS = 5 * 60 * 1000 // 5 mins\nexport const GROUP_SUBSCRIPTION_REQUEST_ID = '2'\nexport const categoryLongKey = 'cUsY'\nexport const WZRK_PREFIX = 'wzrk_'\nexport const WZRK_ID = 'wzrk_id'\nexport const NOTIFICATION_VIEWED = 'Notification Viewed'\nexport const NOTIFICATION_CLICKED = 'Notification Clicked'\nexport const FIRE_PUSH_UNREGISTERED = 'WZRK_FPU'\nexport const PUSH_SUBSCRIPTION_DATA = 'WZRK_PSD' // PUSH SUBSCRIPTION DATA FOR REGISTER/UNREGISTER TOKEN\nexport const COMMAND_INCREMENT = '$incr'\nexport const COMMAND_DECREMENT = '$decr'\nexport const COMMAND_SET = '$set'\nexport const COMMAND_ADD = '$add'\nexport const COMMAND_REMOVE = '$remove'\nexport const COMMAND_DELETE = '$delete'\nexport const WEBINBOX_CONFIG = 'WZRK_INBOX_CONFIG'\nexport const WEBINBOX = 'WZRK_INBOX'\nexport const MAX_INBOX_MSG = 15\nexport const VARIABLES = 'WZRK_PE'\nexport const PUSH_DELAY_MS = 1000\nexport const MAX_DELAY_FREQUENCY = 1000 * 60 * 10\nexport const WZRK_FETCH = 'wzrk_fetch'\n\nexport const SYSTEM_EVENTS = [\n  'Stayed',\n  'UTM Visited',\n  'App Launched',\n  'Notification Sent',\n  NOTIFICATION_VIEWED,\n  NOTIFICATION_CLICKED\n]\n","import {\n  unsupportedKeyCharRegex,\n  unsupportedValueCharRegex\n} from './constants'\n\nexport const isString = (input) => {\n  return (typeof input === 'string' || input instanceof String)\n}\n\nexport const isObject = (input) => {\n  // TODO: refine\n  return Object.prototype.toString.call(input) === '[object Object]'\n}\n\nexport const isDateObject = (input) => {\n  return typeof (input) === 'object' && (input instanceof Date)\n}\n\nexport const isObjectEmpty = (obj) => {\n  for (const prop in obj) {\n    if (obj.hasOwnProperty(prop)) { return false }\n  }\n  return true\n}\n\nexport const isConvertibleToNumber = (n) => {\n  return !isNaN(parseFloat(n)) && isFinite(n)\n}\n\nexport const isNumber = (n) => {\n  return /^-?[\\d.]+(?:e-?\\d+)?$/.test(n) && typeof n === 'number'\n}\n\nexport const isValueValid = (value) => {\n  if (value === null || value === undefined || value === 'undefined') {\n    return false\n  }\n  return true\n}\n\nexport const arrayContains = (arr, obj) => {\n  var i = arr.length\n  while (i--) {\n    if (arr[i] === obj) {\n      return true\n    }\n  }\n  return false\n}\n\nexport const removeUnsupportedChars = (o, logger) => {\n  // keys can't be greater than 1024 chars, values can't be greater than 1024 chars\n  if (typeof o === 'object') {\n    for (const key in o) {\n      if (o.hasOwnProperty(key)) {\n        const sanitizedVal = removeUnsupportedChars(o[key], logger)\n        let sanitizedKey\n        sanitizedKey = sanitize(key, unsupportedKeyCharRegex)\n        if (sanitizedKey.length > 1024) {\n          sanitizedKey = sanitizedKey.substring(0, 1024)\n          logger.reportError(520, sanitizedKey + '... length exceeded 1024 chars. Trimmed.')\n        }\n        delete o[key]\n        o[sanitizedKey] = sanitizedVal\n      }\n    }\n  } else {\n    let val\n\n    if (isString(o)) {\n      val = sanitize(o, unsupportedValueCharRegex)\n      if (val.length > 1024) {\n        val = val.substring(0, 1024)\n        logger.reportError(521, val + '... length exceeded 1024 chars. Trimmed.')\n      }\n    } else {\n      val = o\n    }\n    return val\n  }\n  return o\n}\n\nexport const sanitize = (input, regex) => {\n  return input.replace(regex, '')\n}\n","export const getToday = () => {\n  const today = new Date()\n  return today.getFullYear() + '' + today.getMonth() + '' + today.getDay()\n}\n\nexport const getNow = () => {\n  return Math.floor((new Date()).getTime() / 1000)\n}\n\nexport const convertToWZRKDate = (dateObj) => {\n  return ('$D_' + Math.round(dateObj.getTime() / 1000))\n}\n\nexport const setDate = (dt) => {\n  // expecting  yyyymmdd format either as a number or a string\n  if (isDateValid(dt)) {\n    return '$D_' + dt\n  }\n}\n\nexport const isDateValid = (date) => {\n  const matches = /^(\\d{4})(\\d{2})(\\d{2})$/.exec(date)\n  if (matches == null) return false\n  const d = matches[3]\n  const m = matches[2] - 1\n  const y = matches[1]\n  const composedDate = new Date(y, m, d)\n  // eslint-disable-next-line eqeqeq\n  return composedDate.getDate() == d && composedDate.getMonth() == m && composedDate.getFullYear() == y\n}\n","import {\n  GCOOKIE_NAME,\n  META_COOKIE,\n  KCOOKIE_NAME,\n  LCOOKIE_NAME\n} from './constants'\nexport class StorageManager {\n  static save (key, value) {\n    if (!key || !value) {\n      return false\n    }\n    if (this._isLocalStorageSupported()) {\n      localStorage.setItem(key, typeof value === 'string' ? value : JSON.stringify(value))\n      return true\n    }\n  }\n\n  static read (key) {\n    if (!key) {\n      return false\n    }\n    let data = null\n    if (this._isLocalStorageSupported()) {\n      data = localStorage.getItem(key)\n    }\n    if (data != null) {\n      try {\n        data = JSON.parse(data)\n      } catch (e) {}\n    }\n    return data\n  }\n\n  static remove (key) {\n    if (!key) {\n      return false\n    }\n    if (this._isLocalStorageSupported()) {\n      localStorage.removeItem(key)\n      return true\n    }\n  }\n\n  static removeCookie (name, domain) {\n    let cookieStr = name + '=; expires=Thu, 01 Jan 1970 00:00:01 GMT;'\n\n    if (domain) {\n      cookieStr = cookieStr + ' domain=' + domain + '; path=/'\n    }\n\n    document.cookie = cookieStr\n  }\n\n  static createCookie (name, value, seconds, domain) {\n    let expires = ''\n    let domainStr = ''\n    if (seconds) {\n      const date = new Date()\n      date.setTime(date.getTime() + (seconds * 1000))\n\n      expires = '; expires=' + date.toGMTString()\n    }\n\n    if (domain) {\n      domainStr = '; domain=' + domain\n    }\n\n    value = encodeURIComponent(value)\n\n    document.cookie = name + '=' + value + expires + domainStr + '; path=/'\n  }\n\n  static readCookie (name) {\n    const nameEQ = name + '='\n    const ca = document.cookie.split(';')\n    for (let idx = 0; idx < ca.length; idx++) {\n      let c = ca[idx]\n      while (c.charAt(0) === ' ') {\n        c = c.substring(1, c.length)\n      }\n      // eslint-disable-next-line eqeqeq\n      if (c.indexOf(nameEQ) == 0) {\n        return decodeURIComponent(c.substring(nameEQ.length, c.length))\n      }\n    }\n    return null\n  }\n\n  static _isLocalStorageSupported () {\n    return 'localStorage' in window && window.localStorage !== null && typeof window.localStorage.setItem === 'function'\n  }\n\n  static saveToLSorCookie (property, value) {\n    if (value == null) {\n      return\n    }\n    try {\n      if (this._isLocalStorageSupported()) {\n        this.save(property, encodeURIComponent(JSON.stringify(value)))\n      } else {\n        if (property === GCOOKIE_NAME) {\n          this.createCookie(property, encodeURIComponent(value), 0, window.location.hostname)\n        } else {\n          this.createCookie(property, encodeURIComponent(JSON.stringify(value)), 0, window.location.hostname)\n        }\n      }\n      $ct.globalCache[property] = value\n    } catch (e) {}\n  }\n\n  static readFromLSorCookie (property) {\n    let data\n    if ($ct.globalCache.hasOwnProperty(property)) {\n      return $ct.globalCache[property]\n    }\n    if (this._isLocalStorageSupported()) {\n      data = this.read(property)\n    } else {\n      data = this.readCookie(property)\n    }\n\n    if (data !== null && data !== undefined && !(typeof data.trim === 'function' && data.trim() === '')) {\n      let value\n      try {\n        value = JSON.parse(decodeURIComponent(data))\n      } catch (err) {\n        value = decodeURIComponent(data)\n      }\n      $ct.globalCache[property] = value\n      return value\n    }\n  }\n\n  static createBroadCookie (name, value, seconds, domain) {\n    // sets cookie on the base domain. e.g. if domain is baz.foo.bar.com, set cookie on \".bar.com\"\n    // To update an existing \"broad domain\" cookie, we need to know what domain it was actually set on.\n    // since a retrieved cookie never tells which domain it was set on, we need to set another test cookie\n    // to find out which \"broadest\" domain the cookie was set on. Then delete the test cookie, and use that domain\n    // for updating the actual cookie.\n\n    if (domain) {\n      let broadDomain = $ct.broadDomain\n      if (broadDomain == null) { // if we don't know the broadDomain yet, then find out\n        const domainParts = domain.split('.')\n        let testBroadDomain = ''\n        for (let idx = domainParts.length - 1; idx >= 0; idx--) {\n          if (idx === 0) {\n            testBroadDomain = domainParts[idx] + testBroadDomain\n          } else {\n            testBroadDomain = '.' + domainParts[idx] + testBroadDomain\n          }\n\n          // only needed if the cookie already exists and needs to be updated. See note above.\n          if (this.readCookie(name)) {\n            // no guarantee that browser will delete cookie, hence create short lived cookies\n            var testCookieName = 'test_' + name + idx\n            this.createCookie(testCookieName, value, 10, testBroadDomain) // self-destruct after 10 seconds\n            if (!this.readCookie(testCookieName)) { // if test cookie not set, then the actual cookie wouldn't have been set on this domain either.\n              continue\n            } else { // else if cookie set, then delete the test and the original cookie\n              this.removeCookie(testCookieName, testBroadDomain)\n            }\n          }\n\n          this.createCookie(name, value, seconds, testBroadDomain)\n          const tempCookie = this.readCookie(name)\n          // eslint-disable-next-line eqeqeq\n          if (tempCookie == value) {\n            broadDomain = testBroadDomain\n            $ct.broadDomain = broadDomain\n            break\n          }\n        }\n      } else {\n        this.createCookie(name, value, seconds, broadDomain)\n      }\n    } else {\n      this.createCookie(name, value, seconds, domain)\n    }\n  }\n\n  static getMetaProp (property) {\n    const metaObj = this.readFromLSorCookie(META_COOKIE)\n    if (metaObj != null) {\n      return metaObj[property]\n    }\n  }\n\n  static setMetaProp (property, value) {\n    if (this._isLocalStorageSupported()) {\n      let wzrkMetaObj = this.readFromLSorCookie(META_COOKIE)\n      if (wzrkMetaObj == null) {\n        wzrkMetaObj = {}\n      }\n      if (value === undefined) {\n        delete wzrkMetaObj[property]\n      } else {\n        wzrkMetaObj[property] = value\n      }\n      this.saveToLSorCookie(META_COOKIE, wzrkMetaObj)\n    }\n  }\n\n  static getAndClearMetaProp (property) {\n    const value = this.getMetaProp(property)\n    this.setMetaProp(property, undefined)\n    return value\n  }\n\n  static setInstantDeleteFlagInK () {\n    let k = this.readFromLSorCookie(KCOOKIE_NAME)\n    if (k == null) {\n      k = {}\n    }\n    k.flag = true\n    this.saveToLSorCookie(KCOOKIE_NAME, k)\n  }\n\n  static backupEvent (data, reqNo, logger) {\n    let backupArr = this.readFromLSorCookie(LCOOKIE_NAME)\n    if (typeof backupArr === 'undefined') {\n      backupArr = {}\n    }\n    backupArr[reqNo] = { q: data }\n    this.saveToLSorCookie(LCOOKIE_NAME, backupArr)\n    logger.debug(`stored in ${LCOOKIE_NAME} reqNo : ${reqNo} -> ${data}`)\n  }\n\n  static removeBackup (respNo, logger) {\n    const backupMap = this.readFromLSorCookie(LCOOKIE_NAME)\n    if (typeof backupMap !== 'undefined' && backupMap !== null && typeof backupMap[respNo] !== 'undefined') {\n      logger.debug(`del event: ${respNo} data-> ${backupMap[respNo].q}`)\n      delete backupMap[respNo]\n      this.saveToLSorCookie(LCOOKIE_NAME, backupMap)\n    }\n  }\n}\n\nexport const $ct = {\n  globalCache: {\n    gcookie: null,\n    REQ_N: 0,\n    RESP_N: 0\n  },\n  LRU_CACHE: null,\n  globalProfileMap: undefined,\n  globalEventsMap: undefined,\n  blockRequest: false,\n  isOptInRequest: false,\n  broadDomain: null,\n  webPushEnabled: null,\n  campaignDivMap: {},\n  currentSessionId: null,\n  wiz_counter: 0, // to keep track of number of times we load the body\n  notifApi: {\n    notifEnabledFromApi: false\n  }, // helper variable to handle race condition and check when notifications were called\n  unsubGroups: [],\n  updatedCategoryLong: null,\n  inbox: null,\n  isPrivacyArrPushed: false,\n  privacyArray: [],\n  offline: false,\n  location: null,\n  dismissSpamControl: false,\n  globalUnsubscribe: true,\n  flutterVersion: null,\n  variableStore: {}\n  // domain: window.location.hostname, url -> getHostName()\n  // gcookie: -> device\n}\n","import { StorageManager } from './storage'\nimport { LRU_CACHE } from './constants'\n\nexport default class LRUCache {\n  #keyOrder\n\n  constructor (max) {\n    this.max = max\n    let lruCache = StorageManager.readFromLSorCookie(LRU_CACHE)\n    if (lruCache) {\n      const tempLruCache = {}\n      this.#keyOrder = []\n      lruCache = lruCache.cache\n      for (const entry in lruCache) {\n        if (lruCache.hasOwnProperty(entry)) {\n          tempLruCache[lruCache[entry][0]] = lruCache[entry][1]\n          this.#keyOrder.push(lruCache[entry][0])\n        }\n      }\n      this.cache = tempLruCache\n    } else {\n      this.cache = {}\n      this.#keyOrder = []\n    }\n  }\n\n  get (key) {\n    const item = this.cache[key]\n    if (item) {\n      this.cache = this.#deleteFromObject(key, this.cache)\n      this.cache[key] = item\n      this.#keyOrder.push(key)\n    }\n    this.saveCacheToLS(this.cache)\n    return item\n  }\n\n  set (key, value) {\n    const item = this.cache[key]\n    const allKeys = this.#keyOrder\n    if (item != null) {\n      this.cache = this.#deleteFromObject(key, this.cache)\n    } else if (allKeys.length === this.max) {\n      this.cache = this.#deleteFromObject(allKeys[0], this.cache)\n    }\n    this.cache[key] = value\n    if (this.#keyOrder[this.#keyOrder - 1] !== key) {\n      this.#keyOrder.push(key)\n    }\n    this.saveCacheToLS(this.cache)\n  }\n\n  saveCacheToLS (cache) {\n    const objToArray = []\n    const allKeys = this.#keyOrder\n    for (const index in allKeys) {\n      if (allKeys.hasOwnProperty(index)) {\n        const temp = []\n        temp.push(allKeys[index])\n        temp.push(cache[allKeys[index]])\n        objToArray.push(temp)\n      }\n    }\n    StorageManager.saveToLSorCookie(LRU_CACHE, { cache: objToArray })\n  }\n\n  getKey (value) {\n    if (value === null) {\n      return null\n    }\n    const allKeys = this.#keyOrder\n    for (const index in allKeys) {\n      if (allKeys.hasOwnProperty(index)) {\n        if (this.cache[allKeys[index]] === value) {\n          return allKeys[index]\n        }\n      }\n    }\n    return null\n  }\n\n  getSecondLastKey () {\n    const keysArr = this.#keyOrder\n    if (keysArr != null && keysArr.length > 1) {\n      return keysArr[keysArr.length - 2]\n    }\n    return -1\n  }\n\n  getLastKey () {\n    const keysLength = this.#keyOrder.length\n    if (keysLength) {\n      return this.#keyOrder[keysLength - 1]\n    }\n  }\n\n  #deleteFromObject (key, obj) {\n    const allKeys = JSON.parse(JSON.stringify(this.#keyOrder))\n    const newCache = {}\n    let indexToDelete\n    for (const index in allKeys) {\n      if (allKeys.hasOwnProperty(index)) {\n        if (allKeys[index] !== key) {\n          newCache[allKeys[index]] = obj[allKeys[index]]\n        } else {\n          indexToDelete = index\n        }\n      }\n    }\n    allKeys.splice(indexToDelete, 1)\n    this.#keyOrder = JSON.parse(JSON.stringify(allKeys))\n    return newCache\n  }\n}\n","import { COOKIE_EXPIRY, FIRE_PUSH_UNREGISTERED, GCOOKIE_NAME, KCOOKIE_NAME, LRU_CACHE_SIZE, USEIP_KEY } from '../util/constants'\nimport { isValueValid } from '../util/datatypes'\nimport { getNow } from '../util/datetime'\nimport LRUCache from '../util/lruCache'\nimport { StorageManager, $ct } from '../util/storage'\n\nexport default class CleverTapAPI {\n  #logger\n  #request\n  #device\n  #session\n\n  constructor ({ logger, request, device, session }) {\n    this.#logger = logger\n    this.#request = request\n    this.#device = device\n    this.#session = session\n  }\n\n  /**\n   *\n   * @param {string} global gcookie\n   * @param {string} session\n   * @param {boolean} resume sent true in case of an OUL request from client side, which is returned as it is by server\n   * @param {number} respNumber the index of the request in backupmanager\n   * @param {boolean} optOutResponse\n   * @returns\n   */\n\n  s (global, session, resume, respNumber, optOutResponse) {\n    let oulReq = false\n    let newGuid = false\n\n    // for a scenario when OUL request is true from client side\n    // but resume is returned as false from server end\n    // we maintan a OulReqN var in the window object\n    // and compare with respNumber to determine the response of an OUL request\n    if (window.isOULInProgress) {\n      if (resume || (respNumber !== 'undefined' && respNumber === window.oulReqN)) {\n        window.isOULInProgress = false\n        oulReq = true\n      }\n    }\n\n    // call back function used to store global and session ids for the user\n    if (typeof respNumber === 'undefined') {\n      respNumber = 0\n    }\n\n    StorageManager.removeBackup(respNumber, this.#logger)\n\n    if (respNumber > $ct.globalCache.REQ_N) {\n      // request for some other user so ignore\n      return\n    }\n\n    if (!isValueValid(this.#device.gcookie)) {\n      if (global) {\n        newGuid = true\n      }\n    }\n\n    if (!isValueValid(this.#device.gcookie) || resume || typeof optOutResponse === 'boolean') {\n      const sessionObj = this.#session.getSessionCookieObject()\n\n      /*  If the received session is less than the session in the cookie,\n          then don't update guid as it will be response for old request\n      */\n      if (window.isOULInProgress || (sessionObj.s && (session < sessionObj.s))) {\n        return\n      }\n      this.#logger.debug(`Cookie was ${this.#device.gcookie} set to ${global}`)\n      this.#device.gcookie = global\n      if (!isValueValid(this.#device.gcookie)) {\n        // clear useIP meta prop\n        StorageManager.getAndClearMetaProp(USEIP_KEY)\n      }\n      if (global && StorageManager._isLocalStorageSupported()) {\n        if ($ct.LRU_CACHE == null) {\n          $ct.LRU_CACHE = new LRUCache(LRU_CACHE_SIZE)\n        }\n\n        const kIdFromLS = StorageManager.readFromLSorCookie(KCOOKIE_NAME)\n        let guidFromLRUCache\n        if (kIdFromLS != null && kIdFromLS.id) {\n          guidFromLRUCache = $ct.LRU_CACHE.cache[kIdFromLS.id]\n          if (resume) {\n            if (!guidFromLRUCache) {\n              StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, true)\n              // replace login identity in OUL request\n              // with the gcookie returned in exchange\n              $ct.LRU_CACHE.set(kIdFromLS.id, global)\n            }\n          }\n        }\n\n        StorageManager.saveToLSorCookie(GCOOKIE_NAME, global)\n        // lastk provides the guid\n        const lastK = $ct.LRU_CACHE.getSecondLastKey()\n        if (StorageManager.readFromLSorCookie(FIRE_PUSH_UNREGISTERED) && lastK !== -1) {\n          const lastGUID = $ct.LRU_CACHE.cache[lastK]\n          // fire the request directly via fireRequest to unregister the token\n          // then other requests with the updated guid should follow\n          this.#request.unregisterTokenForGuid(lastGUID)\n        }\n      }\n      StorageManager.createBroadCookie(GCOOKIE_NAME, global, COOKIE_EXPIRY, window.location.hostname)\n      StorageManager.saveToLSorCookie(GCOOKIE_NAME, global)\n    }\n\n    if (StorageManager._isLocalStorageSupported()) {\n      this.#session.manageSession(session)\n    }\n\n    // session cookie\n    const obj = this.#session.getSessionCookieObject()\n\n    // for the race-condition where two responses come back with different session ids. don't write the older session id.\n    if (typeof obj.s === 'undefined' || obj.s <= session) {\n      obj.s = session\n      obj.t = getNow() // time of last response from server\n      this.#session.setSessionCookieObject(obj)\n    }\n\n    // set blockRequest to false only if the device has a valid gcookie\n    if (isValueValid(this.#device.gcookie)) {\n      $ct.blockRequest = false\n    }\n\n    // only process the backup events after an OUL request or a new guid is recieved\n    if ((oulReq || newGuid) && !this.#request.processingBackup) {\n      this.#request.processBackupEvents()\n    }\n\n    $ct.globalCache.RESP_N = respNumber\n  }\n}\n","import { isValueValid } from '../util/datatypes'\nimport { StorageManager } from '../util/storage'\nimport { GCOOKIE_NAME, COOKIE_EXPIRY } from '../util/constants'\n\nexport default class DeviceManager {\n  #logger\n  gcookie\n\n  constructor ({ logger }) {\n    this.#logger = logger\n    this.gcookie = this.getGuid()\n  }\n\n  getGuid () {\n    let guid = null\n    if (isValueValid(this.gcookie)) {\n      return this.gcookie\n    }\n    if (StorageManager._isLocalStorageSupported()) {\n      const value = StorageManager.read(GCOOKIE_NAME)\n      if (isValueValid(value)) {\n        try {\n          guid = JSON.parse(decodeURIComponent(value))\n        } catch (e) {\n          this.#logger.debug('Cannot parse Gcookie from localstorage - must be encoded ' + value)\n          // assumming guids are of size 32. supporting both formats.\n          // guid can have encodedURIComponent or be without it.\n          // 1.56e4078ed15749928c042479ec2b4d47 - breaks on JSON.parse(decodeURIComponent())\n          // 2.%2256e4078ed15749928c042479ec2b4d47%22\n          if (value.length === 32) {\n            guid = value\n            StorageManager.saveToLSorCookie(GCOOKIE_NAME, value)\n          } else {\n            this.#logger.error('Illegal guid ' + value)\n          }\n        }\n\n        // Persist to cookie storage if not present there.\n        if (isValueValid(guid)) {\n          StorageManager.createBroadCookie(GCOOKIE_NAME, guid, COOKIE_EXPIRY, window.location.hostname)\n        }\n      }\n    }\n\n    if (!isValueValid(guid)) {\n      guid = StorageManager.readCookie(GCOOKIE_NAME)\n      if (isValueValid(guid) && (guid.indexOf('%') === 0 || guid.indexOf('\\'') === 0 || guid.indexOf('\"') === 0)) {\n        guid = null\n      }\n      if (isValueValid(guid)) {\n        StorageManager.saveToLSorCookie(GCOOKIE_NAME, guid)\n      }\n    }\n\n    return guid\n  }\n}\n","export const DATA_NOT_SENT_TEXT = 'This property has been ignored.'\nexport const INVALID_ACCOUNT = 'Invalid account ID'\nexport const INVALID_EVENT = 'Event structure not valid. Unable to process event'\nexport const CLEVERTAP_ERROR_PREFIX = 'CleverTap error:' // Formerly wzrk_error_txt\nexport const EMBED_ERROR = `${CLEVERTAP_ERROR_PREFIX} Incorrect embed script.`\nexport const EVENT_ERROR = `${CLEVERTAP_ERROR_PREFIX} Event structure not valid. ${DATA_NOT_SENT_TEXT}`\nexport const GENDER_ERROR = `${CLEVERTAP_ERROR_PREFIX} Gender value should be either M or F. ${DATA_NOT_SENT_TEXT}`\nexport const EMPLOYED_ERROR = `${CLEVERTAP_ERROR_PREFIX} Employed value should be either Y or N. ${DATA_NOT_SENT_TEXT}`\nexport const MARRIED_ERROR = `${CLEVERTAP_ERROR_PREFIX} Married value should be either Y or N. ${DATA_NOT_SENT_TEXT}`\nexport const EDUCATION_ERROR = `${CLEVERTAP_ERROR_PREFIX} Education value should be either School, College or Graduate. ${DATA_NOT_SENT_TEXT}`\nexport const AGE_ERROR = `${CLEVERTAP_ERROR_PREFIX} Age value should be a number. ${DATA_NOT_SENT_TEXT}`\nexport const DOB_ERROR = `${CLEVERTAP_ERROR_PREFIX} DOB value should be a Date Object`\nexport const OBJECT_ARRAY_ERROR = `${CLEVERTAP_ERROR_PREFIX} Expecting Object array in profile`\nexport const DATE_FORMAT_ERROR = `${CLEVERTAP_ERROR_PREFIX} setDate(number). number should be formatted as yyyymmdd`\nexport const ENUM_FORMAT_ERROR = `${CLEVERTAP_ERROR_PREFIX} setEnum(value). value should be a string or a number`\nexport const PHONE_FORMAT_ERROR = `${CLEVERTAP_ERROR_PREFIX} Phone number should be formatted as +[country code][number]`\n","import { isObject, isDateObject, isString, isNumber } from './datatypes'\nimport { convertToWZRKDate } from './datetime'\nimport { CHARGED_ID, CHARGEDID_COOKIE_NAME } from './constants'\nimport { StorageManager } from './storage'\n\nlet _globalChargedId\n\nexport const isEventStructureFlat = (eventObj) => {\n  // Events cannot have nested structure or Arrays\n  if (isObject(eventObj)) {\n    for (var key in eventObj) {\n      if (eventObj.hasOwnProperty(key)) {\n        if (isObject(eventObj[key]) || Array.isArray(eventObj[key])) {\n          return false\n        } else if (isDateObject(eventObj[key])) {\n          eventObj[key] = convertToWZRKDate(eventObj[key])\n        }\n      }\n    }\n    return true\n  }\n  return false\n}\n\nexport const isChargedEventStructureValid = (chargedObj, logger) => {\n  if (isObject(chargedObj)) {\n    for (var key in chargedObj) {\n      if (chargedObj.hasOwnProperty(key)) {\n        if (key === 'Items') {\n          if (!Array.isArray(chargedObj[key])) {\n            return false\n          }\n\n          if (chargedObj[key].length > 50) {\n            logger.reportError(522, 'Charged Items exceed 50 limit. Actual count: ' + chargedObj[key].length)\n          }\n\n          for (var itemKey in chargedObj[key]) {\n            if (chargedObj[key].hasOwnProperty(itemKey)) { // since default array implementation could be overridden - e.g. Teabox site\n              if (!isObject(chargedObj[key][itemKey]) || !isEventStructureFlat(chargedObj[key][itemKey])) {\n                return false\n              }\n            }\n          }\n        } else {\n          if (isObject(chargedObj[key]) || Array.isArray(chargedObj[key])) {\n            return false\n          } else if (isDateObject(chargedObj[key])) {\n            chargedObj[key] = convertToWZRKDate(chargedObj[key])\n          }\n        }\n      }\n    }\n\n    if (isString(chargedObj[CHARGED_ID]) || isNumber(chargedObj[CHARGED_ID])) {\n      // save charged Id\n      const chargedId = chargedObj[CHARGED_ID] + '' // casting chargedId to string\n\n      if (typeof _globalChargedId === 'undefined') {\n        _globalChargedId = StorageManager.readFromLSorCookie(CHARGEDID_COOKIE_NAME)\n      }\n      if (typeof _globalChargedId !== 'undefined' && _globalChargedId.trim() === chargedId.trim()) {\n        // drop event- duplicate charged id\n        logger.error('Duplicate charged Id - Dropped' + chargedObj)\n        return false\n      }\n      _globalChargedId = chargedId\n      StorageManager.saveToLSorCookie(CHARGEDID_COOKIE_NAME, chargedId)\n    }\n    return true\n  } // if object (chargedObject)\n  return false\n}\n","import { isString, isObject, sanitize } from '../util/datatypes'\nimport { EVENT_ERROR } from '../util/messages'\nimport { EV_COOKIE, SYSTEM_EVENTS, unsupportedKeyCharRegex } from '../util/constants'\nimport { isChargedEventStructureValid, isEventStructureFlat } from '../util/validator'\nimport { StorageManager, $ct } from '../util/storage'\n\nexport default class EventHandler extends Array {\n  #logger\n  #oldValues\n  #request\n  #isPersonalisationActive\n\n  constructor ({ logger, request, isPersonalisationActive }, values) {\n    super()\n    this.#logger = logger\n    this.#oldValues = values\n    this.#request = request\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  push (...eventsArr) {\n    this.#processEventArray(eventsArr)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processEventArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  #processEventArray (eventsArr) {\n    if (Array.isArray(eventsArr)) {\n      while (eventsArr.length > 0) {\n        var eventName = eventsArr.shift()\n        if (!isString(eventName)) {\n          this.#logger.error(EVENT_ERROR)\n          continue\n        }\n\n        if (eventName.length > 1024) {\n          eventName = eventName.substring(0, 1024)\n          this.#logger.reportError(510, eventName + '... length exceeded 1024 chars. Trimmed.')\n        }\n\n        if (SYSTEM_EVENTS.includes(eventName)) {\n          this.#logger.reportError(513, eventName + ' is a restricted system event. It cannot be used as an event name.')\n          continue\n        }\n\n        const data = {}\n        data.type = 'event'\n        data.evtName = sanitize(eventName, unsupportedKeyCharRegex)\n\n        if (eventsArr.length !== 0) {\n          const eventObj = eventsArr.shift()\n          if (!isObject(eventObj)) {\n            // put it back if it is not an object\n            eventsArr.unshift(eventObj)\n          } else {\n            // check Charged Event vs. other events.\n            if (eventName === 'Charged') {\n              if (!isChargedEventStructureValid(eventObj, this.#logger)) {\n                this.#logger.reportError(511, 'Charged event structure invalid. Not sent.')\n                continue\n              }\n            } else {\n              if (!isEventStructureFlat(eventObj)) {\n                this.#logger.reportError(512, eventName + ' event structure invalid. Not sent.')\n                continue\n              }\n            }\n            data.evtData = eventObj\n          }\n        }\n\n        this.#request.processEvent(data)\n      }\n    }\n  }\n\n  getDetails (evtName) {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    if (typeof $ct.globalEventsMap === 'undefined') {\n      $ct.globalEventsMap = StorageManager.readFromLSorCookie(EV_COOKIE)\n    }\n    if (typeof $ct.globalEventsMap === 'undefined') {\n      return\n    }\n    const evtObj = $ct.globalEventsMap[evtName]\n    const respObj = {}\n    if (typeof evtObj !== 'undefined') {\n      respObj.firstTime = new Date(evtObj[1] * 1000)\n      respObj.lastTime = new Date(evtObj[2] * 1000)\n      respObj.count = evtObj[0]\n      return respObj\n    }\n  }\n}\n","export const getURLParams = (url) => {\n  const urlParams = {}\n  const idx = url.indexOf('?')\n\n  if (idx > 1) {\n    const uri = url.substring(idx + 1)\n    let match\n    const pl = /\\+/g // Regex for replacing addition symbol with a space\n    const search = /([^&=]+)=?([^&]*)/g\n    const decode = function (s) {\n      let replacement = s.replace(pl, ' ')\n      try {\n        replacement = decodeURIComponent(replacement)\n      } catch (e) {\n        // eat\n      }\n      return replacement\n    }\n    match = search.exec(uri)\n    while (match) {\n      urlParams[decode(match[1])] = decode(match[2])\n      match = search.exec(uri)\n    }\n  }\n  return urlParams\n}\n\nexport const getDomain = (url) => {\n  if (url === '') return ''\n  var a = document.createElement('a')\n  a.href = url\n  return a.hostname\n}\n\nexport const addToURL = (url, k, v) => {\n  return url + '&' + k + '=' + encodeURIComponent(v)\n}\n\nexport const getHostName = () => {\n  return window.location.hostname\n}\n","/* eslint-disable */\nexport const urlBase64ToUint8Array = (base64String) => {\n  let padding = '='.repeat((4 - base64String.length % 4) % 4)\n  let base64 = (base64String + padding)\n      .replace(/\\-/g, '+')\n      .replace(/_/g, '/')\n\n  let rawData = window.atob(base64)\n  let processedData = []\n  for (let i=0; i<rawData.length; i++) {\n    processedData.push(rawData.charCodeAt(i))\n  }\n  return new Uint8Array(processedData)\n}\n\nexport const compressData = (dataObject, logger) => {\n  logger && typeof logger.debug === 'function' && logger.debug('dobj:' + dataObject)\n  return compressToBase64(dataObject)\n}\n\nexport const compress = (uncompressed) => {\n  if (uncompressed == null) return ''\n  let i, value,\n      context_dictionary = {},\n      context_dictionaryToCreate = {},\n      context_c = '',\n      context_wc = '',\n      context_w = '',\n      context_enlargeIn = 2, // Compensate for the first entry which should not count\n      context_dictSize = 3,\n      context_numBits = 2,\n      context_data_string = '',\n      context_data_val = 0,\n      context_data_position = 0,\n      ii,\n      f = String.fromCharCode\n\n  for (ii = 0; ii < uncompressed.length; ii += 1) {\n    context_c = uncompressed.charAt(ii)\n    if (!Object.prototype.hasOwnProperty.call(context_dictionary, context_c)) {\n      context_dictionary[context_c] = context_dictSize++\n      context_dictionaryToCreate[context_c] = true\n    }\n\n    context_wc = context_w + context_c\n    if (Object.prototype.hasOwnProperty.call(context_dictionary, context_wc)) {\n      context_w = context_wc\n    } else {\n      if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate, context_w)) {\n        if (context_w.charCodeAt(0) < 256) {\n          for (i = 0; i < context_numBits; i++) {\n            context_data_val = (context_data_val << 1)\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n          }\n          value = context_w.charCodeAt(0)\n          for (i = 0; i < 8; i++) {\n            context_data_val = (context_data_val << 1) | (value & 1)\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n            value = value >> 1\n          }\n        } else {\n          value = 1\n          for (i = 0; i < context_numBits; i++) {\n            context_data_val = (context_data_val << 1) | value\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n            value = 0\n          }\n          value = context_w.charCodeAt(0)\n          for (i = 0; i < 16; i++) {\n            context_data_val = (context_data_val << 1) | (value & 1)\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n            value = value >> 1\n          }\n        }\n        context_enlargeIn--\n        if (context_enlargeIn == 0) {\n          context_enlargeIn = Math.pow(2, context_numBits)\n          context_numBits++\n        }\n        delete context_dictionaryToCreate[context_w]\n      } else {\n        value = context_dictionary[context_w];\n        for (i = 0; i < context_numBits; i++) {\n          context_data_val = (context_data_val << 1) | (value & 1)\n          if (context_data_position == 15) {\n            context_data_position = 0;\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = value >> 1\n        }\n\n\n      }\n      context_enlargeIn--\n      if (context_enlargeIn == 0) {\n        context_enlargeIn = Math.pow(2, context_numBits)\n        context_numBits++\n      }\n      // Add wc to the dictionary.\n      context_dictionary[context_wc] = context_dictSize++\n      context_w = String(context_c)\n    }\n  }\n\n  // Output the code for w.\n  if (context_w !== '') {\n    if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate, context_w)) {\n      if (context_w.charCodeAt(0) < 256) {\n        for (i = 0; i < context_numBits; i++) {\n          context_data_val = (context_data_val << 1)\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n        }\n        value = context_w.charCodeAt(0)\n        for (i = 0; i < 8; i++) {\n          context_data_val = (context_data_val << 1) | (value & 1)\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = value >> 1\n        }\n      } else {\n        value = 1\n        for (i = 0; i < context_numBits; i++) {\n          context_data_val = (context_data_val << 1) | value\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = 0\n        }\n        value = context_w.charCodeAt(0);\n        for (i = 0; i < 16; i++) {\n          context_data_val = (context_data_val << 1) | (value & 1)\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = value >> 1\n        }\n      }\n      context_enlargeIn--\n      if (context_enlargeIn == 0) {\n        context_enlargeIn = Math.pow(2, context_numBits)\n        context_numBits++\n      }\n      delete context_dictionaryToCreate[context_w]\n    } else {\n      value = context_dictionary[context_w]\n      for (i = 0; i < context_numBits; i++) {\n        context_data_val = (context_data_val << 1) | (value & 1)\n        if (context_data_position == 15) {\n          context_data_position = 0\n          context_data_string += f(context_data_val)\n          context_data_val = 0\n        } else {\n          context_data_position++\n        }\n        value = value >> 1\n      }\n\n\n    }\n    context_enlargeIn--\n    if (context_enlargeIn == 0) {\n      context_enlargeIn = Math.pow(2, context_numBits)\n      context_numBits++\n    }\n  }\n\n  // Mark the end of the stream\n  value = 2\n  for (i = 0; i < context_numBits; i++) {\n    context_data_val = (context_data_val << 1) | (value & 1)\n    if (context_data_position == 15) {\n      context_data_position = 0\n      context_data_string += f(context_data_val)\n      context_data_val = 0\n    } else {\n      context_data_position++\n    }\n    value = value >> 1\n  }\n\n  // Flush the last char\n  while (true) {\n    context_data_val = (context_data_val << 1)\n    if (context_data_position == 15) {\n      context_data_string += f(context_data_val)\n      break\n    } else context_data_position++\n  }\n  return context_data_string\n}\n\nexport const getKeyStr = () => {\n  let key = ''\n  let i = 0\n\n  for (i = 0; i <= 25; i++) {\n    key = key + String.fromCharCode(i + 65)\n  }\n\n  for (i = 0; i <= 25; i++) {\n    key = key + String.fromCharCode(i + 97)\n  }\n\n  for (i = 0; i < 10; i++) {\n    key = key + i\n  }\n\n  return key + '+/='\n}\n\nconst _keyStr = getKeyStr()\n\nexport const convertToFormattedHex = (byte_arr) => {\n  let hex_str = '',\n      i,\n      len,\n      tmp_hex\n\n  if (!Array.isArray(byte_arr)) {\n    return false\n  }\n\n  len = byte_arr.length\n\n  for (i = 0; i < len; ++i) {\n    if (byte_arr[i] < 0) {\n      byte_arr[i] = byte_arr[i] + 256\n    }\n    if (byte_arr[i] === undefined) {\n      byte_arr[i] = 0\n    }\n    tmp_hex = byte_arr[i].toString(16)\n\n    if (tmp_hex.length == 1) tmp_hex = '0' + tmp_hex // Add leading zero.\n\n    //        beautification - needed if you're printing this in the console, else keep commented\n    //        if ((i + 1) % 16 === 0) {\n    //          tmp_hex += \"\\n\";\n    //        } else {\n    //          tmp_hex += \" \";\n    //        }\n\n    hex_str += tmp_hex\n  }\n\n  return hex_str.trim()\n}\n\nexport const convertStringToHex = (s) => {\n  let byte_arr = []\n  for (let i = 0; i < s.length; i++) {\n    let value = s.charCodeAt(i)\n    byte_arr.push(value & 255)\n    byte_arr.push((value >> 8) & 255)\n  }\n  return convertToFormattedHex(byte_arr)\n}\n\nexport const compressToBase64 = (input) => {\n  if (input == null) return ''\n  var output = ''\n  var chr1, chr2, chr3, enc1, enc2, enc3, enc4\n  var i = 0\n\n  input = compress(input)\n\n  while (i < input.length * 2) {\n\n    if (i % 2 == 0) {\n      chr1 = input.charCodeAt(i / 2) >> 8\n      chr2 = input.charCodeAt(i / 2) & 255\n      if (i / 2 + 1 < input.length)\n        chr3 = input.charCodeAt(i / 2 + 1) >> 8\n      else\n        chr3 = NaN\n    } else {\n      chr1 = input.charCodeAt((i - 1) / 2) & 255\n      if ((i + 1) / 2 < input.length) {\n        chr2 = input.charCodeAt((i + 1) / 2) >> 8\n        chr3 = input.charCodeAt((i + 1) / 2) & 255\n      } else\n        chr2 = chr3 = NaN\n    }\n    i += 3\n\n    enc1 = chr1 >> 2;\n    enc2 = ((chr1 & 3) << 4) | (chr2 >> 4)\n    enc3 = ((chr2 & 15) << 2) | (chr3 >> 6)\n    enc4 = chr3 & 63\n\n    if (isNaN(chr2)) {\n      enc3 = enc4 = 64\n    } else if (isNaN(chr3)) {\n      enc4 = 64\n    }\n\n    output = output +\n      _keyStr.charAt(enc1) + _keyStr.charAt(enc2) +\n      _keyStr.charAt(enc3) + _keyStr.charAt(enc4)\n\n  }\n\n  return output\n}\n","\nimport { ARP_COOKIE, MAX_TRIES, OPTOUT_COOKIE_ENDSWITH, USEIP_KEY, MAX_DELAY_FREQUENCY, PUSH_DELAY_MS, WZRK_FETCH } from './constants'\nimport { isString, isValueValid } from './datatypes'\nimport { compressData } from './encoder'\nimport { StorageManager, $ct } from './storage'\nimport { addToURL } from './url'\n\nexport default class RequestDispatcher {\n  static logger\n  static device\n  static account\n  networkRetryCount = 0\n  minDelayFrequency = 0\n\n  // ANCHOR - Requests get fired from here\n  static #fireRequest (url, tries, skipARP, sendOULFlag, evtName) {\n    if (this.#dropRequestDueToOptOut()) {\n      this.logger.debug('req dropped due to optout cookie: ' + this.device.gcookie)\n      return\n    }\n\n    // set a request in progress\n    // so that if gcookie is not present, no other request can be made asynchronusly\n    if (!isValueValid(this.device.gcookie)) {\n      $ct.blockRequest = true\n    }\n    /**\n     * if the gcookie is null\n     * and the request is not the first request\n     * and the tries are less than max tries\n     * keep retrying\n     */\n\n    if (evtName && evtName === WZRK_FETCH) {\n      // New retry mechanism\n      if (!isValueValid(this.device.gcookie) && ($ct.globalCache.RESP_N < $ct.globalCache.REQ_N - 1)) {\n        setTimeout(() => {\n          this.logger.debug(`retrying fire request for url: ${url}, tries: ${this.networkRetryCount}`)\n          this.#fireRequest(url, undefined, skipARP, sendOULFlag)\n        }, this.getDelayFrequency())\n      }\n    } else {\n      if (!isValueValid(this.device.gcookie) &&\n      ($ct.globalCache.RESP_N < $ct.globalCache.REQ_N - 1) &&\n      tries < MAX_TRIES) {\n      // if ongoing First Request is in progress, initiate retry\n        setTimeout(() => {\n          this.logger.debug(`retrying fire request for url: ${url}, tries: ${tries}`)\n          this.#fireRequest(url, tries + 1, skipARP, sendOULFlag)\n        }, 50)\n        return\n      }\n    }\n\n    // set isOULInProgress to true\n    // when sendOULFlag is set to true\n    if (!sendOULFlag) {\n      if (isValueValid(this.device.gcookie)) {\n        // add gcookie to url\n        url = addToURL(url, 'gc', this.device.gcookie)\n      }\n      url = this.#addARPToRequest(url, skipARP)\n    } else {\n      window.isOULInProgress = true\n    }\n\n    url = addToURL(url, 'tries', tries) // Add tries to URL\n\n    url = this.#addUseIPToRequest(url)\n    url = addToURL(url, 'r', new Date().getTime()) // add epoch to beat caching of the URL\n    // TODO: Figure out a better way to handle plugin check\n    if (window.clevertap?.hasOwnProperty('plugin') || window.wizrocket?.hasOwnProperty('plugin')) {\n      // used to add plugin name in request parameter\n      const plugin = window.clevertap.plugin || window.wizrocket.plugin\n      url = addToURL(url, 'ct_pl', plugin)\n    }\n    if (url.indexOf('chrome-extension:') !== -1) {\n      url = url.replace('chrome-extension:', 'https:')\n    }\n    // TODO: Try using Function constructor instead of appending script.\n    var ctCbScripts = document.getElementsByClassName('ct-jp-cb')\n    while (ctCbScripts[0] && ctCbScripts[0].parentNode) {\n      ctCbScripts[0].parentNode.removeChild(ctCbScripts[0])\n    }\n    const s = document.createElement('script')\n    s.setAttribute('type', 'text/javascript')\n    s.setAttribute('src', url)\n    s.setAttribute('class', 'ct-jp-cb')\n    s.setAttribute('rel', 'nofollow')\n    s.async = true\n    document.getElementsByTagName('head')[0].appendChild(s)\n    this.logger.debug('req snt -> url: ' + url)\n  }\n\n  /**\n   *\n   * @param {string} url\n   * @param {*} skipARP\n   * @param {boolean} sendOULFlag\n   */\n  static fireRequest (url, skipARP, sendOULFlag, evtName) {\n    this.#fireRequest(url, 1, skipARP, sendOULFlag, evtName)\n  }\n\n  static #dropRequestDueToOptOut () {\n    if ($ct.isOptInRequest || !isValueValid(this.device.gcookie) || !isString(this.device.gcookie)) {\n      $ct.isOptInRequest = false\n      return false\n    }\n    return this.device.gcookie.slice(-3) === OPTOUT_COOKIE_ENDSWITH\n  }\n\n  static #addUseIPToRequest (pageLoadUrl) {\n    var useIP = StorageManager.getMetaProp(USEIP_KEY)\n    if (typeof useIP !== 'boolean') {\n      useIP = false\n    }\n    return addToURL(pageLoadUrl, USEIP_KEY, useIP ? 'true' : 'false')\n  };\n\n  static #addARPToRequest (url, skipResARP) {\n    if (skipResARP === true) {\n      const _arp = {}\n      _arp.skipResARP = true\n      return addToURL(url, 'arp', compressData(JSON.stringify(_arp), this.logger))\n    }\n    if (StorageManager._isLocalStorageSupported() && typeof localStorage.getItem(ARP_COOKIE) !== 'undefined' && localStorage.getItem(ARP_COOKIE) !== null) {\n      return addToURL(url, 'arp', compressData(JSON.stringify(StorageManager.readFromLSorCookie(ARP_COOKIE)), this.logger))\n    }\n    return url\n  }\n\n  getDelayFrequency () {\n    this.logger.debug('Network retry #' + this.networkRetryCount)\n\n    // Retry with delay as 1s for first 10 retries\n    if (this.networkRetryCount < 10) {\n      this.logger.debug(this.account.id, 'Failure count is ' + this.networkRetryCount + '. Setting delay frequency to 1s')\n      this.minDelayFrequency = PUSH_DELAY_MS // Reset minimum delay to 1s\n      return this.minDelayFrequency\n    }\n\n    if (this.account.region == null) {\n      // Retry with delay as 1s if region is null in case of eu1\n      this.logger.debug(this.account.id, 'Setting delay frequency to 1s')\n      return PUSH_DELAY_MS\n    } else {\n      // Retry with delay as minimum delay frequency and add random number of seconds to scatter traffic\n      const randomDelay = (Math.floor(Math.random() * 10) + 1) * 1000\n      this.minDelayFrequency += randomDelay\n      if (this.minDelayFrequency < MAX_DELAY_FREQUENCY) {\n        this.logger.debug(this.account.id, 'Setting delay frequency to ' + this.minDelayFrequency)\n        return this.minDelayFrequency\n      } else {\n        this.minDelayFrequency = PUSH_DELAY_MS\n      }\n      this.logger.debug(this.account.id, 'Setting delay frequency to ' + this.minDelayFrequency)\n      return this.minDelayFrequency\n    }\n  }\n}\n","// CleverTap specific utilities\n\nimport {\n  StorageManager,\n  $ct\n} from './storage'\nimport {\n  CAMP_COOKIE_NAME,\n  singleQuoteRegex,\n  PR_COOKIE,\n  ARP_COOKIE,\n  GCOOKIE_NAME,\n  IS_OUL,\n  categoryLongKey,\n  CAMP_COOKIE_G,\n  GLOBAL\n} from './constants'\nimport {\n  GENDER_ERROR,\n  EMPLOYED_ERROR,\n  MARRIED_ERROR,\n  EDUCATION_ERROR,\n  AGE_ERROR,\n  DOB_ERROR,\n  PHONE_FORMAT_ERROR,\n  ENUM_FORMAT_ERROR\n} from './messages'\nimport {\n  getToday,\n  convertToWZRKDate,\n  setDate,\n  getNow\n} from './datetime'\nimport {\n  isObject,\n  isDateObject,\n  isConvertibleToNumber,\n  isObjectEmpty,\n  isString,\n  isNumber,\n  isValueValid\n} from './datatypes'\n\nimport { addToURL, getURLParams } from './url'\nimport { compressData } from './encoder'\nimport RequestDispatcher from './requestDispatcher'\n\nexport const getCampaignObject = () => {\n  let finalcampObj = {}\n  if (StorageManager._isLocalStorageSupported()) {\n    let campObj = StorageManager.read(CAMP_COOKIE_NAME)\n    if (campObj != null) {\n      campObj = JSON.parse(decodeURIComponent(campObj).replace(singleQuoteRegex, '\\\"'))\n      if (campObj.hasOwnProperty('global')) {\n        finalcampObj.wp = campObj\n      } else {\n        finalcampObj = campObj\n      }\n    } else {\n      finalcampObj = {}\n    }\n  }\n  return finalcampObj\n}\n\nexport const saveCampaignObject = (campaignObj) => {\n  if (StorageManager._isLocalStorageSupported()) {\n    const newObj = { ...getCampaignObject(), ...campaignObj }\n    const campObj = JSON.stringify(newObj)\n    StorageManager.save(CAMP_COOKIE_NAME, encodeURIComponent(campObj))\n    // Update the CAMP_COOKIE_G to be in sync with CAMP_COOKIE_NAME\n    setCampaignObjectForGuid()\n  }\n}\n\n// set Campaign Object against the guid, with daily count and total count details\nexport const setCampaignObjectForGuid = () => {\n  if (StorageManager._isLocalStorageSupported()) {\n    let guid = StorageManager.read(GCOOKIE_NAME)\n    if (isValueValid(guid)) {\n      try {\n        guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n        const guidCampObj = StorageManager.read(CAMP_COOKIE_G) ? JSON.parse(decodeURIComponent(StorageManager.read(CAMP_COOKIE_G))) : {}\n        if (guid && StorageManager._isLocalStorageSupported()) {\n          var finalCampObj = {}\n          var campObj = getCampaignObject()\n          Object.keys(campObj).forEach(key => {\n            const campKeyObj = (guid in guidCampObj && Object.keys(guidCampObj[guid]).length && guidCampObj[guid][key]) ? guidCampObj[guid][key] : {}\n            const globalObj = campObj[key].global\n            const today = getToday()\n            const dailyObj = campObj[key][today]\n            if (typeof globalObj !== 'undefined') {\n              const campaignIdArray = Object.keys(globalObj)\n              for (const index in campaignIdArray) {\n                let resultObj = []\n                if (campaignIdArray.hasOwnProperty(index)) {\n                  let dailyC = 0\n                  let totalC = 0\n                  const campaignId = campaignIdArray[index]\n                  if (campaignId === 'tc') {\n                    continue\n                  }\n                  if (typeof dailyObj !== 'undefined' && typeof dailyObj[campaignId] !== 'undefined') {\n                    dailyC = dailyObj[campaignId]\n                  }\n                  if (typeof globalObj !== 'undefined' && typeof globalObj[campaignId] !== 'undefined') {\n                    totalC = globalObj[campaignId]\n                  }\n                  resultObj = [campaignId, dailyC, totalC]\n                  campKeyObj[campaignId] = resultObj\n                }\n              }\n            }\n            finalCampObj = { ...finalCampObj, [key]: campKeyObj }\n          })\n          guidCampObj[guid] = finalCampObj\n          StorageManager.save(CAMP_COOKIE_G, encodeURIComponent(JSON.stringify(guidCampObj)))\n        }\n      } catch (e) {\n        console.error('Invalid clevertap Id ' + e)\n      }\n    }\n  }\n}\nexport const getCampaignObjForLc = () => {\n  // before preparing data to send to LC , check if the entry for the guid is already there in CAMP_COOKIE_G\n  const guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n\n  let campObj = {}\n  if (StorageManager._isLocalStorageSupported()) {\n    let resultObj = {}\n    campObj = getCampaignObject()\n    const storageValue = StorageManager.read(CAMP_COOKIE_G)\n    const decodedValue = storageValue ? decodeURIComponent(storageValue) : null\n    const parsedValue = decodedValue ? JSON.parse(decodedValue) : null\n\n    const resultObjWP = (!!guid &&\n                        storageValue !== undefined && storageValue !== null &&\n                        parsedValue && parsedValue[guid] && parsedValue[guid].wp)\n      ? Object.values(parsedValue[guid].wp)\n      : []\n\n    const resultObjWI = (!!guid &&\n                        storageValue !== undefined && storageValue !== null &&\n                        parsedValue && parsedValue[guid] && parsedValue[guid].wi)\n      ? Object.values(parsedValue[guid].wi)\n      : []\n\n    const today = getToday()\n    let todayCwp = 0\n    let todayCwi = 0\n    if (campObj.wp && campObj.wp[today] && campObj.wp[today].tc !== 'undefined') {\n      todayCwp = campObj.wp[today].tc\n    }\n    if (campObj.wi && campObj.wi[today] && campObj.wi[today].tc !== 'undefined') {\n      todayCwi = campObj.wi[today].tc\n    }\n    resultObj = {\n      wmp: todayCwp,\n      wimp: todayCwi,\n      tlc: resultObjWP,\n      witlc: resultObjWI\n    }\n    return resultObj\n  }\n}\n\nexport const isProfileValid = (profileObj, { logger }) => {\n  let valid = false\n  if (isObject(profileObj)) {\n    for (const profileKey in profileObj) {\n      if (profileObj.hasOwnProperty(profileKey)) {\n        valid = true\n        let profileVal = profileObj[profileKey]\n\n        if (profileVal == null) {\n          delete profileObj[profileKey]\n          continue\n        }\n        if (profileKey === 'Gender' && !profileVal.match(/^M$|^F$/)) {\n          valid = false\n          logger.error(GENDER_ERROR)\n        }\n\n        if (profileKey === 'Employed' && !profileVal.match(/^Y$|^N$/)) {\n          valid = false\n          logger.error(EMPLOYED_ERROR)\n        }\n\n        if (profileKey === 'Married' && !profileVal.match(/^Y$|^N$/)) {\n          valid = false\n          logger.error(MARRIED_ERROR)\n        }\n\n        if (profileKey === 'Education' && !profileVal.match(/^School$|^College$|^Graduate$/)) {\n          valid = false\n          logger.error(EDUCATION_ERROR)\n        }\n\n        if (profileKey === 'Age' && profileVal != null) {\n          if (isConvertibleToNumber(profileVal)) {\n            profileObj.Age = +profileVal\n          } else {\n            valid = false\n            logger.error(AGE_ERROR)\n          }\n        }\n        // dob will come in like this - $dt_19470815 or dateObject\n        if (profileKey === 'DOB') {\n          if (((!(/^\\$D_/).test(profileVal) || (profileVal + '').length !== 11)) && !isDateObject(profileVal)) {\n            valid = false\n            logger.error(DOB_ERROR)\n          }\n\n          if (isDateObject(profileVal)) {\n            profileObj[profileKey] = convertToWZRKDate(profileVal)\n          }\n        } else if (isDateObject(profileVal)) {\n          profileObj[profileKey] = convertToWZRKDate(profileVal)\n        }\n\n        if (profileKey === 'Phone' && !isObjectEmpty(profileVal)) {\n          if (profileVal.length > 8 && (profileVal.charAt(0) === '+')) { // valid phone number\n            profileVal = profileVal.substring(1, profileVal.length)\n            if (isConvertibleToNumber(profileVal)) {\n              profileObj.Phone = +profileVal\n            } else {\n              valid = false\n              logger.error(PHONE_FORMAT_ERROR + '. Removed.')\n            }\n          } else {\n            valid = false\n            logger.error(PHONE_FORMAT_ERROR + '. Removed.')\n          }\n        }\n\n        if (!valid) {\n          delete profileObj[profileKey]\n        }\n      }\n    }\n  }\n  return valid\n}\n\nexport const processFBUserObj = (user) => {\n  const profileData = {}\n  profileData.Name = user.name\n  if (user.id != null) {\n    profileData.FBID = user.id + ''\n  }\n  // Feb 2014 - FB announced over 58 gender options, hence we specifically look for male or female. Rest we don't care.\n  if (user.gender === 'male') {\n    profileData.Gender = 'M'\n  } else if (user.gender === 'female') {\n    profileData.Gender = 'F'\n  } else {\n    profileData.Gender = 'O'\n  }\n\n  const getHighestEducation = function (eduArr) {\n    if (eduArr != null) {\n      let college = ''\n      let highschool = ''\n\n      for (let i = 0; i < eduArr.length; i++) {\n        const edu = eduArr[i]\n        if (edu.type != null) {\n          const type = edu.type\n          if (type === 'Graduate School') {\n            return 'Graduate'\n          } else if (type === 'College') {\n            college = '1'\n          } else if (type === 'High School') {\n            highschool = '1'\n          }\n        }\n      }\n\n      if (college === '1') {\n        return 'College'\n      } else if (highschool === '1') {\n        return 'School'\n      }\n    }\n  }\n\n  if (user.relationship_status != null) {\n    profileData.Married = 'N'\n    if (user.relationship_status === 'Married') {\n      profileData.Married = 'Y'\n    }\n  }\n\n  const edu = getHighestEducation(user.education)\n  if (edu != null) {\n    profileData.Education = edu\n  }\n\n  const work = (user.work != null) ? user.work.length : 0\n  if (work > 0) {\n    profileData.Employed = 'Y'\n  } else {\n    profileData.Employed = 'N'\n  }\n\n  if (user.email != null) {\n    profileData.Email = user.email\n  }\n\n  if (user.birthday != null) {\n    const mmddyy = user.birthday.split('/') // comes in as \"08/15/1947\"\n    profileData.DOB = setDate(mmddyy[2] + mmddyy[0] + mmddyy[1])\n  }\n  return profileData\n}\n\nexport const processGPlusUserObj = (user, { logger }) => {\n  const profileData = {}\n  if (user.displayName != null) {\n    profileData.Name = user.displayName\n  }\n  if (user.id != null) {\n    profileData.GPID = user.id + ''\n  }\n\n  if (user.gender != null) {\n    if (user.gender === 'male') {\n      profileData.Gender = 'M'\n    } else if (user.gender === 'female') {\n      profileData.Gender = 'F'\n    } else if (user.gender === 'other') {\n      profileData.Gender = 'O'\n    }\n  }\n\n  if (user.image != null) {\n    if (user.image.isDefault === false) {\n      profileData.Photo = user.image.url.split('?sz')[0]\n    }\n  }\n\n  if (user.emails != null) {\n    for (let emailIdx = 0; emailIdx < user.emails.length; emailIdx++) {\n      const emailObj = user.emails[emailIdx]\n      if (emailObj.type === 'account') {\n        profileData.Email = emailObj.value\n      }\n    }\n  }\n\n  if (user.organizations != null) {\n    profileData.Employed = 'N'\n    for (let i = 0; i < user.organizations.length; i++) {\n      const orgObj = user.organizations[i]\n      if (orgObj.type === 'work') {\n        profileData.Employed = 'Y'\n      }\n    }\n  }\n\n  if (user.birthday != null) {\n    const yyyymmdd = user.birthday.split('-') // comes in as \"1976-07-27\"\n    profileData.DOB = setDate(yyyymmdd[0] + yyyymmdd[1] + yyyymmdd[2])\n  }\n\n  if (user.relationshipStatus != null) {\n    profileData.Married = 'N'\n    if (user.relationshipStatus === 'married') {\n      profileData.Married = 'Y'\n    }\n  }\n  logger.debug('gplus usr profile ' + JSON.stringify(profileData))\n\n  return profileData\n}\n\nexport const addToLocalProfileMap = (profileObj, override) => {\n  if (StorageManager._isLocalStorageSupported()) {\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n      if ($ct.globalProfileMap == null) {\n        $ct.globalProfileMap = {}\n      }\n    }\n\n    // Move props from custom bucket to outside.\n    if (profileObj._custom != null) {\n      const keys = profileObj._custom\n      for (const key in keys) {\n        if (keys.hasOwnProperty(key)) {\n          profileObj[key] = keys[key]\n        }\n      }\n      delete profileObj._custom\n    }\n\n    for (const prop in profileObj) {\n      if (profileObj.hasOwnProperty(prop)) {\n        if ($ct.globalProfileMap.hasOwnProperty(prop) && !override) {\n          continue\n        }\n        $ct.globalProfileMap[prop] = profileObj[prop]\n      }\n    }\n    if ($ct.globalProfileMap._custom != null) {\n      delete $ct.globalProfileMap._custom\n    }\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n  }\n}\n\nexport const closeIframe = (campaignId, divIdIgnored, currentSessionId) => {\n  if (campaignId != null && campaignId !== '-1') {\n    if (StorageManager._isLocalStorageSupported()) {\n      const campaignObj = getCampaignObject()\n\n      let sessionCampaignObj = campaignObj.wp[currentSessionId]\n      if (sessionCampaignObj == null) {\n        sessionCampaignObj = {}\n        campaignObj[currentSessionId] = sessionCampaignObj\n      }\n      sessionCampaignObj[campaignId] = 'dnd'\n      saveCampaignObject(campaignObj)\n    }\n  }\n  if ($ct.campaignDivMap != null) {\n    const divId = $ct.campaignDivMap[campaignId]\n    if (divId != null) {\n      document.getElementById(divId).style.display = 'none'\n      if (divId === 'intentPreview') {\n        if (document.getElementById('intentOpacityDiv') != null) {\n          document.getElementById('intentOpacityDiv').style.display = 'none'\n        }\n      }\n    }\n  }\n}\n\nexport const arp = (jsonMap) => {\n  // For unregister calls dont set arp in LS\n  if (jsonMap.skipResARP != null && jsonMap.skipResARP) {\n    console.debug('Update ARP Request rejected', jsonMap)\n    return null\n  }\n\n  const isOULARP = jsonMap[IS_OUL] === true\n\n  if (StorageManager._isLocalStorageSupported()) {\n    // Update arp only if it is null or an oul request\n    try {\n      let arpFromStorage = StorageManager.readFromLSorCookie(ARP_COOKIE)\n      if (arpFromStorage == null || isOULARP) {\n        arpFromStorage = {}\n        for (const key in jsonMap) {\n          if (jsonMap.hasOwnProperty(key)) {\n            if (jsonMap[key] === -1) {\n              delete arpFromStorage[key]\n            } else {\n              arpFromStorage[key] = jsonMap[key]\n            }\n          }\n        }\n        StorageManager.saveToLSorCookie(ARP_COOKIE, arpFromStorage)\n      }\n    } catch (e) {\n      console.error('Unable to parse ARP JSON: ' + e)\n    }\n  }\n}\n\nexport const getWrappedLink = (link, targetId, type, request, account, logger) => {\n  let data = {}\n  data.sendTo = link\n  data.targetId = targetId\n  data.epoch = getNow()\n\n  if (type != null) {\n    data.type = type\n  } else {\n    data.type = 'view'\n  }\n\n  data = request.addSystemDataToObject(data, undefined)\n  return addToURL(account.recorderURL, 'd', compressData(JSON.stringify(data), logger))\n}\n\nexport const getMessageTemplate = () => {\n  return `<div class=\"notice-message\">\n    <a href=\"[RECORDER_HREF]\" class=\"box\">\n      <div class=\"avatar\"><span class=\"fa [ICON] fa-4x fa-fw\"></span></div>\n      <div class=\"info\">\n        <div class=\"title\">[TITLE]</div>\n        <div class=\"clearfix\"></div>\n        <div class=\"text\">[TEXT]</div>\n      </div>\n      <div class=\"clearfix\"></div>\n    </a>\n  </div>\n  <div class=\"clearfix\"></div>`\n}\n\nexport const getMessageHeadTemplate = () => {\n  return `<head>\n    <base target=\"_parent\" />\n    <link rel=\"stylesheet\" href=\"http://static.clevertap.com/fa/font-awesome.css\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <style>\n    [STYLE]\n    </style>\n  </head>`\n}\n\nexport const setEnum = (enumVal, logger) => {\n  if (isString(enumVal) || isNumber(enumVal)) {\n    return '$E_' + enumVal\n  }\n  logger.error(ENUM_FORMAT_ERROR)\n}\nexport const handleEmailSubscription = (subscription, reEncoded, fetchGroups, account, logger) => {\n  const urlParamsAsIs = getURLParams(location.href) // can't use url_params as it is in lowercase above\n  const encodedEmailId = urlParamsAsIs.e\n  const encodedProfileProps = urlParamsAsIs.p\n  const pageType = urlParamsAsIs.page_type\n\n  if (typeof encodedEmailId !== 'undefined') {\n    const data = {}\n    data.id = account.id // accountId\n    data.unsubGroups = $ct.unsubGroups // unsubscribe groups\n\n    if ($ct.updatedCategoryLong) {\n      data[categoryLongKey] = $ct.updatedCategoryLong\n    }\n\n    let url = account.emailURL\n    if (fetchGroups) {\n      url = addToURL(url, 'fetchGroups', fetchGroups)\n    }\n    if (reEncoded) {\n      url = addToURL(url, 'encoded', reEncoded)\n    }\n    url = addToURL(url, 'e', encodedEmailId)\n    url = addToURL(url, 'd', compressData(JSON.stringify(data), logger))\n    if (encodedProfileProps) {\n      url = addToURL(url, 'p', encodedProfileProps)\n    }\n\n    if (subscription !== '-1') {\n      url = addToURL(url, 'sub', subscription)\n    }\n\n    if (pageType) {\n      $ct.globalUnsubscribe = pageType === GLOBAL\n      url = addToURL(url, 'page_type', pageType)\n    }\n    RequestDispatcher.fireRequest(url)\n  }\n}\n","import {\n  isObjectEmpty\n} from '../util/datatypes'\nimport {\n  isProfileValid,\n  processFBUserObj,\n  processGPlusUserObj,\n  addToLocalProfileMap\n} from '../util/clevertap'\nimport {\n  COMMAND_DELETE,\n  COMMAND_INCREMENT,\n  EVT_PUSH,\n  PR_COOKIE\n} from '../util/constants'\nimport {\n  addToURL\n} from '../util/url'\nimport {\n  StorageManager,\n  $ct\n} from '../util/storage'\nimport { compressData } from '../util/encoder'\nexport default class ProfileHandler extends Array {\n  #logger\n  #request\n  #account\n  #oldValues\n  #isPersonalisationActive\n\n  constructor ({\n    logger,\n    request,\n    account,\n    isPersonalisationActive\n  }, values) {\n    super()\n    this.#logger = logger\n    this.#request = request\n    this.#account = account\n    this.#oldValues = values\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  push (...profilesArr) {\n    this.#processProfileArray(profilesArr)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processProfileArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  getAttribute (propName) {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n    }\n    if ($ct.globalProfileMap != null) {\n      return $ct.globalProfileMap[propName]\n    }\n  }\n\n  #processProfileArray (profileArr) {\n    if (Array.isArray(profileArr) && profileArr.length > 0) {\n      for (const index in profileArr) {\n        if (profileArr.hasOwnProperty(index)) {\n          const outerObj = profileArr[index]\n          let data = {}\n          let profileObj\n          if (outerObj.Site != null) { // organic data from the site\n            profileObj = outerObj.Site\n            if (isObjectEmpty(profileObj) || !isProfileValid(profileObj, {\n              logger: this.#logger\n            })) {\n              return\n            }\n          } else if (outerObj.Facebook != null) { // fb connect data\n            const FbProfileObj = outerObj.Facebook\n            // make sure that the object contains any data at all\n\n            if (!isObjectEmpty(FbProfileObj) && (!FbProfileObj.error)) {\n              profileObj = processFBUserObj(FbProfileObj)\n            }\n          } else if (outerObj['Google Plus'] != null) {\n            const GPlusProfileObj = outerObj['Google Plus']\n            if (!isObjectEmpty(GPlusProfileObj) && (!GPlusProfileObj.error)) {\n              profileObj = processGPlusUserObj(GPlusProfileObj, { logger: this.#logger })\n            }\n          }\n          if (profileObj != null && (!isObjectEmpty(profileObj))) { // profile got set from above\n            data.type = 'profile'\n            if (profileObj.tz == null) {\n              // try to auto capture user timezone if not present\n              profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n            }\n\n            data.profile = profileObj\n            addToLocalProfileMap(profileObj, true)\n            data = this.#request.addSystemDataToObject(data, undefined)\n\n            this.#request.addFlags(data)\n            const compressedData = compressData(JSON.stringify(data), this.#logger)\n\n            let pageLoadUrl = this.#account.dataPostURL\n            pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n            pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n            this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   *\n   * @param {any} key\n   * @param {number} value\n   * @param {string} command\n   * increases or decreases value of the number type properties in profile object\n   */\n  _handleIncrementDecrementValue (key, value, command) {\n    // Check if the value is greater than 0\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n    }\n    if ($ct.globalProfileMap == null && !$ct.globalProfileMap?.hasOwnProperty(key)) {\n      // Check if the profile map already has the propery defined\n      console.error('Kindly create profile with required proprty to increment/decrement.')\n    } else if (!value || typeof value !== 'number' || value <= 0) {\n      console.error('Value should be a number greater than 0')\n    } else {\n      // Update the profile property in local storage\n      if (command === COMMAND_INCREMENT) {\n        $ct.globalProfileMap[key] = $ct.globalProfileMap[key] + value\n      } else {\n        $ct.globalProfileMap[key] = $ct.globalProfileMap[key] - value\n      }\n      StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n\n      // Send the updated value to LC\n      let data = {}\n      const profileObj = {}\n      data.type = 'profile'\n      profileObj[key] = { [command]: value }\n      if (profileObj.tz == null) {\n        // try to auto capture user timezone if not present\n        profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n      }\n      data.profile = profileObj\n      data = this.#request.addSystemDataToObject(data, undefined)\n\n      this.#request.addFlags(data)\n      const compressedData = compressData(JSON.stringify(data), this.#logger)\n      let pageLoadUrl = this.#account.dataPostURL\n      pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n      pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n      this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n    }\n  }\n\n  /**\n   *\n   * @param {any} key\n   * @param {array} arrayVal\n   * @param {string} command\n   * overwrites/sets new value(s) against a key/property in profile object\n   */\n  _handleMultiValueSet (key, arrayVal, command) {\n    const array = []\n    for (let i = 0; i < arrayVal.length; i++) {\n      if (typeof arrayVal[i] === 'number' && !array.includes(arrayVal[i])) {\n        array.push(arrayVal[i])\n      } else if (typeof arrayVal[i] === 'string' && !array.includes(arrayVal[i].toLowerCase())) {\n        array.push(arrayVal[i].toLowerCase())\n      } else {\n        console.error('array supports only string or number type values')\n      }\n    }\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE) ?? {}\n    }\n    $ct.globalProfileMap[key] = array\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n    this.sendMultiValueData(key, arrayVal, command)\n  }\n\n  /**\n   *\n   * @param {any} propKey - the property name to be added in the profile object\n   * @param {string, number, array} propVal - the property value to be added against the @propkey key\n   * @param {string} command\n   * Adds array or single value against a key/property in profile object\n   */\n  _handleMultiValueAdd (propKey, propVal, command) {\n    // Initialize array\n    var array = []\n\n    // Check if globalProfileMap is null, initialize if needed\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE) || {}\n    }\n\n    // Check if the value to be set is either string or number\n    if (typeof propVal === 'string' || typeof propVal === 'number') {\n      if ($ct.globalProfileMap.hasOwnProperty(propKey)) {\n        array = $ct.globalProfileMap[propKey]\n        array.push(typeof propVal === 'number' ? propVal : propVal.toLowerCase())\n      } else {\n        $ct.globalProfileMap[propKey] = propVal\n      }\n    } else {\n      // Check if propVal is an array\n      if ($ct.globalProfileMap.hasOwnProperty(propKey)) {\n        array = Array.isArray($ct.globalProfileMap[propKey]) ? $ct.globalProfileMap[propKey] : [$ct.globalProfileMap[propKey]]\n      }\n\n      // Check for case-sensitive inputs and filter the same ones\n      for (var i = 0; i < propVal.length; i++) {\n        if (typeof propVal[i] === 'number' && !array.includes(propVal[i])) {\n          array.push(propVal[i])\n        } else if (typeof propVal[i] === 'string' && !array.includes(propVal[i].toLowerCase())) {\n          array.push(propVal[i].toLowerCase())\n        } else if ((typeof propVal[i] === 'number' && array.includes(propVal[i])) || (typeof propVal[i] === 'string' && array.includes(propVal[i].toLowerCase()))) {\n          console.error('Values already included')\n        } else {\n          console.error('Array supports only string or number type values')\n        }\n      }\n\n      // Update globalProfileMap with the array\n      $ct.globalProfileMap[propKey] = array\n    }\n\n    // Save to local storage or cookie\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n\n    // Call the sendMultiValueData function\n    this.sendMultiValueData(propKey, propVal, command)\n  }\n\n  /**\n   *\n   * @param {any} propKey\n   * @param {string, number, array} propVal\n   * @param {string} command\n   * removes value(s) against a key/property in profile object\n   */\n  _handleMultiValueRemove (propKey, propVal, command) {\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n    }\n    if (!$ct?.globalProfileMap?.hasOwnProperty(propKey)) {\n      console.error(`The property ${propKey} does not exist.`)\n    } else {\n      if (typeof propVal === 'string' || typeof propVal === 'number') {\n        var index = $ct.globalProfileMap[propKey].indexOf(propVal)\n        if (index !== -1) {\n          $ct.globalProfileMap[propKey].splice(index, 1)\n        }\n      } else {\n        for (var k = 0; k < propVal.length; k++) {\n          var idx = $ct.globalProfileMap[propKey].indexOf(propVal[k])\n          if (idx !== -1) {\n            $ct.globalProfileMap[propKey].splice(idx, 1)\n          }\n        }\n      }\n    }\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n    this.sendMultiValueData(propKey, propVal, command)\n  }\n\n  /**\n   *\n   * @param {any} propKey\n   * @param {string} command\n   * deletes a key value pair from the profile object\n   */\n  _handleMultiValueDelete (propKey, command) {\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n    }\n    if (!$ct?.globalProfileMap?.hasOwnProperty(propKey)) {\n      console.error(`The property ${propKey} does not exist.`)\n    } else {\n      delete $ct.globalProfileMap[propKey]\n    }\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n    this.sendMultiValueData(propKey, null, command)\n  }\n\n  sendMultiValueData (propKey, propVal, command) {\n    // Send the updated value to LC\n    let data = {}\n    const profileObj = {}\n    data.type = 'profile'\n\n    // this removes the property at backend\n    profileObj[propKey] = { [command]: command === COMMAND_DELETE ? true : propVal }\n    if (profileObj.tz == null) {\n      profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n    }\n    data.profile = profileObj\n    data = this.#request.addSystemDataToObject(data, undefined)\n    this.#request.addFlags(data)\n    const compressedData = compressData(JSON.stringify(data), this.#logger)\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n    this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n  }\n}\n","import {\n  isObject,\n  isObjectEmpty\n} from '../util/datatypes'\nimport {\n  KCOOKIE_NAME,\n  GCOOKIE_NAME,\n  EVT_PUSH,\n  LRU_CACHE_SIZE,\n  IS_OUL,\n  CAMP_COOKIE_NAME,\n  CHARGEDID_COOKIE_NAME,\n  PR_COOKIE,\n  EV_COOKIE,\n  ARP_COOKIE,\n  CLEAR,\n  META_COOKIE,\n  FIRE_PUSH_UNREGISTERED\n} from '../util/constants'\nimport {\n  StorageManager,\n  $ct\n} from '../util/storage'\nimport LRUCache from '../util/lruCache'\nimport {\n  compressData\n} from '../util/encoder'\nimport {\n  addToURL,\n  getHostName\n} from '../util/url'\nimport {\n  isProfileValid,\n  processFBUserObj,\n  processGPlusUserObj,\n  addToLocalProfileMap\n} from '../util/clevertap'\n\nexport default class UserLoginHandler extends Array {\n  #request\n  #logger\n  #account\n  #session\n  #oldValues\n  #device\n\n  constructor ({\n    request,\n    account,\n    session,\n    logger,\n    device\n  },\n  values) {\n    super()\n    this.#request = request\n    this.#account = account\n    this.#session = session\n    this.#logger = logger\n    this.#oldValues = values\n    this.#device = device\n  }\n\n  // On User Login\n  #processOUL (profileArr) {\n    let sendOULFlag = true\n    StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, sendOULFlag)\n    const addToK = (ids) => {\n      let k = StorageManager.readFromLSorCookie(KCOOKIE_NAME)\n      const g = StorageManager.readFromLSorCookie(GCOOKIE_NAME)\n      let kId\n      if (k == null) {\n        k = {}\n        kId = ids\n      } else {\n        /* check if already exists */\n        kId = k.id\n        let anonymousUser = false\n        let foundInCache = false\n        if (kId == null) {\n          kId = ids[0]\n          anonymousUser = true\n        }\n        if ($ct.LRU_CACHE == null && StorageManager._isLocalStorageSupported()) {\n          $ct.LRU_CACHE = new LRUCache(LRU_CACHE_SIZE)\n        }\n\n        if (anonymousUser) {\n          if ((g) != null) {\n            // if have gcookie\n            $ct.LRU_CACHE.set(kId, g)\n            $ct.blockRequest = false\n          }\n        } else {\n          // check if the id is present in the cache\n          // set foundInCache to true\n          for (const idx in ids) {\n            if (ids.hasOwnProperty(idx)) {\n              const id = ids[idx]\n              if ($ct.LRU_CACHE.cache[id]) {\n                kId = id\n                foundInCache = true\n                break\n              }\n            }\n          }\n        }\n\n        if (foundInCache) {\n          if (kId !== $ct.LRU_CACHE.getLastKey()) {\n            // New User found\n            // remove the entire cache\n            this.#handleCookieFromCache()\n          } else {\n            sendOULFlag = false\n            StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, sendOULFlag)\n          }\n          const gFromCache = $ct.LRU_CACHE.get(kId)\n          $ct.LRU_CACHE.set(kId, gFromCache)\n          StorageManager.saveToLSorCookie(GCOOKIE_NAME, gFromCache)\n          this.#device.gcookie = gFromCache\n\n          const lastK = $ct.LRU_CACHE.getSecondLastKey()\n          if (StorageManager.readFromLSorCookie(FIRE_PUSH_UNREGISTERED) && lastK !== -1) {\n            // CACHED OLD USER FOUND. TRANSFER PUSH TOKEN TO THIS USER\n            const lastGUID = $ct.LRU_CACHE.cache[lastK]\n            this.#request.unregisterTokenForGuid(lastGUID)\n          }\n        } else {\n          if (!anonymousUser) {\n            this.clear()\n          } else {\n            if ((g) != null) {\n              this.#device.gcookie = g\n              StorageManager.saveToLSorCookie(GCOOKIE_NAME, g)\n              sendOULFlag = false\n            }\n          }\n          StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, false)\n          kId = ids[0]\n        }\n      }\n      k.id = kId\n      StorageManager.saveToLSorCookie(KCOOKIE_NAME, k)\n    }\n\n    if (Array.isArray(profileArr) && profileArr.length > 0) {\n      for (const index in profileArr) {\n        if (profileArr.hasOwnProperty(index)) {\n          const outerObj = profileArr[index]\n          let data = {}\n          let profileObj\n          if (outerObj.Site != null) { // organic data from the site\n            profileObj = outerObj.Site\n            if (isObjectEmpty(profileObj) || !isProfileValid(profileObj, {\n              logger: this.#logger\n            })) {\n              return\n            }\n          } else if (outerObj.Facebook != null) { // fb connect data\n            const FbProfileObj = outerObj.Facebook\n            // make sure that the object contains any data at all\n\n            if (!isObjectEmpty(FbProfileObj) && (!FbProfileObj.error)) {\n              profileObj = processFBUserObj(FbProfileObj)\n            }\n          } else if (outerObj['Google Plus'] != null) {\n            const GPlusProfileObj = outerObj['Google Plus']\n            if (isObjectEmpty(GPlusProfileObj) && (!GPlusProfileObj.error)) {\n              profileObj = processGPlusUserObj(GPlusProfileObj, { logger: this.#logger })\n            }\n          }\n          if (profileObj != null && (!isObjectEmpty(profileObj))) { // profile got set from above\n            data.type = 'profile'\n            if (profileObj.tz == null) {\n              // try to auto capture user timezone if not present\n              profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n            }\n\n            data.profile = profileObj\n            const ids = []\n            if (StorageManager._isLocalStorageSupported()) {\n              if (profileObj.Identity) {\n                ids.push(profileObj.Identity)\n              }\n              if (profileObj.Email) {\n                ids.push(profileObj.Email)\n              }\n              if (profileObj.GPID) {\n                ids.push('GP:' + profileObj.GPID)\n              }\n              if (profileObj.FBID) {\n                ids.push('FB:' + profileObj.FBID)\n              }\n              if (ids.length > 0) {\n                addToK(ids)\n              }\n            }\n            addToLocalProfileMap(profileObj, true)\n            data = this.#request.addSystemDataToObject(data, undefined)\n\n            this.#request.addFlags(data)\n            // Adding 'isOUL' flag in true for OUL cases which.\n            // This flag tells LC to create a new arp object.\n            // Also we will receive the same flag in response arp which tells to delete existing arp object.\n            if (sendOULFlag) {\n              data[IS_OUL] = true\n            }\n            const compressedData = compressData(JSON.stringify(data), this.#logger)\n            let pageLoadUrl = this.#account.dataPostURL\n            pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n            pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n            // Whenever sendOULFlag is true then dont send arp and gcookie (guid in memory in the request)\n            // Also when this flag is set we will get another flag from LC in arp which tells us to delete arp\n            // stored in the cache and replace it with the response arp.\n\n            this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest, sendOULFlag)\n          }\n        }\n      }\n    }\n  }\n\n  clear () {\n    this.#logger.debug('clear called. Reset flag has been set.')\n    this.#deleteUser()\n    StorageManager.setMetaProp(CLEAR, true)\n  }\n\n  #handleCookieFromCache () {\n    $ct.blockRequest = false\n    console.debug('Block request is false')\n    if (StorageManager._isLocalStorageSupported()) {\n      delete localStorage[PR_COOKIE]\n      delete localStorage[EV_COOKIE]\n      delete localStorage[META_COOKIE]\n      delete localStorage[ARP_COOKIE]\n      delete localStorage[CAMP_COOKIE_NAME]\n      delete localStorage[CHARGEDID_COOKIE_NAME]\n    }\n    StorageManager.removeCookie(CAMP_COOKIE_NAME, getHostName())\n    StorageManager.removeCookie(this.#session.cookieName, $ct.broadDomain)\n    StorageManager.removeCookie(ARP_COOKIE, $ct.broadDomain)\n    this.#session.setSessionCookieObject('')\n  }\n\n  #deleteUser () {\n    $ct.blockRequest = true\n    this.#logger.debug('Block request is true')\n    $ct.globalCache = {\n      gcookie: null,\n      REQ_N: 0,\n      RESP_N: 0\n    }\n    if (StorageManager._isLocalStorageSupported()) {\n      delete localStorage[GCOOKIE_NAME]\n      delete localStorage[KCOOKIE_NAME]\n      delete localStorage[PR_COOKIE]\n      delete localStorage[EV_COOKIE]\n      delete localStorage[META_COOKIE]\n      delete localStorage[ARP_COOKIE]\n      delete localStorage[CAMP_COOKIE_NAME]\n      delete localStorage[CHARGEDID_COOKIE_NAME]\n    }\n    StorageManager.removeCookie(GCOOKIE_NAME, $ct.broadDomain)\n    StorageManager.removeCookie(CAMP_COOKIE_NAME, getHostName())\n    StorageManager.removeCookie(KCOOKIE_NAME, getHostName())\n    StorageManager.removeCookie(this.#session.cookieName, $ct.broadDomain)\n    StorageManager.removeCookie(ARP_COOKIE, $ct.broadDomain)\n    this.#device.gcookie = null\n    this.#session.setSessionCookieObject('')\n  }\n\n  #processLoginArray (loginArr) {\n    if (Array.isArray(loginArr) && loginArr.length > 0) {\n      const profileObj = loginArr.pop()\n      const processProfile = profileObj != null && isObject(profileObj) &&\n          ((profileObj.Site != null && Object.keys(profileObj.Site).length > 0) ||\n              (profileObj.Facebook != null && Object.keys(profileObj.Facebook).length > 0) ||\n              (profileObj['Google Plus'] != null && Object.keys(profileObj['Google Plus']).length > 0))\n      if (processProfile) {\n        StorageManager.setInstantDeleteFlagInK()\n        try {\n          this.#processOUL([profileObj])\n        } catch (e) {\n          this.#logger.debug(e)\n        }\n      } else {\n        this.#logger.error('Profile object is in incorrect format')\n      }\n    }\n  }\n\n  push (...profilesArr) {\n    this.#processLoginArray(profilesArr)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processLoginArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n}\n","export class CTWebPersonalisationBanner extends HTMLElement {\n  constructor () {\n    super()\n    this.shadow = this.attachShadow({ mode: 'open' })\n  }\n\n  _details = null\n  shadow = null\n\n  get details () {\n    return this._details || ''\n  }\n\n  set details (val) {\n    if (this._details === null) {\n      this._details = val\n      this.renderBanner()\n    }\n  }\n\n  renderBanner () {\n    this.shadow.innerHTML = this.getBannerContent()\n    if (this.trackClick !== false) {\n      this.addEventListener('click', () => {\n        const onClickUrl = this.details.onClick\n        if (onClickUrl) {\n          this.details.window ? window.open(onClickUrl, '_blank') : window.parent.location.href = onClickUrl\n        }\n        window.clevertap.renderNotificationClicked({ msgId: this.msgId, pivotId: this.pivotId })\n      })\n    }\n    window.clevertap.renderNotificationViewed({ msgId: this.msgId, pivotId: this.pivotId })\n  }\n\n  getBannerContent () {\n    return `\n      <style type=\"text/css\">\n        .banner {\n          position: relative;\n          cursor: ${this.details.onClick ? 'pointer' : ''}\n        }\n        img {\n          height: ${this.divHeight ? this.divHeight : 'auto'};\n          width: 100%;\n        }\n        .wrapper:is(.left, .right, .center) {\n          display: flex;\n          justify-content: center;\n          flex-direction: column;\n          align-items: center;\n          position: absolute;\n          width: 100%;\n          height: 100%;\n          overflow: auto;\n          top: 0;\n        }\n        ${this.details.css ? this.details.css : ''}\n      </style>\n      <div class=\"banner\">\n        <picture>\n          <source media=\"(min-width:480px)\" srcset=\"${this.details.desktopImageURL}\">\n          <source srcset=\"${this.details.mobileImageURL}\">\n          <img src=\"${this.details.desktopImageURL}\" alt=\"Please upload a picture\" style=\"width:100%;\" part=\"banner__img\">\n        </picture>\n        ${this.details.html ? this.details.html : ''}\n      </div>\n    `\n  }\n}\n","import { CTWebPersonalisationBanner } from './banner'\nexport class CTWebPersonalisationCarousel extends HTMLElement {\n  constructor () {\n    super()\n    this.shadow = this.attachShadow({ mode: 'open' })\n    if (customElements.get('ct-web-personalisation-banner') === undefined) {\n      customElements.define('ct-web-personalisation-banner', CTWebPersonalisationBanner)\n    }\n  }\n\n  _target = null\n  _carousel = null\n  shadow = null\n  slides = 0\n  previouslySelectedItem = -1\n  selectedItem = 1\n  autoSlide = null\n  stopAutoSlideTimeout = null\n\n  get target () {\n    return this._target || ''\n  }\n\n  set target (val) {\n    if (this._target === null) {\n      this._target = val\n      this.renderCarousel()\n    }\n  }\n\n  get details () {\n    return this.target.display.details\n  }\n\n  get display () {\n    return this.target.display\n  }\n\n  renderCarousel () {\n    this.slides = this.details.length\n    this.shadow.innerHTML = this.getStyles()\n    const carousel = this.getCarouselContent()\n    if (this.display.showNavBtns) {\n      carousel.insertAdjacentHTML('beforeend', this.display.navBtnsHtml)\n    }\n    if (this.display.showNavArrows) {\n      carousel.insertAdjacentHTML('beforeend', this.display.leftNavArrowHtml)\n      carousel.insertAdjacentHTML('beforeend', this.display.rightNavArrowHtml)\n    }\n    this._carousel = carousel\n    this.shadow.appendChild(carousel)\n    this.setupClick()\n    this.updateSelectedItem()\n    // TODO: enable conditionally\n    this.startAutoSlide()\n    this.setupOnHover()\n    window.clevertap.renderNotificationViewed({ msgId: this.target.wzrk_id, pivotId: this.target.wzrk_pivot })\n  }\n\n  setupClick () {\n    this._carousel.addEventListener('click', (event) => {\n      const eventID = event.target.id\n      if (eventID.startsWith('carousel__button')) {\n        const selected = +eventID.split('-')[1]\n        if (selected !== this.selectedItem) {\n          this.previouslySelectedItem = this.selectedItem\n          this.selectedItem = selected\n          this.updateSelectedItem()\n          this.startAutoSlide()\n        }\n      } else if (eventID.startsWith('carousel__arrow')) {\n        eventID.endsWith('right') ? this.goToNext() : this.goToPrev()\n        this.startAutoSlide()\n      } else if (eventID.indexOf('-') > -1) {\n        const item = +eventID.split('-')[1]\n        const index = item - 1\n        if (window.parent.clevertap) {\n          // console.log('Raise notification clicked event for ', item)\n          window.clevertap.renderNotificationClicked({ msgId: this.target.wzrk_id, pivotId: this.target.wzrk_pivot, wzrk_slideNo: item })\n        }\n        const url = this.details[index].onClick\n        if (url !== '') {\n          this.details[index].window ? window.open(url, '_blank') : window.location.href = url\n        }\n      }\n    })\n  }\n\n  setupOnHover () {\n    this._carousel.addEventListener('mouseenter', (event) => {\n      this.stopAutoSlideTimeout = setTimeout(() => {\n        this.autoSlide = clearInterval(this.autoSlide)\n      }, 500)\n    })\n\n    this._carousel.addEventListener('mouseleave', (event) => {\n      clearTimeout(this.stopAutoSlideTimeout)\n      if (this.autoSlide === undefined) {\n        this.startAutoSlide()\n      }\n    })\n  }\n\n  getCarouselContent () {\n    const carousel = document.createElement('div')\n    carousel.setAttribute('class', 'carousel')\n\n    this.details.forEach((detail, i) => {\n      const banner = document.createElement('ct-web-personalisation-banner')\n      banner.classList.add('carousel__item')\n      banner.trackClick = false\n      banner.setAttribute('id', `carousel__item-${i + 1}`)\n      banner.details = detail\n      carousel.appendChild(banner)\n    })\n\n    return carousel\n  }\n\n  getStyles () {\n    return `\n      <style>\n      .carousel {\n        position: relative;\n      }\n\n      .carousel__item {\n        background-color: grey;\n        display: none;\n        background-repeat: no-repeat;\n        background-size: cover;\n      }\n\n      ct-web-personalisation-banner::part(banner__img) {\n        height: ${this?.target?.display?.divHeight ? this.target.display.divHeight : 'auto'};\n        width: 100%;\n        transition: 2s;\n      }\n\n      .carousel__item--selected {\n        display: block;\n      }\n      ${this.display.navBtnsCss}\n      ${this.display.navArrowsCss}\n      </style>\n  `\n  }\n\n  updateSelectedItem () {\n    if (this.previouslySelectedItem !== -1) {\n      const prevItem = this.shadow.getElementById(`carousel__item-${this.previouslySelectedItem}`)\n      const prevButton = this.shadow.getElementById(`carousel__button-${this.previouslySelectedItem}`)\n      prevItem.classList.remove('carousel__item--selected')\n      prevButton.classList.remove('carousel__button--selected')\n    }\n    const item = this.shadow.getElementById(`carousel__item-${this.selectedItem}`)\n    const button = this.shadow.getElementById(`carousel__button-${this.selectedItem}`)\n    item.classList.add('carousel__item--selected')\n    button.classList.add('carousel__button--selected')\n  }\n\n  startAutoSlide () {\n    clearInterval(this.autoSlide)\n    this.autoSlide = setInterval(() => {\n      this.goToNext()\n    }, this.display.sliderTime ? this.display.sliderTime * 1000 : 3000)\n  }\n\n  goToNext () {\n    this.goTo(this.selectedItem, (this.selectedItem + 1) % this.slides)\n  }\n\n  goToPrev () {\n    this.goTo(this.selectedItem, this.selectedItem - 1)\n  }\n\n  goTo (prev, cur) {\n    this.previouslySelectedItem = prev\n    this.selectedItem = cur\n    if (cur === 0) {\n      this.selectedItem = this.slides\n    }\n    this.updateSelectedItem()\n  }\n}\n","import {\n  getCampaignObject,\n  saveCampaignObject\n} from '../clevertap'\nimport { StorageManager } from '../storage'\n\nexport class CTWebPopupImageOnly extends HTMLElement {\n  constructor () {\n    super()\n    this.shadow = this.attachShadow({ mode: 'open' })\n  }\n\n    _target = null\n    _session = null\n    shadow = null\n    popup = null\n    container = null\n    resizeObserver = null\n\n    get target () {\n      return this._target || ''\n    }\n\n    set target (val) {\n      if (this._target === null) {\n        this._target = val\n        this.renderImageOnlyPopup()\n      }\n    }\n\n    get session () {\n      return this._session || ''\n    }\n\n    set session (val) {\n      this._session = val\n    }\n\n    get msgId () {\n      return this.target.wzrk_id\n    }\n\n    get pivotId () {\n      return this.target.wzrk_pivot\n    }\n\n    get onClickUrl () {\n      return this.target.display.onClickUrl\n    }\n\n    renderImageOnlyPopup () {\n      const campaignId = this.target.wzrk_id.split('_')[0]\n      const currentSessionId = this.session.sessionId\n\n      this.shadow.innerHTML = this.getImageOnlyPopupContent()\n      this.popup = this.shadowRoot.getElementById('imageOnlyPopup')\n      this.container = this.shadowRoot.getElementById('container')\n      this.closeIcon = this.shadowRoot.getElementById('close')\n\n      this.popup.addEventListener('load', this.updateImageAndContainerWidth())\n      this.resizeObserver = new ResizeObserver(() => this.handleResize(this.popup, this.container))\n      this.resizeObserver.observe(this.popup)\n\n      this.closeIcon.addEventListener('click', () => {\n        this.resizeObserver.unobserve(this.popup)\n        document.getElementById('wzrkImageOnlyDiv').style.display = 'none'\n        this.remove()\n        if (campaignId != null && campaignId !== '-1') {\n          if (StorageManager._isLocalStorageSupported()) {\n            const campaignObj = getCampaignObject()\n\n            let sessionCampaignObj = campaignObj.wp[currentSessionId]\n            if (sessionCampaignObj == null) {\n              sessionCampaignObj = {}\n              campaignObj[currentSessionId] = sessionCampaignObj\n            }\n            sessionCampaignObj[campaignId] = 'dnd'\n            saveCampaignObject(campaignObj)\n          }\n        }\n      })\n\n      window.clevertap.renderNotificationViewed({ msgId: this.msgId, pivotId: this.pivotId })\n\n      if (this.onClickUrl) {\n        this.popup.addEventListener('click', () => {\n          this.target.display.window ? window.open(this.onClickUrl, '_blank') : window.parent.location.href = this.onClickUrl\n          window.clevertap.renderNotificationClicked({ msgId: this.msgId, pivotId: this.pivotId })\n        })\n      }\n    }\n\n    handleResize (popup, container) {\n      const width = this.getRenderedImageWidth(popup)\n      container.style.setProperty('width', `${width}px`)\n    }\n\n    getImageOnlyPopupContent () {\n      return `\n        ${this.target.msgContent.css}\n        ${this.target.msgContent.html}\n      `\n    }\n\n    updateImageAndContainerWidth () {\n      return () => {\n        const width = this.getRenderedImageWidth(this.popup)\n        this.popup.style.setProperty('width', `${width}px`)\n        this.container.style.setProperty('width', `${width}px`)\n        this.container.style.setProperty('height', 'auto')\n        this.container.style.setProperty('position', 'fixed')\n        this.popup.style.setProperty('visibility', 'visible')\n        this.closeIcon.style.setProperty('visibility', 'visible')\n        document.getElementById('wzrkImageOnlyDiv').style.visibility = 'visible'\n      }\n    }\n\n    getRenderedImageWidth (img) {\n      const ratio = img.naturalWidth / img.naturalHeight\n      return img.height * ratio\n    }\n}\n","import { determineTimeStampText, greenTickSvg } from './helper'\nexport class Message extends HTMLElement {\n  constructor (config, message) {\n    super()\n    this.shadow = this.attachShadow({ mode: 'open' })\n    this.config = config\n    this.message = message\n    this.renderMessage(message)\n  }\n\n  wrapper = null\n  snackBar = null\n\n  get pivotId () {\n    return this.message.wzrk_pivot\n  }\n\n  get campaignId () {\n    return this.message.wzrk_id\n  }\n\n  createEl (type, id, part) {\n    const _el = document.createElement(type)\n    _el.setAttribute('id', id)\n    _el.setAttribute('part', part || id)\n    return _el\n  }\n\n  renderMessage (msg) {\n    this.wrapper = this.createEl('div', 'messageWrapper')\n\n    switch (msg.templateType) {\n      case 'text-only':\n      case 'text-with-icon':\n      case 'text-with-icon-and-image': {\n        const message = this.prepareBasicMessage(msg.msg[0])\n        this.wrapper.appendChild(message)\n      }\n    }\n\n    const timeStamp = this.createEl('div', 'timeStamp')\n    timeStamp.innerHTML = `<span>${determineTimeStampText(msg.id.split('_')[1])}<span>`\n    if (!msg.viewed) {\n      const unreadMarker = this.createEl('span', 'unreadMarker')\n      timeStamp.appendChild(unreadMarker)\n    }\n\n    this.wrapper.appendChild(timeStamp)\n    this.shadow.appendChild(this.wrapper)\n  }\n\n  prepareBasicMessage (msg) {\n    const message = this.createEl('div', 'message')\n\n    if (msg.imageUrl) {\n      const imageContainer = this.addImage(msg.imageUrl, 'mainImg')\n      message.appendChild(imageContainer)\n    }\n    const iconTitleDescWrapper = this.createEl('div', 'iconTitleDescWrapper')\n    if (msg.iconUrl) {\n      const iconContainer = this.addImage(msg.iconUrl, 'iconImg')\n      iconTitleDescWrapper.appendChild(iconContainer)\n    }\n    const titleDescWrapper = this.createEl('div', 'titleDescWrapper')\n    if (msg.title) {\n      const title = this.createEl('div', 'title')\n      title.innerText = msg.title\n      titleDescWrapper.appendChild(title)\n    }\n    if (msg.description) {\n      const description = this.createEl('div', 'description')\n      description.innerText = msg.description\n      titleDescWrapper.appendChild(description)\n    }\n    if (msg.title || msg.description) {\n      iconTitleDescWrapper.appendChild(titleDescWrapper)\n    }\n\n    if (msg.iconUrl || msg.title || msg.description) {\n      message.appendChild(iconTitleDescWrapper)\n    }\n    if (msg.buttons && msg.buttons.length) {\n      const buttonsContainer = this.addButtons(msg.buttons)\n      message.appendChild(buttonsContainer)\n    }\n    return message\n  }\n\n  addButtons (buttons = []) {\n    const buttonsContainer = this.createEl('div', 'buttonsContainer')\n    let hasCopyAction = false\n    buttons.forEach((b, i) => {\n      const button = this.createEl('button', `button-${i}`, 'button')\n      button.innerText = b.text\n      if (i > 0) {\n        button.style.cssText += 'margin-left: 2px;'\n      }\n      if (b.action === 'copy') {\n        hasCopyAction = true\n      }\n      buttonsContainer.appendChild(button)\n    })\n    if (hasCopyAction) {\n      this.addSnackbar(buttonsContainer)\n    }\n    return buttonsContainer\n  }\n\n  addSnackbar (buttonsContainer) {\n    this.snackBar = this.createEl('div', `snackbar-${this.campaignId}`, 'snackbar')\n    this.snackBar.innerHTML = greenTickSvg\n    const clipboardMsg = this.createEl('span', `snackbar-msg-${this.campaignId}`, 'snackbar-msg')\n    clipboardMsg.innerText = 'Copied to clipboard'\n    this.snackBar.appendChild(clipboardMsg)\n    buttonsContainer.appendChild(this.snackBar)\n  }\n\n  addImage (url, type) {\n    const imageContainer = this.createEl('div', `${type}Container`)\n    const image = this.createEl('img', type)\n    image.setAttribute('src', url)\n    // images will be fetched as and when the element comes into the viewport\n    image.setAttribute('loading', 'lazy')\n    imageContainer.appendChild(image)\n    return imageContainer\n  }\n\n  raiseClickedEvent (path, isPreview) {\n    switch (this.message.templateType) {\n      case 'text-only':\n      case 'text-with-icon':\n      case 'text-with-icon-and-image': {\n        this.raiseClickedForBasicTemplates(path, isPreview)\n      }\n    }\n  }\n\n  raiseClickedForBasicTemplates (path, isPreview) {\n    const msg = this.message.msg[0]\n    const payload = { msgId: this.campaignId, pivotId: this.pivotId }\n    if (path.tagName === 'BUTTON') {\n      const id = path.id.split('-')[1]\n      const button = msg.buttons[id]\n      payload.kv = {\n        wzrk_c2a: button.text\n      }\n      if (button.action === 'url') {\n        button.openUrlInNewTab ? window.open(button.url, '_blank') : (window.location = button.url)\n      } else if (button.action === 'copy') {\n        window.focus()\n        navigator.clipboard.writeText(button.clipboardText)\n        this.snackBar.style.setProperty('display', 'flex', 'important')\n        setTimeout(() => {\n          this.snackBar.style.setProperty('display', 'none', 'important')\n        }, 2000)\n      }\n    } else if (path.tagName === 'CT-INBOX-MESSAGE' && msg.onClickUrl) {\n      msg.openUrlInNewTab ? window.open(msg.onClickUrl, '_blank') : (window.location = msg.onClickUrl)\n    }\n    if (isPreview) {\n      console.log('Notifiction clicked event will be raised at run time with payload ::', payload)\n    } else {\n      window.clevertap.renderNotificationClicked(payload)\n    }\n  }\n}\n","export const messageStyles = ({ backgroundColor, borderColor, titleColor, descriptionColor, buttonColor, buttonTextColor, unreadMarkerColor }) => {\n  return `\n    <style id=\"messageStyles\">\n      ct-inbox-message::part(messageWrapper) {\n        margin-bottom: 16px; \n      }\n      ct-inbox-message::part(message) {\n        background-color: ${backgroundColor}; \n        border: 1px solid ${borderColor};\n        border-radius: 4px; \n        overflow: hidden;\n        min-height: 40px;\n      }\n      ct-inbox-message::part(message):hover {\n        box-shadow: 0px 4px 8px rgb(0 0 0 / 10%);\n        cursor: pointer;\n      }\n      ct-inbox-message::part(iconTitleDescWrapper) {\n        display: flex; \n        padding: 16px;\n      }\n      ct-inbox-message::part(titleDescWrapper) {\n        display: flex; \n        flex-direction: column;\n      }\n      ct-inbox-message::part(iconImgContainer) {\n        display: flex; \n        margin-right: 16px;\n      }\n      ct-inbox-message::part(mainImgContainer) {\n        line-height: 0;\n      }\n      ct-inbox-message::part(mainImg) {\n        width: 100%; \n        background: #b2b1ae;\n      }\n      ct-inbox-message::part(iconImg) {\n        height: 40px; \n        width: 40px;\n      }\n      ct-inbox-message::part(title) {\n        font-size: 14px !important; \n        line-height: 20px; \n        font-weight: 600; \n        color: ${titleColor}\n      }\n      ct-inbox-message::part(description) {\n        font-size: 14px !important; \n        line-height: 20px; \n        font-weight: 400; \n        color: ${descriptionColor}\n      }\n      ct-inbox-message::part(button) {\n        background-color: ${buttonColor}; \n        color: ${buttonTextColor}; \n        padding: 8px 16px; \n        font-size: 12px; \n        line-height: 16px; \n        font-weight: 600; \n        flex: 1; \n        border-radius: 0px; \n        text-transform: capitalize; \n        cursor: pointer; \n        border: none;\n      }\n      ct-inbox-message::part(buttonsContainer) {\n        display: flex;\n        position: relative;\n      }\n      ct-inbox-message::part(snackbar) {\n        position: absolute;\n        top: calc(-100% - 12px);\n        left: 50%;\n        transform: translate(-50%, 0px);\n        font-size: 14px;\n        font-weight: 400;\n        background: #FFFFFF;\n        border: 1px solid #ECEDF2;\n        box-shadow: 0px 4px 8px rgb(0 0 0 / 6%), 0px 0px 2px rgb(0 0 0 / 4%);\n        border-radius: 4px;\n        z-index: 2;\n        display: none;\n        width: max-content;\n        align-items: center;\n        padding: 8px 16px;\n        justify-content: center;\n      }\n\n      ct-inbox-message::part(snackbar-msg) {\n        color: black;\n        margin-left: 8px;\n      }\n\n      ct-inbox-message::part(timeStamp) {\n        display: flex; \n        justify-content: end; \n        align-items: center; \n        margin-top: 4px; \n        font-size: 12px !important; \n        line-height: 16px; \n        color: black;\n      }\n      ct-inbox-message::part(unreadMarker) {\n        height: 8px; \n        width: 8px; \n        border-radius: 50%; \n        background-color: ${unreadMarkerColor}; \n        margin-left: 8px;\n      }\n      @media only screen and (min-width: 420px) {\n        ct-inbox-message::part(mainImg) {\n          height: 180px;\n        }\n      }\n    </style>\n  `\n}\n\nexport const inboxContainerStyles = ({\n  panelBackgroundColor,\n  panelBorderColor,\n  headerBackgroundColor,\n  headerTitleColor,\n  closeIconColor,\n  categoriesTabColor,\n  categoriesTitleColor,\n  categoriesBorderColor,\n  selectedCategoryTabColor,\n  selectedCategoryTitleColor,\n  selectedCategoryBorderColor,\n  headerCategoryHeight\n}) => {\n  return `\n      <style id=\"webInboxStyles\">\n        #inbox {\n          width: 100%;\n          position: fixed;\n          background-color: #fff; \n          display: none; \n          box-shadow: 0px 2px 10px 0px #d7d7d791;\n          background-color: ${panelBackgroundColor}; \n          border: 1px solid ${panelBorderColor};\n          top: 0;\n          left: 0;\n          height: 100%;\n          overflow: auto;\n          z-index: 1;\n          box-sizing: content-box;\n          border-radius: 4px;\n        }\n  \n        #emptyInboxMsg {\n          display: block;\n          padding: 10px;\n          text-align: center;\n          color: black;\n        }\n  \n        #header {\n          height: 36px; \n          width: 100%; \n          display: flex; \n          justify-content: center; \n          align-items: center; \n          background-color: ${headerBackgroundColor}; \n          background-color: var(--card-bg, ${headerBackgroundColor});\n          color: ${headerTitleColor}\n        }\n  \n        #closeInbox {\n          font-size: 20px; \n          margin-right: 12px; \n          color: ${closeIconColor}; \n          cursor: pointer;\n        }\n  \n        #headerTitle {\n          font-size: 14px; \n          line-height: 20px; \n          flex-grow: 1; \n          font-weight: 700; \n          text-align: center;\n          flex-grow: 1;\n          text-align: center;\n        }\n  \n        #categoriesContainer {\n          padding: 16px 16px 0 16px; \n          height: 32px; \n          display: flex;\n          scroll-behavior: smooth;\n          position: relative;\n        }\n\n        #categoriesWrapper {\n          height: 32px; \n          overflow-x: scroll;\n          display: flex;\n          white-space: nowrap;\n          scrollbar-width: none;\n        }\n\n        #categoriesWrapper::-webkit-scrollbar {\n          display: none;\n        }\n  \n        #leftArrow, #rightArrow {\n          height: 32px;\n          align-items: center;\n          font-weight: 700;\n          position: absolute;\n          z-index: 2;\n          pointer-events: auto;\n          cursor: pointer;\n          display: none;\n        }\n\n        #leftArrow {\n          left: 0;\n          padding-left: 4px;\n          padding-right: 16px;\n          background: linear-gradient(90deg, ${panelBackgroundColor} 0%, ${panelBackgroundColor}99 80%, ${panelBackgroundColor}0d 100%);\n        }\n\n        #rightArrow {\n          right: 0;\n          padding-right: 4px;\n          padding-left: 16px;\n          background: linear-gradient(-90deg, ${panelBackgroundColor} 0%, ${panelBackgroundColor}99 80%, ${panelBackgroundColor}0d 100%);\n        }\n\n        [id^=\"category-\"] {\n          display: flex; \n          flex: 1 1 0; \n          justify-content: center; \n          align-items: center; \n          font-size: 14px; \n          line-height: 20px; \n          background-color: ${categoriesTabColor}; \n          color: ${categoriesTitleColor}; \n          cursor: pointer;\n          padding: 6px 24px;\n          margin: 0 3px;\n          border-radius: 16px;\n          border: ${categoriesBorderColor ? '1px solid ' + categoriesBorderColor : 'none'};\n        }\n\n        [id^=\"category-\"][selected=\"true\"] {\n          background-color: ${selectedCategoryTabColor}; \n          color: ${selectedCategoryTitleColor}; \n          border: ${selectedCategoryBorderColor ? '1px solid ' + selectedCategoryBorderColor : 'none'}\n        }\n  \n        #inboxCard {\n          padding: 0 16px 0 16px;\n          overflow-y: auto;\n          box-sizing: border-box;\n          margin-top: 16px;\n        }\n\n        @media only screen and (min-width: 480px) {\n          #inbox {\n            width: var(--inbox-width, 392px);\n            height: var(--inbox-height, 546px);\n            position: var(--inbox-position, fixed);\n            right: var(--inbox-right, unset);\n            bottom: var(--inbox-bottom, unset);\n            top: var(--inbox-top, unset);\n            left: var(--inbox-left, unset);\n          }\n  \n          #inboxCard {\n            height: calc(var(--inbox-height, 546px) - ${headerCategoryHeight}px); \n          }\n  \n        }\n      </style>\n      `\n}\n","import { StorageManager, $ct } from '../../util/storage'\nimport { Message } from './Message'\nimport { inboxContainerStyles, messageStyles } from './inboxStyles'\nimport { getInboxPosition, determineTimeStampText, arrowSvg, getInboxMessages, saveInboxMessages } from './helper'\nimport { WEBINBOX_CONFIG, MAX_INBOX_MSG } from '../../util/constants'\n\nexport class Inbox extends HTMLElement {\n  constructor (logger) {\n    super()\n    this.logger = logger\n    this.shadow = this.attachShadow({ mode: 'open' })\n  }\n\n  isInboxOpen = false\n  isInboxFromFlutter = false\n  selectedCategory = null\n  unviewedMessages = {}\n  unviewedCounter = 0\n  isPreview = false\n  inboxConfigForPreview = {}\n\n  // dom references\n  inboxSelector = null\n  inbox = null\n  emptyInboxMsg = null\n  inboxCard = null\n  unviewedBadge = null\n  observer = null\n  selectedCategoryRef = null\n\n  get incomingMessages () {\n    return []\n  }\n\n  set incomingMessages (msgs = []) {\n    if (msgs.length > 0 && this.inbox) {\n      this.updateInboxMessages(msgs)\n    }\n  }\n\n  get incomingMessagesForPreview () {\n    return []\n  }\n\n  set incomingMessagesForPreview (msgs = []) {\n    const previewMsgs = {}\n    if (msgs.length > 0 && this.inbox) {\n      this.isPreview = true\n      this.unviewedCounter = 0\n      msgs.forEach((m) => {\n        const key = `${m.wzrk_id.split('_')[0]}_${Date.now()}`\n        m.id = key\n        previewMsgs[key] = m\n        this.unviewedMessages[key] = m\n        this.unviewedCounter++\n      })\n      this.buildUIForMessages(previewMsgs)\n      this.updateUnviewedBadgeCounter()\n    }\n  }\n\n  connectedCallback () {\n    this.init()\n  }\n\n  init () {\n    this.config = this.isPreview ? this.inboxConfigForPreview : StorageManager.readFromLSorCookie(WEBINBOX_CONFIG) || {}\n    if (Object.keys(this.config).length === 0) {\n      return\n    }\n    this.inboxSelector = document.getElementById(this.config.inboxSelector)\n    if (this.inboxSelector === null) {\n      return\n    }\n\n    if (this.config.styles.notificationsBadge) {\n      this.addUnviewedBadge()\n    } else if (this.unviewedBadge) {\n      this.unviewedBadge.remove()\n    }\n\n    this.createinbox()\n\n    /**\n     * We need to remove the listener as there could be a scenario where init would be called when\n     * we get updated web inbox settings from LC after the inbox has been initialised.\n     * It can so happen that the inbox-selector would have changed.\n     */\n    document.removeEventListener('click', this.addClickListenerOnDocument)\n    document.addEventListener('click', this.addClickListenerOnDocument)\n    this.config.categories.length && this.updateActiveCategory(this.selectedCategoryRef.innerText)\n\n    this.shadow.innerHTML = this.getInboxStyles()\n    this.shadow.appendChild(this.inbox)\n  }\n\n  addMsgsToInboxFromLS () {\n    const messages = this.deleteExpiredAndGetUnexpiredMsgs(false)\n    const msgIds = messages ? Object.keys(messages) : []\n    if (msgIds.length === 0) {\n      return\n    }\n    msgIds.forEach((m) => {\n      if (!messages[m].viewed) {\n        this.unviewedMessages[m] = messages[m]\n        this.unviewedCounter++\n      }\n    })\n    this.buildUIForMessages(messages)\n    this.updateUnviewedBadgeCounter()\n  }\n\n  /**\n   * @param {*} deleteMsgsFromUI - If this param is true, then we'll have to check the UI and delete expired messages from the DOM\n   * It'll be false when you are building the inbox layout for the very first time.\n   *\n   * This method reads the inbox messages from LS,\n   * based on the deleteMsgsFromUI flag deletes the expired messages from UI and decrements the unviewed counter if the message was not viewed,\n   * sorts the messages based on the date,\n   * saves the unexpired messages to LS\n   * and returns the sorted unexpired messages\n   *\n   * Scenarios when we encounter expired messages -\n   * 1. building ui for the 1st time, no need to decrement the unviewed counter as the correct count will be set at the time of rendering\n   * 2. UI is already built (deleteMsgsFromUI = true) and you open the inbox\n   *    a. You'll find the expired msg in inbox\n   *    b. You'll not find the expired msg in inbox.\n   *       This happens when we receive new messages from LC, increment unviewed counter, save it in LS. (We build the UI only when the user opens inbox.)\n   *  In both the above scenarios, we'll still have to decrement the unviewed counter if the message was not viewed.\n   */\n  deleteExpiredAndGetUnexpiredMsgs (deleteMsgsFromUI = true) {\n    let messages = getInboxMessages()\n\n    const now = Math.floor(Date.now() / 1000)\n    for (const msg in messages) {\n      if (messages[msg].wzrk_ttl && messages[msg].wzrk_ttl > 0 && messages[msg].wzrk_ttl < now) {\n        if (deleteMsgsFromUI) {\n          const el = this.shadowRoot.getElementById(messages[msg].id)\n          el && el.remove()\n          if (!messages[msg].viewed) {\n            this.unviewedCounter--\n            this.updateUnviewedBadgeCounter()\n          }\n        }\n        delete messages[msg]\n      }\n    }\n    if (messages && messages.length > 0) {\n      messages = Object.values(messages).sort((a, b) => b.date - a.date).reduce((acc, m) => { acc[m.id] = m; return acc }, {})\n    }\n    saveInboxMessages(messages)\n    return messages\n  }\n\n  updateInboxMessages (msgs = []) {\n    const inboxMsgs = this.deleteExpiredAndGetUnexpiredMsgs()\n    const date = Date.now()\n    const incomingMsgs = {}\n    msgs.forEach((m, i) => {\n      const key = `${m.wzrk_id.split('_')[0]}_${Date.now()}`\n      m.id = key\n      // We are doing this to preserve the order of the messages\n      m.date = date - i\n      m.viewed = 0\n      inboxMsgs[key] = m\n      incomingMsgs[key] = m\n      this.unviewedMessages[key] = m\n      this.unviewedCounter++\n    })\n    saveInboxMessages(inboxMsgs)\n    this.buildUIForMessages(incomingMsgs)\n    this.updateUnviewedBadgeCounter()\n  }\n\n  createEl (type, id, part) {\n    const _el = document.createElement(type)\n    _el.setAttribute('id', id)\n    _el.setAttribute('part', part || id)\n    return _el\n  }\n\n  addUnviewedBadge () {\n    if (!this.unviewedBadge) {\n      this.unviewedBadge = this.createEl('div', 'unviewedBadge')\n      // As this unviewedBadge element will be directly added to the DOM, we are defining inline styles\n      this.unviewedBadge.style.cssText = `display: none; position: absolute; height: 16px; width: 26px; border-radius: 8px; background-color: ${this.config.styles.notificationsBadge.backgroundColor}; font-size: 12px; color: ${this.config.styles.notificationsBadge.textColor}; font-weight: bold; align-items: center; justify-content: center;`\n      document.body.appendChild(this.unviewedBadge)\n    }\n    this.updateUnviewedBadgePosition()\n\n    // called when user switches b/w portrait and landscape mode.\n    window.addEventListener('resize', () => {\n      this.updateUnviewedBadgePosition()\n    })\n  }\n\n  updateUnviewedBadgePosition () {\n    const { top, right } = this.inboxSelector.getBoundingClientRect()\n    this.unviewedBadge.style.top = `${top - 8}px`\n    this.unviewedBadge.style.left = `${right - 8}px`\n  }\n\n  createinbox () {\n    this.inbox = this.createEl('div', 'inbox')\n    const header = this.createEl('div', 'header')\n\n    const headerTitle = this.createEl('div', 'headerTitle')\n    headerTitle.innerText = this.config.title\n\n    const closeIcon = this.createEl('div', 'closeInbox')\n    closeIcon.innerHTML = '&times'\n\n    header.appendChild(headerTitle)\n    header.appendChild(closeIcon)\n    this.inbox.appendChild(header)\n    if (this.config.categories.length) {\n      const categories = this.createCategories()\n      this.inbox.appendChild(categories)\n    }\n    this.inboxCard = this.createEl('div', 'inboxCard')\n    this.inbox.appendChild(this.inboxCard)\n\n    this.emptyInboxMsg = this.createEl('div', 'emptyInboxMsg')\n    this.emptyInboxMsg.innerText = 'All messages will be displayed here.'\n    this.inboxCard.appendChild(this.emptyInboxMsg)\n\n    // Intersection observer for notification viewed\n    const options = {\n      root: this.inboxCard,\n      rootMargin: '0px',\n      threshold: 0.5\n    }\n    this.observer = new IntersectionObserver((entries, observer) => { this.handleMessageViewed(entries) }, options)\n\n    this.addMsgsToInboxFromLS()\n  }\n\n  createCategories () {\n    const categoriesContainer = this.createEl('div', 'categoriesContainer')\n\n    const leftArrow = this.createEl('div', 'leftArrow')\n    leftArrow.innerHTML = arrowSvg\n    leftArrow.children[0].style = 'transform: rotate(180deg)'\n    leftArrow.addEventListener('click', () => {\n      this.shadowRoot.getElementById('categoriesWrapper').scrollBy(-70, 0)\n    })\n    categoriesContainer.appendChild(leftArrow)\n\n    const categoriesWrapper = this.createEl('div', 'categoriesWrapper')\n    const _categories = ['All', ...this.config.categories]\n    _categories.forEach((c, i) => {\n      const category = this.createEl('div', `category-${i}`, 'category')\n      category.innerText = c\n      if (i === 0) {\n        this.selectedCategoryRef = category\n      }\n      categoriesWrapper.appendChild(category)\n    })\n    categoriesContainer.appendChild(categoriesWrapper)\n\n    const rightArrow = this.createEl('div', 'rightArrow')\n    rightArrow.innerHTML = arrowSvg\n    rightArrow.addEventListener('click', () => {\n      this.shadowRoot.getElementById('categoriesWrapper').scrollBy(70, 0)\n    })\n    categoriesContainer.appendChild(rightArrow)\n\n    const options = { root: categoriesContainer, threshold: 0.9 }\n    const firstCategory = categoriesWrapper.children[0]\n    const lastCategory = categoriesWrapper.children[this.config.categories.length]\n\n    const firstCategoryObserver = new IntersectionObserver((e) => {\n      this.categoryObserverCb(leftArrow, e[0].intersectionRatio >= 0.9)\n    }, options)\n    firstCategoryObserver.observe(firstCategory)\n\n    const lastCategoryObserver = new IntersectionObserver((e) => {\n      this.categoryObserverCb(rightArrow, e[0].intersectionRatio >= 0.9)\n    }, options)\n    lastCategoryObserver.observe(lastCategory)\n\n    return categoriesContainer\n  }\n\n  categoryObserverCb (el, hide) {\n    if (!el) {\n      return\n    }\n    el.style.display = hide ? 'none' : 'flex'\n  }\n\n  updateActiveCategory (activeCategory) {\n    this.selectedCategory = activeCategory\n\n    this.inboxCard.scrollTop = 0\n    let counter = 0\n\n    this.prevCategoryRef && this.prevCategoryRef.setAttribute('selected', 'false')\n    this.selectedCategoryRef.setAttribute('selected', 'true')\n\n    this.inboxCard.childNodes.forEach(c => {\n      if (c.getAttribute('id') !== 'emptyInboxMsg') {\n        c.style.display = (this.selectedCategory === 'All' || c.getAttribute('category') === this.selectedCategory) ? 'block' : 'none'\n        if (c.style.display === 'block') {\n          counter++\n        }\n      }\n    })\n    if (counter === 0) {\n      this.emptyInboxMsg.innerText = `${activeCategory} messages will be displayed here.`\n      this.emptyInboxMsg.style.display = 'block'\n    } else {\n      this.emptyInboxMsg.style.display = 'none'\n    }\n  }\n\n  buildUIForMessages (messages = {}) {\n    !this.isPreview && this.updateTSForRenderedMsgs()\n    this.inboxCard.scrollTop = 0\n    const maxMsgsInInbox = this.config.maxMsgsInInbox ?? MAX_INBOX_MSG\n    const firstChild = this.inboxCard.firstChild\n\n    const sortedMsgs = Object.values(messages).sort((a, b) => b.date - a.date).map((m) => m.id)\n    for (const m of sortedMsgs) {\n      const item = new Message(this.config, messages[m])\n      item.setAttribute('id', messages[m].id)\n      item.setAttribute('pivot', messages[m].wzrk_pivot)\n      item.setAttribute('part', 'ct-inbox-message')\n      if (this.config.categories.length > 0) {\n        item.setAttribute('category', messages[m].tags[0] || '')\n        item.style.display = (this.selectedCategory === 'All' || messages[m].category === this.selectedCategory) ? 'block' : 'none'\n      } else {\n        item.style.display = 'block'\n      }\n      this.inboxCard.insertBefore(item, firstChild)\n      this.observer.observe(item)\n    }\n\n    let msgTotalCount = this.inboxCard.querySelectorAll('ct-inbox-message').length\n    while (msgTotalCount > maxMsgsInInbox) {\n      const ctInboxMsgs = this.inboxCard.querySelectorAll('ct-inbox-message')\n      if (ctInboxMsgs.length > 0) { ctInboxMsgs[ctInboxMsgs.length - 1].remove() }\n      msgTotalCount--\n    }\n    const hasMessages = this.inboxCard.querySelectorAll('ct-inbox-message[style*=\"display: block\"]').length\n    this.emptyInboxMsg.style.display = hasMessages ? 'none' : 'block'\n  }\n\n  /**\n   * Adds a click listener on the document. For every click we check\n   * 1. if the click has happenned within the inbox\n   *    - on close button, we close the inbox\n   *    - on any of the category, we set that as the activeCategory\n   *    - on any of the message, we mark raise notification clicked event. To identify the clicks on a button, we have p.id.startsWith('button-')\n   * 2. if the user has clicked on the inboxSelector, we toggle inbox\n   * 3. if the click is anywhere else on the UI and the inbox is open, we simply close it\n   */\n\n  addClickListenerOnDocument = (() => {\n    return (e) => {\n      if (e.composedPath().includes(this.inbox)) {\n        // path is not supported on FF. So we fallback to e.composedPath\n        const path = e.path || (e.composedPath && e.composedPath())\n        if (path.length) {\n          const id = path[0].id\n          if (id === 'closeInbox') {\n            this.toggleInbox()\n          } else if (id.startsWith('category-')) {\n            this.prevCategoryRef = this.selectedCategoryRef\n            this.selectedCategoryRef = path[0]\n            this.updateActiveCategory(path[0].innerText)\n          } else {\n            const _path = path.filter((p) => p.id?.startsWith('button-') || p.tagName === 'CT-INBOX-MESSAGE')\n            if (_path.length) {\n              const messageEl = _path[_path.length - 1]\n              messageEl.raiseClickedEvent(_path[0], this.isPreview)\n            }\n          }\n        }\n      } else if (this.inboxSelector.contains(e.target) || this.isInboxOpen) {\n        if (this.isInboxFromFlutter) {\n          this.isInboxFromFlutter = false\n        } else {\n          this.toggleInbox(e)\n        }\n      }\n    }\n  })()\n\n  /**\n   * This function will be called every time when a message comes into the inbox viewport and it's visibility increases to 50% or drops below 50%\n   * If a msg is 50% visible in the UI, we need to mark the message as viewed in LS and raise notification viewed event\n   */\n  handleMessageViewed (entries) {\n    const raiseViewedEvent = !this.isPreview\n    if (this.isInboxOpen) {\n      entries.forEach((e) => {\n        if (e.isIntersecting && this.unviewedMessages.hasOwnProperty(e.target.id) && e.target.message.viewed === 0) {\n          e.target.message.viewed = 1\n          if (raiseViewedEvent) {\n            window.clevertap.renderNotificationViewed({ msgId: e.target.campaignId, pivotId: e.target.pivotId })\n            this.updateMessageInLS(e.target.id, { ...e.target.message, viewed: 1 })\n            setTimeout(() => {\n              e.target.shadowRoot.getElementById('unreadMarker').style.display = 'none'\n            }, 1000)\n          } else {\n            console.log('Notifiction viewed event will be raised at run time with payload ::', { msgId: e.target.campaignId, pivotId: e.target.pivotId })\n          }\n          this.unviewedCounter--\n          this.updateUnviewedBadgeCounter()\n          delete this.unviewedMessages[e.target.id]\n        }\n      })\n    }\n  }\n\n  updateMessageInLS (key, value) {\n    if (!this.isPreview) {\n      const messages = getInboxMessages()\n      messages[key] = value\n      saveInboxMessages(messages)\n    }\n  }\n\n  // create a separte fn fro refactoring\n  toggleInbox (e) {\n    this.isInboxOpen = !this.isInboxOpen\n    this.isInboxFromFlutter = !!e?.rect\n    if (this.isInboxOpen) {\n      this.inboxCard.scrollTop = 0\n      !this.isPreview && this.deleteExpiredAndGetUnexpiredMsgs()\n      this.inbox.style.display = 'block'\n      this.inbox.style.zIndex = '2147483647' // zIndex should be max for the inbox to be rendered on top of all elements\n      if (this.config.categories.length) {\n        this.selectedCategoryRef.setAttribute('selected', 'false')\n        this.selectedCategoryRef = this.shadowRoot.getElementById('category-0')\n        this.updateActiveCategory(this.selectedCategoryRef.innerText)\n        this.shadowRoot.getElementById('categoriesWrapper').scrollLeft -= this.shadowRoot.getElementById('categoriesWrapper').scrollWidth\n      }\n      this.setInboxPosition(e)\n    } else {\n      this.inbox.style.display = 'none'\n    }\n  }\n\n  setInboxPosition (e) {\n    const windowWidth = window.outerWidth\n    const customInboxStyles = getComputedStyle($ct.inbox)\n    const top = customInboxStyles.getPropertyValue('--inbox-top')\n    const bottom = customInboxStyles.getPropertyValue('--inbox-bottom')\n    const left = customInboxStyles.getPropertyValue('--inbox-left')\n    const right = customInboxStyles.getPropertyValue('--inbox-right')\n    const hasPositionDefined = top || bottom || left || right\n    if (windowWidth > 481 && !hasPositionDefined) {\n      const res = getInboxPosition(e, this.inbox.clientHeight, this.inbox.clientWidth)\n      const xPos = res.xPos\n      const yPos = res.yPos\n      this.inbox.style.top = yPos + 'px'\n      this.inbox.style.left = xPos + 'px'\n    }\n  }\n\n  /**\n   * Updates the UI with the number of unviewed messages\n   * If there are more than 9 unviewed messages, we show the count as 9+\n   */\n\n  setBadgeStyle = (msgCount) => {\n    if (this.unviewedBadge !== null) {\n      this.unviewedBadge.innerText = msgCount > 9 ? '9+' : msgCount\n      this.unviewedBadge.style.display = msgCount > 0 ? 'flex' : 'none'\n    }\n  }\n\n  updateUnviewedBadgeCounter () {\n    if (this.isPreview) {\n      this.setBadgeStyle(this.unviewedCounter)\n      return\n    }\n    let counter = 0\n    this.inboxCard.querySelectorAll('ct-inbox-message').forEach((m) => {\n      const messages = getInboxMessages()\n      if (messages[m.id] && messages[m.id].viewed === 0) {\n        counter++\n      }\n    })\n    this.setBadgeStyle(counter)\n  }\n\n  updateTSForRenderedMsgs () {\n    this.inboxCard.querySelectorAll('ct-inbox-message').forEach((m) => {\n      const ts = m.id.split('_')[1]\n      m.shadow.getElementById('timeStamp').firstChild.innerText = determineTimeStampText(ts)\n    })\n  }\n\n  getInboxStyles () {\n    const headerHeight = 36\n    const categoriesHeight = this.config.categories.length ? 64 : 16\n\n    const styles = {\n      panelBackgroundColor: this.config.styles.panelBackgroundColor,\n      panelBorderColor: this.config.styles.panelBorderColor,\n      headerBackgroundColor: this.config.styles.header.backgroundColor,\n      headerTitleColor: this.config.styles.header.titleColor,\n      closeIconColor: this.config.styles.closeIconColor,\n      categoriesTabColor: this.config.styles.categories.tabColor,\n      categoriesTitleColor: this.config.styles.categories.titleColor,\n      selectedCategoryTabColor: this.config.styles.categories.selectedTab.tabColor,\n      selectedCategoryTitleColor: this.config.styles.categories.selectedTab.titleColor,\n      headerCategoryHeight: headerHeight + categoriesHeight\n    }\n    if (this.config.styles.categories.borderColor) {\n      styles.categoriesBorderColor = this.config.styles.categories.borderColor\n    }\n    if (this.config.styles.categories.selectedTab.borderColor) {\n      styles.selectedCategoryBorderColor = this.config.styles.categories.selectedTab.borderColor\n    }\n\n    const inboxStyles = inboxContainerStyles(styles)\n\n    const cardStyles = this.config.styles.cards\n    const msgStyles = messageStyles({\n      backgroundColor: cardStyles.backgroundColor,\n      borderColor: cardStyles.borderColor,\n      titleColor: cardStyles.titleColor,\n      descriptionColor: cardStyles.descriptionColor,\n      buttonColor: cardStyles.buttonColor,\n      buttonTextColor: cardStyles.buttonTextColor,\n      unreadMarkerColor: cardStyles.unreadMarkerColor\n    })\n\n    return inboxStyles + msgStyles\n  }\n}\n","import { StorageManager, $ct } from '../../util/storage'\nimport { Inbox } from './WebInbox'\nimport { Message } from './Message'\nimport { WEBINBOX_CONFIG, GCOOKIE_NAME, WEBINBOX } from '../../util/constants'\nimport { isValueValid } from '../../util/datatypes'\n\nexport const processWebInboxSettings = (webInboxSetting, isPreview = false) => {\n  const _settings = StorageManager.readFromLSorCookie(WEBINBOX_CONFIG) || {}\n  if (isPreview) {\n    $ct.inbox.inboxConfigForPreview = webInboxSetting\n    $ct.inbox.isPreview = true\n    $ct.inbox && $ct.inbox.init()\n  } else if (JSON.stringify(_settings) !== JSON.stringify(webInboxSetting)) {\n    StorageManager.saveToLSorCookie(WEBINBOX_CONFIG, webInboxSetting)\n    $ct.inbox && $ct.inbox.init()\n  }\n}\n\nexport const processInboxNotifs = (msg) => {\n  if (msg.inbox_preview) {\n    $ct.inbox.incomingMessagesForPreview = msg.inbox_notifs\n  } else {\n    $ct.inbox.incomingMessages = msg\n  }\n}\n\nexport const processWebInboxResponse = (msg) => {\n  if (msg.webInboxSetting) {\n    processWebInboxSettings(msg.webInboxSetting, msg.inbox_preview)\n  }\n  if (msg.inbox_notifs != null) {\n    processInboxNotifs(msg)\n  }\n}\n\nexport const addWebInbox = (logger) => {\n  checkAndRegisterWebInboxElements()\n  $ct.inbox = new Inbox({ logger })\n  document.body.appendChild($ct.inbox)\n}\n\nconst getAndMigrateInboxMessages = (guid) => {\n  const messages = StorageManager.readFromLSorCookie(WEBINBOX) || {}\n  // Doing this to migrate message to guid level\n  if (Object.keys(messages).length > 0 && Object.keys(messages)[0].includes('_')) {\n    const gudInboxObj = {}\n    gudInboxObj[guid] = messages\n    StorageManager.saveToLSorCookie(WEBINBOX, gudInboxObj)\n    return gudInboxObj\n  }\n  return messages\n}\n\nexport const getInboxMessages = () => {\n  const guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n  if (!isValueValid(guid)) { return {} }\n  const messages = getAndMigrateInboxMessages(guid)\n\n  return messages.hasOwnProperty(guid) ? messages[guid] : {}\n}\n\nexport const saveInboxMessages = (messages) => {\n  const guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n  if (!isValueValid(guid)) { return }\n  const storedInboxObj = getAndMigrateInboxMessages(guid)\n\n  const newObj = { ...storedInboxObj, [guid]: messages }\n  StorageManager.saveToLSorCookie(WEBINBOX, newObj)\n}\n\nexport const initializeWebInbox = (logger) => {\n  return new Promise((resolve, reject) => {\n    if (document.readyState === 'complete') {\n      addWebInbox(logger)\n      resolve()\n    } else {\n      const config = StorageManager.readFromLSorCookie(WEBINBOX_CONFIG) || {}\n      const onLoaded = () => {\n        /**\n         * We need this null check here because $ct.inbox could be initialised via init method too on document load.\n         * In that case we don't need to call addWebInbox method\n         */\n        if ($ct.inbox === null) {\n          addWebInbox(logger)\n        }\n        resolve()\n      }\n      window.addEventListener('load', () => {\n        /**\n         * Scripts can be loaded layzily, we may not get element from dom as it may not be mounted yet\n         * We will to check element for 10 seconds and give up\n         */\n        if (document.getElementById(config.inboxSelector)) {\n          onLoaded()\n        } else {\n          // check for element for next 10 seconds\n          let count = 0\n          if (count < 20) {\n            const t = setInterval(() => {\n              if (document.getElementById(config.inboxSelector)) {\n                onLoaded()\n                clearInterval(t)\n                resolve()\n              } else if (count >= 20) {\n                clearInterval(t)\n                logger.debug('Failed to add inbox')\n              }\n              count++\n            }, 500)\n          }\n        }\n      })\n    }\n  })\n}\n\nexport const checkAndRegisterWebInboxElements = () => {\n  if (customElements.get('ct-web-inbox') === undefined) {\n    customElements.define('ct-web-inbox', Inbox)\n    customElements.define('ct-inbox-message', Message)\n  }\n}\n\nexport const getInboxPosition = (e, inboxHeight, inboxWidth) => {\n  const horizontalScroll = document.scrollingElement.scrollLeft\n  const verticalScroll = document.scrollingElement.scrollTop\n  const windowWidth = window.innerWidth + horizontalScroll\n  const windowHeight = window.innerHeight + verticalScroll\n  const selectorRect = e.rect || e.target.getBoundingClientRect()\n  const selectorX = selectorRect.x + horizontalScroll\n  const selectorY = selectorRect.y + verticalScroll\n  const selectorLeft = selectorRect.left + horizontalScroll\n  const selectorRight = selectorRect.right + horizontalScroll\n  const selectorTop = selectorRect.top + verticalScroll\n  // const selectorBottom = selectorRect.bottom + verticalScroll\n  const selectorBottom = selectorRect.bottom\n  const selectorHeight = selectorRect.height\n  const selectorWidth = selectorRect.width\n  const selectorCenter = {\n    x: selectorX + (selectorWidth / 2),\n    y: selectorY + (selectorHeight / 2)\n  }\n  const halfOfInboxHeight = (inboxHeight / 2)\n  const halfOfInboxWidth = (inboxWidth / 2)\n  let inboxOnSide = false\n\n  let xPos, yPos\n\n  const padding = 16\n\n  /**\n   * y co-ordinates:\n   * Try to push the card downwards\n   * if that's not possible, push it upwards\n   * if that too is not possible, then the card will be placed on the side. Add some padding.\n   *\n   * x co-ordinates:\n   * If the card is on the side,\n   *    try to place it to the right. If it's not possible,\n   *    place it to the left\n   * If the card is either on top/ bottom, set the x co-ordinate such that the selector center and the inbox card center become the same\n   * Now,\n   *  if the left of the inbox card is < 0,\n   *    try to get the left aligned to the selectorLeft.\n   *    if that's not possible, simply set left to 0\n   *  if the right of the inbox card > windowWidth,\n   *    try to get the right of rhe inbox card aligned with the selectorRight\n   *    if that's not possible, simply set the inbox right to the window Right\n   */\n  if (selectorBottom + inboxHeight <= windowHeight) { // try to place the card down\n    const availableHeight = windowHeight - (selectorBottom + inboxHeight)\n    yPos = availableHeight >= padding ? selectorBottom + padding : selectorBottom + availableHeight\n  } else if (selectorTop - inboxHeight >= verticalScroll) { // try to place the card up\n    const availableHeight = selectorTop - inboxHeight\n    yPos = availableHeight >= padding ? selectorTop - inboxHeight - padding : selectorTop - inboxHeight - availableHeight\n  } else {\n    inboxOnSide = true\n    yPos = selectorCenter.y - halfOfInboxHeight // with this the y co-ordinate of the selector center and the inbox card center become the same\n    if (yPos < verticalScroll) {\n      yPos = verticalScroll\n    } else if (yPos + inboxHeight > windowHeight) {\n      yPos = windowHeight - inboxHeight\n    }\n  }\n\n  if (inboxOnSide) {\n    // See if we can place the card to the right of the selector\n    const inboxRight = selectorRight + inboxWidth\n    if (inboxRight <= windowWidth) {\n      const availableWidth = inboxRight + padding <= windowWidth ? padding : windowWidth - inboxRight\n      xPos = selectorRight + availableWidth\n    } else {\n      const inboxLeft = selectorLeft - inboxWidth\n      const availableWidth = inboxLeft - padding >= horizontalScroll ? padding : inboxLeft - horizontalScroll\n      xPos = inboxLeft - availableWidth\n    }\n  } else {\n    xPos = selectorCenter.x - halfOfInboxWidth\n    if (xPos < horizontalScroll) {\n      if (selectorLeft + inboxWidth <= windowWidth) {\n        xPos = selectorLeft\n      } else {\n        xPos = horizontalScroll\n      }\n    } else if (xPos + inboxWidth > windowWidth) {\n      if (selectorRight - inboxWidth >= horizontalScroll) {\n        xPos = selectorRight - inboxWidth\n      } else {\n        xPos = windowWidth - inboxWidth\n      }\n    }\n  }\n\n  return { xPos, yPos }\n}\n\nexport const determineTimeStampText = (ts) => {\n  const now = Date.now()\n  let diff = Math.floor((now - ts) / 60000)\n  if (diff < 5) {\n    return 'Just now'\n  }\n  if (diff < 60) {\n    return `${diff} minute${diff > 1 ? 's' : ''} ago`\n  }\n  diff = Math.floor(diff / 60)\n  if (diff < 24) {\n    return `${diff} hour${diff > 1 ? 's' : ''} ago`\n  }\n  diff = Math.floor(diff / 24)\n  return `${diff} day${diff > 1 ? 's' : ''} ago`\n}\n\nexport const hasWebInboxSettingsInLS = () => {\n  return Object.keys(StorageManager.readFromLSorCookie(WEBINBOX_CONFIG) || {}).length > 0\n}\n\nexport const arrowSvg = `<svg width=\"6\" height=\"10\" viewBox=\"0 0 6 10\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M0.258435 9.74751C-0.0478584 9.44825 -0.081891 8.98373 0.156337 8.64775L0.258435 8.52836L3.87106 5L0.258435 1.47164C-0.0478588 1.17239 -0.0818914 0.707867 0.156337 0.371887L0.258435 0.252494C0.564728 -0.0467585 1.04018 -0.0800085 1.38407 0.152743L1.50627 0.252494L5.74156 4.39042C6.04786 4.68968 6.08189 5.1542 5.84366 5.49018L5.74156 5.60957L1.50627 9.74751C1.16169 10.0842 0.603015 10.0842 0.258435 9.74751Z\" fill=\"#63698F\"/>\n</svg>\n`\nexport const greenTickSvg = `<svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16C12.4183 16 16 12.4183 16 8ZM9.6839 5.93602C9.97083 5.55698 10.503 5.48833 10.8725 5.78269C11.2135 6.0544 11.2968 6.54044 11.0819 6.91173L11.0219 7.00198L8.09831 10.864C7.80581 11.2504 7.26654 11.3086 6.90323 11.0122L6.82822 10.9433L5.04597 9.10191C4.71635 8.76136 4.71826 8.21117 5.05023 7.87303C5.35666 7.5609 5.83722 7.53855 6.16859 7.80482L6.24814 7.87739L7.35133 9.01717L9.6839 5.93602Z\" fill=\"#03A387\"/>\n</svg>\n`\n","import {\n  addToLocalProfileMap,\n  arp,\n  getCampaignObject,\n  saveCampaignObject,\n  closeIframe\n} from './clevertap'\n\nimport {\n  CAMP_COOKIE_NAME,\n  DISPLAY,\n  GLOBAL,\n  EV_COOKIE,\n  NOTIFICATION_VIEWED,\n  NOTIFICATION_CLICKED,\n  WZRK_PREFIX,\n  WZRK_ID,\n  CAMP_COOKIE_G,\n  GCOOKIE_NAME\n} from './constants'\n\nimport {\n  getNow,\n  getToday\n} from './datetime'\n\nimport {\n  compressToBase64\n} from './encoder'\n\nimport { StorageManager, $ct } from './storage'\nimport RequestDispatcher from './requestDispatcher'\nimport { CTWebPersonalisationBanner } from './web-personalisation/banner'\nimport { CTWebPersonalisationCarousel } from './web-personalisation/carousel'\nimport { CTWebPopupImageOnly } from './web-popupImageonly/popupImageonly'\nimport { checkAndRegisterWebInboxElements, initializeWebInbox, processWebInboxSettings, hasWebInboxSettingsInLS, processInboxNotifs } from '../modules/web-inbox/helper'\n\nconst _tr = (msg, {\n  device,\n  session,\n  request,\n  logger\n}) => {\n  const _device = device\n  const _session = session\n  const _request = request\n  const _logger = logger\n  let _wizCounter = 0\n\n  // Campaign House keeping\n  const doCampHouseKeeping = (targetingMsgJson) => {\n    const campaignId = targetingMsgJson.wzrk_id.split('_')[0]\n    const today = getToday()\n\n    const incrCount = (obj, campaignId, excludeFromFreqCaps) => {\n      let currentCount = 0\n      let totalCount = 0\n      if (obj[campaignId] != null) {\n        currentCount = obj[campaignId]\n      }\n      currentCount++\n      if (obj.tc != null) {\n        totalCount = obj.tc\n      }\n      // if exclude from caps then dont add to total counts\n      if (excludeFromFreqCaps < 0) {\n        totalCount++\n      }\n\n      obj.tc = totalCount\n      obj[campaignId] = currentCount\n    }\n\n    if (StorageManager._isLocalStorageSupported()) {\n      delete sessionStorage[CAMP_COOKIE_NAME]\n      var campTypeObj = {}\n      const campObj = getCampaignObject()\n      if (targetingMsgJson.display.wtarget_type === 3 && campObj.hasOwnProperty('wi')) {\n        campTypeObj = campObj.wi\n      } else if ((targetingMsgJson.display.wtarget_type === 0 || targetingMsgJson.display.wtarget_type === 1) && campObj.hasOwnProperty('wp')) {\n        campTypeObj = campObj.wp\n      } else {\n        campTypeObj = {}\n      }\n      if (campObj.hasOwnProperty('global')) {\n        campTypeObj.wp = campObj\n      }\n      // global session limit. default is 1\n      if (targetingMsgJson[DISPLAY].wmc == null) {\n        targetingMsgJson[DISPLAY].wmc = 1\n      }\n\n      // global session limit for web inbox. default is 1\n      if (targetingMsgJson[DISPLAY].wimc == null) {\n        targetingMsgJson[DISPLAY].wimc = 1\n      }\n\n      var excludeFromFreqCaps = -1 // efc - Exclude from frequency caps\n      let campaignSessionLimit = -1 // mdc - Once per session\n      let campaignDailyLimit = -1 // tdc - Once per day\n      let campaignTotalLimit = -1 // tlc - Once per user for the duration of campaign\n      let totalDailyLimit = -1\n      let totalSessionLimit = -1 // wmc - Web Popup Global Session Limit\n      let totalInboxSessionLimit = -1 // wimc - Web Inbox Global Session Limit\n\n      if (targetingMsgJson[DISPLAY].efc != null) { // exclude from frequency cap\n        excludeFromFreqCaps = parseInt(targetingMsgJson[DISPLAY].efc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].mdc != null) { // Campaign Session Limit\n        campaignSessionLimit = parseInt(targetingMsgJson[DISPLAY].mdc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].tdc != null) { // No of web popups in a day per campaign\n        campaignDailyLimit = parseInt(targetingMsgJson[DISPLAY].tdc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].tlc != null) { // Total lifetime count\n        campaignTotalLimit = parseInt(targetingMsgJson[DISPLAY].tlc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].wmp != null) { // No of campaigns per day\n        totalDailyLimit = parseInt(targetingMsgJson[DISPLAY].wmp, 10)\n      }\n      if (targetingMsgJson[DISPLAY].wmc != null) { // No of campaigns per session\n        totalSessionLimit = parseInt(targetingMsgJson[DISPLAY].wmc, 10)\n      }\n\n      if (targetingMsgJson[DISPLAY].wimc != null) { // No of inbox campaigns per session\n        totalInboxSessionLimit = parseInt(targetingMsgJson[DISPLAY].wimc, 10)\n      }\n      // session level capping\n      var sessionObj = campTypeObj[_session.sessionId]\n      if (sessionObj) {\n        const campaignSessionCount = sessionObj[campaignId]\n        const totalSessionCount = sessionObj.tc\n        // dnd\n        if (campaignSessionCount === 'dnd' && !$ct.dismissSpamControl) {\n          return false\n        }\n\n        if (targetingMsgJson[DISPLAY].wtarget_type === 3) {\n          // Inbox session\n          if (totalInboxSessionLimit > 0 && totalSessionCount >= totalInboxSessionLimit && excludeFromFreqCaps < 0) {\n            return false\n          }\n        } else {\n          // session\n          if (totalSessionLimit > 0 && totalSessionCount >= totalSessionLimit && excludeFromFreqCaps < 0) {\n            return false\n          }\n        }\n\n        // campaign session\n        if (campaignSessionLimit > 0 && campaignSessionCount >= campaignSessionLimit) {\n          return false\n        }\n      } else {\n        sessionObj = {}\n        campTypeObj[_session.sessionId] = sessionObj\n      }\n\n      // daily level capping\n      var dailyObj = campTypeObj[today]\n      if (dailyObj != null) {\n        const campaignDailyCount = dailyObj[campaignId]\n        const totalDailyCount = dailyObj.tc\n        // daily\n        if (totalDailyLimit > 0 && totalDailyCount >= totalDailyLimit && excludeFromFreqCaps < 0) {\n          return false\n        }\n        // campaign daily\n        if (campaignDailyLimit > 0 && campaignDailyCount >= campaignDailyLimit) {\n          return false\n        }\n      } else {\n        dailyObj = {}\n        campTypeObj[today] = dailyObj\n      }\n\n      var globalObj = campTypeObj[GLOBAL]\n      if (globalObj != null) {\n        const campaignTotalCount = globalObj[campaignId]\n        // campaign total\n        if (campaignTotalLimit > 0 && campaignTotalCount >= campaignTotalLimit) {\n          return false\n        }\n      } else {\n        globalObj = {}\n        campTypeObj[GLOBAL] = globalObj\n      }\n    }\n    // delay\n    if (targetingMsgJson[DISPLAY].delay != null && targetingMsgJson[DISPLAY].delay > 0) {\n      const delay = targetingMsgJson[DISPLAY].delay\n      targetingMsgJson[DISPLAY].delay = 0\n      setTimeout(_tr, delay * 1000, msg, {\n        device: _device,\n        session: _session,\n        request: _request,\n        logger: _logger\n      })\n      return false\n    }\n\n    incrCount(sessionObj, campaignId, excludeFromFreqCaps)\n    incrCount(dailyObj, campaignId, excludeFromFreqCaps)\n    incrCount(globalObj, campaignId, excludeFromFreqCaps)\n\n    let campKey = 'wp'\n    if (targetingMsgJson[DISPLAY].wtarget_type === 3) {\n      campKey = 'wi'\n    }\n    // get ride of stale sessions and day entries\n    const newCampObj = {}\n    newCampObj[_session.sessionId] = sessionObj\n    newCampObj[today] = dailyObj\n    newCampObj[GLOBAL] = globalObj\n    saveCampaignObject({ [campKey]: newCampObj })\n  }\n\n  const getCookieParams = () => {\n    const gcookie = _device.getGuid()\n    const scookieObj = _session.getSessionCookieObject()\n    return '&t=wc&d=' + encodeURIComponent(compressToBase64(gcookie + '|' + scookieObj.p + '|' + scookieObj.s))\n  }\n\n  const setupClickEvent = (onClick, targetingMsgJson, contentDiv, divId, isLegacy) => {\n    if (onClick !== '' && onClick != null) {\n      let ctaElement\n      let jsCTAElements\n      if (isLegacy) {\n        ctaElement = contentDiv\n      } else if (contentDiv !== null) {\n        jsCTAElements = contentDiv.getElementsByClassName('jsCT_CTA')\n        if (jsCTAElements != null && jsCTAElements.length === 1) {\n          ctaElement = jsCTAElements[0]\n        }\n      }\n      const jsFunc = targetingMsgJson.display.jsFunc\n      const isPreview = targetingMsgJson.display.preview\n      if (isPreview == null) {\n        onClick += getCookieParams()\n      }\n\n      if (ctaElement != null) {\n        ctaElement.onclick = () => {\n          // invoke js function call\n          if (jsFunc != null) {\n            // track notification clicked event\n            if (isPreview == null) {\n              RequestDispatcher.fireRequest(onClick)\n            }\n            invokeExternalJs(jsFunc, targetingMsgJson)\n            // close iframe. using -1 for no campaignId\n            closeIframe('-1', divId, _session.sessionId)\n            return\n          }\n          // pass on the gcookie|page|scookieId for capturing the click event\n          if (targetingMsgJson.display.window === 1) {\n            window.open(onClick, '_blank')\n          } else {\n            window.location = onClick\n          }\n        }\n      }\n    }\n  }\n\n  const invokeExternalJs = (jsFunc, targetingMsgJson) => {\n    const func = window.parent[jsFunc]\n    if (typeof func === 'function') {\n      if (targetingMsgJson.display.kv != null) {\n        func(targetingMsgJson.display.kv)\n      } else {\n        func()\n      }\n    }\n  }\n\n  const setupClickUrl = (onClick, targetingMsgJson, contentDiv, divId, isLegacy) => {\n    incrementImpression(targetingMsgJson)\n    setupClickEvent(onClick, targetingMsgJson, contentDiv, divId, isLegacy)\n  }\n\n  const incrementImpression = (targetingMsgJson) => {\n    const data = {}\n    data.type = 'event'\n    data.evtName = NOTIFICATION_VIEWED\n    data.evtData = { [WZRK_ID]: targetingMsgJson.wzrk_id }\n    if (targetingMsgJson.wzrk_pivot) {\n      data.evtData = { ...data.evtData, wzrk_pivot: targetingMsgJson.wzrk_pivot }\n    }\n    _request.processEvent(data)\n  }\n\n  const renderPersonalisationBanner = (targetingMsgJson) => {\n    if (customElements.get('ct-web-personalisation-banner') === undefined) {\n      customElements.define('ct-web-personalisation-banner', CTWebPersonalisationBanner)\n    }\n    const divId = targetingMsgJson.display.divId ?? targetingMsgJson.display.divSelector\n    const bannerEl = document.createElement('ct-web-personalisation-banner')\n    bannerEl.msgId = targetingMsgJson.wzrk_id\n    bannerEl.pivotId = targetingMsgJson.wzrk_pivot\n    bannerEl.divHeight = targetingMsgJson.display.divHeight\n    bannerEl.details = targetingMsgJson.display.details[0]\n    const containerEl = targetingMsgJson.display.divId ? document.getElementById(divId) : document.querySelector(divId)\n    containerEl.innerHTML = ''\n    containerEl.appendChild(bannerEl)\n  }\n\n  const renderPersonalisationCarousel = (targetingMsgJson) => {\n    if (customElements.get('ct-web-personalisation-carousel') === undefined) {\n      customElements.define('ct-web-personalisation-carousel', CTWebPersonalisationCarousel)\n    }\n    const divId = targetingMsgJson.display.divId ?? targetingMsgJson.display.divSelector\n    const carousel = document.createElement('ct-web-personalisation-carousel')\n    carousel.target = targetingMsgJson\n    const container = targetingMsgJson.display.divId ? document.getElementById(divId) : document.querySelector(divId)\n    container.innerHTML = ''\n    container.appendChild(carousel)\n  }\n\n  const renderPopUpImageOnly = (targetingMsgJson) => {\n    const divId = 'wzrkImageOnlyDiv'\n    const popupImageOnly = document.createElement('ct-web-popup-imageonly')\n    popupImageOnly.session = _session\n    popupImageOnly.target = targetingMsgJson\n    const containerEl = document.getElementById(divId)\n    containerEl.innerHTML = ''\n    containerEl.style.visibility = 'hidden'\n    containerEl.appendChild(popupImageOnly)\n  }\n\n  const renderFooterNotification = (targetingMsgJson) => {\n    const campaignId = targetingMsgJson.wzrk_id.split('_')[0]\n    const displayObj = targetingMsgJson.display\n\n    if (displayObj.wtarget_type === 2) { // Handling Web Native display\n      // Logic for kv pair data\n      if (targetingMsgJson.msgContent.type === 1) {\n        const inaObj = {}\n\n        inaObj.msgId = targetingMsgJson.wzrk_id\n        if (targetingMsgJson.wzrk_pivot) {\n          inaObj.pivotId = targetingMsgJson.wzrk_pivot\n        }\n        if (targetingMsgJson.msgContent.kv != null) {\n          inaObj.kv = targetingMsgJson.msgContent.kv\n        }\n        const kvPairsEvent = new CustomEvent('CT_web_native_display', { detail: inaObj })\n        document.dispatchEvent(kvPairsEvent)\n        return\n      }\n    }\n    if (displayObj.layout === 1) { // Handling Web Exit Intent\n      return showExitIntent(undefined, targetingMsgJson)\n    }\n    if (displayObj.layout === 3) { // Handling Web Popup Image Only\n      const divId = 'wzrkImageOnlyDiv'\n      if (doCampHouseKeeping(targetingMsgJson) === false) {\n        return\n      }\n      if ($ct.dismissSpamControl && document.getElementById(divId) != null) {\n        const element = document.getElementById(divId)\n        element.remove()\n      }\n      // ImageOnly campaign and Interstitial/Exit Intent shouldn't coexist\n      if (document.getElementById(divId) != null || document.getElementById('intentPreview') != null) {\n        return\n      }\n      const msgDiv = document.createElement('div')\n      msgDiv.id = divId\n      document.body.appendChild(msgDiv)\n      if (customElements.get('ct-web-popup-imageonly') === undefined) {\n        customElements.define('ct-web-popup-imageonly', CTWebPopupImageOnly)\n      }\n      return renderPopUpImageOnly(targetingMsgJson)\n    }\n\n    if (doCampHouseKeeping(targetingMsgJson) === false) {\n      return\n    }\n\n    const divId = 'wizParDiv' + displayObj.layout\n\n    if ($ct.dismissSpamControl && document.getElementById(divId) != null) {\n      const element = document.getElementById(divId)\n      element.remove()\n    }\n    if (document.getElementById(divId) != null) {\n      return\n    }\n\n    $ct.campaignDivMap[campaignId] = divId\n    const isBanner = displayObj.layout === 2\n    const msgDiv = document.createElement('div')\n    msgDiv.id = divId\n    const viewHeight = window.innerHeight\n    const viewWidth = window.innerWidth\n    let legacy = false\n\n    if (!isBanner) {\n      const marginBottom = viewHeight * 5 / 100\n      var contentHeight = 10\n      let right = viewWidth * 5 / 100\n      let bottomPosition = contentHeight + marginBottom\n      let width = viewWidth * 30 / 100 + 20\n      let widthPerct = 'width:30%;'\n      // for small devices  - mobile phones\n      if ((/mobile/i.test(navigator.userAgent) || (/mini/i.test(navigator.userAgent))) && /iPad/i.test(navigator.userAgent) === false) {\n        width = viewWidth * 85 / 100 + 20\n        right = viewWidth * 5 / 100\n        bottomPosition = viewHeight * 5 / 100\n        widthPerct = 'width:80%;'\n        // medium devices - tablets\n      } else if ('ontouchstart' in window || (/tablet/i.test(navigator.userAgent))) {\n        width = viewWidth * 50 / 100 + 20\n        right = viewWidth * 5 / 100\n        bottomPosition = viewHeight * 5 / 100\n        widthPerct = 'width:50%;'\n      }\n      // legacy footer notif\n      if (displayObj.proto == null) {\n        legacy = true\n        msgDiv.setAttribute('style', 'display:block;overflow:hidden; bottom:' + bottomPosition + 'px !important;width:' + width + 'px !important;right:' + right + 'px !important;position:fixed;z-index:2147483647;')\n      } else {\n        msgDiv.setAttribute('style', widthPerct + displayObj.iFrameStyle)\n      }\n    } else {\n      msgDiv.setAttribute('style', displayObj.iFrameStyle)\n    }\n    document.body.appendChild(msgDiv)\n    const iframe = document.createElement('iframe')\n\n    const borderRadius = displayObj.br === false ? '0' : '8'\n\n    iframe.frameborder = '0px'\n    iframe.marginheight = '0px'\n    iframe.marginwidth = '0px'\n    iframe.scrolling = 'no'\n    iframe.id = 'wiz-iframe'\n    const onClick = targetingMsgJson.display.onClick\n    let pointerCss = ''\n    if (onClick !== '' && onClick != null) {\n      pointerCss = 'cursor:pointer;'\n    }\n\n    let html\n    // direct html\n    if (targetingMsgJson.msgContent.type === 1) {\n      html = targetingMsgJson.msgContent.html\n      html = html.replace(/##campaignId##/g, campaignId)\n      html = html.replace(/##campaignId_batchId##/g, targetingMsgJson.wzrk_id)\n    } else {\n      const css = '' +\n        '<style type=\"text/css\">' +\n        'body{margin:0;padding:0;}' +\n        '#contentDiv.wzrk{overflow:hidden;padding:0;text-align:center;' + pointerCss + '}' +\n        '#contentDiv.wzrk td{padding:15px 10px;}' +\n        '.wzrkPPtitle{font-weight: bold;font-size: 16px;font-family:arial;padding-bottom:10px;word-break: break-word;}' +\n        '.wzrkPPdscr{font-size: 14px;font-family:arial;line-height:16px;word-break: break-word;display:inline-block;}' +\n        '.PL15{padding-left:15px;}' +\n        '.wzrkPPwarp{margin:20px 20px 0 5px;padding:0px;border-radius: ' + borderRadius + 'px;box-shadow: 1px 1px 5px #888888;}' +\n        'a.wzrkClose{cursor:pointer;position: absolute;top: 11px;right: 11px;z-index: 2147483647;font-size:19px;font-family:arial;font-weight:bold;text-decoration: none;width: 25px;/*height: 25px;*/text-align: center; -webkit-appearance: none; line-height: 25px;' +\n        'background: #353535;border: #fff 2px solid;border-radius: 100%;box-shadow: #777 2px 2px 2px;color:#fff;}' +\n        'a:hover.wzrkClose{background-color:#d1914a !important;color:#fff !important; -webkit-appearance: none;}' +\n        'td{vertical-align:top;}' +\n        'td.imgTd{border-top-left-radius:8px;border-bottom-left-radius:8px;}' +\n        '</style>'\n\n      let bgColor, textColor, btnBg, leftTd, btColor\n      if (targetingMsgJson.display.theme === 'dark') {\n        bgColor = '#2d2d2e'\n        textColor = '#eaeaea'\n        btnBg = '#353535'\n        leftTd = '#353535'\n        btColor = '#ffffff'\n      } else {\n        bgColor = '#ffffff'\n        textColor = '#000000'\n        leftTd = '#f4f4f4'\n        btnBg = '#a5a6a6'\n        btColor = '#ffffff'\n      }\n      const titleText = targetingMsgJson.msgContent.title\n      const descriptionText = targetingMsgJson.msgContent.description\n      let imageTd = ''\n      if (targetingMsgJson.msgContent.imageUrl != null && targetingMsgJson.msgContent.imageUrl !== '') {\n        imageTd = \"<td class='imgTd' style='background-color:\" + leftTd + \"'><img src='\" + targetingMsgJson.msgContent.imageUrl + \"' height='60' width='60'></td>\"\n      }\n      const onClickStr = 'parent.$WZRK_WR.closeIframe(' + campaignId + \",'\" + divId + \"');\"\n      const title = \"<div class='wzrkPPwarp' style='color:\" + textColor + ';background-color:' + bgColor + \";'>\" +\n        \"<a href='javascript:void(0);' onclick=\" + onClickStr + \" class='wzrkClose' style='background-color:\" + btnBg + ';color:' + btColor + \"'>&times;</a>\" +\n        \"<div id='contentDiv' class='wzrk'>\" +\n        \"<table cellpadding='0' cellspacing='0' border='0'>\" +\n        // \"<tr><td colspan='2'></td></tr>\"+\n        '<tr>' + imageTd + \"<td style='vertical-align:top;'>\" +\n        \"<div class='wzrkPPtitle' style='color:\" + textColor + \"'>\" + titleText + '</div>'\n      const body = \"<div class='wzrkPPdscr' style='color:\" + textColor + \"'>\" + descriptionText + '<div></td></tr></table></div>'\n      html = css + title + body\n    }\n\n    iframe.setAttribute('style', 'z-index: 2147483647; display:block; width: 100% !important; border:0px !important; border-color:none !important;')\n    msgDiv.appendChild(iframe)\n    const ifrm = (iframe.contentWindow) ? iframe.contentWindow : (iframe.contentDocument.document) ? iframe.contentDocument.document : iframe.contentDocument\n    const doc = ifrm.document\n\n    // Dispatch event for popup box/banner close\n    const closeCampaign = new Event('CT_campaign_rendered')\n    document.dispatchEvent(closeCampaign)\n\n    doc.open()\n    doc.write(html)\n\n    if (displayObj['custom-editor']) {\n      appendScriptForCustomEvent(targetingMsgJson, doc)\n    }\n    doc.close()\n\n    const adjustIFrameHeight = () => {\n      // adjust iframe and body height of html inside correctly\n      contentHeight = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv').scrollHeight\n      if (displayObj['custom-editor'] !== true && !isBanner) {\n        contentHeight += 25\n      }\n      document.getElementById('wiz-iframe').contentDocument.body.style.margin = '0px'\n      document.getElementById('wiz-iframe').style.height = contentHeight + 'px'\n    }\n\n    const ua = navigator.userAgent.toLowerCase()\n    if (ua.indexOf('safari') !== -1) {\n      if (ua.indexOf('chrome') > -1) {\n        iframe.onload = () => {\n          adjustIFrameHeight()\n          const contentDiv = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv')\n          setupClickUrl(onClick, targetingMsgJson, contentDiv, divId, legacy)\n        }\n      } else {\n        let inDoc = iframe.contentDocument || iframe.contentWindow\n        if (inDoc.document) inDoc = inDoc.document\n        // safari iphone 7+ needs this.\n        adjustIFrameHeight()\n        const _timer = setInterval(() => {\n          if (inDoc.readyState === 'complete') {\n            clearInterval(_timer)\n            // adjust iframe and body height of html inside correctly\n            adjustIFrameHeight()\n            const contentDiv = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv')\n            setupClickUrl(onClick, targetingMsgJson, contentDiv, divId, legacy)\n          }\n        }, 10)\n      }\n    } else {\n      iframe.onload = () => {\n        // adjust iframe and body height of html inside correctly\n        adjustIFrameHeight()\n        const contentDiv = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv')\n        setupClickUrl(onClick, targetingMsgJson, contentDiv, divId, legacy)\n      }\n    }\n  }\n\n  const appendScriptForCustomEvent = (targetingMsgJson, doc) => {\n    const script = doc.createElement('script')\n    script.innerHTML = `\n      const ct__camapignId = '${targetingMsgJson.wzrk_id}';\n      const ct__formatVal = (v) => {\n          return v && v.trim().substring(0, 20);\n      }\n      const ct__parentOrigin =  window.parent.origin;\n      document.body.addEventListener('click', (event) => {\n        const elem = event.target.closest?.('a[wzrk_c2a], button[wzrk_c2a]');\n        if (elem) {\n            const {innerText, id, name, value, href} = elem;\n            const clickAttr = elem.getAttribute('onclick') || elem.getAttribute('click');\n            const onclickURL = clickAttr?.match(/(window.open)[(\\](\\\"|')(.*)(\\\"|',)/)?.[3] || clickAttr?.match(/(location.href *= *)(\\\"|')(.*)(\\\"|')/)?.[3];\n            const props = {innerText, id, name, value};\n            let msgCTkv = Object.keys(props).reduce((acc, c) => {\n                const formattedVal = ct__formatVal(props[c]);\n                formattedVal && (acc['wzrk_click_' + c] = formattedVal);\n                return acc;\n            }, {});\n            if(onclickURL) { msgCTkv['wzrk_click_' + 'url'] = onclickURL; }\n            if(href) { msgCTkv['wzrk_click_' + 'c2a'] = href; }\n            const notifData = { msgId: ct__camapignId, msgCTkv, pivotId: '${targetingMsgJson.wzrk_pivot}' };\n            window.parent.clevertap.renderNotificationClicked(notifData);\n        }\n      });\n    `\n    doc.body.appendChild(script)\n  }\n\n  let _callBackCalled = false\n\n  const showFooterNotification = (targetingMsgJson) => {\n    let onClick = targetingMsgJson.display.onClick\n\n    // TODO: Needs wizrocket as a global variable\n    if (window.clevertap.hasOwnProperty('notificationCallback') &&\n      typeof window.clevertap.notificationCallback !== 'undefined' &&\n      typeof window.clevertap.notificationCallback === 'function') {\n      const notificationCallback = window.clevertap.notificationCallback\n\n      if (!_callBackCalled) {\n        const inaObj = {}\n        inaObj.msgContent = targetingMsgJson.msgContent\n        inaObj.msgId = targetingMsgJson.wzrk_id\n        if (targetingMsgJson.wzrk_pivot) {\n          inaObj.pivotId = targetingMsgJson.wzrk_pivot\n        }\n        if (targetingMsgJson.display.kv != null) {\n          inaObj.kv = targetingMsgJson.display.kv\n        }\n\n        window.clevertap.raiseNotificationClicked = () => {\n          if (onClick !== '' && onClick != null) {\n            const jsFunc = targetingMsgJson.display.jsFunc\n            onClick += getCookieParams()\n\n            // invoke js function call\n            if (jsFunc != null) {\n              // track notification clicked event\n              RequestDispatcher.fireRequest(onClick)\n              invokeExternalJs(jsFunc, targetingMsgJson)\n              return\n            }\n            // pass on the gcookie|page|scookieId for capturing the click event\n            if (targetingMsgJson.display.window === 1) {\n              window.open(onClick, '_blank')\n            } else {\n              window.location = onClick\n            }\n          }\n        }\n        window.clevertap.raiseNotificationViewed = () => {\n          incrementImpression(targetingMsgJson)\n        }\n        notificationCallback(inaObj)\n        _callBackCalled = true\n      }\n    } else {\n      window.clevertap.popupCurrentWzrkId = targetingMsgJson.wzrk_id\n      renderFooterNotification(targetingMsgJson)\n\n      if (window.clevertap.hasOwnProperty('popupCallbacks') &&\n        typeof window.clevertap.popupCallbacks !== 'undefined' &&\n        typeof window.clevertap.popupCallbacks[targetingMsgJson.wzrk_id] === 'function') {\n        const popupCallback = window.clevertap.popupCallbacks[targetingMsgJson.wzrk_id]\n\n        const inaObj = {}\n        inaObj.msgContent = targetingMsgJson.msgContent\n        inaObj.msgId = targetingMsgJson.wzrk_id\n\n        if (targetingMsgJson.wzrk_pivot) {\n          inaObj.pivotId = targetingMsgJson.wzrk_pivot\n        }\n\n        var msgCTkv = []\n        for (var wzrkPrefixKey in targetingMsgJson) {\n          // ADD WZRK PREFIX KEY VALUE PAIRS\n          if (wzrkPrefixKey.startsWith(WZRK_PREFIX) && wzrkPrefixKey !== WZRK_ID) {\n            const wzrkJson = { [wzrkPrefixKey]: targetingMsgJson[wzrkPrefixKey] }\n            msgCTkv.push(wzrkJson)\n          }\n        }\n\n        if (msgCTkv.length > 0) {\n          inaObj.msgCTkv = msgCTkv\n        }\n        if (targetingMsgJson.display.kv != null) {\n          inaObj.kv = targetingMsgJson.display.kv\n        }\n\n        // PUBLIC API TO RECORD CLICKED EVENT\n        window.clevertap.raisePopupNotificationClicked = (notificationData) => {\n          if (!notificationData || !notificationData.msgId) { return }\n\n          const eventData = {}\n          eventData.type = 'event'\n          eventData.evtName = NOTIFICATION_CLICKED\n          eventData.evtData = { [WZRK_ID]: notificationData.msgId }\n          if (targetingMsgJson.wzrk_pivot) {\n            eventData.evtData = { ...eventData.evtData, wzrk_pivot: notificationData.pivotId }\n          }\n\n          // WZRK PREFIX KEY VALUE PAIRS\n          if (notificationData.msgCTkv) {\n            for (var wzrkPrefixObj of notificationData.msgCTkv) {\n              eventData.evtData = { ...eventData.evtData, ...wzrkPrefixObj }\n            }\n          }\n\n          _request.processEvent(eventData)\n        }\n        popupCallback(inaObj)\n      }\n    }\n  }\n\n  let exitintentObj\n  const showExitIntent = (event, targetObj) => {\n    let targetingMsgJson\n    if (event != null && event.clientY > 0) {\n      return\n    }\n    if (targetObj == null) {\n      targetingMsgJson = exitintentObj\n    } else {\n      targetingMsgJson = targetObj\n    }\n\n    if ($ct.dismissSpamControl && targetingMsgJson.display.wtarget_type === 0 && document.getElementById('intentPreview') != null && document.getElementById('intentOpacityDiv') != null) {\n      const element = document.getElementById('intentPreview')\n      element.remove()\n      document.getElementById('intentOpacityDiv').remove()\n    }\n    // ImageOnly campaign and Interstitial/Exit Intent shouldn't coexist\n    if (document.getElementById('intentPreview') != null || document.getElementById('wzrkImageOnlyDiv') != null) {\n      return\n    }\n    // dont show exit intent on tablet/mobile - only on desktop\n    if (targetingMsgJson.display.layout == null &&\n      ((/mobile/i.test(navigator.userAgent)) || (/mini/i.test(navigator.userAgent)) || (/iPad/i.test(navigator.userAgent)) ||\n        ('ontouchstart' in window) || (/tablet/i.test(navigator.userAgent)))) {\n      return\n    }\n\n    if (doCampHouseKeeping(targetingMsgJson) === false) {\n      return\n    }\n\n    const campaignId = targetingMsgJson.wzrk_id.split('_')[0]\n    $ct.campaignDivMap[campaignId] = 'intentPreview'\n    let legacy = false\n    const opacityDiv = document.createElement('div')\n    opacityDiv.id = 'intentOpacityDiv'\n    const opacity = targetingMsgJson.display.opacity || 0.7\n    const rgbaColor = `rgba(0,0,0,${opacity})`\n    opacityDiv.setAttribute('style', `position: fixed;top: 0;bottom: 0;left: 0;width: 100%;height: 100%;z-index: 2147483646;background: ${rgbaColor};`)\n    document.body.appendChild(opacityDiv)\n\n    const msgDiv = document.createElement('div')\n    msgDiv.id = 'intentPreview'\n\n    if (targetingMsgJson.display.proto == null) {\n      legacy = true\n      msgDiv.setAttribute('style', 'display:block;overflow:hidden;top:55% !important;left:50% !important;position:fixed;z-index:2147483647;width:600px !important;height:600px !important;margin:-300px 0 0 -300px !important;')\n    } else {\n      msgDiv.setAttribute('style', targetingMsgJson.display.iFrameStyle)\n    }\n    document.body.appendChild(msgDiv)\n    const iframe = document.createElement('iframe')\n    const borderRadius = targetingMsgJson.display.br === false ? '0' : '8'\n    iframe.frameborder = '0px'\n    iframe.marginheight = '0px'\n    iframe.marginwidth = '0px'\n    iframe.scrolling = 'no'\n    iframe.id = 'wiz-iframe-intent'\n    const onClick = targetingMsgJson.display.onClick\n    let pointerCss = ''\n    if (onClick !== '' && onClick != null) {\n      pointerCss = 'cursor:pointer;'\n    }\n    let html\n    // direct html\n    if (targetingMsgJson.msgContent.type === 1) {\n      html = targetingMsgJson.msgContent.html\n      html = html.replace(/##campaignId##/g, campaignId)\n      html = html.replace(/##campaignId_batchId##/g, targetingMsgJson.wzrk_id)\n    } else {\n      const css = '' +\n        '<style type=\"text/css\">' +\n        'body{margin:0;padding:0;}' +\n        '#contentDiv.wzrk{overflow:hidden;padding:0 0 20px 0;text-align:center;' + pointerCss + '}' +\n        '#contentDiv.wzrk td{padding:15px 10px;}' +\n        '.wzrkPPtitle{font-weight: bold;font-size: 24px;font-family:arial;word-break: break-word;padding-top:20px;}' +\n        '.wzrkPPdscr{font-size: 14px;font-family:arial;line-height:16px;word-break: break-word;display:inline-block;padding:20px 20px 0 20px;line-height:20px;}' +\n        '.PL15{padding-left:15px;}' +\n        '.wzrkPPwarp{margin:20px 20px 0 5px;padding:0px;border-radius: ' + borderRadius + 'px;box-shadow: 1px 1px 5px #888888;}' +\n        'a.wzrkClose{cursor:pointer;position: absolute;top: 11px;right: 11px;z-index: 2147483647;font-size:19px;font-family:arial;font-weight:bold;text-decoration: none;width: 25px;/*height: 25px;*/text-align: center; -webkit-appearance: none; line-height: 25px;' +\n        'background: #353535;border: #fff 2px solid;border-radius: 100%;box-shadow: #777 2px 2px 2px;color:#fff;}' +\n        'a:hover.wzrkClose{background-color:#d1914a !important;color:#fff !important; -webkit-appearance: none;}' +\n        '#contentDiv .button{padding-top:20px;}' +\n        '#contentDiv .button a{font-size: 14px;font-weight:bold;font-family:arial;text-align:center;display:inline-block;text-decoration:none;padding:0 30px;height:40px;line-height:40px;background:#ea693b;color:#fff;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;}' +\n        '</style>'\n\n      let bgColor, textColor, btnBg, btColor\n      if (targetingMsgJson.display.theme === 'dark') {\n        bgColor = '#2d2d2e'\n        textColor = '#eaeaea'\n        btnBg = '#353535'\n        btColor = '#ffffff'\n      } else {\n        bgColor = '#ffffff'\n        textColor = '#000000'\n        btnBg = '#a5a6a6'\n        btColor = '#ffffff'\n      }\n      const titleText = targetingMsgJson.msgContent.title\n      const descriptionText = targetingMsgJson.msgContent.description\n      let ctaText = ''\n      if (targetingMsgJson.msgContent.ctaText != null && targetingMsgJson.msgContent.ctaText !== '') {\n        ctaText = \"<div class='button'><a href='#'>\" + targetingMsgJson.msgContent.ctaText + '</a></div>'\n      }\n\n      let imageTd = ''\n      if (targetingMsgJson.msgContent.imageUrl != null && targetingMsgJson.msgContent.imageUrl !== '') {\n        imageTd = \"<div style='padding-top:20px;'><img src='\" + targetingMsgJson.msgContent.imageUrl + \"' width='500' alt=\" + titleText + ' /></div>'\n      }\n      const onClickStr = 'parent.$WZRK_WR.closeIframe(' + campaignId + \",'intentPreview');\"\n      const title = \"<div class='wzrkPPwarp' style='color:\" + textColor + ';background-color:' + bgColor + \";'>\" +\n        \"<a href='javascript:void(0);' onclick=\" + onClickStr + \" class='wzrkClose' style='background-color:\" + btnBg + ';color:' + btColor + \"'>&times;</a>\" +\n        \"<div id='contentDiv' class='wzrk'>\" +\n        \"<div class='wzrkPPtitle' style='color:\" + textColor + \"'>\" + titleText + '</div>'\n      const body = \"<div class='wzrkPPdscr' style='color:\" + textColor + \"'>\" + descriptionText + '</div>' + imageTd + ctaText +\n        '</div></div>'\n      html = css + title + body\n    }\n    iframe.setAttribute('style', 'z-index: 2147483647; display:block; height: 100% !important; width: 100% !important;min-height:80px !important;border:0px !important; border-color:none !important;')\n    msgDiv.appendChild(iframe)\n    const ifrm = (iframe.contentWindow) ? iframe.contentWindow : (iframe.contentDocument.document) ? iframe.contentDocument.document : iframe.contentDocument\n    const doc = ifrm.document\n\n    // Dispatch event for interstitial/exit intent close\n    const closeCampaign = new Event('CT_campaign_rendered')\n    document.dispatchEvent(closeCampaign)\n\n    doc.open()\n    doc.write(html)\n    if (targetingMsgJson.display['custom-editor']) {\n      appendScriptForCustomEvent(targetingMsgJson, doc)\n    }\n    doc.close()\n\n    const contentDiv = document.getElementById('wiz-iframe-intent').contentDocument.getElementById('contentDiv')\n    setupClickUrl(onClick, targetingMsgJson, contentDiv, 'intentPreview', legacy)\n  }\n\n  if (!document.body) {\n    if (_wizCounter < 6) {\n      _wizCounter++\n      setTimeout(_tr, 1000, msg, {\n        device: _device,\n        session: _session,\n        request: _request,\n        logger: _logger\n      })\n    }\n    return\n  }\n  const processNativeDisplayArr = (arrInAppNotifs) => {\n    Object.keys(arrInAppNotifs).map(key => {\n      var elementId, id\n      if (arrInAppNotifs[key].display.divId) {\n        elementId = arrInAppNotifs[key].display.divId\n        id = document.getElementById(elementId)\n      } else {\n        elementId = arrInAppNotifs[key].display.divSelector\n        id = document.querySelector(elementId)\n      }\n      if (id !== null) {\n        arrInAppNotifs[key].msgContent.type === 2 ? renderPersonalisationBanner(arrInAppNotifs[key]) : renderPersonalisationCarousel(arrInAppNotifs[key])\n        delete arrInAppNotifs[key]\n      }\n    })\n  }\n\n  const addLoadListener = (arrInAppNotifs) => {\n    window.addEventListener('load', () => {\n      let count = 0\n      if (count < 20) {\n        const t = setInterval(() => {\n          processNativeDisplayArr(arrInAppNotifs)\n          if (Object.keys(arrInAppNotifs).length === 0 || count === 20) {\n            clearInterval(t)\n            arrInAppNotifs = {}\n          }\n          count++\n        }, 500)\n      }\n    })\n  }\n\n  if (msg.inapp_notifs != null) {\n    const arrInAppNotifs = {}\n    for (let index = 0; index < msg.inapp_notifs.length; index++) {\n      const targetNotif = msg.inapp_notifs[index]\n      if (targetNotif.display.wtarget_type == null || targetNotif.display.wtarget_type === 0) {\n        showFooterNotification(targetNotif)\n      } else if (targetNotif.display.wtarget_type === 1) { // if display['wtarget_type']==1 then exit intent\n        exitintentObj = targetNotif\n        window.document.body.onmouseleave = showExitIntent\n      } else if (targetNotif.display.wtarget_type === 2) { // if display['wtarget_type']==2 then web native display\n        if (targetNotif.msgContent.type === 2 || targetNotif.msgContent.type === 3) { // Check for banner and carousel\n          const element = targetNotif.display.divId ? document.getElementById(targetNotif.display.divId) : document.querySelector(targetNotif.display.divSelector)\n          if (element !== null) {\n            targetNotif.msgContent.type === 2 ? renderPersonalisationBanner(targetNotif) : renderPersonalisationCarousel(targetNotif)\n          } else {\n            arrInAppNotifs[targetNotif.wzrk_id.split('_')[0]] = targetNotif // Add targetNotif to object\n          }\n        } else {\n          showFooterNotification(targetNotif)\n        }\n      }\n    }\n    // Process banner or carousel campaign array\n    if (Object.keys(arrInAppNotifs).length) {\n      if (document.readyState === 'complete') {\n        processNativeDisplayArr(arrInAppNotifs)\n      } else {\n        addLoadListener(arrInAppNotifs)\n      }\n    }\n  }\n\n  const mergeEventMap = (newEvtMap) => {\n    if ($ct.globalEventsMap == null) {\n      $ct.globalEventsMap = StorageManager.readFromLSorCookie(EV_COOKIE)\n      if ($ct.globalEventsMap == null) {\n        $ct.globalEventsMap = newEvtMap\n        return\n      }\n    }\n    for (const key in newEvtMap) {\n      if (newEvtMap.hasOwnProperty(key)) {\n        const oldEvtObj = $ct.globalEventsMap[key]\n        const newEvtObj = newEvtMap[key]\n        if ($ct.globalEventsMap[key] != null) {\n          if (newEvtObj[0] != null && newEvtObj[0] > oldEvtObj[0]) {\n            $ct.globalEventsMap[key] = newEvtObj\n          }\n        } else {\n          $ct.globalEventsMap[key] = newEvtObj\n        }\n      }\n    }\n  }\n\n  const handleInboxNotifications = () => {\n    if (msg.inbox_preview) {\n      processInboxNotifs(msg)\n      return\n    }\n    if (msg.inbox_notifs) {\n      const msgArr = []\n      for (let index = 0; index < msg.inbox_notifs.length; index++) {\n        if (doCampHouseKeeping(msg.inbox_notifs[index]) !== false) {\n          msgArr.push(msg.inbox_notifs[index])\n        }\n      }\n      processInboxNotifs(msgArr)\n    }\n  }\n\n  if (msg.webInboxSetting || msg.inbox_notifs != null) {\n    /**\n     * When the user visits a website for the 1st time after web inbox channel is setup,\n     * we need to initialise the inbox here because the initializeWebInbox method within init will not be executed\n     * as we would not have any entry related to webInboxSettings in the LS\n     */\n\n    if (hasWebInboxSettingsInLS()) {\n      checkAndRegisterWebInboxElements()\n    }\n    if ($ct.inbox === null) {\n      msg.webInboxSetting && processWebInboxSettings(msg.webInboxSetting)\n      initializeWebInbox(_logger)\n        .then(() => {\n          handleInboxNotifications()\n        })\n        .catch(e => {})\n    } else {\n      handleInboxNotifications()\n    }\n  }\n\n  if (msg.vars) {\n    $ct.variableStore.mergeVariables(msg.vars)\n    return\n  }\n\n  const staleDataUpdate = (staledata, campType) => {\n    const campObj = getCampaignObject()\n    const globalObj = campObj[campType].global\n    if (globalObj != null && campType) {\n      for (const idx in staledata) {\n        if (staledata.hasOwnProperty(idx)) {\n          delete globalObj[staledata[idx]]\n          if (StorageManager.read(CAMP_COOKIE_G)) {\n            const guidCampObj = JSON.parse(decodeURIComponent(StorageManager.read(CAMP_COOKIE_G)))\n            const guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n            if (guidCampObj[guid] && guidCampObj[guid][campType] && guidCampObj[guid][campType][staledata[idx]]) {\n              delete guidCampObj[guid][campType][staledata[idx]]\n              StorageManager.save(CAMP_COOKIE_G, encodeURIComponent(JSON.stringify(guidCampObj)))\n            }\n          }\n        }\n      }\n    }\n    saveCampaignObject(campObj)\n  }\n\n  if (StorageManager._isLocalStorageSupported()) {\n    try {\n      if (msg.evpr != null) {\n        const eventsMap = msg.evpr.events\n        const profileMap = msg.evpr.profile\n        const syncExpiry = msg.evpr.expires_in\n        const now = getNow()\n        StorageManager.setMetaProp('lsTime', now)\n        StorageManager.setMetaProp('exTs', syncExpiry)\n        mergeEventMap(eventsMap)\n        StorageManager.saveToLSorCookie(EV_COOKIE, $ct.globalEventsMap)\n        if ($ct.globalProfileMap == null) {\n          addToLocalProfileMap(profileMap, true)\n        } else {\n          addToLocalProfileMap(profileMap, false)\n        }\n      }\n      if (msg.arp != null) {\n        arp(msg.arp)\n      }\n      if (msg.inapp_stale != null && msg.inapp_stale.length > 0) {\n        // web popup stale\n        staleDataUpdate(msg.inapp_stale, 'wp')\n      }\n      if (msg.inbox_stale != null && msg.inbox_stale.length > 0) {\n        // web inbox stale\n        staleDataUpdate(msg.inbox_stale, 'wi')\n      }\n    } catch (e) {\n      _logger.error('Unable to persist evrp/arp: ' + e)\n    }\n  }\n}\n\nexport default _tr\n","import {\n  StorageManager\n} from '../util/storage'\nexport default class User {\n  #isPersonalisationActive\n\n  constructor ({\n    isPersonalisationActive\n  }) {\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  getTotalVisits () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    let visitCount = StorageManager.getMetaProp('sc')\n    if (visitCount == null) {\n      visitCount = 1\n    }\n    return visitCount\n  }\n\n  getLastVisit () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    const prevSession = StorageManager.getMetaProp('ps')\n    if (prevSession != null) {\n      return new Date(prevSession * 1000)\n    }\n  }\n}\n","import {\n  CLEVERTAP_ERROR_PREFIX\n} from '../util/messages'\n\nexport const logLevels = {\n  DISABLE: 0,\n  ERROR: 1,\n  INFO: 2,\n  DEBUG: 3,\n  DEBUG_PE: 4\n}\n\nexport class Logger {\n  #logLevel\n  wzrkError = {}\n  constructor (logLevel) {\n    this.#logLevel = logLevel == null ? logLevel : logLevels.INFO\n    this.wzrkError = {}\n  }\n\n  get logLevel () {\n    return this.#logLevel\n  }\n\n  set logLevel (logLevel) {\n    this.#logLevel = logLevel\n  }\n\n  error (message) {\n    if (this.#logLevel >= logLevels.ERROR) {\n      this.#log('error', message)\n    }\n  }\n\n  info (message) {\n    if (this.#logLevel >= logLevels.INFO) {\n      this.#log('log', message)\n    }\n  }\n\n  debug (message) {\n    if (this.#logLevel >= logLevels.DEBUG || this.#isLegacyDebug) {\n      this.#log('debug', message)\n    }\n  }\n\n  debugPE (message) {\n    if (this.#logLevel >= logLevels.DEBUG_PE) {\n      this.#log('debug_pe', message)\n    }\n  }\n\n  reportError (code, description) {\n    this.wzrkError.c = code\n    this.wzrkError.d = description\n    this.error(`${CLEVERTAP_ERROR_PREFIX} ${code}: ${description}`)\n  }\n\n  #log (level, message) {\n    if (window.console) {\n      try {\n        const ts = new Date().getTime()\n        console[level](`CleverTap [${ts}]: ${message}`)\n      } catch (e) {}\n    }\n  }\n\n  get #isLegacyDebug () {\n    return (typeof sessionStorage !== 'undefined' && sessionStorage.WZRK_D === '')\n  }\n}\n\nexport default {\n  Logger,\n  logLevels\n}\n","import { singleQuoteRegex, SCOOKIE_EXP_TIME_IN_SECS } from '../util/constants'\nimport { isObject } from '../util/datatypes'\nimport { getNow } from '../util/datetime'\nimport { StorageManager } from '../util/storage'\nimport { getHostName } from '../util/url'\n\nexport default class SessionManager {\n  #logger\n  #sessionId\n  #isPersonalisationActive\n  cookieName // SCOOKIE_NAME\n  scookieObj\n\n  constructor ({\n    logger,\n    isPersonalisationActive\n  }) {\n    this.sessionId = StorageManager.getMetaProp('cs')\n    this.#logger = logger\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  get sessionId () {\n    return this.#sessionId\n  }\n\n  set sessionId (sessionId) {\n    this.#sessionId = sessionId\n  }\n\n  getSessionCookieObject () {\n    let scookieStr = StorageManager.readCookie(this.cookieName)\n    let obj = {}\n\n    if (scookieStr != null) {\n      // converting back single quotes to double for JSON parsing - http://www.iandevlin.com/blog/2012/04/html5/cookies-json-localstorage-and-opera\n      scookieStr = scookieStr.replace(singleQuoteRegex, '\"')\n\n      obj = JSON.parse(scookieStr)\n      if (!isObject(obj)) {\n        obj = {}\n      } else {\n        if (typeof obj.t !== 'undefined') { // check time elapsed since last request\n          const lastTime = obj.t\n          const now = getNow()\n          if ((now - lastTime) > (SCOOKIE_EXP_TIME_IN_SECS + 60)) {\n            // adding 60 seconds to compensate for in-journey requests\n            // ideally the cookie should've died after SCOOKIE_EXP_TIME_IN_SECS but it's still around as we can read\n            // hence we shouldn't use it.\n            obj = {}\n          }\n        }\n      }\n    }\n    this.scookieObj = obj\n    return obj\n  }\n\n  setSessionCookieObject (obj) {\n    const objStr = JSON.stringify(obj)\n    StorageManager.createBroadCookie(this.cookieName, objStr, SCOOKIE_EXP_TIME_IN_SECS, getHostName())\n  }\n\n  manageSession (session) {\n    // first time. check if current session id in localstorage is same\n    // if not same then prev = current and current = this new session\n    if (typeof this.sessionId === 'undefined' || this.sessionId !== session) {\n      const currentSessionInLS = StorageManager.getMetaProp('cs')\n      // if sessionId in meta is undefined - set current to both\n      if (typeof currentSessionInLS === 'undefined') {\n        StorageManager.setMetaProp('ps', session)\n        StorageManager.setMetaProp('cs', session)\n        StorageManager.setMetaProp('sc', 1)\n      } else if (currentSessionInLS !== session) {\n        // not same as session in local storage. new session\n        StorageManager.setMetaProp('ps', currentSessionInLS)\n        StorageManager.setMetaProp('cs', session)\n        let sessionCount = StorageManager.getMetaProp('sc')\n        if (typeof sessionCount === 'undefined') {\n          sessionCount = 0\n        }\n        StorageManager.setMetaProp('sc', sessionCount + 1)\n      }\n      this.sessionId = session\n    }\n  }\n\n  getTimeElapsed () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    if (this.scookieObj != null) { // TODO: check logic?\n      this.scookieObj = this.getSessionCookieObject()\n    }\n    const sessionStart = this.scookieObj.s\n    if (sessionStart != null) {\n      const ts = getNow()\n      return Math.floor(ts - sessionStart)\n    }\n  }\n\n  getPageCount () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n\n    if (this.scookieObj != null) { // TODO: check logic\n      this.scookieObj = this.getSessionCookieObject()\n    }\n    return this.scookieObj.p\n  }\n}\n","import { CAMP_COOKIE_NAME, CLEAR, EVT_PUSH, EV_COOKIE, FIRE_PUSH_UNREGISTERED, LCOOKIE_NAME, PUSH_SUBSCRIPTION_DATA, WEBPUSH_LS_KEY } from '../util/constants'\nimport { isObjectEmpty, isValueValid, removeUnsupportedChars } from '../util/datatypes'\nimport { getNow } from '../util/datetime'\nimport { compressData } from '../util/encoder'\nimport RequestDispatcher from '../util/requestDispatcher'\nimport { StorageManager, $ct } from '../util/storage'\nimport { addToURL } from '../util/url'\nimport { getCampaignObjForLc } from '../util/clevertap'\n\nlet seqNo = 0\nlet requestTime = 0\n\nexport default class RequestManager {\n  #logger\n  #account\n  #device\n  #session\n  #isPersonalisationActive\n  #clearCookie = false\n  processingBackup = false\n\n  constructor ({ logger, account, device, session, isPersonalisationActive }) {\n    this.#logger = logger\n    this.#account = account\n    this.#device = device\n    this.#session = session\n    this.#isPersonalisationActive = isPersonalisationActive\n\n    RequestDispatcher.logger = logger\n    RequestDispatcher.device = device\n    RequestDispatcher.account = account\n  }\n\n  processBackupEvents () {\n    const backupMap = StorageManager.readFromLSorCookie(LCOOKIE_NAME)\n    if (typeof backupMap === 'undefined' || backupMap === null) {\n      return\n    }\n    this.processingBackup = true\n    for (const idx in backupMap) {\n      if (backupMap.hasOwnProperty(idx)) {\n        const backupEvent = backupMap[idx]\n        if (typeof backupEvent.fired === 'undefined') {\n          this.#logger.debug('Processing backup event : ' + backupEvent.q)\n          if (typeof backupEvent.q !== 'undefined') {\n            RequestDispatcher.fireRequest(backupEvent.q)\n          }\n          backupEvent.fired = true\n        }\n      }\n    }\n    StorageManager.saveToLSorCookie(LCOOKIE_NAME, backupMap)\n    this.processingBackup = false\n  }\n\n  addSystemDataToObject (dataObject, ignoreTrim) {\n    // ignore trim for chrome notifications; undefined everywhere else\n    if (typeof ignoreTrim === 'undefined') {\n      dataObject = removeUnsupportedChars(dataObject, this.#logger)\n    }\n\n    if (!isObjectEmpty(this.#logger.wzrkError)) {\n      dataObject.wzrk_error = this.#logger.wzrkError\n      this.#logger.wzrkError = {}\n    }\n\n    dataObject.id = this.#account.id\n\n    if (isValueValid(this.#device.gcookie)) {\n      dataObject.g = this.#device.gcookie\n    }\n\n    const obj = this.#session.getSessionCookieObject()\n    dataObject.s = obj.s // session cookie\n    dataObject.pg = (typeof obj.p === 'undefined') ? 1 : obj.p // Page count\n    let proto = document.location.protocol\n    proto = proto.replace(':', '')\n    dataObject.af = { lib: 'web-sdk-v$$PACKAGE_VERSION$$', protocol: proto, ...$ct.flutterVersion } // app fields\n    if (sessionStorage.hasOwnProperty('WZRK_D')) { dataObject.debug = true }\n\n    return dataObject\n  }\n\n  addFlags (data) {\n    // check if cookie should be cleared.\n    this.#clearCookie = StorageManager.getAndClearMetaProp(CLEAR)\n    if (this.#clearCookie !== undefined && this.#clearCookie) {\n      data.rc = true\n      this.#logger.debug('reset cookie sent in request and cleared from meta for future requests.')\n    }\n    if (this.#isPersonalisationActive()) {\n      const lastSyncTime = StorageManager.getMetaProp('lsTime')\n      const expirySeconds = StorageManager.getMetaProp('exTs')\n\n      // dsync not found in local storage - get data from server\n      if (typeof lastSyncTime === 'undefined' || typeof expirySeconds === 'undefined') {\n        data.dsync = true\n        return\n      }\n      const now = getNow()\n      // last sync time has expired - get fresh data from server\n      if (lastSyncTime + expirySeconds < now) {\n        data.dsync = true\n      }\n    }\n  }\n\n  // saves url to backup cache and fires the request\n  /**\n   *\n   * @param {string} url\n   * @param {boolean} override whether the request can go through or not\n   * @param {Boolean} sendOULFlag - true in case of a On User Login request\n   */\n  saveAndFireRequest (url, override, sendOULFlag, evtName) {\n    const now = getNow()\n    url = addToURL(url, 'rn', ++$ct.globalCache.REQ_N)\n    const data = url + '&i=' + now + '&sn=' + seqNo\n    StorageManager.backupEvent(data, $ct.globalCache.REQ_N, this.#logger)\n\n    // if offline is set to true, save the request in backup and return\n    if ($ct.offline) return\n    // if there is no override\n    // and an OUL request is not in progress\n    // then process the request as it is\n    // else block the request\n    // note - $ct.blockRequest should ideally be used for override\n    if ((!override || (this.#clearCookie !== undefined && this.#clearCookie)) && !window.isOULInProgress) {\n      if (now === requestTime) {\n        seqNo++\n      } else {\n        requestTime = now\n        seqNo = 0\n      }\n      window.oulReqN = $ct.globalCache.REQ_N\n      RequestDispatcher.fireRequest(data, false, sendOULFlag, evtName)\n    } else {\n      this.#logger.debug(`Not fired due to override - ${$ct.blockRequest} or clearCookie - ${this.#clearCookie} or OUL request in progress - ${window.isOULInProgress}`)\n    }\n  }\n\n  unregisterTokenForGuid (givenGUID) {\n    const payload = StorageManager.readFromLSorCookie(PUSH_SUBSCRIPTION_DATA)\n    // Send unregister event only when token is available\n    if (payload) {\n      const data = {}\n      data.type = 'data'\n      if (isValueValid(givenGUID)) {\n        data.g = givenGUID\n      }\n      data.action = 'unregister'\n      data.id = this.#account.id\n\n      const obj = this.#session.getSessionCookieObject()\n\n      data.s = obj.s // session cookie\n      const compressedData = compressData(JSON.stringify(data), this.#logger)\n\n      let pageLoadUrl = this.#account.dataPostURL\n      pageLoadUrl = addToURL(pageLoadUrl, 'type', 'data')\n      pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n      RequestDispatcher.fireRequest(pageLoadUrl, true)\n      StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, false)\n    }\n    // REGISTER TOKEN\n    this.registerToken(payload)\n  }\n\n  registerToken (payload) {\n    if (!payload) return\n    // add gcookie etc to the payload\n    payload = this.addSystemDataToObject(payload, true)\n    payload = JSON.stringify(payload)\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', 'data')\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(payload, this.#logger))\n    RequestDispatcher.fireRequest(pageLoadUrl)\n    // set in localstorage\n    StorageManager.save(WEBPUSH_LS_KEY, 'ok')\n  }\n\n  processEvent (data) {\n    this.#addToLocalEventMap(data.evtName)\n    data = this.addSystemDataToObject(data, undefined)\n    this.addFlags(data)\n    data[CAMP_COOKIE_NAME] = getCampaignObjForLc()\n    const compressedData = compressData(JSON.stringify(data), this.#logger)\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n    this.saveAndFireRequest(pageLoadUrl, $ct.blockRequest, false, data.evtName)\n  }\n\n  #addToLocalEventMap (evtName) {\n    if (StorageManager._isLocalStorageSupported()) {\n      if (typeof $ct.globalEventsMap === 'undefined') {\n        $ct.globalEventsMap = StorageManager.readFromLSorCookie(EV_COOKIE)\n        if (typeof $ct.globalEventsMap === 'undefined') {\n          $ct.globalEventsMap = {}\n        }\n      }\n\n      const nowTs = getNow()\n      let evtDetail = $ct.globalEventsMap[evtName]\n      if (typeof evtDetail !== 'undefined') {\n        evtDetail[2] = nowTs\n        evtDetail[0]++\n      } else {\n        evtDetail = []\n        evtDetail.push(1)\n        evtDetail.push(nowTs)\n        evtDetail.push(nowTs)\n      }\n      $ct.globalEventsMap[evtName] = evtDetail\n      StorageManager.saveToLSorCookie(EV_COOKIE, $ct.globalEventsMap)\n    }\n  }\n\n  async post (url, body) {\n    try {\n      const response = await fetch(url, {\n        method: 'post',\n        headers: { 'Content-Type': 'application/json' },\n        body: body\n      })\n      if (response.ok) {\n        const data = await response.json()\n        this.#logger.debug('Sync data successful', data)\n        return data\n      } else {\n        throw response\n      }\n    } catch (e) {\n      this.#logger.debug('Error in syncing variables', e)\n      throw e\n    }\n  }\n}\n","import {\n  isObjectEmpty\n} from '../util/datatypes'\nimport {\n  EVT_PUSH,\n  USEIP_KEY,\n  OPTOUT_KEY,\n  CT_OPTOUT_KEY\n} from '../util/constants'\nimport {\n  StorageManager,\n  $ct\n} from '../util/storage'\nimport {\n  compressData\n} from '../util/encoder'\nimport {\n  addToURL\n} from '../util/url'\n\nexport default class Privacy extends Array {\n  #request\n  #account\n  #oldValues\n  #logger\n\n  constructor ({\n    request,\n    account,\n    logger\n  },\n  values) {\n    super()\n    this.#logger = logger\n    this.#request = request\n    this.#account = account\n    this.#oldValues = values\n  }\n\n  push (...privacyArr) {\n    if ($ct.isPrivacyArrPushed) {\n      this.#processPrivacyArray($ct.privacyArray.length > 0 ? $ct.privacyArray : privacyArr)\n    } else {\n      $ct.privacyArray.push(...privacyArr)\n    }\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processPrivacyArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  #processPrivacyArray (privacyArr) {\n    if (Array.isArray(privacyArr) && privacyArr.length > 0) {\n      const privacyObj = privacyArr.reduce((prev, curr) => ({ ...prev, ...curr }), {})\n      let data = {}\n      const profileObj = {}\n      var optOut = false\n\n      if (privacyObj.hasOwnProperty(OPTOUT_KEY)) {\n        optOut = privacyObj[OPTOUT_KEY]\n        if (typeof optOut === 'boolean') {\n          profileObj[CT_OPTOUT_KEY] = optOut\n          // should be true when user wants to opt in\n          $ct.isOptInRequest = !optOut\n        }\n      }\n      if (privacyObj.hasOwnProperty(USEIP_KEY)) {\n        const useIP = privacyObj[USEIP_KEY]\n        const shouldUseIP = (typeof useIP === 'boolean') ? useIP : false\n        StorageManager.setMetaProp(USEIP_KEY, shouldUseIP)\n      }\n      if (!isObjectEmpty(profileObj)) {\n        data.type = 'profile'\n        data.profile = profileObj\n        data = this.#request.addSystemDataToObject(data, undefined)\n        const compressedData = compressData(JSON.stringify(data), this.#logger)\n        let pageLoadUrl = this.#account.dataPostURL\n        pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n        pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n        pageLoadUrl = addToURL(pageLoadUrl, OPTOUT_KEY, optOut ? 'true' : 'false')\n        this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n        privacyArr.splice(0, privacyArr.length)\n      }\n    }\n  }\n}\n","import { StorageManager, $ct } from '../util/storage'\nimport { isObject } from '../util/datatypes'\nimport {\n  PUSH_SUBSCRIPTION_DATA\n} from '../util/constants'\nimport {\n  urlBase64ToUint8Array\n} from '../util/encoder'\n\nexport default class NotificationHandler extends Array {\n  #oldValues\n  #logger\n  #request\n  #account\n  #wizAlertJSPath\n  #fcmPublicKey\n\n  constructor ({\n    logger,\n    session,\n    request,\n    account\n  }, values) {\n    super()\n    this.#wizAlertJSPath = 'https://d2r1yp2w7bby2u.cloudfront.net/js/wzrk_dialog.min.js'\n    this.#fcmPublicKey = null\n    this.#oldValues = values\n    this.#logger = logger\n    this.#request = request\n    this.#account = account\n  }\n\n  push (...displayArgs) {\n    this.#setUpWebPush(displayArgs)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#setUpWebPush(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  #setUpWebPush (displayArgs) {\n    if ($ct.webPushEnabled && displayArgs.length > 0) {\n      this.#handleNotificationRegistration(displayArgs)\n    } else if ($ct.webPushEnabled == null && displayArgs.length > 0) {\n      $ct.notifApi.notifEnabledFromApi = true\n      $ct.notifApi.displayArgs = displayArgs.slice()\n    } else if ($ct.webPushEnabled === false && displayArgs.length > 0) {\n      this.#logger.error('Make sure push notifications are fully enabled and integrated')\n    }\n  }\n\n  #setUpWebPushNotifications (subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsServiceUrl) {\n    if (navigator.userAgent.indexOf('Chrome') !== -1 || navigator.userAgent.indexOf('Firefox') !== -1) {\n      this.#setUpChromeFirefoxNotifications(subscriptionCallback, serviceWorkerPath)\n    } else if (navigator.userAgent.indexOf('Safari') !== -1) {\n      this.#setUpSafariNotifications(subscriptionCallback, apnsWebPushId, apnsServiceUrl)\n    }\n  }\n\n  #setApplicationServerKey (applicationServerKey) {\n    this.#fcmPublicKey = applicationServerKey\n  }\n\n  #setUpSafariNotifications (subscriptionCallback, apnsWebPushId, apnsServiceUrl) {\n    // ensure that proper arguments are passed\n    if (typeof apnsWebPushId === 'undefined') {\n      this.#logger.error('Ensure that APNS Web Push ID is supplied')\n    }\n    if (typeof apnsServiceUrl === 'undefined') {\n      this.#logger.error('Ensure that APNS Web Push service path is supplied')\n    }\n    if ('safari' in window && 'pushNotification' in window.safari) {\n      window.safari.pushNotification.requestPermission(\n        apnsServiceUrl,\n        apnsWebPushId, {}, (subscription) => {\n          if (subscription.permission === 'granted') {\n            const subscriptionData = JSON.parse(JSON.stringify(subscription))\n            subscriptionData.endpoint = subscription.deviceToken\n            subscriptionData.browser = 'Safari'\n            StorageManager.saveToLSorCookie(PUSH_SUBSCRIPTION_DATA, subscriptionData)\n\n            this.#request.registerToken(subscriptionData)\n            this.#logger.info('Safari Web Push registered. Device Token: ' + subscription.deviceToken)\n          } else if (subscription.permission === 'denied') {\n            this.#logger.info('Error subscribing to Safari web push')\n          }\n        })\n    }\n  }\n\n  /**\n   * Sets up a service worker for WebPush(chrome/Firefox) push notifications and sends the data to LC\n   */\n  #setUpChromeFirefoxNotifications (subscriptionCallback, serviceWorkerPath) {\n    let registrationScope = ''\n\n    if ('serviceWorker' in navigator) {\n      navigator.serviceWorker.register(serviceWorkerPath).then((registration) => {\n        if (typeof __wzrk_account_id !== 'undefined') { // eslint-disable-line\n          // shopify accounts , since the service worker is not at root, serviceWorker.ready is never resolved.\n          // hence add a timeout and hope serviceWroker is ready within that time.\n          return new Promise(resolve => setTimeout(() => resolve(registration), 5000))\n        }\n        registrationScope = registration.scope\n\n        // IF SERVICE WORKER IS AT ROOT, RETURN THE READY PROMISE\n        // ELSE IF CHROME RETURN PROMISE AFTER 5 SECONDS\n        // OR getRegistrations PROMISE IF ITS FIREFOX\n        const rootDirRegex = /^(\\.?)(\\/?)([^/]*).js$/\n        const isServiceWorkerAtRoot = rootDirRegex.test(serviceWorkerPath)\n        if (isServiceWorkerAtRoot) {\n          return navigator.serviceWorker.ready\n        } else {\n          if (navigator.userAgent.indexOf('Chrome') !== -1) {\n            return new Promise(resolve => setTimeout(() => resolve(registration), 5000))\n          } else {\n            return navigator.serviceWorker.getRegistrations()\n          }\n        }\n      }).then((serviceWorkerRegistration) => {\n        // ITS AN ARRAY IN CASE OF FIREFOX, SO USE THE REGISTRATION WITH PROPER SCOPE\n        if (navigator.userAgent.indexOf('Firefox') !== -1 && Array.isArray(serviceWorkerRegistration)) {\n          serviceWorkerRegistration = serviceWorkerRegistration.filter((i) => i.scope === registrationScope)[0]\n        }\n        const subscribeObj = { userVisibleOnly: true }\n\n        if (this.#fcmPublicKey != null) {\n          subscribeObj.applicationServerKey = urlBase64ToUint8Array(this.#fcmPublicKey)\n        }\n\n        serviceWorkerRegistration.pushManager.subscribe(subscribeObj)\n          .then((subscription) => {\n            this.#logger.info('Service Worker registered. Endpoint: ' + subscription.endpoint)\n\n            // convert the subscription keys to strings; this sets it up nicely for pushing to LC\n            const subscriptionData = JSON.parse(JSON.stringify(subscription))\n\n            // remove the common chrome/firefox endpoint at the beginning of the token\n            if (navigator.userAgent.indexOf('Chrome') !== -1) {\n              subscriptionData.endpoint = subscriptionData.endpoint.split('/').pop()\n              subscriptionData.browser = 'Chrome'\n            } else if (navigator.userAgent.indexOf('Firefox') !== -1) {\n              subscriptionData.endpoint = subscriptionData.endpoint.split('/').pop()\n              subscriptionData.browser = 'Firefox'\n            }\n            StorageManager.saveToLSorCookie(PUSH_SUBSCRIPTION_DATA, subscriptionData)\n            this.#request.registerToken(subscriptionData)\n\n            if (typeof subscriptionCallback !== 'undefined' && typeof subscriptionCallback === 'function') {\n              subscriptionCallback()\n            }\n          }).catch((error) => {\n            this.#logger.error('Error subscribing: ' + error)\n            // unsubscribe from webpush if error\n            serviceWorkerRegistration.pushManager.getSubscription().then((subscription) => {\n              if (subscription !== null) {\n                subscription.unsubscribe().then((successful) => {\n                  // You've successfully unsubscribed\n                  this.#logger.info('Unsubscription successful')\n                }).catch((e) => {\n                  // Unsubscription failed\n                  this.#logger.error('Error unsubscribing: ' + e)\n                })\n              }\n            })\n          })\n      }).catch((err) => {\n        this.#logger.error('error registering service worker: ' + err)\n      })\n    }\n  }\n\n  #addWizAlertJS () {\n    const scriptTag = document.createElement('script')\n    scriptTag.setAttribute('type', 'text/javascript')\n    scriptTag.setAttribute('id', 'wzrk-alert-js')\n    scriptTag.setAttribute('src', this.#wizAlertJSPath)\n\n    // add the script tag to the end of the body\n    document.getElementsByTagName('body')[0].appendChild(scriptTag)\n\n    return scriptTag\n  }\n\n  #removeWizAlertJS () {\n    const scriptTag = document.getElementById('wzrk-alert-js')\n    scriptTag.parentNode.removeChild(scriptTag)\n  }\n\n  #handleNotificationRegistration (displayArgs) {\n    // make sure everything is specified\n    let titleText\n    let bodyText\n    let okButtonText\n    let rejectButtonText\n    let okButtonColor\n    let skipDialog\n    let askAgainTimeInSeconds\n    let okCallback\n    let rejectCallback\n    let subscriptionCallback\n    let serviceWorkerPath\n    let httpsPopupPath\n    let httpsIframePath\n    let apnsWebPushId\n    let apnsWebPushServiceUrl\n\n    if (displayArgs.length === 1) {\n      if (isObject(displayArgs[0])) {\n        const notifObj = displayArgs[0]\n        titleText = notifObj.titleText\n        bodyText = notifObj.bodyText\n        okButtonText = notifObj.okButtonText\n        rejectButtonText = notifObj.rejectButtonText\n        okButtonColor = notifObj.okButtonColor\n        skipDialog = notifObj.skipDialog\n        askAgainTimeInSeconds = notifObj.askAgainTimeInSeconds\n        okCallback = notifObj.okCallback\n        rejectCallback = notifObj.rejectCallback\n        subscriptionCallback = notifObj.subscriptionCallback\n        serviceWorkerPath = notifObj.serviceWorkerPath\n        httpsPopupPath = notifObj.httpsPopupPath\n        httpsIframePath = notifObj.httpsIframePath\n        apnsWebPushId = notifObj.apnsWebPushId\n        apnsWebPushServiceUrl = notifObj.apnsWebPushServiceUrl\n      }\n    } else {\n      titleText = displayArgs[0]\n      bodyText = displayArgs[1]\n      okButtonText = displayArgs[2]\n      rejectButtonText = displayArgs[3]\n      okButtonColor = displayArgs[4]\n      skipDialog = displayArgs[5]\n      askAgainTimeInSeconds = displayArgs[6]\n    }\n\n    if (skipDialog == null) {\n      skipDialog = false\n    }\n\n    if (serviceWorkerPath == null) {\n      serviceWorkerPath = '/clevertap_sw.js'\n    }\n\n    // ensure that the browser supports notifications\n    if (typeof navigator.serviceWorker === 'undefined') {\n      return\n    }\n\n    const isHTTP = httpsPopupPath != null && httpsIframePath != null\n\n    // make sure the site is on https for chrome notifications\n    if (window.location.protocol !== 'https:' && document.location.hostname !== 'localhost' && !isHTTP) {\n      this.#logger.error('Make sure you are https or localhost to register for notifications')\n      return\n    }\n\n    // right now, we only support Chrome V50 & higher & Firefox\n    if (navigator.userAgent.indexOf('Chrome') !== -1) {\n      const chromeAgent = navigator.userAgent.match(/Chrome\\/(\\d+)/)\n      if (chromeAgent == null || parseInt(chromeAgent[1], 10) < 50) { return }\n    } else if (navigator.userAgent.indexOf('Firefox') !== -1) {\n      const firefoxAgent = navigator.userAgent.match(/Firefox\\/(\\d+)/)\n      if (firefoxAgent == null || parseInt(firefoxAgent[1], 10) < 50) { return }\n    } else if (navigator.userAgent.indexOf('Safari') !== -1) {\n      const safariAgent = navigator.userAgent.match(/Safari\\/(\\d+)/)\n      if (safariAgent == null || parseInt(safariAgent[1], 10) < 50) { return }\n    } else {\n      return\n    }\n\n    // we check for the cookie in setUpChromeNotifications() the tokens may have changed\n\n    if (!isHTTP) {\n      if (Notification == null) {\n        return\n      }\n      // handle migrations from other services -> chrome notifications may have already been asked for before\n      if (Notification.permission === 'granted') {\n        // skip the dialog and register\n        this.#setUpWebPushNotifications(subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsWebPushServiceUrl)\n        return\n      } else if (Notification.permission === 'denied') {\n        // we've lost this profile :'(\n        return\n      }\n\n      if (skipDialog) {\n        this.#setUpWebPushNotifications(subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsWebPushServiceUrl)\n        return\n      }\n    }\n\n    // make sure the right parameters are passed\n    if (!titleText || !bodyText || !okButtonText || !rejectButtonText) {\n      this.#logger.error('Missing input parameters; please specify title, body, ok button and cancel button text')\n      return\n    }\n\n    // make sure okButtonColor is formatted properly\n    if (okButtonColor == null || !okButtonColor.match(/^#[a-f\\d]{6}$/i)) {\n      okButtonColor = '#f28046' // default color for positive button\n    }\n\n    // make sure the user isn't asked for notifications more than askAgainTimeInSeconds\n    const now = new Date().getTime() / 1000\n    if ((StorageManager.getMetaProp('notif_last_time')) == null) {\n      StorageManager.setMetaProp('notif_last_time', now)\n    } else {\n      if (askAgainTimeInSeconds == null) {\n        // 7 days by default\n        askAgainTimeInSeconds = 7 * 24 * 60 * 60\n      }\n\n      if (now - StorageManager.getMetaProp('notif_last_time') < askAgainTimeInSeconds) {\n        return\n      } else {\n        // continue asking\n        StorageManager.setMetaProp('notif_last_time', now)\n      }\n    }\n\n    if (isHTTP) {\n      // add the https iframe\n      const httpsIframe = document.createElement('iframe')\n      httpsIframe.setAttribute('style', 'display:none;')\n      httpsIframe.setAttribute('src', httpsIframePath)\n      document.body.appendChild(httpsIframe)\n      window.addEventListener('message', (event) => {\n        if (event.data != null) {\n          let obj = {}\n          try {\n            obj = JSON.parse(event.data)\n          } catch (e) {\n            // not a call from our iframe\n            return\n          }\n          if (obj.state != null) {\n            if (obj.from === 'ct' && obj.state === 'not') {\n              this.#addWizAlertJS().onload = () => {\n                // create our wizrocket popup\n                window.wzrkPermissionPopup.wizAlert({\n                  title: titleText,\n                  body: bodyText,\n                  confirmButtonText: okButtonText,\n                  confirmButtonColor: okButtonColor,\n                  rejectButtonText: rejectButtonText\n                }, (enabled) => { // callback function\n                  if (enabled) {\n                    // the user accepted on the dialog box\n                    if (typeof okCallback === 'function') {\n                      okCallback()\n                    }\n                    // redirect to popup.html\n                    window.open(httpsPopupPath)\n                  } else {\n                    if (typeof rejectCallback === 'function') {\n                      rejectCallback()\n                    }\n                  }\n                  this.#removeWizAlertJS()\n                })\n              }\n            }\n          }\n        }\n      }, false)\n    } else {\n      this.#addWizAlertJS().onload = () => {\n        // create our wizrocket popup\n        window.wzrkPermissionPopup.wizAlert({\n          title: titleText,\n          body: bodyText,\n          confirmButtonText: okButtonText,\n          confirmButtonColor: okButtonColor,\n          rejectButtonText: rejectButtonText\n        }, (enabled) => { // callback function\n          if (enabled) {\n            // the user accepted on the dialog box\n            if (typeof okCallback === 'function') {\n              okCallback()\n            }\n            this.#setUpWebPushNotifications(subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsWebPushServiceUrl)\n          } else {\n            if (typeof rejectCallback === 'function') {\n              rejectCallback()\n            }\n          }\n          this.#removeWizAlertJS()\n        })\n      }\n    }\n  }\n\n  _enableWebPush (enabled, applicationServerKey) {\n    $ct.webPushEnabled = enabled\n    if (applicationServerKey != null) {\n      this.#setApplicationServerKey(applicationServerKey)\n    }\n    if ($ct.webPushEnabled && $ct.notifApi.notifEnabledFromApi) {\n      this.#handleNotificationRegistration($ct.notifApi.displayArgs)\n    } else if (!$ct.webPushEnabled && $ct.notifApi.notifEnabledFromApi) {\n      this.#logger.error('Ensure that web push notifications are fully enabled and integrated before requesting them')\n    }\n  }\n}\n","export class Variable {\n  #variableStore\n\n  constructor ({ variableStore }) {\n    this.name = null\n    this.defaultValue = null\n    this.value = null\n    this.type = null\n    this.hadStarted = false\n    this.valueChangedCallbacks = []\n    this.#variableStore = variableStore\n  }\n\n  getValue () {\n    return this.value\n  }\n\n  getdefaultValue () {\n    return this.defaultValue\n  }\n\n  /**\n   * Defines a new variable with the provided name, default value, and variable store.\n   * @static\n   * @param {string} name - The name of the variable.\n   * @param {*} defaultValue - The default value of the variable.\n   * @param {VariableStore} variableStore - The VariableStore instance for registration.\n   * @returns {Variable|null} - The created Variable instance or null if invalid parameters are provided.\n   */\n  static define (name, defaultValue, variableStore) {\n    if (!name || typeof name !== 'string') {\n      this.log('Empty or invalid name parameter provided.')\n      return null\n    }\n    if (name.startsWith('.') || name.endsWith('.')) {\n      this.log('Variable name starts or ends with a `.` which is not allowed: ' + name)\n      return null\n    }\n\n    let type = 'string'\n    if (typeof defaultValue === 'number') {\n      type = 'number'\n    } else if (typeof defaultValue === 'boolean') {\n      type = 'boolean'\n    }\n\n    const existing = variableStore.getVariable(name)\n    if (existing) {\n      return existing\n    }\n\n    const varInstance = new Variable({ variableStore })\n    try {\n      varInstance.name = name\n      varInstance.defaultValue = defaultValue\n      varInstance.value = defaultValue\n      varInstance.type = type\n      variableStore.registerVariable(varInstance)\n      varInstance.update(defaultValue)\n    } catch (error) {\n      console.error(error)\n    }\n    return varInstance\n  }\n\n  update (newValue) {\n    const oldValue = this.value\n    this.value = newValue\n    if (newValue === null && oldValue === null) {\n      return\n    }\n    if (newValue !== null && newValue === oldValue && this.hadStarted) {\n      return\n    }\n    if (this.#variableStore.hasVarsRequestCompleted()) {\n      this.hadStarted = true\n      this.triggerValueChanged()\n    }\n  }\n\n  triggerValueChanged () {\n    this.valueChangedCallbacks.forEach((onValueChanged) => {\n      onValueChanged(this)\n    })\n  }\n\n  addValueChangedCallback (onValueChanged) {\n    if (!onValueChanged) {\n      console.log('Invalid callback parameter provided.')\n      return\n    }\n    this.valueChangedCallbacks.push(onValueChanged)\n\n    if (this.#variableStore.hasVarsRequestCompleted()) {\n      onValueChanged(this)\n    }\n  }\n\n  removeValueChangedCallback (onValueChanged) {\n    const index = this.valueChangedCallbacks.indexOf(onValueChanged)\n    if (index !== -1) {\n      this.valueChangedCallbacks.splice(index, 1)\n    }\n  }\n\n  clearStartFlag () {\n    this.hadStarted = false\n  }\n}\n","import { VARIABLES, WZRK_FETCH } from '../../util/constants'\nimport { StorageManager, $ct } from '../../util/storage'\nclass VariableStore {\n  #logger\n  #account\n  #request\n  #event\n\n  #variables\n  #remoteVariables\n  #fetchCallback\n  #variablesChangedCallbacks\n  #oneTimeVariablesChangedCallbacks\n  #hasVarsRequestCompleted = false\n\n  constructor ({ logger, request, account, event }) {\n    this.#logger = logger\n    this.#account = account\n    this.#request = request\n    this.#event = event\n\n    this.#variables = {}\n    this.#remoteVariables = {}\n    this.#variablesChangedCallbacks = []\n    this.#oneTimeVariablesChangedCallbacks = []\n\n    $ct.variableStore = this\n  }\n\n  /**\n   * Registers a variable instance in the store.\n   * @param {Object} varInstance - The variable instance to be registered.\n   */\n  registerVariable (varInstance) {\n    const { name } = varInstance\n    this.#variables[name] = varInstance\n    console.log('registerVariable', this.#variables)\n  }\n\n  /**\n   * Retrieves a variable by its name.\n   * @param {string} name - The name of the variable to retrieve.\n   * @returns {Object} - The variable instance.\n   */\n  getVariable (name) {\n    return this.#variables[name]\n  }\n\n  hasVarsRequestCompleted () {\n    return this.#hasVarsRequestCompleted\n  }\n\n  /**\n   * Synchronizes variables with the server.\n   * @param {Function} onSyncSuccess - Callback function on successful synchronization.\n   * @param {Function} onSyncFailure - Callback function on synchronization failure.\n   * @throws Will throw an error if the account token is missing.\n   * @returns {Promise} - The result of the synchronization request.\n   */\n  async syncVariables (onSyncSuccess, onSyncFailure) {\n    if (!this.#account.token) {\n      throw new Error('Account token is missing')\n    }\n\n    const payload = {\n      type: 'varsPayload',\n      vars: {}\n    }\n    for (const name in this.#variables) {\n      payload.vars[name] = {\n        defaultValue: this.#variables[name].defaultValue,\n        type: this.#variables[name].type\n      }\n    }\n\n    let meta = {}\n    meta = this.#request.addSystemDataToObject(meta, undefined)\n    meta.tk = this.#account.token\n\n    meta.type = 'meta'\n    const body = JSON.stringify([meta, payload])\n    const url = this.#account.dataPostPEURL\n\n    try {\n      const r = await this.#request.post(url, body)\n      if (onSyncSuccess && typeof onSyncSuccess === 'function') {\n        onSyncSuccess(r)\n      }\n      return r\n    } catch (e) {\n      if (onSyncFailure && typeof onSyncFailure === 'function') {\n        onSyncFailure(e)\n      }\n      if (e.status === 400) {\n        this.#logger.error('Invalid sync payload or clear the existing draft')\n      } else if (e.status === 401) {\n        this.#logger.error('This is not a test profile')\n      } else {\n        this.#logger.error('Sync variable failed')\n      }\n    }\n  }\n\n  /**\n   * Fetches variables from the server.\n   * @param {Function} onFetchComplete - Callback function on fetch completion.\n   */\n  async fetchVariables (onFetchComplete) {\n    this.#event.push(WZRK_FETCH, { t: 4 })\n    if (onFetchComplete && typeof onFetchComplete === 'function') {\n      this.#fetchCallback = onFetchComplete\n    }\n  }\n\n  mergeVariables (vars) {\n    console.log('msg vars is ', vars)\n    this.#hasVarsRequestCompleted = true\n\n    StorageManager.saveToLSorCookie(VARIABLES, vars)\n    this.#remoteVariables = vars\n\n    for (const name in this.#variables) {\n      if (vars.hasOwnProperty(name)) {\n        this.#variables[name].update(vars[name])\n      }\n    }\n\n    if (this.#fetchCallback) {\n      this.#fetchCallback()\n    }\n\n    this.#runVariablesChangedCallback()\n  }\n\n  addVariablesChangedCallback (callback) {\n    if (callback && typeof callback === 'function') {\n      this.#variablesChangedCallbacks.push(callback)\n\n      if (this.hasVarsRequestCompleted()) {\n        callback()\n      }\n    } else {\n      this.#logger.error('callback is not a function')\n    }\n  }\n\n  addOneTimeVariablesChangedCallback (callback) {\n    if (callback && typeof callback === 'function') {\n      if (this.hasVarsRequestCompleted()) {\n        callback()\n      } else {\n        this.#oneTimeVariablesChangedCallbacks.push(callback)\n      }\n    }\n  }\n\n  removeVariablesChangedCallback (callback) {\n    const index = this.#variablesChangedCallbacks.indexOf(callback)\n    if (index !== -1) {\n      this.#variablesChangedCallbacks.splice(index, 1)\n    }\n  }\n\n  removeOneTimeVariablesChangedCallback (callback) {\n    const index = this.#oneTimeVariablesChangedCallbacks.indexOf(callback)\n    if (index !== -1) {\n      this.#oneTimeVariablesChangedCallbacks.splice(index, 1)\n    }\n  }\n\n  #runVariablesChangedCallback () {\n    for (var callback of this.#variablesChangedCallbacks) {\n      callback()\n    }\n    for (var callBack of this.#oneTimeVariablesChangedCallbacks) {\n      callBack()\n    }\n    this.#oneTimeVariablesChangedCallbacks.length = 0\n  }\n}\n\nexport default VariableStore\n","import Account from './modules/account'\nimport CleverTapAPI from './modules/api'\nimport DeviceManager from './modules/device'\nimport EventHandler from './modules/event'\nimport ProfileHandler from './modules/profile'\nimport UserLoginHandler from './modules/userLogin'\nimport _tr from './util/tr'\nimport User from './modules/user'\nimport { Logger, logLevels } from './modules/logger'\nimport SessionManager from './modules/session'\nimport ReqestManager from './modules/request'\nimport {\n  CAMP_COOKIE_NAME,\n  SCOOKIE_PREFIX,\n  NOTIFICATION_VIEWED,\n  NOTIFICATION_CLICKED,\n  EVT_PING,\n  FIRST_PING_FREQ_IN_MILLIS,\n  CONTINUOUS_PING_FREQ_IN_MILLIS,\n  GROUP_SUBSCRIPTION_REQUEST_ID,\n  WZRK_ID,\n  WZRK_PREFIX,\n  categoryLongKey,\n  COMMAND_INCREMENT,\n  COMMAND_DECREMENT,\n  COMMAND_SET,\n  COMMAND_ADD,\n  COMMAND_REMOVE,\n  COMMAND_DELETE,\n  EVT_PUSH,\n  WZRK_FETCH\n} from './util/constants'\nimport { EMBED_ERROR } from './util/messages'\nimport { StorageManager, $ct } from './util/storage'\nimport { addToURL, getDomain, getURLParams } from './util/url'\nimport { getCampaignObjForLc, setEnum, handleEmailSubscription, closeIframe } from './util/clevertap'\nimport { compressData } from './util/encoder'\nimport Privacy from './modules/privacy'\nimport NotificationHandler from './modules/notification'\nimport { hasWebInboxSettingsInLS, checkAndRegisterWebInboxElements, initializeWebInbox, getInboxMessages, saveInboxMessages } from './modules/web-inbox/helper'\nimport { Variable } from './modules/variables/variable'\nimport VariableStore from './modules/variables/variableStore'\n\nexport default class CleverTap {\n  #logger\n  #api\n  #onloadcalled\n  #device\n  #session\n  #account\n  #request\n  #variableStore\n  #isSpa\n  #previousUrl\n  #boundCheckPageChanged = this.#checkPageChanged.bind(this)\n  #dismissSpamControl\n  enablePersonalization\n\n  get spa () {\n    return this.#isSpa\n  }\n\n  set spa (value) {\n    const isSpa = value === true\n    if (this.#isSpa !== isSpa && this.#onloadcalled === 1) {\n      // if clevertap.spa is changed after init has been called then update the click listeners\n      if (isSpa) {\n        document.addEventListener('click', this.#boundCheckPageChanged)\n      } else {\n        document.removeEventListener('click', this.#boundCheckPageChanged)\n      }\n    }\n    this.#isSpa = isSpa\n  }\n\n  get dismissSpamControl () {\n    return this.#dismissSpamControl\n  }\n\n  set dismissSpamControl (value) {\n    const dismissSpamControl = value === true\n    this.#dismissSpamControl = dismissSpamControl\n    $ct.dismissSpamControl = dismissSpamControl\n  }\n\n  constructor (clevertap = {}) {\n    this.#onloadcalled = 0\n    this._isPersonalisationActive = this._isPersonalisationActive.bind(this)\n    this.raiseNotificationClicked = () => { }\n    this.#logger = new Logger(logLevels.INFO)\n    this.#account = new Account(clevertap.account?.[0], clevertap.region || clevertap.account?.[1], clevertap.targetDomain || clevertap.account?.[2], clevertap.token || clevertap.account?.[3])\n    this.#device = new DeviceManager({ logger: this.#logger })\n    this.#dismissSpamControl = clevertap.dismissSpamControl || false\n    this.#session = new SessionManager({\n      logger: this.#logger,\n      isPersonalisationActive: this._isPersonalisationActive\n    })\n    this.#request = new ReqestManager({\n      logger: this.#logger,\n      account: this.#account,\n      device: this.#device,\n      session: this.#session,\n      isPersonalisationActive: this._isPersonalisationActive\n    })\n    this.enablePersonalization = clevertap.enablePersonalization || false\n    this.event = new EventHandler({\n      logger: this.#logger,\n      request: this.#request,\n      isPersonalisationActive: this._isPersonalisationActive\n    }, clevertap.event)\n\n    this.profile = new ProfileHandler({\n      logger: this.#logger,\n      request: this.#request,\n      account: this.#account,\n      isPersonalisationActive: this._isPersonalisationActive\n    }, clevertap.profile)\n\n    this.onUserLogin = new UserLoginHandler({\n      request: this.#request,\n      account: this.#account,\n      session: this.#session,\n      logger: this.#logger,\n      device: this.#device\n    }, clevertap.onUserLogin)\n\n    this.privacy = new Privacy({\n      request: this.#request,\n      account: this.#account,\n      logger: this.#logger\n    }, clevertap.privacy)\n\n    this.notifications = new NotificationHandler({\n      logger: this.#logger,\n      request: this.#request,\n      account: this.#account\n    }, clevertap.notifications)\n\n    this.#variableStore = new VariableStore({\n      logger: this.#logger,\n      request: this.#request,\n      account: this.#account,\n      event: this.event\n    })\n\n    this.#api = new CleverTapAPI({\n      logger: this.#logger,\n      request: this.#request,\n      device: this.#device,\n      session: this.#session\n    })\n\n    this.spa = clevertap.spa\n    this.dismissSpamControl = clevertap.dismissSpamControl\n\n    this.user = new User({\n      isPersonalisationActive: this._isPersonalisationActive\n    })\n\n    this.session = {\n      getTimeElapsed: () => {\n        return this.#session.getTimeElapsed()\n      },\n      getPageCount: () => {\n        return this.#session.getPageCount()\n      }\n    }\n\n    this.logout = () => {\n      this.#logger.debug('logout called')\n      StorageManager.setInstantDeleteFlagInK()\n    }\n\n    this.clear = () => {\n      this.onUserLogin.clear()\n    }\n\n    this.getCleverTapID = () => {\n      return this.#device.getGuid()\n    }\n\n    this.getAccountID = () => {\n      return this.#account.id\n    }\n\n    this.getSCDomain = () => {\n      return this.#account.finalTargetDomain\n    }\n\n    this.setLibrary = (libName, libVersion) => {\n      $ct.flutterVersion = { [libName]: libVersion }\n    }\n\n    // Set the Signed Call sdk version and fire request\n    this.setSCSDKVersion = (ver) => {\n      this.#account.scSDKVersion = ver\n      const data = {}\n      data.af = { scv: 'sc-sdk-v' + this.#account.scSDKVersion }\n      let pageLoadUrl = this.#account.dataPostURL\n      pageLoadUrl = addToURL(pageLoadUrl, 'type', 'page')\n      pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n      this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n    }\n\n    if (hasWebInboxSettingsInLS()) {\n      checkAndRegisterWebInboxElements()\n      initializeWebInbox(this.#logger)\n    }\n\n    // Get Inbox Message Count\n    this.getInboxMessageCount = () => {\n      const msgCount = getInboxMessages()\n      return Object.keys(msgCount).length\n    }\n\n    // Get Inbox Unread Message Count\n    this.getInboxMessageUnreadCount = () => {\n      if ($ct.inbox) {\n        return $ct.inbox.unviewedCounter\n      } else {\n        this.#logger.debug('No unread messages')\n      }\n    }\n\n    // Get All Inbox messages\n    this.getAllInboxMessages = () => {\n      return getInboxMessages()\n    }\n\n    // Get only Unread messages\n    this.getUnreadInboxMessages = () => {\n      if ($ct.inbox) {\n        return $ct.inbox.unviewedMessages\n      } else {\n        this.#logger.debug('No unread messages')\n      }\n    }\n\n    // Get message object belonging to the given message id only. Message id should be a String\n    this.getInboxMessageForId = (messageId) => {\n      const messages = getInboxMessages()\n      if ((messageId !== null || messageId !== '') && messages.hasOwnProperty(messageId)) {\n        return messages[messageId]\n      } else {\n        this.#logger.error('No message available for message Id ' + messageId)\n      }\n    }\n\n    // Delete message from the Inbox. Message id should be a String\n    // If the message to be deleted is unviewed then decrement the badge count, delete the message from unviewedMessages list\n    // Then remove the message from local storage and update cookie\n    this.deleteInboxMessage = (messageId) => {\n      const messages = getInboxMessages()\n      if ((messageId !== null || messageId !== '') && messages.hasOwnProperty(messageId)) {\n        const el = document.querySelector('ct-web-inbox').shadowRoot.getElementById(messageId)\n        if (messages[messageId].viewed === 0) {\n          $ct.inbox.unviewedCounter--\n          delete $ct.inbox.unviewedMessages[messageId]\n          document.getElementById('unviewedBadge').innerText = $ct.inbox.unviewedCounter\n          document.getElementById('unviewedBadge').style.display = $ct.inbox.unviewedCounter > 0 ? 'flex' : 'none'\n        }\n        el && el.remove()\n        delete messages[messageId]\n        saveInboxMessages(messages)\n      } else {\n        this.#logger.error('No message available for message Id ' + messageId)\n      }\n    }\n\n    /* Mark Message as Read. Message id should be a String\n     - Check if the message Id exist in the unread message list\n     - Remove the unread marker, update the viewed flag, decrement the bage Count\n     - renderNotificationViewed */\n    this.markReadInboxMessage = (messageId) => {\n      const unreadMsg = $ct.inbox.unviewedMessages\n      const messages = getInboxMessages()\n      if ((messageId !== null || messageId !== '') && unreadMsg.hasOwnProperty(messageId)) {\n        const el = document.querySelector('ct-web-inbox').shadowRoot.getElementById(messageId)\n        if (el !== null) { el.shadowRoot.getElementById('unreadMarker').style.display = 'none' }\n        messages[messageId].viewed = 1\n        if (document.getElementById('unviewedBadge')) {\n          var counter = parseInt(document.getElementById('unviewedBadge').innerText) - 1\n          document.getElementById('unviewedBadge').innerText = counter\n          document.getElementById('unviewedBadge').style.display = counter > 0 ? 'flex' : 'none'\n        }\n        window.clevertap.renderNotificationViewed({ msgId: messages[messageId].wzrk_id, pivotId: messages[messageId].pivotId })\n        $ct.inbox.unviewedCounter--\n        delete $ct.inbox.unviewedMessages[messageId]\n        saveInboxMessages(messages)\n      } else {\n        this.#logger.error('No message available for message Id ' + messageId)\n      }\n    }\n\n    /* Mark Message as Read. messageIds should be a an array of string */\n    this.markReadInboxMessagesForIds = (messageIds) => {\n      if (Array.isArray(messageIds)) {\n        for (var id = 0; id < messageIds.length; id++) {\n          this.markReadInboxMessage(messageIds[id])\n        }\n      }\n    }\n\n    /* Mark all messages as read\n      - Get the count of unread messages, update unread marker style\n      - renderNotificationViewed, update the badge count and style\n    */\n    this.markReadAllInboxMessage = () => {\n      const unreadMsg = $ct.inbox.unviewedMessages\n      const messages = getInboxMessages()\n      if (Object.keys(unreadMsg).length > 0) {\n        const msgIds = Object.keys(unreadMsg)\n        msgIds.forEach(key => {\n          const el = document.querySelector('ct-web-inbox').shadowRoot.getElementById(key)\n          if (el !== null) { el.shadowRoot.getElementById('unreadMarker').style.display = 'none' }\n          messages[key].viewed = 1\n          window.clevertap.renderNotificationViewed({ msgId: messages[key].wzrk_id, pivotId: messages[key].wzrk_pivot })\n        })\n        document.getElementById('unviewedBadge').innerText = 0\n        document.getElementById('unviewedBadge').style.display = 'none'\n        saveInboxMessages(messages)\n        $ct.inbox.unviewedCounter = 0\n        $ct.inbox.unviewedMessages = {}\n      } else {\n        this.#logger.debug('All messages are already read')\n      }\n    }\n\n    this.toggleInbox = (e) => $ct.inbox?.toggleInbox(e)\n\n    // method for notification viewed\n    this.renderNotificationViewed = (detail) => {\n      processNotificationEvent(NOTIFICATION_VIEWED, detail)\n    }\n\n    // method for notification clicked\n    this.renderNotificationClicked = (detail) => {\n      processNotificationEvent(NOTIFICATION_CLICKED, detail)\n    }\n\n    const processNotificationEvent = (eventName, eventDetail) => {\n      if (!eventDetail || !eventDetail.msgId) { return }\n      const data = {}\n      data.type = 'event'\n      data.evtName = eventName\n      data.evtData = { [WZRK_ID]: eventDetail.msgId }\n\n      if (eventDetail.pivotId) {\n        data.evtData = { ...data.evtData, wzrk_pivot: eventDetail.pivotId }\n      }\n\n      if (eventDetail.wzrk_slideNo) {\n        data.evtData = { ...data.evtData, wzrk_slideNo: eventDetail.wzrk_slideNo }\n      }\n\n      // Adding kv pair to event data\n      if (eventDetail.kv && eventDetail.kv !== null && eventDetail.kv !== undefined) {\n        for (const key in eventDetail.kv) {\n          if (key.startsWith(WZRK_PREFIX)) {\n            data.evtData = { ...data.evtData, [key]: eventDetail.kv[key] }\n          }\n        }\n      }\n\n      // Adding msgCTkv to event data\n      if (eventDetail.msgCTkv && eventDetail.msgCTkv !== null && eventDetail.msgCTkv !== undefined) {\n        for (const key in eventDetail.msgCTkv) {\n          if (key.startsWith(WZRK_PREFIX)) {\n            data.evtData = { ...data.evtData, [key]: eventDetail.msgCTkv[key] }\n          }\n        }\n      }\n      this.#request.processEvent(data)\n    }\n\n    this.setLogLevel = (l) => {\n      this.#logger.logLevel = Number(l)\n      if (l === 3) {\n        sessionStorage.WZRK_D = ''\n      } else {\n        delete sessionStorage.WZRK_D\n      }\n    }\n    /**\n * @param {} key\n * @param {*} value\n */\n    this.handleIncrementValue = (key, value) => {\n      this.profile._handleIncrementDecrementValue(key, value, COMMAND_INCREMENT)\n    }\n\n    this.handleDecrementValue = (key, value) => {\n      this.profile._handleIncrementDecrementValue(key, value, COMMAND_DECREMENT)\n    }\n\n    this.setMultiValuesForKey = (key, value) => {\n      if (Array.isArray(value)) {\n        this.profile._handleMultiValueSet(key, value, COMMAND_SET)\n      } else {\n        console.error('setMultiValuesForKey should be called with a value of type array')\n      }\n    }\n\n    this.addMultiValueForKey = (key, value) => {\n      if (typeof value === 'string' || typeof value === 'number') {\n        this.profile._handleMultiValueAdd(key, value, COMMAND_ADD)\n      } else {\n        console.error('addMultiValueForKey should be called with a value of type string or number.')\n      }\n    }\n\n    this.addMultiValuesForKey = (key, value) => {\n      if (Array.isArray(value)) {\n        this.profile._handleMultiValueAdd(key, value, COMMAND_ADD)\n      } else {\n        console.error('addMultiValuesForKey should be called with a value of type array.')\n      }\n    }\n\n    this.removeMultiValueForKey = (key, value) => {\n      if (typeof value === 'string' || typeof value === 'number') {\n        this.profile._handleMultiValueRemove(key, value, COMMAND_REMOVE)\n      } else {\n        console.error('removeMultiValueForKey should be called with a value of type string or number.')\n      }\n    }\n\n    this.removeMultiValuesForKey = (key, value) => {\n      if (Array.isArray(value)) {\n        this.profile._handleMultiValueRemove(key, value, COMMAND_REMOVE)\n      } else {\n        console.error('removeMultiValuesForKey should be called with a value of type array.')\n      }\n    }\n\n    this.removeValueForKey = (key) => {\n      this.profile._handleMultiValueDelete(key, COMMAND_DELETE)\n    }\n\n    const _handleEmailSubscription = (subscription, reEncoded, fetchGroups) => {\n      handleEmailSubscription(subscription, reEncoded, fetchGroups, this.#account, this.#logger)\n    }\n\n    /**\n     *\n     * @param {number} lat\n     * @param {number} lng\n     * @param {callback function} handleCoordinates\n     * @returns\n    */\n    this.getLocation = function (lat, lng) {\n      // latitude and longitude should be number type\n      if ((lat && typeof lat !== 'number') || (lng && typeof lng !== 'number')) {\n        console.log('Latitude and Longitude must be of number type')\n        return\n      }\n      if (lat && lng) {\n        // valid latitude ranges bw +-90\n        if (lat <= -90 || lat > 90) {\n          console.log('A vaid latitude must range between -90 and 90')\n          return\n        }\n        // valid longitude ranges bw +-180\n        if (lng <= -180 || lng > 180) {\n          console.log('A valid longitude must range between -180 and 180')\n          return\n        }\n        $ct.location = { Latitude: lat, Longitude: lng }\n        this.sendLocationData({ Latitude: lat, Longitude: lng })\n      } else {\n        if (navigator.geolocation) {\n          navigator.geolocation.getCurrentPosition(showPosition.bind(this), showError)\n        } else {\n          console.log('Geolocation is not supported by this browser.')\n        }\n      }\n    }\n\n    function showPosition (position) {\n      var lat = position.coords.latitude\n      var lng = position.coords.longitude\n      $ct.location = { Latitude: lat, Longitude: lng }\n      this.sendLocationData({ Latitude: lat, Longitude: lng })\n    }\n\n    function showError (error) {\n      switch (error.code) {\n        case error.PERMISSION_DENIED:\n          console.log('User denied the request for Geolocation.')\n          break\n        case error.POSITION_UNAVAILABLE:\n          console.log('Location information is unavailable.')\n          break\n        case error.TIMEOUT:\n          console.log('The request to get user location timed out.')\n          break\n        case error.UNKNOWN_ERROR:\n          console.log('An unknown error occurred.')\n          break\n      }\n    }\n\n    const api = this.#api\n    api.logout = this.logout\n    api.clear = this.clear\n    api.closeIframe = (campaignId, divIdIgnored) => {\n      closeIframe(campaignId, divIdIgnored, this.#session.sessionId)\n    }\n    api.enableWebPush = (enabled, applicationServerKey) => {\n      this.notifications._enableWebPush(enabled, applicationServerKey)\n    }\n    api.tr = (msg) => {\n      _tr(msg, {\n        device: this.#device,\n        session: this.#session,\n        request: this.#request,\n        logger: this.#logger\n      })\n    }\n    api.setEnum = (enumVal) => {\n      setEnum(enumVal, this.#logger)\n    }\n    api.is_onloadcalled = () => {\n      return (this.#onloadcalled === 1)\n    }\n    api.subEmail = (reEncoded) => {\n      _handleEmailSubscription('1', reEncoded)\n    }\n    api.getEmail = (reEncoded, withGroups) => {\n      _handleEmailSubscription('-1', reEncoded, withGroups)\n    }\n    api.unSubEmail = (reEncoded) => {\n      _handleEmailSubscription('0', reEncoded)\n    }\n    api.unsubEmailGroups = (reEncoded) => {\n      $ct.unsubGroups = []\n      const elements = document.getElementsByClassName('ct-unsub-group-input-item')\n\n      for (let i = 0; i < elements.length; i++) {\n        const element = elements[i]\n        if (element.name) {\n          const data = { name: element.name, isUnsubscribed: element.checked }\n          $ct.unsubGroups.push(data)\n        }\n      }\n\n      _handleEmailSubscription(GROUP_SUBSCRIPTION_REQUEST_ID, reEncoded)\n    }\n    api.setSubscriptionGroups = (value) => {\n      $ct.unsubGroups = value\n    }\n    api.getSubscriptionGroups = () => {\n      return $ct.unsubGroups\n    }\n    api.changeSubscriptionGroups = (reEncoded, updatedGroups) => {\n      api.setSubscriptionGroups(updatedGroups)\n      _handleEmailSubscription(GROUP_SUBSCRIPTION_REQUEST_ID, reEncoded)\n    }\n    api.isGlobalUnsubscribe = () => {\n      return $ct.globalUnsubscribe\n    }\n    api.setIsGlobalUnsubscribe = (value) => {\n      $ct.globalUnsubscribe = value\n    }\n    api.setUpdatedCategoryLong = (profile) => {\n      if (profile[categoryLongKey]) {\n        $ct.updatedCategoryLong = profile[categoryLongKey]\n      }\n    }\n    window.$CLTP_WR = window.$WZRK_WR = api\n\n    if (clevertap.account?.[0].id) {\n      // The accountId is present so can init with empty values.\n      // Needed to maintain backward compatability with legacy implementations.\n      // Npm imports/require will need to call init explictly with accountId\n      this.init()\n    }\n  }\n\n  // starts here\n  init (accountId, region, targetDomain, token) {\n    if (this.#onloadcalled === 1) {\n      // already initailsed\n      return\n    }\n    StorageManager.removeCookie('WZRK_P', window.location.hostname)\n    if (!this.#account.id) {\n      if (!accountId) {\n        this.#logger.error(EMBED_ERROR)\n        return\n      }\n      this.#account.id = accountId\n    }\n    this.#session.cookieName = SCOOKIE_PREFIX + '_' + this.#account.id\n\n    if (region) {\n      this.#account.region = region\n    }\n    if (targetDomain) {\n      this.#account.targetDomain = targetDomain\n    }\n    if (token) {\n      this.#account.token = token\n    }\n\n    const currLocation = location.href\n    const urlParams = getURLParams(currLocation.toLowerCase())\n\n    // eslint-disable-next-line eqeqeq\n    if (typeof urlParams.e !== 'undefined' && urlParams.wzrk_ex == '0') {\n      return\n    }\n\n    $ct.isPrivacyArrPushed = true\n    if ($ct.privacyArray.length > 0) {\n      this.privacy.push($ct.privacyArray)\n    }\n\n    this.#processOldValues()\n    this.pageChanged()\n    const backupInterval = setInterval(() => {\n      if (this.#device.gcookie) {\n        clearInterval(backupInterval)\n        this.#request.processBackupEvents()\n      }\n    }, 3000)\n    if (this.#isSpa) {\n      // listen to click on the document and check if URL has changed.\n      document.addEventListener('click', this.#boundCheckPageChanged)\n    } else {\n      // remove existing click listeners if any\n      document.removeEventListener('click', this.#boundCheckPageChanged)\n    }\n    this.#onloadcalled = 1\n  }\n\n  // process the option array provided to the clevertap object\n  // after its been initialized\n  #processOldValues () {\n    this.onUserLogin._processOldValues()\n    this.privacy._processOldValues()\n    this.event._processOldValues()\n    this.profile._processOldValues()\n    this.notifications._processOldValues()\n  }\n\n  #debounce (func) {\n    let timeout\n    return function () {\n      clearTimeout(timeout)\n      timeout = setTimeout(func, 300)\n    }\n  }\n\n  #checkPageChanged () {\n    const debouncedPageChanged = this.#debounce(() => {\n      if (this.#previousUrl !== location.href) {\n        this.pageChanged()\n      }\n    })\n    debouncedPageChanged()\n  }\n\n  pageChanged () {\n    const currLocation = window.location.href\n    const urlParams = getURLParams(currLocation.toLowerCase())\n    // -- update page count\n    const obj = this.#session.getSessionCookieObject()\n    let pgCount = (typeof obj.p === 'undefined') ? 0 : obj.p\n    obj.p = ++pgCount\n    this.#session.setSessionCookieObject(obj)\n    // -- update page count\n\n    let data = {}\n    let referrerDomain = getDomain(document.referrer)\n\n    if (window.location.hostname !== referrerDomain) {\n      const maxLen = 120\n      if (referrerDomain !== '') {\n        referrerDomain = referrerDomain.length > maxLen ? referrerDomain.substring(0, maxLen) : referrerDomain\n        data.referrer = referrerDomain\n      }\n\n      let utmSource = urlParams.utm_source || urlParams.wzrk_source\n      if (typeof utmSource !== 'undefined') {\n        utmSource = utmSource.length > maxLen ? utmSource.substring(0, maxLen) : utmSource\n        data.us = utmSource // utm_source\n      }\n\n      let utmMedium = urlParams.utm_medium || urlParams.wzrk_medium\n      if (typeof utmMedium !== 'undefined') {\n        utmMedium = utmMedium.length > maxLen ? utmMedium.substring(0, maxLen) : utmMedium\n        data.um = utmMedium // utm_medium\n      }\n\n      let utmCampaign = urlParams.utm_campaign || urlParams.wzrk_campaign\n      if (typeof utmCampaign !== 'undefined') {\n        utmCampaign = utmCampaign.length > maxLen ? utmCampaign.substring(0, maxLen) : utmCampaign\n        data.uc = utmCampaign // utm_campaign\n      }\n\n      // also independently send wzrk_medium to the backend\n      if (typeof urlParams.wzrk_medium !== 'undefined') {\n        const wm = urlParams.wzrk_medium\n        if (wm.match(/^email$|^social$|^search$/)) {\n          data.wm = wm // wzrk_medium\n        }\n      }\n    }\n\n    data = this.#request.addSystemDataToObject(data, undefined)\n    data.cpg = currLocation\n\n    data[CAMP_COOKIE_NAME] = getCampaignObjForLc()\n    let pageLoadUrl = this.#account.dataPostURL\n    this.#request.addFlags(data)\n    // send dsync flag when page = 1\n    if (parseInt(data.pg) === 1) {\n      this.#overrideDSyncFlag(data)\n    }\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', 'page')\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n\n    this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n\n    if (parseInt(data.pg) === 1) {\n      this.event.push(WZRK_FETCH, { t: 4 })\n    }\n\n    this.#previousUrl = currLocation\n    setTimeout(() => {\n      if (pgCount <= 3) {\n        // send ping for up to 3 pages\n        this.#pingRequest()\n      }\n\n      if (this.#isPingContinuous()) {\n        setInterval(() => {\n          this.#pingRequest()\n        }, CONTINUOUS_PING_FREQ_IN_MILLIS)\n      }\n    }, FIRST_PING_FREQ_IN_MILLIS)\n  }\n\n  #pingRequest () {\n    let pageLoadUrl = this.#account.dataPostURL\n    let data = {}\n    data = this.#request.addSystemDataToObject(data, undefined)\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PING)\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n\n    this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n  }\n\n  #isPingContinuous () {\n    return (typeof window.wzrk_d !== 'undefined' && window.wzrk_d.ping === 'continuous')\n  }\n\n  _isPersonalisationActive () {\n    return StorageManager._isLocalStorageSupported() && this.enablePersonalization\n  }\n\n  #overrideDSyncFlag (data) {\n    if (this._isPersonalisationActive()) {\n      data.dsync = true\n    }\n  }\n\n  popupCallbacks = {};\n  popupCurrentWzrkId = '';\n\n  // eslint-disable-next-line accessor-pairs\n  set popupCallback (callback) {\n    this.popupCallbacks[this.popupCurrentWzrkId] = callback\n  }\n\n  /**\n   *\n   * @param {object} payload\n   */\n  sendLocationData (payload) {\n    // Send the updated value to LC\n    let data = {}\n    data.af = {}\n    const profileObj = {}\n    data.type = 'profile'\n    if (profileObj.tz == null) {\n      profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n    }\n    data.profile = profileObj\n    if (payload) {\n      const keys = Object.keys(payload)\n      keys.forEach(key => {\n        data.af[key] = payload[key]\n      })\n    }\n    if ($ct.location) {\n      data.af = { ...data.af, ...$ct.location }\n    }\n    data = this.#request.addSystemDataToObject(data, undefined)\n    this.#request.addFlags(data)\n    const compressedData = compressData(JSON.stringify(data), this.#logger)\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n    this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n  }\n\n  // offline mode\n  /**\n   * events will be recorded and queued locally when passed with true\n   * but will not be sent to the server until offline is disabled by passing false\n   * @param {boolean} arg\n   */\n\n  setOffline (arg) {\n    if (typeof arg !== 'boolean') {\n      console.error('setOffline should be called with a value of type boolean')\n      return\n    }\n    $ct.offline = arg\n    // if offline is disabled\n    // process events from cache\n    if (!arg) {\n      this.#request.processBackupEvents()\n    }\n  }\n\n  defineVariable (name, defaultValue) {\n    return Variable.define(name, defaultValue, this.#variableStore)\n  }\n\n  async syncVariables (onSyncSuccess, onSyncFailure) {\n    if (this.#logger.logLevel === 4) {\n      return this.#variableStore.syncVariables(onSyncSuccess, onSyncFailure)\n    } else {\n      this.#logger.error('App log level is not set to 4')\n    }\n  }\n\n  async fetchVariables (onFetchSuccess) {\n    return this.#variableStore.fetchVariables(onFetchSuccess)\n  }\n\n  addVariablesChangedCallback (callback) {\n    this.#variableStore.addVariablesChangedCallback(callback)\n  }\n\n  addOneTimeVariablesChangedCallback (callback) {\n    this.#variableStore.addOneTimeVariablesChangedCallback(callback)\n  }\n}\n","import 'regenerator-runtime/runtime.js'\nimport Clevertap from './clevertap'\n\nconst clevertap = new Clevertap(window.clevertap)\n\nwindow.clevertap = window.wizrocket = clevertap\n\nexport default clevertap\n"],"names":["runtime","exports","Op","Object","prototype","hasOwn","hasOwnProperty","defineProperty","obj","key","desc","value","undefined","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","makeInvokeMethod","tryCatch","fn","arg","type","call","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","displayName","defineIteratorMethods","forEach","method","_invoke","isGeneratorFunction","genFun","ctor","constructor","name","mark","setPrototypeOf","__proto__","awrap","__await","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","result","then","unwrapped","error","previousPromise","enqueue","callInvokeWithMethodAndArg","async","Promise","iter","next","done","state","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","methodName","TypeError","info","resultName","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","keys","val","object","reverse","length","pop","iterable","iteratorMethod","isNaN","i","skipTempReset","prev","charAt","slice","stop","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","module","regeneratorRuntime","accidentalStrictMode","globalThis","Function","TARGET_DOMAIN","TARGET_PROTOCOL","DEFAULT_REGION","Account","id","region","targetDomain","token","accountId","dcSDKVersion","finalTargetDomain","dataPostPEURL","dataPostURL","recorderURL","emailURL","unsupportedKeyCharRegex","RegExp","unsupportedValueCharRegex","singleQuoteRegex","CLEAR","CHARGED_ID","CHARGEDID_COOKIE_NAME","GCOOKIE_NAME","KCOOKIE_NAME","CAMP_COOKIE_NAME","CAMP_COOKIE_G","SCOOKIE_PREFIX","SCOOKIE_EXP_TIME_IN_SECS","EV_COOKIE","META_COOKIE","PR_COOKIE","ARP_COOKIE","LCOOKIE_NAME","GLOBAL","DISPLAY","WEBPUSH_LS_KEY","OPTOUT_KEY","CT_OPTOUT_KEY","OPTOUT_COOKIE_ENDSWITH","USEIP_KEY","LRU_CACHE","LRU_CACHE_SIZE","IS_OUL","EVT_PUSH","EVT_PING","COOKIE_EXPIRY","MAX_TRIES","FIRST_PING_FREQ_IN_MILLIS","CONTINUOUS_PING_FREQ_IN_MILLIS","GROUP_SUBSCRIPTION_REQUEST_ID","categoryLongKey","WZRK_PREFIX","WZRK_ID","NOTIFICATION_VIEWED","NOTIFICATION_CLICKED","FIRE_PUSH_UNREGISTERED","PUSH_SUBSCRIPTION_DATA","COMMAND_INCREMENT","COMMAND_DECREMENT","COMMAND_SET","COMMAND_ADD","COMMAND_REMOVE","COMMAND_DELETE","WEBINBOX_CONFIG","WEBINBOX","MAX_INBOX_MSG","VARIABLES","PUSH_DELAY_MS","MAX_DELAY_FREQUENCY","WZRK_FETCH","SYSTEM_EVENTS","isString","input","String","isObject","toString","isDateObject","Date","isObjectEmpty","prop","isConvertibleToNumber","n","parseFloat","isFinite","isNumber","test","isValueValid","removeUnsupportedChars","o","logger","sanitizedVal","sanitizedKey","sanitize","substring","reportError","regex","replace","getToday","today","getFullYear","getMonth","getDay","getNow","Math","floor","getTime","convertToWZRKDate","dateObj","round","setDate","dt","isDateValid","date","matches","exec","d","m","y","composedDate","getDate","StorageManager","save","_isLocalStorageSupported","localStorage","setItem","JSON","stringify","read","data","getItem","parse","e","remove","removeItem","removeCookie","domain","cookieStr","document","cookie","createCookie","seconds","expires","domainStr","setTime","toGMTString","encodeURIComponent","readCookie","nameEQ","ca","split","idx","c","indexOf","decodeURIComponent","window","saveToLSorCookie","property","location","hostname","$ct","globalCache","readFromLSorCookie","trim","createBroadCookie","broadDomain","domainParts","testBroadDomain","testCookieName","tempCookie","getMetaProp","metaObj","setMetaProp","wzrkMetaObj","getAndClearMetaProp","setInstantDeleteFlagInK","k","flag","backupEvent","reqNo","backupArr","q","debug","removeBackup","respNo","backupMap","gcookie","REQ_N","RESP_N","globalProfileMap","globalEventsMap","blockRequest","isOptInRequest","webPushEnabled","campaignDivMap","currentSessionId","wiz_counter","notifApi","notifEnabledFromApi","unsubGroups","updatedCategoryLong","inbox","isPrivacyArrPushed","privacyArray","offline","dismissSpamControl","globalUnsubscribe","flutterVersion","variableStore","LRUCache","max","lruCache","tempLruCache","cache","get","item","saveCacheToLS","set","allKeys","objToArray","index","temp","getKey","getSecondLastKey","keysArr","getLastKey","keysLength","newCache","indexToDelete","splice","CleverTapAPI","request","device","session","s","global","resume","respNumber","optOutResponse","oulReq","newGuid","isOULInProgress","oulReqN","sessionObj","getSessionCookieObject","kIdFromLS","guidFromLRUCache","lastK","lastGUID","unregisterTokenForGuid","manageSession","t","setSessionCookieObject","processingBackup","processBackupEvents","DeviceManager","getGuid","guid","DATA_NOT_SENT_TEXT","CLEVERTAP_ERROR_PREFIX","EMBED_ERROR","EVENT_ERROR","GENDER_ERROR","EMPLOYED_ERROR","MARRIED_ERROR","EDUCATION_ERROR","AGE_ERROR","DOB_ERROR","ENUM_FORMAT_ERROR","PHONE_FORMAT_ERROR","_globalChargedId","isEventStructureFlat","eventObj","Array","isArray","isChargedEventStructureValid","chargedObj","itemKey","chargedId","EventHandler","isPersonalisationActive","eventsArr","_processOldValues","getDetails","evtName","evtObj","respObj","firstTime","lastTime","count","eventName","shift","includes","unshift","evtData","processEvent","getURLParams","url","urlParams","uri","match","pl","search","decode","replacement","getDomain","a","createElement","href","addToURL","v","getHostName","urlBase64ToUint8Array","base64String","padding","repeat","base64","rawData","atob","processedData","charCodeAt","Uint8Array","compressData","dataObject","compressToBase64","compress","uncompressed","context_dictionary","context_dictionaryToCreate","context_c","context_wc","context_w","context_enlargeIn","context_dictSize","context_numBits","context_data_string","context_data_val","context_data_position","ii","f","fromCharCode","pow","getKeyStr","_keyStr","output","chr1","chr2","chr3","enc1","enc2","enc3","enc4","NaN","RequestDispatcher","networkRetryCount","minDelayFrequency","fireRequest","skipARP","sendOULFlag","getDelayFrequency","account","randomDelay","random","skipResARP","_arp","pageLoadUrl","useIP","tries","setTimeout","clevertap","wizrocket","plugin","ctCbScripts","getElementsByClassName","parentNode","removeChild","setAttribute","getElementsByTagName","appendChild","getCampaignObject","finalcampObj","campObj","wp","saveCampaignObject","campaignObj","newObj","setCampaignObjectForGuid","guidCampObj","finalCampObj","campKeyObj","globalObj","dailyObj","campaignIdArray","resultObj","dailyC","totalC","campaignId","console","getCampaignObjForLc","storageValue","decodedValue","parsedValue","resultObjWP","resultObjWI","wi","todayCwp","todayCwi","tc","wmp","wimp","tlc","witlc","isProfileValid","profileObj","valid","profileKey","profileVal","Age","Phone","processFBUserObj","user","profileData","Name","FBID","gender","Gender","getHighestEducation","eduArr","college","highschool","edu","relationship_status","Married","education","Education","work","Employed","email","Email","birthday","mmddyy","DOB","processGPlusUserObj","GPID","image","isDefault","Photo","emails","emailIdx","emailObj","organizations","orgObj","yyyymmdd","relationshipStatus","addToLocalProfileMap","override","_custom","closeIframe","divIdIgnored","sessionCampaignObj","divId","getElementById","style","display","arp","jsonMap","isOULARP","arpFromStorage","setEnum","enumVal","handleEmailSubscription","subscription","reEncoded","fetchGroups","urlParamsAsIs","encodedEmailId","encodedProfileProps","p","pageType","page_type","ProfileHandler","profilesArr","getAttribute","propName","_handleIncrementDecrementValue","command","tz","profile","addSystemDataToObject","addFlags","compressedData","saveAndFireRequest","_handleMultiValueSet","arrayVal","array","toLowerCase","sendMultiValueData","_handleMultiValueAdd","propKey","propVal","_handleMultiValueRemove","_handleMultiValueDelete","profileArr","outerObj","Site","Facebook","FbProfileObj","GPlusProfileObj","UserLoginHandler","clear","addToK","ids","g","kId","anonymousUser","foundInCache","gFromCache","Identity","cookieName","loginArr","processProfile","CTWebPersonalisationBanner","HTMLElement","_details","shadow","attachShadow","mode","details","renderBanner","innerHTML","getBannerContent","trackClick","addEventListener","onClickUrl","onClick","open","parent","renderNotificationClicked","msgId","pivotId","renderNotificationViewed","divHeight","css","desktopImageURL","mobileImageURL","html","CTWebPersonalisationCarousel","_target","_carousel","slides","previouslySelectedItem","selectedItem","autoSlide","stopAutoSlideTimeout","customElements","target","renderCarousel","getStyles","carousel","getCarouselContent","showNavBtns","insertAdjacentHTML","navBtnsHtml","showNavArrows","leftNavArrowHtml","rightNavArrowHtml","setupClick","updateSelectedItem","startAutoSlide","setupOnHover","wzrk_id","wzrk_pivot","event","eventID","startsWith","selected","endsWith","goToNext","goToPrev","wzrk_slideNo","clearInterval","clearTimeout","detail","banner","classList","add","navBtnsCss","navArrowsCss","prevItem","prevButton","button","setInterval","sliderTime","goTo","cur","CTWebPopupImageOnly","_session","popup","container","resizeObserver","renderImageOnlyPopup","sessionId","getImageOnlyPopupContent","shadowRoot","closeIcon","updateImageAndContainerWidth","ResizeObserver","handleResize","observe","unobserve","width","getRenderedImageWidth","setProperty","msgContent","visibility","img","ratio","naturalWidth","naturalHeight","height","Message","config","message","wrapper","snackBar","renderMessage","createEl","part","_el","msg","templateType","prepareBasicMessage","timeStamp","determineTimeStampText","viewed","unreadMarker","imageUrl","imageContainer","addImage","iconTitleDescWrapper","iconUrl","iconContainer","titleDescWrapper","title","innerText","description","buttons","buttonsContainer","addButtons","hasCopyAction","b","text","cssText","action","addSnackbar","greenTickSvg","clipboardMsg","raiseClickedEvent","path","isPreview","raiseClickedForBasicTemplates","payload","tagName","kv","wzrk_c2a","openUrlInNewTab","focus","navigator","clipboard","writeText","clipboardText","log","messageStyles","backgroundColor","borderColor","titleColor","descriptionColor","buttonColor","buttonTextColor","unreadMarkerColor","inboxContainerStyles","panelBackgroundColor","panelBorderColor","headerBackgroundColor","headerTitleColor","closeIconColor","categoriesTabColor","categoriesTitleColor","categoriesBorderColor","selectedCategoryTabColor","selectedCategoryTitleColor","selectedCategoryBorderColor","headerCategoryHeight","Inbox","isInboxOpen","isInboxFromFlutter","selectedCategory","unviewedMessages","unviewedCounter","inboxConfigForPreview","inboxSelector","emptyInboxMsg","inboxCard","unviewedBadge","observer","selectedCategoryRef","addClickListenerOnDocument","composedPath","toggleInbox","prevCategoryRef","updateActiveCategory","_path","filter","messageEl","contains","setBadgeStyle","msgCount","incomingMessages","msgs","updateInboxMessages","incomingMessagesForPreview","previewMsgs","now","buildUIForMessages","updateUnviewedBadgeCounter","connectedCallback","init","styles","notificationsBadge","addUnviewedBadge","createinbox","removeEventListener","categories","getInboxStyles","addMsgsToInboxFromLS","messages","deleteExpiredAndGetUnexpiredMsgs","msgIds","deleteMsgsFromUI","getInboxMessages","wzrk_ttl","el","sort","reduce","acc","saveInboxMessages","inboxMsgs","incomingMsgs","textColor","body","updateUnviewedBadgePosition","top","right","getBoundingClientRect","left","header","headerTitle","createCategories","options","root","rootMargin","threshold","IntersectionObserver","entries","handleMessageViewed","categoriesContainer","leftArrow","arrowSvg","children","scrollBy","categoriesWrapper","_categories","category","rightArrow","firstCategory","lastCategory","firstCategoryObserver","categoryObserverCb","intersectionRatio","lastCategoryObserver","hide","activeCategory","scrollTop","counter","childNodes","updateTSForRenderedMsgs","maxMsgsInInbox","firstChild","sortedMsgs","map","tags","insertBefore","msgTotalCount","querySelectorAll","ctInboxMsgs","hasMessages","raiseViewedEvent","isIntersecting","updateMessageInLS","rect","zIndex","scrollLeft","scrollWidth","setInboxPosition","windowWidth","outerWidth","customInboxStyles","getComputedStyle","getPropertyValue","bottom","hasPositionDefined","res","getInboxPosition","clientHeight","clientWidth","xPos","yPos","ts","headerHeight","categoriesHeight","tabColor","selectedTab","inboxStyles","cardStyles","cards","msgStyles","processWebInboxSettings","webInboxSetting","_settings","processInboxNotifs","inbox_preview","inbox_notifs","addWebInbox","checkAndRegisterWebInboxElements","getAndMigrateInboxMessages","gudInboxObj","storedInboxObj","initializeWebInbox","readyState","onLoaded","inboxHeight","inboxWidth","horizontalScroll","scrollingElement","verticalScroll","innerWidth","windowHeight","innerHeight","selectorRect","selectorX","x","selectorY","selectorLeft","selectorRight","selectorTop","selectorBottom","selectorHeight","selectorWidth","selectorCenter","halfOfInboxHeight","halfOfInboxWidth","inboxOnSide","availableHeight","inboxRight","availableWidth","inboxLeft","diff","hasWebInboxSettingsInLS","_tr","_device","_request","_logger","_wizCounter","doCampHouseKeeping","targetingMsgJson","incrCount","excludeFromFreqCaps","currentCount","totalCount","sessionStorage","campTypeObj","wtarget_type","wmc","wimc","campaignSessionLimit","campaignDailyLimit","campaignTotalLimit","totalDailyLimit","totalSessionLimit","totalInboxSessionLimit","efc","parseInt","mdc","tdc","campaignSessionCount","totalSessionCount","campaignDailyCount","totalDailyCount","campaignTotalCount","delay","campKey","newCampObj","getCookieParams","scookieObj","setupClickEvent","contentDiv","isLegacy","ctaElement","jsCTAElements","jsFunc","preview","onclick","invokeExternalJs","func","setupClickUrl","incrementImpression","renderPersonalisationBanner","divSelector","bannerEl","containerEl","querySelector","renderPersonalisationCarousel","renderPopUpImageOnly","popupImageOnly","renderFooterNotification","displayObj","inaObj","kvPairsEvent","CustomEvent","dispatchEvent","layout","showExitIntent","element","msgDiv","isBanner","viewHeight","viewWidth","legacy","marginBottom","contentHeight","bottomPosition","widthPerct","userAgent","proto","iFrameStyle","iframe","borderRadius","br","frameborder","marginheight","marginwidth","scrolling","pointerCss","bgColor","btnBg","leftTd","btColor","theme","titleText","descriptionText","imageTd","onClickStr","ifrm","contentWindow","contentDocument","doc","closeCampaign","Event","write","appendScriptForCustomEvent","close","adjustIFrameHeight","scrollHeight","margin","ua","onload","inDoc","_timer","script","_callBackCalled","showFooterNotification","notificationCallback","raiseNotificationClicked","raiseNotificationViewed","popupCurrentWzrkId","popupCallbacks","popupCallback","msgCTkv","wzrkPrefixKey","wzrkJson","raisePopupNotificationClicked","notificationData","eventData","wzrkPrefixObj","exitintentObj","targetObj","clientY","opacityDiv","opacity","rgbaColor","ctaText","processNativeDisplayArr","arrInAppNotifs","elementId","addLoadListener","inapp_notifs","targetNotif","onmouseleave","mergeEventMap","newEvtMap","oldEvtObj","newEvtObj","handleInboxNotifications","msgArr","catch","vars","mergeVariables","staleDataUpdate","staledata","campType","evpr","eventsMap","events","profileMap","syncExpiry","expires_in","inapp_stale","inbox_stale","User","getTotalVisits","visitCount","getLastVisit","prevSession","logLevels","DISABLE","ERROR","INFO","DEBUG","DEBUG_PE","Logger","logLevel","wzrkError","debugPE","code","level","WZRK_D","SessionManager","scookieStr","objStr","currentSessionInLS","sessionCount","getTimeElapsed","sessionStart","getPageCount","seqNo","requestTime","RequestManager","fired","ignoreTrim","wzrk_error","pg","protocol","af","lib","rc","lastSyncTime","expirySeconds","dsync","givenGUID","registerToken","post","response","fetch","headers","ok","json","nowTs","evtDetail","Privacy","privacyArr","privacyObj","curr","optOut","shouldUseIP","NotificationHandler","displayArgs","_enableWebPush","enabled","applicationServerKey","subscriptionCallback","serviceWorkerPath","apnsWebPushId","apnsServiceUrl","safari","pushNotification","requestPermission","permission","subscriptionData","endpoint","deviceToken","browser","registrationScope","serviceWorker","register","registration","__wzrk_account_id","scope","rootDirRegex","isServiceWorkerAtRoot","ready","getRegistrations","serviceWorkerRegistration","subscribeObj","userVisibleOnly","pushManager","subscribe","getSubscription","unsubscribe","successful","scriptTag","bodyText","okButtonText","rejectButtonText","okButtonColor","skipDialog","askAgainTimeInSeconds","okCallback","rejectCallback","httpsPopupPath","httpsIframePath","apnsWebPushServiceUrl","notifObj","isHTTP","chromeAgent","firefoxAgent","safariAgent","Notification","httpsIframe","from","wzrkPermissionPopup","wizAlert","confirmButtonText","confirmButtonColor","Variable","defaultValue","hadStarted","valueChangedCallbacks","getValue","getdefaultValue","existing","getVariable","varInstance","registerVariable","update","newValue","oldValue","hasVarsRequestCompleted","triggerValueChanged","onValueChanged","addValueChangedCallback","removeValueChangedCallback","clearStartFlag","VariableStore","syncVariables","onSyncSuccess","onSyncFailure","meta","tk","r","status","fetchVariables","onFetchComplete","addVariablesChangedCallback","callback","addOneTimeVariablesChangedCallback","removeVariablesChangedCallback","removeOneTimeVariablesChangedCallback","callBack","CleverTap","spa","isSpa","bind","enablePersonalization","_isPersonalisationActive","ReqestManager","onUserLogin","privacy","notifications","logout","getCleverTapID","getAccountID","getSCDomain","setLibrary","libName","libVersion","setSCSDKVersion","ver","scSDKVersion","scv","getInboxMessageCount","getInboxMessageUnreadCount","getAllInboxMessages","getUnreadInboxMessages","getInboxMessageForId","messageId","deleteInboxMessage","markReadInboxMessage","unreadMsg","markReadInboxMessagesForIds","messageIds","markReadAllInboxMessage","processNotificationEvent","eventDetail","setLogLevel","l","Number","handleIncrementValue","handleDecrementValue","setMultiValuesForKey","addMultiValueForKey","addMultiValuesForKey","removeMultiValueForKey","removeMultiValuesForKey","removeValueForKey","_handleEmailSubscription","getLocation","lat","lng","Latitude","Longitude","sendLocationData","geolocation","getCurrentPosition","showPosition","showError","position","coords","latitude","longitude","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","UNKNOWN_ERROR","api","enableWebPush","tr","is_onloadcalled","subEmail","getEmail","withGroups","unSubEmail","unsubEmailGroups","elements","isUnsubscribed","checked","setSubscriptionGroups","getSubscriptionGroups","changeSubscriptionGroups","updatedGroups","isGlobalUnsubscribe","setIsGlobalUnsubscribe","setUpdatedCategoryLong","$CLTP_WR","$WZRK_WR","currLocation","wzrk_ex","pageChanged","backupInterval","pgCount","referrerDomain","referrer","maxLen","utmSource","utm_source","wzrk_source","us","utmMedium","utm_medium","wzrk_medium","um","utmCampaign","utm_campaign","wzrk_campaign","uc","wm","cpg","setOffline","defineVariable","onFetchSuccess","timeout","debouncedPageChanged","wzrk_d","ping","Clevertap"],"mappings":"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"}