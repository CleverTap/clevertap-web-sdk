{"version":3,"file":"clevertap.js","sources":["src/options.js","src/modules/account.js","src/util/constants.js","src/util/datatypes.js","src/util/datetime.js","src/util/storage.js","src/util/lruCache.js","src/modules/api.js","src/modules/device.js","src/util/messages.js","src/util/validator.js","src/modules/event.js","src/util/url.js","src/util/encoder.js","src/util/requestDispatcher.js","src/util/clevertap.js","src/modules/profile.js","src/modules/userLogin.js","src/util/web-personalisation/banner.js","src/util/web-personalisation/carousel.js","src/util/web-popupImageonly/popupImageonly.js","src/modules/web-inbox/Message.js","src/modules/web-inbox/inboxStyles.js","src/modules/web-inbox/WebInbox.js","src/modules/web-inbox/helper.js","src/modules/visualBuilder/builder_constants.js","src/modules/visualBuilder/dataUpdate.js","src/modules/visualBuilder/pageBuilder.js","src/modules/webPushPrompt/promptStyles.js","src/modules/notification.js","src/modules/webPushPrompt/prompt.js","src/util/tr.js","src/modules/user.js","src/modules/logger.js","src/modules/session.js","src/modules/request.js","src/modules/privacy.js","src/modules/variables/variable.js","src/modules/variables/variableStore.js","src/clevertap.js","src/main.js"],"sourcesContent":["export const TARGET_DOMAIN = 'clevertap-prod.com'\nexport const TARGET_PROTOCOL = 'https:'\nexport const DEFAULT_REGION = 'eu1'\n","import { DEFAULT_REGION, TARGET_DOMAIN, TARGET_PROTOCOL } from '../options'\n\nexport default class Account {\n  #accountId\n  #region = ''\n  #targetDomain = TARGET_DOMAIN\n  #dcSdkversion = ''\n  #token = ''\n\n  constructor ({ id } = {}, region = '', targetDomain = TARGET_DOMAIN, token = '') {\n    this.id = id\n    if (region) {\n      this.region = region\n    }\n    if (targetDomain) {\n      this.targetDomain = targetDomain\n    }\n    if (token) {\n      this.token = token\n    }\n  }\n\n  get id () {\n    return this.#accountId\n  }\n\n  set id (accountId) {\n    this.#accountId = accountId\n  }\n\n  get region () {\n    return this.#region\n  }\n\n  set region (region) {\n    this.#region = region\n  }\n\n  get dcSDKVersion () {\n    return this.#dcSdkversion\n  }\n\n  set dcSDKVersion (dcSDKVersion) {\n    this.#dcSdkversion = dcSDKVersion\n  }\n\n  get targetDomain () {\n    return this.#targetDomain\n  }\n\n  set targetDomain (targetDomain) {\n    this.#targetDomain = targetDomain\n  }\n\n  get token () {\n    return this.#token\n  }\n\n  set token (token) {\n    this.#token = token\n  }\n\n  get finalTargetDomain () {\n    if (this.region) {\n      return `${this.region}.${this.targetDomain}`\n    } else {\n      if (this.targetDomain === TARGET_DOMAIN) {\n        return `${DEFAULT_REGION}.${this.targetDomain}`\n      }\n      return this.targetDomain\n    }\n  }\n\n  get dataPostPEURL () {\n    return `${TARGET_PROTOCOL}//${this.finalTargetDomain}/defineVars`\n  }\n\n  get dataPostURL () {\n    return `${TARGET_PROTOCOL}//${this.finalTargetDomain}/a?t=96`\n  }\n\n  get recorderURL () {\n    return `${TARGET_PROTOCOL}//${this.finalTargetDomain}/r?r=1`\n  }\n\n  get emailURL () {\n    return `${TARGET_PROTOCOL}//${this.finalTargetDomain}/e?r=1`\n  }\n}\n","export const unsupportedKeyCharRegex = new RegExp('^\\\\s+|\\\\\\.|\\:|\\\\\\$|\\'|\\\"|\\\\\\\\|\\\\s+$', 'g')\nexport const unsupportedValueCharRegex = new RegExp(\"^\\\\s+|\\'|\\\"|\\\\\\\\|\\\\s+$\", 'g')\nexport const doubleQuoteRegex = new RegExp('\\\"', 'g')\nexport const singleQuoteRegex = new RegExp('\\'', 'g')\nexport const CLEAR = 'clear'\nexport const CHARGED_ID = 'Charged ID'\nexport const CHARGEDID_COOKIE_NAME = 'WZRK_CHARGED_ID'\nexport const GCOOKIE_NAME = 'WZRK_G'\nexport const KCOOKIE_NAME = 'WZRK_K'\nexport const CAMP_COOKIE_NAME = 'WZRK_CAMP'\nexport const CAMP_COOKIE_G = 'WZRK_CAMP_G'// cookie for storing campaign details against guid\nexport const SCOOKIE_PREFIX = 'WZRK_S'\nexport const SCOOKIE_EXP_TIME_IN_SECS = 60 * 20 // 20 mins\nexport const EV_COOKIE = 'WZRK_EV'\nexport const META_COOKIE = 'WZRK_META'\nexport const PR_COOKIE = 'WZRK_PR'\nexport const ARP_COOKIE = 'WZRK_ARP'\nexport const LCOOKIE_NAME = 'WZRK_L'\nexport const NOTIF_COOKIE_NAME = 'WZRK_N'\nexport const GLOBAL = 'global' // used for email unsubscribe also\nexport const TOTAL_COUNT = 'tc'\nexport const DISPLAY = 'display'\nexport const UNDEFINED = 'undefined'\nexport const WEBPUSH_LS_KEY = 'WZRK_WPR'\nexport const OPTOUT_KEY = 'optOut'\nexport const CT_OPTOUT_KEY = 'ct_optout'\nexport const OPTOUT_COOKIE_ENDSWITH = ':OO'\nexport const USEIP_KEY = 'useIP'\nexport const LRU_CACHE = 'WZRK_X'\nexport const LRU_CACHE_SIZE = 100\nexport const IS_OUL = 'isOUL'\nexport const EVT_PUSH = 'push'\nexport const EVT_PING = 'ping'\nexport const COOKIE_EXPIRY = 86400 * 365 // 1 Year in seconds\nexport const MAX_TRIES = 200 // API tries\nexport const FIRST_PING_FREQ_IN_MILLIS = 2 * 60 * 1000 // 2 mins\nexport const CONTINUOUS_PING_FREQ_IN_MILLIS = 5 * 60 * 1000 // 5 mins\nexport const GROUP_SUBSCRIPTION_REQUEST_ID = '2'\nexport const categoryLongKey = 'cUsY'\nexport const WZRK_PREFIX = 'wzrk_'\nexport const WZRK_ID = 'wzrk_id'\nexport const NOTIFICATION_VIEWED = 'Notification Viewed'\nexport const NOTIFICATION_CLICKED = 'Notification Clicked'\nexport const FIRE_PUSH_UNREGISTERED = 'WZRK_FPU'\nexport const PUSH_SUBSCRIPTION_DATA = 'WZRK_PSD' // PUSH SUBSCRIPTION DATA FOR REGISTER/UNREGISTER TOKEN\nexport const COMMAND_INCREMENT = '$incr'\nexport const COMMAND_DECREMENT = '$decr'\nexport const COMMAND_SET = '$set'\nexport const COMMAND_ADD = '$add'\nexport const COMMAND_REMOVE = '$remove'\nexport const COMMAND_DELETE = '$delete'\nexport const WEBINBOX_CONFIG = 'WZRK_INBOX_CONFIG'\nexport const WEBINBOX = 'WZRK_INBOX'\nexport const MAX_INBOX_MSG = 15\nexport const VARIABLES = 'WZRK_PE'\nexport const PUSH_DELAY_MS = 1000\nexport const MAX_DELAY_FREQUENCY = 1000 * 60 * 10\nexport const WZRK_FETCH = 'wzrk_fetch'\nexport const WEBPUSH_CONFIG = 'WZRK_PUSH_CONFIG'\n\nexport const SYSTEM_EVENTS = [\n  'Stayed',\n  'UTM Visited',\n  'App Launched',\n  'Notification Sent',\n  NOTIFICATION_VIEWED,\n  NOTIFICATION_CLICKED\n]\n","import {\n  unsupportedKeyCharRegex,\n  unsupportedValueCharRegex\n} from './constants'\n\nexport const isString = (input) => {\n  return (typeof input === 'string' || input instanceof String)\n}\n\nexport const isObject = (input) => {\n  // TODO: refine\n  return Object.prototype.toString.call(input) === '[object Object]'\n}\n\nexport const isDateObject = (input) => {\n  return typeof (input) === 'object' && (input instanceof Date)\n}\n\nexport const isObjectEmpty = (obj) => {\n  for (const prop in obj) {\n    if (obj.hasOwnProperty(prop)) { return false }\n  }\n  return true\n}\n\nexport const isConvertibleToNumber = (n) => {\n  return !isNaN(parseFloat(n)) && isFinite(n)\n}\n\nexport const isNumber = (n) => {\n  return /^-?[\\d.]+(?:e-?\\d+)?$/.test(n) && typeof n === 'number'\n}\n\nexport const isValueValid = (value) => {\n  if (value === null || value === undefined || value === 'undefined') {\n    return false\n  }\n  return true\n}\n\nexport const arrayContains = (arr, obj) => {\n  var i = arr.length\n  while (i--) {\n    if (arr[i] === obj) {\n      return true\n    }\n  }\n  return false\n}\n\nexport const removeUnsupportedChars = (o, logger) => {\n  // keys can't be greater than 1024 chars, values can't be greater than 1024 chars\n  if (typeof o === 'object') {\n    for (const key in o) {\n      if (o.hasOwnProperty(key)) {\n        const sanitizedVal = removeUnsupportedChars(o[key], logger)\n        let sanitizedKey\n        sanitizedKey = sanitize(key, unsupportedKeyCharRegex)\n        if (sanitizedKey.length > 1024) {\n          sanitizedKey = sanitizedKey.substring(0, 1024)\n          logger.reportError(520, sanitizedKey + '... length exceeded 1024 chars. Trimmed.')\n        }\n        delete o[key]\n        o[sanitizedKey] = sanitizedVal\n      }\n    }\n  } else {\n    let val\n\n    if (isString(o)) {\n      val = sanitize(o, unsupportedValueCharRegex)\n      if (val.length > 1024) {\n        val = val.substring(0, 1024)\n        logger.reportError(521, val + '... length exceeded 1024 chars. Trimmed.')\n      }\n    } else {\n      val = o\n    }\n    return val\n  }\n  return o\n}\n\nexport const sanitize = (input, regex) => {\n  return input.replace(regex, '')\n}\n","export const getToday = () => {\n  const today = new Date()\n  return today.getFullYear() + '' + today.getMonth() + '' + today.getDay()\n}\n\nexport const getNow = () => {\n  return Math.floor((new Date()).getTime() / 1000)\n}\n\nexport const convertToWZRKDate = (dateObj) => {\n  return ('$D_' + Math.round(dateObj.getTime() / 1000))\n}\n\nexport const setDate = (dt) => {\n  // expecting  yyyymmdd format either as a number or a string\n  if (isDateValid(dt)) {\n    return '$D_' + dt\n  }\n}\n\nexport const isDateValid = (date) => {\n  const matches = /^(\\d{4})(\\d{2})(\\d{2})$/.exec(date)\n  if (matches == null) return false\n  const d = matches[3]\n  const m = matches[2] - 1\n  const y = matches[1]\n  const composedDate = new Date(y, m, d)\n  // eslint-disable-next-line eqeqeq\n  return composedDate.getDate() == d && composedDate.getMonth() == m && composedDate.getFullYear() == y\n}\n","import {\n  GCOOKIE_NAME,\n  META_COOKIE,\n  KCOOKIE_NAME,\n  LCOOKIE_NAME\n} from './constants'\nexport class StorageManager {\n  static save (key, value) {\n    if (!key || !value) {\n      return false\n    }\n    if (this._isLocalStorageSupported()) {\n      localStorage.setItem(key, typeof value === 'string' ? value : JSON.stringify(value))\n      return true\n    }\n  }\n\n  static read (key) {\n    if (!key) {\n      return false\n    }\n    let data = null\n    if (this._isLocalStorageSupported()) {\n      data = localStorage.getItem(key)\n    }\n    if (data != null) {\n      try {\n        data = JSON.parse(data)\n      } catch (e) {}\n    }\n    return data\n  }\n\n  static remove (key) {\n    if (!key) {\n      return false\n    }\n    if (this._isLocalStorageSupported()) {\n      localStorage.removeItem(key)\n      return true\n    }\n  }\n\n  static removeCookie (name, domain) {\n    let cookieStr = name + '=; expires=Thu, 01 Jan 1970 00:00:01 GMT;'\n\n    if (domain) {\n      cookieStr = cookieStr + ' domain=' + domain + '; path=/'\n    }\n\n    document.cookie = cookieStr\n  }\n\n  static createCookie (name, value, seconds, domain) {\n    let expires = ''\n    let domainStr = ''\n    if (seconds) {\n      const date = new Date()\n      date.setTime(date.getTime() + (seconds * 1000))\n\n      expires = '; expires=' + date.toGMTString()\n    }\n\n    if (domain) {\n      domainStr = '; domain=' + domain\n    }\n\n    value = encodeURIComponent(value)\n\n    document.cookie = name + '=' + value + expires + domainStr + '; path=/'\n  }\n\n  static readCookie (name) {\n    const nameEQ = name + '='\n    const ca = document.cookie.split(';')\n    for (let idx = 0; idx < ca.length; idx++) {\n      let c = ca[idx]\n      while (c.charAt(0) === ' ') {\n        c = c.substring(1, c.length)\n      }\n      // eslint-disable-next-line eqeqeq\n      if (c.indexOf(nameEQ) == 0) {\n        return decodeURIComponent(c.substring(nameEQ.length, c.length))\n      }\n    }\n    return null\n  }\n\n  static _isLocalStorageSupported () {\n    return 'localStorage' in window && window.localStorage !== null && typeof window.localStorage.setItem === 'function'\n  }\n\n  static saveToLSorCookie (property, value) {\n    if (value == null) {\n      return\n    }\n    try {\n      if (this._isLocalStorageSupported()) {\n        this.save(property, encodeURIComponent(JSON.stringify(value)))\n      } else {\n        if (property === GCOOKIE_NAME) {\n          this.createCookie(property, encodeURIComponent(value), 0, window.location.hostname)\n        } else {\n          this.createCookie(property, encodeURIComponent(JSON.stringify(value)), 0, window.location.hostname)\n        }\n      }\n      $ct.globalCache[property] = value\n    } catch (e) {}\n  }\n\n  static readFromLSorCookie (property) {\n    let data\n    if ($ct.globalCache.hasOwnProperty(property)) {\n      return $ct.globalCache[property]\n    }\n    if (this._isLocalStorageSupported()) {\n      data = this.read(property)\n    } else {\n      data = this.readCookie(property)\n    }\n\n    if (data !== null && data !== undefined && !(typeof data.trim === 'function' && data.trim() === '')) {\n      let value\n      try {\n        value = JSON.parse(decodeURIComponent(data))\n      } catch (err) {\n        value = decodeURIComponent(data)\n      }\n      $ct.globalCache[property] = value\n      return value\n    }\n  }\n\n  static createBroadCookie (name, value, seconds, domain) {\n    // sets cookie on the base domain. e.g. if domain is baz.foo.bar.com, set cookie on \".bar.com\"\n    // To update an existing \"broad domain\" cookie, we need to know what domain it was actually set on.\n    // since a retrieved cookie never tells which domain it was set on, we need to set another test cookie\n    // to find out which \"broadest\" domain the cookie was set on. Then delete the test cookie, and use that domain\n    // for updating the actual cookie.\n\n    if (domain) {\n      let broadDomain = $ct.broadDomain\n      if (broadDomain == null) { // if we don't know the broadDomain yet, then find out\n        const domainParts = domain.split('.')\n        let testBroadDomain = ''\n        for (let idx = domainParts.length - 1; idx >= 0; idx--) {\n          if (idx === 0) {\n            testBroadDomain = domainParts[idx] + testBroadDomain\n          } else {\n            testBroadDomain = '.' + domainParts[idx] + testBroadDomain\n          }\n\n          // only needed if the cookie already exists and needs to be updated. See note above.\n          if (this.readCookie(name)) {\n            // no guarantee that browser will delete cookie, hence create short lived cookies\n            var testCookieName = 'test_' + name + idx\n            this.createCookie(testCookieName, value, 10, testBroadDomain) // self-destruct after 10 seconds\n            if (!this.readCookie(testCookieName)) { // if test cookie not set, then the actual cookie wouldn't have been set on this domain either.\n              continue\n            } else { // else if cookie set, then delete the test and the original cookie\n              this.removeCookie(testCookieName, testBroadDomain)\n            }\n          }\n\n          this.createCookie(name, value, seconds, testBroadDomain)\n          const tempCookie = this.readCookie(name)\n          // eslint-disable-next-line eqeqeq\n          if (tempCookie == value) {\n            broadDomain = testBroadDomain\n            $ct.broadDomain = broadDomain\n            break\n          }\n        }\n      } else {\n        this.createCookie(name, value, seconds, broadDomain)\n      }\n    } else {\n      this.createCookie(name, value, seconds, domain)\n    }\n  }\n\n  static getMetaProp (property) {\n    const metaObj = this.readFromLSorCookie(META_COOKIE)\n    if (metaObj != null) {\n      return metaObj[property]\n    }\n  }\n\n  static setMetaProp (property, value) {\n    if (this._isLocalStorageSupported()) {\n      let wzrkMetaObj = this.readFromLSorCookie(META_COOKIE)\n      if (wzrkMetaObj == null) {\n        wzrkMetaObj = {}\n      }\n      if (value === undefined) {\n        delete wzrkMetaObj[property]\n      } else {\n        wzrkMetaObj[property] = value\n      }\n      this.saveToLSorCookie(META_COOKIE, wzrkMetaObj)\n    }\n  }\n\n  static getAndClearMetaProp (property) {\n    const value = this.getMetaProp(property)\n    this.setMetaProp(property, undefined)\n    return value\n  }\n\n  static setInstantDeleteFlagInK () {\n    let k = this.readFromLSorCookie(KCOOKIE_NAME)\n    if (k == null) {\n      k = {}\n    }\n    k.flag = true\n    this.saveToLSorCookie(KCOOKIE_NAME, k)\n  }\n\n  static backupEvent (data, reqNo, logger) {\n    let backupArr = this.readFromLSorCookie(LCOOKIE_NAME)\n    if (typeof backupArr === 'undefined') {\n      backupArr = {}\n    }\n    backupArr[reqNo] = { q: data }\n    this.saveToLSorCookie(LCOOKIE_NAME, backupArr)\n    logger.debug(`stored in ${LCOOKIE_NAME} reqNo : ${reqNo} -> ${data}`)\n  }\n\n  static removeBackup (respNo, logger) {\n    const backupMap = this.readFromLSorCookie(LCOOKIE_NAME)\n    if (typeof backupMap !== 'undefined' && backupMap !== null && typeof backupMap[respNo] !== 'undefined') {\n      logger.debug(`del event: ${respNo} data-> ${backupMap[respNo].q}`)\n      delete backupMap[respNo]\n      this.saveToLSorCookie(LCOOKIE_NAME, backupMap)\n    }\n  }\n}\n\nexport const $ct = {\n  globalCache: {\n    gcookie: null,\n    REQ_N: 0,\n    RESP_N: 0\n  },\n  LRU_CACHE: null,\n  globalProfileMap: undefined,\n  globalEventsMap: undefined,\n  blockRequest: false,\n  isOptInRequest: false,\n  broadDomain: null,\n  webPushEnabled: null,\n  campaignDivMap: {},\n  currentSessionId: null,\n  wiz_counter: 0, // to keep track of number of times we load the body\n  notifApi: {\n    notifEnabledFromApi: false\n  }, // helper variable to handle race condition and check when notifications were called\n  unsubGroups: [],\n  updatedCategoryLong: null,\n  inbox: null,\n  isPrivacyArrPushed: false,\n  privacyArray: [],\n  offline: false,\n  location: null,\n  dismissSpamControl: false,\n  globalUnsubscribe: true,\n  flutterVersion: null,\n  variableStore: {},\n  pushConfig: null\n  // domain: window.location.hostname, url -> getHostName()\n  // gcookie: -> device\n}\n","import { StorageManager } from './storage'\nimport { LRU_CACHE } from './constants'\n\nexport default class LRUCache {\n  #keyOrder\n\n  constructor (max) {\n    this.max = max\n    let lruCache = StorageManager.readFromLSorCookie(LRU_CACHE)\n    if (lruCache) {\n      const tempLruCache = {}\n      this.#keyOrder = []\n      lruCache = lruCache.cache\n      for (const entry in lruCache) {\n        if (lruCache.hasOwnProperty(entry)) {\n          tempLruCache[lruCache[entry][0]] = lruCache[entry][1]\n          this.#keyOrder.push(lruCache[entry][0])\n        }\n      }\n      this.cache = tempLruCache\n    } else {\n      this.cache = {}\n      this.#keyOrder = []\n    }\n  }\n\n  get (key) {\n    const item = this.cache[key]\n    if (item) {\n      this.cache = this.#deleteFromObject(key, this.cache)\n      this.cache[key] = item\n      this.#keyOrder.push(key)\n    }\n    this.saveCacheToLS(this.cache)\n    return item\n  }\n\n  set (key, value) {\n    const item = this.cache[key]\n    const allKeys = this.#keyOrder\n    if (item != null) {\n      this.cache = this.#deleteFromObject(key, this.cache)\n    } else if (allKeys.length === this.max) {\n      this.cache = this.#deleteFromObject(allKeys[0], this.cache)\n    }\n    this.cache[key] = value\n    if (this.#keyOrder[this.#keyOrder - 1] !== key) {\n      this.#keyOrder.push(key)\n    }\n    this.saveCacheToLS(this.cache)\n  }\n\n  saveCacheToLS (cache) {\n    const objToArray = []\n    const allKeys = this.#keyOrder\n    for (const index in allKeys) {\n      if (allKeys.hasOwnProperty(index)) {\n        const temp = []\n        temp.push(allKeys[index])\n        temp.push(cache[allKeys[index]])\n        objToArray.push(temp)\n      }\n    }\n    StorageManager.saveToLSorCookie(LRU_CACHE, { cache: objToArray })\n  }\n\n  getKey (value) {\n    if (value === null) {\n      return null\n    }\n    const allKeys = this.#keyOrder\n    for (const index in allKeys) {\n      if (allKeys.hasOwnProperty(index)) {\n        if (this.cache[allKeys[index]] === value) {\n          return allKeys[index]\n        }\n      }\n    }\n    return null\n  }\n\n  getSecondLastKey () {\n    const keysArr = this.#keyOrder\n    if (keysArr != null && keysArr.length > 1) {\n      return keysArr[keysArr.length - 2]\n    }\n    return -1\n  }\n\n  getLastKey () {\n    const keysLength = this.#keyOrder.length\n    if (keysLength) {\n      return this.#keyOrder[keysLength - 1]\n    }\n  }\n\n  #deleteFromObject (key, obj) {\n    const allKeys = JSON.parse(JSON.stringify(this.#keyOrder))\n    const newCache = {}\n    let indexToDelete\n    for (const index in allKeys) {\n      if (allKeys.hasOwnProperty(index)) {\n        if (allKeys[index] !== key) {\n          newCache[allKeys[index]] = obj[allKeys[index]]\n        } else {\n          indexToDelete = index\n        }\n      }\n    }\n    allKeys.splice(indexToDelete, 1)\n    this.#keyOrder = JSON.parse(JSON.stringify(allKeys))\n    return newCache\n  }\n}\n","import { COOKIE_EXPIRY, FIRE_PUSH_UNREGISTERED, GCOOKIE_NAME, KCOOKIE_NAME, LRU_CACHE_SIZE, USEIP_KEY } from '../util/constants'\nimport { isValueValid } from '../util/datatypes'\nimport { getNow } from '../util/datetime'\nimport LRUCache from '../util/lruCache'\nimport { StorageManager, $ct } from '../util/storage'\n\nexport default class CleverTapAPI {\n  #logger\n  #request\n  #device\n  #session\n\n  constructor ({ logger, request, device, session }) {\n    this.#logger = logger\n    this.#request = request\n    this.#device = device\n    this.#session = session\n  }\n\n  /**\n   *\n   * @param {string} global gcookie\n   * @param {string} session\n   * @param {boolean} resume sent true in case of an OUL request from client side, which is returned as it is by server\n   * @param {number} respNumber the index of the request in backupmanager\n   * @param {boolean} optOutResponse\n   * @returns\n   */\n\n  s (global, session, resume, respNumber, optOutResponse) {\n    let oulReq = false\n    let newGuid = false\n\n    // for a scenario when OUL request is true from client side\n    // but resume is returned as false from server end\n    // we maintan a OulReqN var in the window object\n    // and compare with respNumber to determine the response of an OUL request\n    if (window.isOULInProgress) {\n      if (resume || (respNumber !== 'undefined' && respNumber === window.oulReqN)) {\n        window.isOULInProgress = false\n        oulReq = true\n      }\n    }\n\n    // call back function used to store global and session ids for the user\n    if (typeof respNumber === 'undefined') {\n      respNumber = 0\n    }\n\n    StorageManager.removeBackup(respNumber, this.#logger)\n\n    if (respNumber > $ct.globalCache.REQ_N) {\n      // request for some other user so ignore\n      return\n    }\n\n    if (!isValueValid(this.#device.gcookie)) {\n      if (global) {\n        newGuid = true\n      }\n    }\n\n    if (!isValueValid(this.#device.gcookie) || resume || typeof optOutResponse === 'boolean') {\n      const sessionObj = this.#session.getSessionCookieObject()\n\n      /*  If the received session is less than the session in the cookie,\n          then don't update guid as it will be response for old request\n      */\n      if (window.isOULInProgress || (sessionObj.s && (session < sessionObj.s))) {\n        return\n      }\n      this.#logger.debug(`Cookie was ${this.#device.gcookie} set to ${global}`)\n      this.#device.gcookie = global\n      if (!isValueValid(this.#device.gcookie)) {\n        // clear useIP meta prop\n        StorageManager.getAndClearMetaProp(USEIP_KEY)\n      }\n      if (global && StorageManager._isLocalStorageSupported()) {\n        if ($ct.LRU_CACHE == null) {\n          $ct.LRU_CACHE = new LRUCache(LRU_CACHE_SIZE)\n        }\n\n        const kIdFromLS = StorageManager.readFromLSorCookie(KCOOKIE_NAME)\n        let guidFromLRUCache\n        if (kIdFromLS != null && kIdFromLS.id) {\n          guidFromLRUCache = $ct.LRU_CACHE.cache[kIdFromLS.id]\n          if (resume) {\n            if (!guidFromLRUCache) {\n              StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, true)\n              // replace login identity in OUL request\n              // with the gcookie returned in exchange\n              $ct.LRU_CACHE.set(kIdFromLS.id, global)\n            }\n          }\n        }\n\n        StorageManager.saveToLSorCookie(GCOOKIE_NAME, global)\n        // lastk provides the guid\n        const lastK = $ct.LRU_CACHE.getSecondLastKey()\n        if (StorageManager.readFromLSorCookie(FIRE_PUSH_UNREGISTERED) && lastK !== -1) {\n          const lastGUID = $ct.LRU_CACHE.cache[lastK]\n          // fire the request directly via fireRequest to unregister the token\n          // then other requests with the updated guid should follow\n          this.#request.unregisterTokenForGuid(lastGUID)\n        }\n      }\n      StorageManager.createBroadCookie(GCOOKIE_NAME, global, COOKIE_EXPIRY, window.location.hostname)\n      StorageManager.saveToLSorCookie(GCOOKIE_NAME, global)\n    }\n\n    if (StorageManager._isLocalStorageSupported()) {\n      this.#session.manageSession(session)\n    }\n\n    // session cookie\n    const obj = this.#session.getSessionCookieObject()\n\n    // for the race-condition where two responses come back with different session ids. don't write the older session id.\n    if (typeof obj.s === 'undefined' || obj.s <= session) {\n      obj.s = session\n      obj.t = getNow() // time of last response from server\n      this.#session.setSessionCookieObject(obj)\n    }\n\n    // set blockRequest to false only if the device has a valid gcookie\n    if (isValueValid(this.#device.gcookie)) {\n      $ct.blockRequest = false\n    }\n\n    // only process the backup events after an OUL request or a new guid is recieved\n    if ((oulReq || newGuid) && !this.#request.processingBackup) {\n      this.#request.processBackupEvents()\n    }\n\n    $ct.globalCache.RESP_N = respNumber\n  }\n}\n","import { isValueValid } from '../util/datatypes'\nimport { StorageManager } from '../util/storage'\nimport { GCOOKIE_NAME, COOKIE_EXPIRY } from '../util/constants'\n\nexport default class DeviceManager {\n  #logger\n  gcookie\n\n  constructor ({ logger }) {\n    this.#logger = logger\n    this.gcookie = this.getGuid()\n  }\n\n  getGuid () {\n    let guid = null\n    if (isValueValid(this.gcookie)) {\n      return this.gcookie\n    }\n    if (StorageManager._isLocalStorageSupported()) {\n      const value = StorageManager.read(GCOOKIE_NAME)\n      if (isValueValid(value)) {\n        try {\n          guid = JSON.parse(decodeURIComponent(value))\n        } catch (e) {\n          this.#logger.debug('Cannot parse Gcookie from localstorage - must be encoded ' + value)\n          // assumming guids are of size 32. supporting both formats.\n          // guid can have encodedURIComponent or be without it.\n          // 1.56e4078ed15749928c042479ec2b4d47 - breaks on JSON.parse(decodeURIComponent())\n          // 2.%2256e4078ed15749928c042479ec2b4d47%22\n          if (value.length === 32) {\n            guid = value\n            StorageManager.saveToLSorCookie(GCOOKIE_NAME, value)\n          } else {\n            this.#logger.error('Illegal guid ' + value)\n          }\n        }\n\n        // Persist to cookie storage if not present there.\n        if (isValueValid(guid)) {\n          StorageManager.createBroadCookie(GCOOKIE_NAME, guid, COOKIE_EXPIRY, window.location.hostname)\n        }\n      }\n    }\n\n    if (!isValueValid(guid)) {\n      guid = StorageManager.readCookie(GCOOKIE_NAME)\n      if (isValueValid(guid) && (guid.indexOf('%') === 0 || guid.indexOf('\\'') === 0 || guid.indexOf('\"') === 0)) {\n        guid = null\n      }\n      if (isValueValid(guid)) {\n        StorageManager.saveToLSorCookie(GCOOKIE_NAME, guid)\n      }\n    }\n\n    return guid\n  }\n}\n","export const DATA_NOT_SENT_TEXT = 'This property has been ignored.'\nexport const INVALID_ACCOUNT = 'Invalid account ID'\nexport const INVALID_EVENT = 'Event structure not valid. Unable to process event'\nexport const CLEVERTAP_ERROR_PREFIX = 'CleverTap error:' // Formerly wzrk_error_txt\nexport const EMBED_ERROR = `${CLEVERTAP_ERROR_PREFIX} Incorrect embed script.`\nexport const EVENT_ERROR = `${CLEVERTAP_ERROR_PREFIX} Event structure not valid. ${DATA_NOT_SENT_TEXT}`\nexport const GENDER_ERROR = `${CLEVERTAP_ERROR_PREFIX} Gender value should be either M or F. ${DATA_NOT_SENT_TEXT}`\nexport const EMPLOYED_ERROR = `${CLEVERTAP_ERROR_PREFIX} Employed value should be either Y or N. ${DATA_NOT_SENT_TEXT}`\nexport const MARRIED_ERROR = `${CLEVERTAP_ERROR_PREFIX} Married value should be either Y or N. ${DATA_NOT_SENT_TEXT}`\nexport const EDUCATION_ERROR = `${CLEVERTAP_ERROR_PREFIX} Education value should be either School, College or Graduate. ${DATA_NOT_SENT_TEXT}`\nexport const AGE_ERROR = `${CLEVERTAP_ERROR_PREFIX} Age value should be a number. ${DATA_NOT_SENT_TEXT}`\nexport const DOB_ERROR = `${CLEVERTAP_ERROR_PREFIX} DOB value should be a Date Object`\nexport const OBJECT_ARRAY_ERROR = `${CLEVERTAP_ERROR_PREFIX} Expecting Object array in profile`\nexport const DATE_FORMAT_ERROR = `${CLEVERTAP_ERROR_PREFIX} setDate(number). number should be formatted as yyyymmdd`\nexport const ENUM_FORMAT_ERROR = `${CLEVERTAP_ERROR_PREFIX} setEnum(value). value should be a string or a number`\nexport const PHONE_FORMAT_ERROR = `${CLEVERTAP_ERROR_PREFIX} Phone number should be formatted as +[country code][number]`\n","import { isObject, isDateObject, isString, isNumber } from './datatypes'\nimport { convertToWZRKDate } from './datetime'\nimport { CHARGED_ID, CHARGEDID_COOKIE_NAME } from './constants'\nimport { StorageManager } from './storage'\n\nlet _globalChargedId\n\nexport const isEventStructureFlat = (eventObj) => {\n  // Events cannot have nested structure or Arrays\n  if (isObject(eventObj)) {\n    for (var key in eventObj) {\n      if (eventObj.hasOwnProperty(key)) {\n        if (isObject(eventObj[key]) || Array.isArray(eventObj[key])) {\n          return false\n        } else if (isDateObject(eventObj[key])) {\n          eventObj[key] = convertToWZRKDate(eventObj[key])\n        }\n      }\n    }\n    return true\n  }\n  return false\n}\n\nexport const isChargedEventStructureValid = (chargedObj, logger) => {\n  if (isObject(chargedObj)) {\n    for (var key in chargedObj) {\n      if (chargedObj.hasOwnProperty(key)) {\n        if (key === 'Items') {\n          if (!Array.isArray(chargedObj[key])) {\n            return false\n          }\n\n          if (chargedObj[key].length > 50) {\n            logger.reportError(522, 'Charged Items exceed 50 limit. Actual count: ' + chargedObj[key].length)\n          }\n\n          for (var itemKey in chargedObj[key]) {\n            if (chargedObj[key].hasOwnProperty(itemKey)) { // since default array implementation could be overridden - e.g. Teabox site\n              if (!isObject(chargedObj[key][itemKey]) || !isEventStructureFlat(chargedObj[key][itemKey])) {\n                return false\n              }\n            }\n          }\n        } else {\n          if (isObject(chargedObj[key]) || Array.isArray(chargedObj[key])) {\n            return false\n          } else if (isDateObject(chargedObj[key])) {\n            chargedObj[key] = convertToWZRKDate(chargedObj[key])\n          }\n        }\n      }\n    }\n\n    if (isString(chargedObj[CHARGED_ID]) || isNumber(chargedObj[CHARGED_ID])) {\n      // save charged Id\n      const chargedId = chargedObj[CHARGED_ID] + '' // casting chargedId to string\n\n      if (typeof _globalChargedId === 'undefined') {\n        _globalChargedId = StorageManager.readFromLSorCookie(CHARGEDID_COOKIE_NAME)\n      }\n      if (typeof _globalChargedId !== 'undefined' && _globalChargedId.trim() === chargedId.trim()) {\n        // drop event- duplicate charged id\n        logger.error('Duplicate charged Id - Dropped' + chargedObj)\n        return false\n      }\n      _globalChargedId = chargedId\n      StorageManager.saveToLSorCookie(CHARGEDID_COOKIE_NAME, chargedId)\n    }\n    return true\n  } // if object (chargedObject)\n  return false\n}\n","import { isString, isObject, sanitize } from '../util/datatypes'\nimport { EVENT_ERROR } from '../util/messages'\nimport { EV_COOKIE, SYSTEM_EVENTS, unsupportedKeyCharRegex } from '../util/constants'\nimport { isChargedEventStructureValid, isEventStructureFlat } from '../util/validator'\nimport { StorageManager, $ct } from '../util/storage'\n\nexport default class EventHandler extends Array {\n  #logger\n  #oldValues\n  #request\n  #isPersonalisationActive\n\n  constructor ({ logger, request, isPersonalisationActive }, values) {\n    super()\n    this.#logger = logger\n    this.#oldValues = values\n    this.#request = request\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  push (...eventsArr) {\n    this.#processEventArray(eventsArr)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processEventArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  #processEventArray (eventsArr) {\n    if (Array.isArray(eventsArr)) {\n      while (eventsArr.length > 0) {\n        var eventName = eventsArr.shift()\n        if (!isString(eventName)) {\n          this.#logger.error(EVENT_ERROR)\n          continue\n        }\n\n        if (eventName.length > 1024) {\n          eventName = eventName.substring(0, 1024)\n          this.#logger.reportError(510, eventName + '... length exceeded 1024 chars. Trimmed.')\n        }\n\n        if (SYSTEM_EVENTS.includes(eventName)) {\n          this.#logger.reportError(513, eventName + ' is a restricted system event. It cannot be used as an event name.')\n          continue\n        }\n\n        const data = {}\n        data.type = 'event'\n        data.evtName = sanitize(eventName, unsupportedKeyCharRegex)\n\n        if (eventsArr.length !== 0) {\n          const eventObj = eventsArr.shift()\n          if (!isObject(eventObj)) {\n            // put it back if it is not an object\n            eventsArr.unshift(eventObj)\n          } else {\n            // check Charged Event vs. other events.\n            if (eventName === 'Charged') {\n              if (!isChargedEventStructureValid(eventObj, this.#logger)) {\n                this.#logger.reportError(511, 'Charged event structure invalid. Not sent.')\n                continue\n              }\n            } else {\n              if (!isEventStructureFlat(eventObj)) {\n                this.#logger.reportError(512, eventName + ' event structure invalid. Not sent.')\n                continue\n              }\n            }\n            data.evtData = eventObj\n          }\n        }\n\n        this.#request.processEvent(data)\n      }\n    }\n  }\n\n  getDetails (evtName) {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    if (typeof $ct.globalEventsMap === 'undefined') {\n      $ct.globalEventsMap = StorageManager.readFromLSorCookie(EV_COOKIE)\n    }\n    if (typeof $ct.globalEventsMap === 'undefined') {\n      return\n    }\n    const evtObj = $ct.globalEventsMap[evtName]\n    const respObj = {}\n    if (typeof evtObj !== 'undefined') {\n      respObj.firstTime = new Date(evtObj[1] * 1000)\n      respObj.lastTime = new Date(evtObj[2] * 1000)\n      respObj.count = evtObj[0]\n      return respObj\n    }\n  }\n}\n","export const getURLParams = (url) => {\n  const urlParams = {}\n  const idx = url.indexOf('?')\n\n  if (idx > 1) {\n    const uri = url.substring(idx + 1)\n    let match\n    const pl = /\\+/g // Regex for replacing addition symbol with a space\n    const search = /([^&=]+)=?([^&]*)/g\n    const decode = function (s) {\n      let replacement = s.replace(pl, ' ')\n      try {\n        replacement = decodeURIComponent(replacement)\n      } catch (e) {\n        // eat\n      }\n      return replacement\n    }\n    match = search.exec(uri)\n    while (match) {\n      urlParams[decode(match[1])] = decode(match[2])\n      match = search.exec(uri)\n    }\n  }\n  return urlParams\n}\n\nexport const getDomain = (url) => {\n  if (url === '') return ''\n  var a = document.createElement('a')\n  a.href = url\n  return a.hostname\n}\n\nexport const addToURL = (url, k, v) => {\n  return url + '&' + k + '=' + encodeURIComponent(v)\n}\n\nexport const getHostName = () => {\n  return window.location.hostname\n}\n","/* eslint-disable */\nexport const urlBase64ToUint8Array = (base64String) => {\n  let padding = '='.repeat((4 - base64String.length % 4) % 4)\n  let base64 = (base64String + padding)\n      .replace(/\\-/g, '+')\n      .replace(/_/g, '/')\n\n  let rawData = window.atob(base64)\n  let processedData = []\n  for (let i=0; i<rawData.length; i++) {\n    processedData.push(rawData.charCodeAt(i))\n  }\n  return new Uint8Array(processedData)\n}\n\nexport const compressData = (dataObject, logger) => {\n  logger && typeof logger.debug === 'function' && logger.debug('dobj:' + dataObject)\n  return compressToBase64(dataObject)\n}\n\nexport const compress = (uncompressed) => {\n  if (uncompressed == null) return ''\n  let i, value,\n      context_dictionary = {},\n      context_dictionaryToCreate = {},\n      context_c = '',\n      context_wc = '',\n      context_w = '',\n      context_enlargeIn = 2, // Compensate for the first entry which should not count\n      context_dictSize = 3,\n      context_numBits = 2,\n      context_data_string = '',\n      context_data_val = 0,\n      context_data_position = 0,\n      ii,\n      f = String.fromCharCode\n\n  for (ii = 0; ii < uncompressed.length; ii += 1) {\n    context_c = uncompressed.charAt(ii)\n    if (!Object.prototype.hasOwnProperty.call(context_dictionary, context_c)) {\n      context_dictionary[context_c] = context_dictSize++\n      context_dictionaryToCreate[context_c] = true\n    }\n\n    context_wc = context_w + context_c\n    if (Object.prototype.hasOwnProperty.call(context_dictionary, context_wc)) {\n      context_w = context_wc\n    } else {\n      if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate, context_w)) {\n        if (context_w.charCodeAt(0) < 256) {\n          for (i = 0; i < context_numBits; i++) {\n            context_data_val = (context_data_val << 1)\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n          }\n          value = context_w.charCodeAt(0)\n          for (i = 0; i < 8; i++) {\n            context_data_val = (context_data_val << 1) | (value & 1)\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n            value = value >> 1\n          }\n        } else {\n          value = 1\n          for (i = 0; i < context_numBits; i++) {\n            context_data_val = (context_data_val << 1) | value\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n            value = 0\n          }\n          value = context_w.charCodeAt(0)\n          for (i = 0; i < 16; i++) {\n            context_data_val = (context_data_val << 1) | (value & 1)\n            if (context_data_position == 15) {\n              context_data_position = 0\n              context_data_string += f(context_data_val)\n              context_data_val = 0\n            } else {\n              context_data_position++\n            }\n            value = value >> 1\n          }\n        }\n        context_enlargeIn--\n        if (context_enlargeIn == 0) {\n          context_enlargeIn = Math.pow(2, context_numBits)\n          context_numBits++\n        }\n        delete context_dictionaryToCreate[context_w]\n      } else {\n        value = context_dictionary[context_w];\n        for (i = 0; i < context_numBits; i++) {\n          context_data_val = (context_data_val << 1) | (value & 1)\n          if (context_data_position == 15) {\n            context_data_position = 0;\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = value >> 1\n        }\n\n\n      }\n      context_enlargeIn--\n      if (context_enlargeIn == 0) {\n        context_enlargeIn = Math.pow(2, context_numBits)\n        context_numBits++\n      }\n      // Add wc to the dictionary.\n      context_dictionary[context_wc] = context_dictSize++\n      context_w = String(context_c)\n    }\n  }\n\n  // Output the code for w.\n  if (context_w !== '') {\n    if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate, context_w)) {\n      if (context_w.charCodeAt(0) < 256) {\n        for (i = 0; i < context_numBits; i++) {\n          context_data_val = (context_data_val << 1)\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n        }\n        value = context_w.charCodeAt(0)\n        for (i = 0; i < 8; i++) {\n          context_data_val = (context_data_val << 1) | (value & 1)\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = value >> 1\n        }\n      } else {\n        value = 1\n        for (i = 0; i < context_numBits; i++) {\n          context_data_val = (context_data_val << 1) | value\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = 0\n        }\n        value = context_w.charCodeAt(0);\n        for (i = 0; i < 16; i++) {\n          context_data_val = (context_data_val << 1) | (value & 1)\n          if (context_data_position == 15) {\n            context_data_position = 0\n            context_data_string += f(context_data_val)\n            context_data_val = 0\n          } else {\n            context_data_position++\n          }\n          value = value >> 1\n        }\n      }\n      context_enlargeIn--\n      if (context_enlargeIn == 0) {\n        context_enlargeIn = Math.pow(2, context_numBits)\n        context_numBits++\n      }\n      delete context_dictionaryToCreate[context_w]\n    } else {\n      value = context_dictionary[context_w]\n      for (i = 0; i < context_numBits; i++) {\n        context_data_val = (context_data_val << 1) | (value & 1)\n        if (context_data_position == 15) {\n          context_data_position = 0\n          context_data_string += f(context_data_val)\n          context_data_val = 0\n        } else {\n          context_data_position++\n        }\n        value = value >> 1\n      }\n\n\n    }\n    context_enlargeIn--\n    if (context_enlargeIn == 0) {\n      context_enlargeIn = Math.pow(2, context_numBits)\n      context_numBits++\n    }\n  }\n\n  // Mark the end of the stream\n  value = 2\n  for (i = 0; i < context_numBits; i++) {\n    context_data_val = (context_data_val << 1) | (value & 1)\n    if (context_data_position == 15) {\n      context_data_position = 0\n      context_data_string += f(context_data_val)\n      context_data_val = 0\n    } else {\n      context_data_position++\n    }\n    value = value >> 1\n  }\n\n  // Flush the last char\n  while (true) {\n    context_data_val = (context_data_val << 1)\n    if (context_data_position == 15) {\n      context_data_string += f(context_data_val)\n      break\n    } else context_data_position++\n  }\n  return context_data_string\n}\n\nexport const getKeyStr = () => {\n  let key = ''\n  let i = 0\n\n  for (i = 0; i <= 25; i++) {\n    key = key + String.fromCharCode(i + 65)\n  }\n\n  for (i = 0; i <= 25; i++) {\n    key = key + String.fromCharCode(i + 97)\n  }\n\n  for (i = 0; i < 10; i++) {\n    key = key + i\n  }\n\n  return key + '+/='\n}\n\nconst _keyStr = getKeyStr()\n\nexport const convertToFormattedHex = (byte_arr) => {\n  let hex_str = '',\n      i,\n      len,\n      tmp_hex\n\n  if (!Array.isArray(byte_arr)) {\n    return false\n  }\n\n  len = byte_arr.length\n\n  for (i = 0; i < len; ++i) {\n    if (byte_arr[i] < 0) {\n      byte_arr[i] = byte_arr[i] + 256\n    }\n    if (byte_arr[i] === undefined) {\n      byte_arr[i] = 0\n    }\n    tmp_hex = byte_arr[i].toString(16)\n\n    if (tmp_hex.length == 1) tmp_hex = '0' + tmp_hex // Add leading zero.\n\n    //        beautification - needed if you're printing this in the console, else keep commented\n    //        if ((i + 1) % 16 === 0) {\n    //          tmp_hex += \"\\n\";\n    //        } else {\n    //          tmp_hex += \" \";\n    //        }\n\n    hex_str += tmp_hex\n  }\n\n  return hex_str.trim()\n}\n\nexport const convertStringToHex = (s) => {\n  let byte_arr = []\n  for (let i = 0; i < s.length; i++) {\n    let value = s.charCodeAt(i)\n    byte_arr.push(value & 255)\n    byte_arr.push((value >> 8) & 255)\n  }\n  return convertToFormattedHex(byte_arr)\n}\n\nexport const compressToBase64 = (input) => {\n  if (input == null) return ''\n  var output = ''\n  var chr1, chr2, chr3, enc1, enc2, enc3, enc4\n  var i = 0\n\n  input = compress(input)\n\n  while (i < input.length * 2) {\n\n    if (i % 2 == 0) {\n      chr1 = input.charCodeAt(i / 2) >> 8\n      chr2 = input.charCodeAt(i / 2) & 255\n      if (i / 2 + 1 < input.length)\n        chr3 = input.charCodeAt(i / 2 + 1) >> 8\n      else\n        chr3 = NaN\n    } else {\n      chr1 = input.charCodeAt((i - 1) / 2) & 255\n      if ((i + 1) / 2 < input.length) {\n        chr2 = input.charCodeAt((i + 1) / 2) >> 8\n        chr3 = input.charCodeAt((i + 1) / 2) & 255\n      } else\n        chr2 = chr3 = NaN\n    }\n    i += 3\n\n    enc1 = chr1 >> 2;\n    enc2 = ((chr1 & 3) << 4) | (chr2 >> 4)\n    enc3 = ((chr2 & 15) << 2) | (chr3 >> 6)\n    enc4 = chr3 & 63\n\n    if (isNaN(chr2)) {\n      enc3 = enc4 = 64\n    } else if (isNaN(chr3)) {\n      enc4 = 64\n    }\n\n    output = output +\n      _keyStr.charAt(enc1) + _keyStr.charAt(enc2) +\n      _keyStr.charAt(enc3) + _keyStr.charAt(enc4)\n\n  }\n\n  return output\n}\n","\nimport { ARP_COOKIE, MAX_TRIES, OPTOUT_COOKIE_ENDSWITH, USEIP_KEY, MAX_DELAY_FREQUENCY, PUSH_DELAY_MS, WZRK_FETCH } from './constants'\nimport { isString, isValueValid } from './datatypes'\nimport { compressData } from './encoder'\nimport { StorageManager, $ct } from './storage'\nimport { addToURL } from './url'\n\nexport default class RequestDispatcher {\n  static logger\n  static device\n  static account\n  networkRetryCount = 0\n  minDelayFrequency = 0\n\n  // ANCHOR - Requests get fired from here\n  static #fireRequest (url, tries, skipARP, sendOULFlag, evtName) {\n    if (this.#dropRequestDueToOptOut()) {\n      this.logger.debug('req dropped due to optout cookie: ' + this.device.gcookie)\n      return\n    }\n\n    // set a request in progress\n    // so that if gcookie is not present, no other request can be made asynchronusly\n    if (!isValueValid(this.device.gcookie)) {\n      $ct.blockRequest = true\n    }\n    /**\n     * if the gcookie is null\n     * and the request is not the first request\n     * and the tries are less than max tries\n     * keep retrying\n     */\n\n    if (evtName && evtName === WZRK_FETCH) {\n      // New retry mechanism\n      if (!isValueValid(this.device.gcookie) && ($ct.globalCache.RESP_N < $ct.globalCache.REQ_N - 1)) {\n        setTimeout(() => {\n          this.logger.debug(`retrying fire request for url: ${url}, tries: ${this.networkRetryCount}`)\n          this.#fireRequest(url, undefined, skipARP, sendOULFlag)\n        }, this.getDelayFrequency())\n      }\n    } else {\n      if (!isValueValid(this.device.gcookie) &&\n      ($ct.globalCache.RESP_N < $ct.globalCache.REQ_N - 1) &&\n      tries < MAX_TRIES) {\n      // if ongoing First Request is in progress, initiate retry\n        setTimeout(() => {\n          this.logger.debug(`retrying fire request for url: ${url}, tries: ${tries}`)\n          this.#fireRequest(url, tries + 1, skipARP, sendOULFlag)\n        }, 50)\n        return\n      }\n    }\n\n    // set isOULInProgress to true\n    // when sendOULFlag is set to true\n    if (!sendOULFlag) {\n      if (isValueValid(this.device.gcookie)) {\n        // add gcookie to url\n        url = addToURL(url, 'gc', this.device.gcookie)\n      }\n      url = this.#addARPToRequest(url, skipARP)\n    } else {\n      window.isOULInProgress = true\n    }\n\n    url = addToURL(url, 'tries', tries) // Add tries to URL\n\n    url = this.#addUseIPToRequest(url)\n    url = addToURL(url, 'r', new Date().getTime()) // add epoch to beat caching of the URL\n    // TODO: Figure out a better way to handle plugin check\n    if (window.clevertap?.hasOwnProperty('plugin') || window.wizrocket?.hasOwnProperty('plugin')) {\n      // used to add plugin name in request parameter\n      const plugin = window.clevertap.plugin || window.wizrocket.plugin\n      url = addToURL(url, 'ct_pl', plugin)\n    }\n    if (url.indexOf('chrome-extension:') !== -1) {\n      url = url.replace('chrome-extension:', 'https:')\n    }\n    // TODO: Try using Function constructor instead of appending script.\n    var ctCbScripts = document.getElementsByClassName('ct-jp-cb')\n    while (ctCbScripts[0] && ctCbScripts[0].parentNode) {\n      ctCbScripts[0].parentNode.removeChild(ctCbScripts[0])\n    }\n    const s = document.createElement('script')\n    s.setAttribute('type', 'text/javascript')\n    s.setAttribute('src', url)\n    s.setAttribute('class', 'ct-jp-cb')\n    s.setAttribute('rel', 'nofollow')\n    s.async = true\n    document.getElementsByTagName('head')[0].appendChild(s)\n    this.logger.debug('req snt -> url: ' + url)\n  }\n\n  /**\n   *\n   * @param {string} url\n   * @param {*} skipARP\n   * @param {boolean} sendOULFlag\n   */\n  static fireRequest (url, skipARP, sendOULFlag, evtName) {\n    this.#fireRequest(url, 1, skipARP, sendOULFlag, evtName)\n  }\n\n  static #dropRequestDueToOptOut () {\n    if ($ct.isOptInRequest || !isValueValid(this.device.gcookie) || !isString(this.device.gcookie)) {\n      $ct.isOptInRequest = false\n      return false\n    }\n    return this.device.gcookie.slice(-3) === OPTOUT_COOKIE_ENDSWITH\n  }\n\n  static #addUseIPToRequest (pageLoadUrl) {\n    var useIP = StorageManager.getMetaProp(USEIP_KEY)\n    if (typeof useIP !== 'boolean') {\n      useIP = false\n    }\n    return addToURL(pageLoadUrl, USEIP_KEY, useIP ? 'true' : 'false')\n  };\n\n  static #addARPToRequest (url, skipResARP) {\n    if (skipResARP === true) {\n      const _arp = {}\n      _arp.skipResARP = true\n      return addToURL(url, 'arp', compressData(JSON.stringify(_arp), this.logger))\n    }\n    if (StorageManager._isLocalStorageSupported() && typeof localStorage.getItem(ARP_COOKIE) !== 'undefined' && localStorage.getItem(ARP_COOKIE) !== null) {\n      return addToURL(url, 'arp', compressData(JSON.stringify(StorageManager.readFromLSorCookie(ARP_COOKIE)), this.logger))\n    }\n    return url\n  }\n\n  getDelayFrequency () {\n    this.logger.debug('Network retry #' + this.networkRetryCount)\n\n    // Retry with delay as 1s for first 10 retries\n    if (this.networkRetryCount < 10) {\n      this.logger.debug(this.account.id, 'Failure count is ' + this.networkRetryCount + '. Setting delay frequency to 1s')\n      this.minDelayFrequency = PUSH_DELAY_MS // Reset minimum delay to 1s\n      return this.minDelayFrequency\n    }\n\n    if (this.account.region == null) {\n      // Retry with delay as 1s if region is null in case of eu1\n      this.logger.debug(this.account.id, 'Setting delay frequency to 1s')\n      return PUSH_DELAY_MS\n    } else {\n      // Retry with delay as minimum delay frequency and add random number of seconds to scatter traffic\n      const randomDelay = (Math.floor(Math.random() * 10) + 1) * 1000\n      this.minDelayFrequency += randomDelay\n      if (this.minDelayFrequency < MAX_DELAY_FREQUENCY) {\n        this.logger.debug(this.account.id, 'Setting delay frequency to ' + this.minDelayFrequency)\n        return this.minDelayFrequency\n      } else {\n        this.minDelayFrequency = PUSH_DELAY_MS\n      }\n      this.logger.debug(this.account.id, 'Setting delay frequency to ' + this.minDelayFrequency)\n      return this.minDelayFrequency\n    }\n  }\n}\n","// CleverTap specific utilities\n\nimport {\n  StorageManager,\n  $ct\n} from './storage'\nimport {\n  CAMP_COOKIE_NAME,\n  singleQuoteRegex,\n  PR_COOKIE,\n  ARP_COOKIE,\n  GCOOKIE_NAME,\n  IS_OUL,\n  categoryLongKey,\n  CAMP_COOKIE_G,\n  GLOBAL\n} from './constants'\nimport {\n  GENDER_ERROR,\n  EMPLOYED_ERROR,\n  MARRIED_ERROR,\n  EDUCATION_ERROR,\n  AGE_ERROR,\n  DOB_ERROR,\n  PHONE_FORMAT_ERROR,\n  ENUM_FORMAT_ERROR\n} from './messages'\nimport {\n  getToday,\n  convertToWZRKDate,\n  setDate,\n  getNow\n} from './datetime'\nimport {\n  isObject,\n  isDateObject,\n  isConvertibleToNumber,\n  isObjectEmpty,\n  isString,\n  isNumber,\n  isValueValid\n} from './datatypes'\n\nimport { addToURL, getURLParams } from './url'\nimport { compressData } from './encoder'\nimport RequestDispatcher from './requestDispatcher'\n\nexport const getCampaignObject = () => {\n  let finalcampObj = {}\n  if (StorageManager._isLocalStorageSupported()) {\n    let campObj = StorageManager.read(CAMP_COOKIE_NAME)\n    if (campObj != null) {\n      campObj = JSON.parse(decodeURIComponent(campObj).replace(singleQuoteRegex, '\\\"'))\n      if (campObj.hasOwnProperty('global')) {\n        finalcampObj.wp = campObj\n      } else {\n        finalcampObj = campObj\n      }\n    } else {\n      finalcampObj = {}\n    }\n  }\n  return finalcampObj\n}\n\nexport const saveCampaignObject = (campaignObj) => {\n  if (StorageManager._isLocalStorageSupported()) {\n    const newObj = { ...getCampaignObject(), ...campaignObj }\n    const campObj = JSON.stringify(newObj)\n    StorageManager.save(CAMP_COOKIE_NAME, encodeURIComponent(campObj))\n    // Update the CAMP_COOKIE_G to be in sync with CAMP_COOKIE_NAME\n    setCampaignObjectForGuid()\n  }\n}\n\n// set Campaign Object against the guid, with daily count and total count details\nexport const setCampaignObjectForGuid = () => {\n  if (StorageManager._isLocalStorageSupported()) {\n    let guid = StorageManager.read(GCOOKIE_NAME)\n    if (isValueValid(guid)) {\n      try {\n        guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n        const guidCampObj = StorageManager.read(CAMP_COOKIE_G) ? JSON.parse(decodeURIComponent(StorageManager.read(CAMP_COOKIE_G))) : {}\n        if (guid && StorageManager._isLocalStorageSupported()) {\n          var finalCampObj = {}\n          var campObj = getCampaignObject()\n          Object.keys(campObj).forEach(key => {\n            const campKeyObj = (guid in guidCampObj && Object.keys(guidCampObj[guid]).length && guidCampObj[guid][key]) ? guidCampObj[guid][key] : {}\n            const globalObj = campObj[key].global\n            const today = getToday()\n            const dailyObj = campObj[key][today]\n            if (typeof globalObj !== 'undefined') {\n              const campaignIdArray = Object.keys(globalObj)\n              for (const index in campaignIdArray) {\n                let resultObj = []\n                if (campaignIdArray.hasOwnProperty(index)) {\n                  let dailyC = 0\n                  let totalC = 0\n                  const campaignId = campaignIdArray[index]\n                  if (campaignId === 'tc') {\n                    continue\n                  }\n                  if (typeof dailyObj !== 'undefined' && typeof dailyObj[campaignId] !== 'undefined') {\n                    dailyC = dailyObj[campaignId]\n                  }\n                  if (typeof globalObj !== 'undefined' && typeof globalObj[campaignId] !== 'undefined') {\n                    totalC = globalObj[campaignId]\n                  }\n                  resultObj = [campaignId, dailyC, totalC]\n                  campKeyObj[campaignId] = resultObj\n                }\n              }\n            }\n            finalCampObj = { ...finalCampObj, [key]: campKeyObj }\n          })\n          guidCampObj[guid] = finalCampObj\n          StorageManager.save(CAMP_COOKIE_G, encodeURIComponent(JSON.stringify(guidCampObj)))\n        }\n      } catch (e) {\n        console.error('Invalid clevertap Id ' + e)\n      }\n    }\n  }\n}\nexport const getCampaignObjForLc = () => {\n  // before preparing data to send to LC , check if the entry for the guid is already there in CAMP_COOKIE_G\n  const guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n\n  let campObj = {}\n  if (StorageManager._isLocalStorageSupported()) {\n    let resultObj = {}\n    campObj = getCampaignObject()\n    const storageValue = StorageManager.read(CAMP_COOKIE_G)\n    const decodedValue = storageValue ? decodeURIComponent(storageValue) : null\n    const parsedValue = decodedValue ? JSON.parse(decodedValue) : null\n\n    const resultObjWP = (!!guid &&\n                        storageValue !== undefined && storageValue !== null &&\n                        parsedValue && parsedValue[guid] && parsedValue[guid].wp)\n      ? Object.values(parsedValue[guid].wp)\n      : []\n\n    const resultObjWI = (!!guid &&\n                        storageValue !== undefined && storageValue !== null &&\n                        parsedValue && parsedValue[guid] && parsedValue[guid].wi)\n      ? Object.values(parsedValue[guid].wi)\n      : []\n\n    const today = getToday()\n    let todayCwp = 0\n    let todayCwi = 0\n    if (campObj.wp && campObj.wp[today] && campObj.wp[today].tc !== 'undefined') {\n      todayCwp = campObj.wp[today].tc\n    }\n    if (campObj.wi && campObj.wi[today] && campObj.wi[today].tc !== 'undefined') {\n      todayCwi = campObj.wi[today].tc\n    }\n    resultObj = {\n      wmp: todayCwp,\n      wimp: todayCwi,\n      tlc: resultObjWP,\n      witlc: resultObjWI\n    }\n    return resultObj\n  }\n}\n\nexport const isProfileValid = (profileObj, { logger }) => {\n  let valid = false\n  if (isObject(profileObj)) {\n    for (const profileKey in profileObj) {\n      if (profileObj.hasOwnProperty(profileKey)) {\n        valid = true\n        let profileVal = profileObj[profileKey]\n\n        if (profileVal == null) {\n          delete profileObj[profileKey]\n          continue\n        }\n        if (profileKey === 'Gender' && !profileVal.match(/^M$|^F$/)) {\n          valid = false\n          logger.error(GENDER_ERROR)\n        }\n\n        if (profileKey === 'Employed' && !profileVal.match(/^Y$|^N$/)) {\n          valid = false\n          logger.error(EMPLOYED_ERROR)\n        }\n\n        if (profileKey === 'Married' && !profileVal.match(/^Y$|^N$/)) {\n          valid = false\n          logger.error(MARRIED_ERROR)\n        }\n\n        if (profileKey === 'Education' && !profileVal.match(/^School$|^College$|^Graduate$/)) {\n          valid = false\n          logger.error(EDUCATION_ERROR)\n        }\n\n        if (profileKey === 'Age' && profileVal != null) {\n          if (isConvertibleToNumber(profileVal)) {\n            profileObj.Age = +profileVal\n          } else {\n            valid = false\n            logger.error(AGE_ERROR)\n          }\n        }\n        // dob will come in like this - $dt_19470815 or dateObject\n        if (profileKey === 'DOB') {\n          if (((!(/^\\$D_/).test(profileVal) || (profileVal + '').length !== 11)) && !isDateObject(profileVal)) {\n            valid = false\n            logger.error(DOB_ERROR)\n          }\n\n          if (isDateObject(profileVal)) {\n            profileObj[profileKey] = convertToWZRKDate(profileVal)\n          }\n        } else if (isDateObject(profileVal)) {\n          profileObj[profileKey] = convertToWZRKDate(profileVal)\n        }\n\n        if (profileKey === 'Phone' && !isObjectEmpty(profileVal)) {\n          if (profileVal.length > 8 && (profileVal.charAt(0) === '+')) { // valid phone number\n            profileVal = profileVal.substring(1, profileVal.length)\n            if (isConvertibleToNumber(profileVal)) {\n              profileObj.Phone = +profileVal\n            } else {\n              valid = false\n              logger.error(PHONE_FORMAT_ERROR + '. Removed.')\n            }\n          } else {\n            valid = false\n            logger.error(PHONE_FORMAT_ERROR + '. Removed.')\n          }\n        }\n\n        if (!valid) {\n          delete profileObj[profileKey]\n        }\n      }\n    }\n  }\n  return valid\n}\n\nexport const processFBUserObj = (user) => {\n  const profileData = {}\n  profileData.Name = user.name\n  if (user.id != null) {\n    profileData.FBID = user.id + ''\n  }\n  // Feb 2014 - FB announced over 58 gender options, hence we specifically look for male or female. Rest we don't care.\n  if (user.gender === 'male') {\n    profileData.Gender = 'M'\n  } else if (user.gender === 'female') {\n    profileData.Gender = 'F'\n  } else {\n    profileData.Gender = 'O'\n  }\n\n  const getHighestEducation = function (eduArr) {\n    if (eduArr != null) {\n      let college = ''\n      let highschool = ''\n\n      for (let i = 0; i < eduArr.length; i++) {\n        const edu = eduArr[i]\n        if (edu.type != null) {\n          const type = edu.type\n          if (type === 'Graduate School') {\n            return 'Graduate'\n          } else if (type === 'College') {\n            college = '1'\n          } else if (type === 'High School') {\n            highschool = '1'\n          }\n        }\n      }\n\n      if (college === '1') {\n        return 'College'\n      } else if (highschool === '1') {\n        return 'School'\n      }\n    }\n  }\n\n  if (user.relationship_status != null) {\n    profileData.Married = 'N'\n    if (user.relationship_status === 'Married') {\n      profileData.Married = 'Y'\n    }\n  }\n\n  const edu = getHighestEducation(user.education)\n  if (edu != null) {\n    profileData.Education = edu\n  }\n\n  const work = (user.work != null) ? user.work.length : 0\n  if (work > 0) {\n    profileData.Employed = 'Y'\n  } else {\n    profileData.Employed = 'N'\n  }\n\n  if (user.email != null) {\n    profileData.Email = user.email\n  }\n\n  if (user.birthday != null) {\n    const mmddyy = user.birthday.split('/') // comes in as \"08/15/1947\"\n    profileData.DOB = setDate(mmddyy[2] + mmddyy[0] + mmddyy[1])\n  }\n  return profileData\n}\n\nexport const processGPlusUserObj = (user, { logger }) => {\n  const profileData = {}\n  if (user.displayName != null) {\n    profileData.Name = user.displayName\n  }\n  if (user.id != null) {\n    profileData.GPID = user.id + ''\n  }\n\n  if (user.gender != null) {\n    if (user.gender === 'male') {\n      profileData.Gender = 'M'\n    } else if (user.gender === 'female') {\n      profileData.Gender = 'F'\n    } else if (user.gender === 'other') {\n      profileData.Gender = 'O'\n    }\n  }\n\n  if (user.image != null) {\n    if (user.image.isDefault === false) {\n      profileData.Photo = user.image.url.split('?sz')[0]\n    }\n  }\n\n  if (user.emails != null) {\n    for (let emailIdx = 0; emailIdx < user.emails.length; emailIdx++) {\n      const emailObj = user.emails[emailIdx]\n      if (emailObj.type === 'account') {\n        profileData.Email = emailObj.value\n      }\n    }\n  }\n\n  if (user.organizations != null) {\n    profileData.Employed = 'N'\n    for (let i = 0; i < user.organizations.length; i++) {\n      const orgObj = user.organizations[i]\n      if (orgObj.type === 'work') {\n        profileData.Employed = 'Y'\n      }\n    }\n  }\n\n  if (user.birthday != null) {\n    const yyyymmdd = user.birthday.split('-') // comes in as \"1976-07-27\"\n    profileData.DOB = setDate(yyyymmdd[0] + yyyymmdd[1] + yyyymmdd[2])\n  }\n\n  if (user.relationshipStatus != null) {\n    profileData.Married = 'N'\n    if (user.relationshipStatus === 'married') {\n      profileData.Married = 'Y'\n    }\n  }\n  logger.debug('gplus usr profile ' + JSON.stringify(profileData))\n\n  return profileData\n}\n\nexport const addToLocalProfileMap = (profileObj, override) => {\n  if (StorageManager._isLocalStorageSupported()) {\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n      if ($ct.globalProfileMap == null) {\n        $ct.globalProfileMap = {}\n      }\n    }\n\n    // Move props from custom bucket to outside.\n    if (profileObj._custom != null) {\n      const keys = profileObj._custom\n      for (const key in keys) {\n        if (keys.hasOwnProperty(key)) {\n          profileObj[key] = keys[key]\n        }\n      }\n      delete profileObj._custom\n    }\n\n    for (const prop in profileObj) {\n      if (profileObj.hasOwnProperty(prop)) {\n        if ($ct.globalProfileMap.hasOwnProperty(prop) && !override) {\n          continue\n        }\n        $ct.globalProfileMap[prop] = profileObj[prop]\n      }\n    }\n    if ($ct.globalProfileMap._custom != null) {\n      delete $ct.globalProfileMap._custom\n    }\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n  }\n}\n\nexport const closeIframe = (campaignId, divIdIgnored, currentSessionId) => {\n  if (campaignId != null && campaignId !== '-1') {\n    if (StorageManager._isLocalStorageSupported()) {\n      const campaignObj = getCampaignObject()\n\n      let sessionCampaignObj = campaignObj.wp[currentSessionId]\n      if (sessionCampaignObj == null) {\n        sessionCampaignObj = {}\n        campaignObj[currentSessionId] = sessionCampaignObj\n      }\n      sessionCampaignObj[campaignId] = 'dnd'\n      saveCampaignObject(campaignObj)\n    }\n  }\n  if ($ct.campaignDivMap != null) {\n    const divId = $ct.campaignDivMap[campaignId]\n    if (divId != null) {\n      document.getElementById(divId).style.display = 'none'\n      if (divId === 'intentPreview') {\n        if (document.getElementById('intentOpacityDiv') != null) {\n          document.getElementById('intentOpacityDiv').style.display = 'none'\n        }\n      }\n    }\n  }\n}\n\nexport const arp = (jsonMap) => {\n  // For unregister calls dont set arp in LS\n  if (jsonMap.skipResARP != null && jsonMap.skipResARP) {\n    console.debug('Update ARP Request rejected', jsonMap)\n    return null\n  }\n\n  const isOULARP = jsonMap[IS_OUL] === true\n\n  if (StorageManager._isLocalStorageSupported()) {\n    // Update arp only if it is null or an oul request\n    try {\n      let arpFromStorage = StorageManager.readFromLSorCookie(ARP_COOKIE)\n      if (arpFromStorage == null || isOULARP) {\n        arpFromStorage = {}\n        for (const key in jsonMap) {\n          if (jsonMap.hasOwnProperty(key)) {\n            if (jsonMap[key] === -1) {\n              delete arpFromStorage[key]\n            } else {\n              arpFromStorage[key] = jsonMap[key]\n            }\n          }\n        }\n        StorageManager.saveToLSorCookie(ARP_COOKIE, arpFromStorage)\n      }\n    } catch (e) {\n      console.error('Unable to parse ARP JSON: ' + e)\n    }\n  }\n}\n\nexport const getWrappedLink = (link, targetId, type, request, account, logger) => {\n  let data = {}\n  data.sendTo = link\n  data.targetId = targetId\n  data.epoch = getNow()\n\n  if (type != null) {\n    data.type = type\n  } else {\n    data.type = 'view'\n  }\n\n  data = request.addSystemDataToObject(data, undefined)\n  return addToURL(account.recorderURL, 'd', compressData(JSON.stringify(data), logger))\n}\n\nexport const getMessageTemplate = () => {\n  return `<div class=\"notice-message\">\n    <a href=\"[RECORDER_HREF]\" class=\"box\">\n      <div class=\"avatar\"><span class=\"fa [ICON] fa-4x fa-fw\"></span></div>\n      <div class=\"info\">\n        <div class=\"title\">[TITLE]</div>\n        <div class=\"clearfix\"></div>\n        <div class=\"text\">[TEXT]</div>\n      </div>\n      <div class=\"clearfix\"></div>\n    </a>\n  </div>\n  <div class=\"clearfix\"></div>`\n}\n\nexport const getMessageHeadTemplate = () => {\n  return `<head>\n    <base target=\"_parent\" />\n    <link rel=\"stylesheet\" href=\"http://static.clevertap.com/fa/font-awesome.css\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <style>\n    [STYLE]\n    </style>\n  </head>`\n}\n\nexport const setEnum = (enumVal, logger) => {\n  if (isString(enumVal) || isNumber(enumVal)) {\n    return '$E_' + enumVal\n  }\n  logger.error(ENUM_FORMAT_ERROR)\n}\nexport const handleEmailSubscription = (subscription, reEncoded, fetchGroups, account, logger) => {\n  const urlParamsAsIs = getURLParams(location.href) // can't use url_params as it is in lowercase above\n  const encodedEmailId = urlParamsAsIs.e\n  const encodedProfileProps = urlParamsAsIs.p\n  const pageType = urlParamsAsIs.page_type\n\n  if (typeof encodedEmailId !== 'undefined') {\n    const data = {}\n    data.id = account.id // accountId\n    data.unsubGroups = $ct.unsubGroups // unsubscribe groups\n\n    if ($ct.updatedCategoryLong) {\n      data[categoryLongKey] = $ct.updatedCategoryLong\n    }\n\n    let url = account.emailURL\n    if (fetchGroups) {\n      url = addToURL(url, 'fetchGroups', fetchGroups)\n    }\n    if (reEncoded) {\n      url = addToURL(url, 'encoded', reEncoded)\n    }\n    url = addToURL(url, 'e', encodedEmailId)\n    url = addToURL(url, 'd', compressData(JSON.stringify(data), logger))\n    if (encodedProfileProps) {\n      url = addToURL(url, 'p', encodedProfileProps)\n    }\n\n    if (subscription !== '-1') {\n      url = addToURL(url, 'sub', subscription)\n    }\n\n    if (pageType) {\n      $ct.globalUnsubscribe = pageType === GLOBAL\n      url = addToURL(url, 'page_type', pageType)\n    }\n    RequestDispatcher.fireRequest(url)\n  }\n}\n","import {\n  isObjectEmpty\n} from '../util/datatypes'\nimport {\n  isProfileValid,\n  processFBUserObj,\n  processGPlusUserObj,\n  addToLocalProfileMap\n} from '../util/clevertap'\nimport {\n  COMMAND_DELETE,\n  COMMAND_INCREMENT,\n  EVT_PUSH,\n  PR_COOKIE\n} from '../util/constants'\nimport {\n  addToURL\n} from '../util/url'\nimport {\n  StorageManager,\n  $ct\n} from '../util/storage'\nimport { compressData } from '../util/encoder'\nexport default class ProfileHandler extends Array {\n  #logger\n  #request\n  #account\n  #oldValues\n  #isPersonalisationActive\n\n  constructor ({\n    logger,\n    request,\n    account,\n    isPersonalisationActive\n  }, values) {\n    super()\n    this.#logger = logger\n    this.#request = request\n    this.#account = account\n    this.#oldValues = values\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  push (...profilesArr) {\n    this.#processProfileArray(profilesArr)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processProfileArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  getAttribute (propName) {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n    }\n    if ($ct.globalProfileMap != null) {\n      return $ct.globalProfileMap[propName]\n    }\n  }\n\n  #processProfileArray (profileArr) {\n    if (Array.isArray(profileArr) && profileArr.length > 0) {\n      for (const index in profileArr) {\n        if (profileArr.hasOwnProperty(index)) {\n          const outerObj = profileArr[index]\n          let data = {}\n          let profileObj\n          if (outerObj.Site != null) { // organic data from the site\n            profileObj = outerObj.Site\n            if (isObjectEmpty(profileObj) || !isProfileValid(profileObj, {\n              logger: this.#logger\n            })) {\n              return\n            }\n          } else if (outerObj.Facebook != null) { // fb connect data\n            const FbProfileObj = outerObj.Facebook\n            // make sure that the object contains any data at all\n\n            if (!isObjectEmpty(FbProfileObj) && (!FbProfileObj.error)) {\n              profileObj = processFBUserObj(FbProfileObj)\n            }\n          } else if (outerObj['Google Plus'] != null) {\n            const GPlusProfileObj = outerObj['Google Plus']\n            if (!isObjectEmpty(GPlusProfileObj) && (!GPlusProfileObj.error)) {\n              profileObj = processGPlusUserObj(GPlusProfileObj, { logger: this.#logger })\n            }\n          }\n          if (profileObj != null && (!isObjectEmpty(profileObj))) { // profile got set from above\n            data.type = 'profile'\n            if (profileObj.tz == null) {\n              // try to auto capture user timezone if not present\n              profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n            }\n\n            data.profile = profileObj\n            addToLocalProfileMap(profileObj, true)\n            data = this.#request.addSystemDataToObject(data, undefined)\n\n            this.#request.addFlags(data)\n            const compressedData = compressData(JSON.stringify(data), this.#logger)\n\n            let pageLoadUrl = this.#account.dataPostURL\n            pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n            pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n            this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   *\n   * @param {any} key\n   * @param {number} value\n   * @param {string} command\n   * increases or decreases value of the number type properties in profile object\n   */\n  _handleIncrementDecrementValue (key, value, command) {\n    // Check if the value is greater than 0\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n    }\n    if ($ct.globalProfileMap == null && !$ct.globalProfileMap?.hasOwnProperty(key)) {\n      // Check if the profile map already has the propery defined\n      console.error('Kindly create profile with required proprty to increment/decrement.')\n    } else if (!value || typeof value !== 'number' || value <= 0) {\n      console.error('Value should be a number greater than 0')\n    } else {\n      // Update the profile property in local storage\n      if (command === COMMAND_INCREMENT) {\n        $ct.globalProfileMap[key] = $ct.globalProfileMap[key] + value\n      } else {\n        $ct.globalProfileMap[key] = $ct.globalProfileMap[key] - value\n      }\n      StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n\n      // Send the updated value to LC\n      let data = {}\n      const profileObj = {}\n      data.type = 'profile'\n      profileObj[key] = { [command]: value }\n      if (profileObj.tz == null) {\n        // try to auto capture user timezone if not present\n        profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n      }\n      data.profile = profileObj\n      data = this.#request.addSystemDataToObject(data, true)\n\n      this.#request.addFlags(data)\n      const compressedData = compressData(JSON.stringify(data), this.#logger)\n      let pageLoadUrl = this.#account.dataPostURL\n      pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n      pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n      this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n    }\n  }\n\n  /**\n   *\n   * @param {any} key\n   * @param {array} arrayVal\n   * @param {string} command\n   * overwrites/sets new value(s) against a key/property in profile object\n   */\n  _handleMultiValueSet (key, arrayVal, command) {\n    const array = []\n    for (let i = 0; i < arrayVal.length; i++) {\n      if (typeof arrayVal[i] === 'number' && !array.includes(arrayVal[i])) {\n        array.push(arrayVal[i])\n      } else if (typeof arrayVal[i] === 'string' && !array.includes(arrayVal[i].toLowerCase())) {\n        array.push(arrayVal[i].toLowerCase())\n      } else {\n        console.error('array supports only string or number type values')\n      }\n    }\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE) ?? {}\n    }\n    $ct.globalProfileMap[key] = array\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n    this.sendMultiValueData(key, arrayVal, command)\n  }\n\n  /**\n   *\n   * @param {any} propKey - the property name to be added in the profile object\n   * @param {string, number, array} propVal - the property value to be added against the @propkey key\n   * @param {string} command\n   * Adds array or single value against a key/property in profile object\n   */\n  _handleMultiValueAdd (propKey, propVal, command) {\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE) || {}\n    }\n\n    const existingValue = $ct.globalProfileMap[propKey]\n    const array = Array.isArray(existingValue) ? existingValue : (existingValue != null ? [existingValue] : [])\n\n    const addValue = (value) => {\n      const normalizedValue = typeof value === 'number' ? value : value.toLowerCase()\n      if (!array.includes(normalizedValue)) {\n        array.push(normalizedValue)\n      }\n    }\n\n    if (Array.isArray(propVal)) {\n      propVal.forEach(value => {\n        if (typeof value === 'string' || typeof value === 'number') {\n          addValue(value)\n        } else {\n          this.#logger.error('Array supports only string or number type values')\n        }\n      })\n    } else if (typeof propVal === 'string' || typeof propVal === 'number') {\n      addValue(propVal)\n    } else {\n      this.#logger.error('Unsupported value type')\n      return\n    }\n\n    $ct.globalProfileMap[propKey] = array\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n    this.sendMultiValueData(propKey, propVal, command)\n  }\n\n  /**\n   *\n   * @param {any} propKey\n   * @param {string, number, array} propVal\n   * @param {string} command\n   * removes value(s) against a key/property in profile object\n   */\n  _handleMultiValueRemove (propKey, propVal, command) {\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE) || {}\n    }\n\n    if (!$ct.globalProfileMap.hasOwnProperty(propKey)) {\n      this.#logger.error(`The property ${propKey} does not exist.`)\n      return\n    }\n\n    const removeValue = (value) => {\n      const index = $ct.globalProfileMap[propKey].indexOf(value)\n      if (index !== -1) {\n        $ct.globalProfileMap[propKey].splice(index, 1)\n      }\n    }\n\n    if (Array.isArray(propVal)) {\n      propVal.forEach(removeValue)\n    } else if (typeof propVal === 'string' || typeof propVal === 'number') {\n      removeValue(propVal)\n    } else {\n      this.#logger.error('Unsupported propVal type')\n      return\n    }\n\n    // Remove the key if the array is empty\n    if ($ct.globalProfileMap[propKey].length === 0) {\n      delete $ct.globalProfileMap[propKey]\n    }\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n    this.sendMultiValueData(propKey, propVal, command)\n  }\n\n  /**\n   *\n   * @param {any} propKey\n   * @param {string} command\n   * deletes a key value pair from the profile object\n   */\n  _handleMultiValueDelete (propKey, command) {\n    if ($ct.globalProfileMap == null) {\n      $ct.globalProfileMap = StorageManager.readFromLSorCookie(PR_COOKIE)\n    }\n    if (!$ct?.globalProfileMap?.hasOwnProperty(propKey)) {\n      this.#logger.error(`The property ${propKey} does not exist.`)\n    } else {\n      delete $ct.globalProfileMap[propKey]\n    }\n    StorageManager.saveToLSorCookie(PR_COOKIE, $ct.globalProfileMap)\n    this.sendMultiValueData(propKey, null, command)\n  }\n\n  sendMultiValueData (propKey, propVal, command) {\n    // Send the updated value to LC\n    let data = {}\n    const profileObj = {}\n    data.type = 'profile'\n\n    // this removes the property at backend\n    profileObj[propKey] = { [command]: command === COMMAND_DELETE ? true : propVal }\n    if (profileObj.tz == null) {\n      profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n    }\n    data.profile = profileObj\n    data = this.#request.addSystemDataToObject(data, true)\n    this.#request.addFlags(data)\n    const compressedData = compressData(JSON.stringify(data), this.#logger)\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n    this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n  }\n}\n","import {\n  isObject,\n  isObjectEmpty\n} from '../util/datatypes'\nimport {\n  KCOOKIE_NAME,\n  GCOOKIE_NAME,\n  EVT_PUSH,\n  LRU_CACHE_SIZE,\n  IS_OUL,\n  CAMP_COOKIE_NAME,\n  CHARGEDID_COOKIE_NAME,\n  PR_COOKIE,\n  EV_COOKIE,\n  ARP_COOKIE,\n  CLEAR,\n  META_COOKIE,\n  FIRE_PUSH_UNREGISTERED\n} from '../util/constants'\nimport {\n  StorageManager,\n  $ct\n} from '../util/storage'\nimport LRUCache from '../util/lruCache'\nimport {\n  compressData\n} from '../util/encoder'\nimport {\n  addToURL,\n  getHostName\n} from '../util/url'\nimport {\n  isProfileValid,\n  processFBUserObj,\n  processGPlusUserObj,\n  addToLocalProfileMap\n} from '../util/clevertap'\n\nexport default class UserLoginHandler extends Array {\n  #request\n  #logger\n  #account\n  #session\n  #oldValues\n  #device\n\n  constructor ({\n    request,\n    account,\n    session,\n    logger,\n    device\n  },\n  values) {\n    super()\n    this.#request = request\n    this.#account = account\n    this.#session = session\n    this.#logger = logger\n    this.#oldValues = values\n    this.#device = device\n  }\n\n  // On User Login\n  #processOUL (profileArr) {\n    let sendOULFlag = true\n    StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, sendOULFlag)\n    const addToK = (ids) => {\n      let k = StorageManager.readFromLSorCookie(KCOOKIE_NAME)\n      const g = StorageManager.readFromLSorCookie(GCOOKIE_NAME)\n      let kId\n      if (k == null) {\n        k = {}\n        kId = ids\n      } else {\n        /* check if already exists */\n        kId = k.id\n        let anonymousUser = false\n        let foundInCache = false\n        if (kId == null) {\n          kId = ids[0]\n          anonymousUser = true\n        }\n        if ($ct.LRU_CACHE == null && StorageManager._isLocalStorageSupported()) {\n          $ct.LRU_CACHE = new LRUCache(LRU_CACHE_SIZE)\n        }\n\n        if (anonymousUser) {\n          if ((g) != null) {\n            // if have gcookie\n            $ct.LRU_CACHE.set(kId, g)\n            $ct.blockRequest = false\n          }\n        } else {\n          // check if the id is present in the cache\n          // set foundInCache to true\n          for (const idx in ids) {\n            if (ids.hasOwnProperty(idx)) {\n              const id = ids[idx]\n              if ($ct.LRU_CACHE.cache[id]) {\n                kId = id\n                foundInCache = true\n                break\n              }\n            }\n          }\n        }\n\n        if (foundInCache) {\n          if (kId !== $ct.LRU_CACHE.getLastKey()) {\n            // New User found\n            // remove the entire cache\n            this.#handleCookieFromCache()\n          } else {\n            sendOULFlag = false\n            StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, sendOULFlag)\n          }\n          const gFromCache = $ct.LRU_CACHE.get(kId)\n          $ct.LRU_CACHE.set(kId, gFromCache)\n          StorageManager.saveToLSorCookie(GCOOKIE_NAME, gFromCache)\n          this.#device.gcookie = gFromCache\n\n          const lastK = $ct.LRU_CACHE.getSecondLastKey()\n          if (StorageManager.readFromLSorCookie(FIRE_PUSH_UNREGISTERED) && lastK !== -1) {\n            // CACHED OLD USER FOUND. TRANSFER PUSH TOKEN TO THIS USER\n            const lastGUID = $ct.LRU_CACHE.cache[lastK]\n            this.#request.unregisterTokenForGuid(lastGUID)\n          }\n        } else {\n          if (!anonymousUser) {\n            this.clear()\n          } else {\n            if ((g) != null) {\n              this.#device.gcookie = g\n              StorageManager.saveToLSorCookie(GCOOKIE_NAME, g)\n              sendOULFlag = false\n            }\n          }\n          StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, false)\n          kId = ids[0]\n        }\n      }\n      k.id = kId\n      StorageManager.saveToLSorCookie(KCOOKIE_NAME, k)\n    }\n\n    if (Array.isArray(profileArr) && profileArr.length > 0) {\n      for (const index in profileArr) {\n        if (profileArr.hasOwnProperty(index)) {\n          const outerObj = profileArr[index]\n          let data = {}\n          let profileObj\n          if (outerObj.Site != null) { // organic data from the site\n            profileObj = outerObj.Site\n            if (isObjectEmpty(profileObj) || !isProfileValid(profileObj, {\n              logger: this.#logger\n            })) {\n              return\n            }\n          } else if (outerObj.Facebook != null) { // fb connect data\n            const FbProfileObj = outerObj.Facebook\n            // make sure that the object contains any data at all\n\n            if (!isObjectEmpty(FbProfileObj) && (!FbProfileObj.error)) {\n              profileObj = processFBUserObj(FbProfileObj)\n            }\n          } else if (outerObj['Google Plus'] != null) {\n            const GPlusProfileObj = outerObj['Google Plus']\n            if (isObjectEmpty(GPlusProfileObj) && (!GPlusProfileObj.error)) {\n              profileObj = processGPlusUserObj(GPlusProfileObj, { logger: this.#logger })\n            }\n          }\n          if (profileObj != null && (!isObjectEmpty(profileObj))) { // profile got set from above\n            data.type = 'profile'\n            if (profileObj.tz == null) {\n              // try to auto capture user timezone if not present\n              profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n            }\n\n            data.profile = profileObj\n            const ids = []\n            if (StorageManager._isLocalStorageSupported()) {\n              if (profileObj.Identity) {\n                ids.push(profileObj.Identity)\n              }\n              if (profileObj.Email) {\n                ids.push(profileObj.Email)\n              }\n              if (profileObj.GPID) {\n                ids.push('GP:' + profileObj.GPID)\n              }\n              if (profileObj.FBID) {\n                ids.push('FB:' + profileObj.FBID)\n              }\n              if (ids.length > 0) {\n                addToK(ids)\n              }\n            }\n            addToLocalProfileMap(profileObj, true)\n            data = this.#request.addSystemDataToObject(data, undefined)\n\n            this.#request.addFlags(data)\n            // Adding 'isOUL' flag in true for OUL cases which.\n            // This flag tells LC to create a new arp object.\n            // Also we will receive the same flag in response arp which tells to delete existing arp object.\n            if (sendOULFlag) {\n              data[IS_OUL] = true\n            }\n            const compressedData = compressData(JSON.stringify(data), this.#logger)\n            let pageLoadUrl = this.#account.dataPostURL\n            pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n            pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n            // Whenever sendOULFlag is true then dont send arp and gcookie (guid in memory in the request)\n            // Also when this flag is set we will get another flag from LC in arp which tells us to delete arp\n            // stored in the cache and replace it with the response arp.\n\n            this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest, sendOULFlag)\n          }\n        }\n      }\n    }\n  }\n\n  clear () {\n    this.#logger.debug('clear called. Reset flag has been set.')\n    this.#deleteUser()\n    StorageManager.setMetaProp(CLEAR, true)\n  }\n\n  #handleCookieFromCache () {\n    $ct.blockRequest = false\n    console.debug('Block request is false')\n    if (StorageManager._isLocalStorageSupported()) {\n      delete localStorage[PR_COOKIE]\n      delete localStorage[EV_COOKIE]\n      delete localStorage[META_COOKIE]\n      delete localStorage[ARP_COOKIE]\n      delete localStorage[CAMP_COOKIE_NAME]\n      delete localStorage[CHARGEDID_COOKIE_NAME]\n    }\n    StorageManager.removeCookie(CAMP_COOKIE_NAME, getHostName())\n    StorageManager.removeCookie(this.#session.cookieName, $ct.broadDomain)\n    StorageManager.removeCookie(ARP_COOKIE, $ct.broadDomain)\n    this.#session.setSessionCookieObject('')\n  }\n\n  #deleteUser () {\n    $ct.blockRequest = true\n    this.#logger.debug('Block request is true')\n    $ct.globalCache = {\n      gcookie: null,\n      REQ_N: 0,\n      RESP_N: 0\n    }\n    if (StorageManager._isLocalStorageSupported()) {\n      delete localStorage[GCOOKIE_NAME]\n      delete localStorage[KCOOKIE_NAME]\n      delete localStorage[PR_COOKIE]\n      delete localStorage[EV_COOKIE]\n      delete localStorage[META_COOKIE]\n      delete localStorage[ARP_COOKIE]\n      delete localStorage[CAMP_COOKIE_NAME]\n      delete localStorage[CHARGEDID_COOKIE_NAME]\n    }\n    StorageManager.removeCookie(GCOOKIE_NAME, $ct.broadDomain)\n    StorageManager.removeCookie(CAMP_COOKIE_NAME, getHostName())\n    StorageManager.removeCookie(KCOOKIE_NAME, getHostName())\n    StorageManager.removeCookie(this.#session.cookieName, $ct.broadDomain)\n    StorageManager.removeCookie(ARP_COOKIE, $ct.broadDomain)\n    this.#device.gcookie = null\n    this.#session.setSessionCookieObject('')\n  }\n\n  #processLoginArray (loginArr) {\n    if (Array.isArray(loginArr) && loginArr.length > 0) {\n      const profileObj = loginArr.pop()\n      const processProfile = profileObj != null && isObject(profileObj) &&\n          ((profileObj.Site != null && Object.keys(profileObj.Site).length > 0) ||\n              (profileObj.Facebook != null && Object.keys(profileObj.Facebook).length > 0) ||\n              (profileObj['Google Plus'] != null && Object.keys(profileObj['Google Plus']).length > 0))\n      if (processProfile) {\n        StorageManager.setInstantDeleteFlagInK()\n        try {\n          this.#processOUL([profileObj])\n        } catch (e) {\n          this.#logger.debug(e)\n        }\n      } else {\n        this.#logger.error('Profile object is in incorrect format')\n      }\n    }\n  }\n\n  push (...profilesArr) {\n    this.#processLoginArray(profilesArr)\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processLoginArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n}\n","export class CTWebPersonalisationBanner extends HTMLElement {\n  constructor () {\n    super()\n    this.shadow = this.attachShadow({ mode: 'open' })\n  }\n\n  _details = null\n  shadow = null\n\n  get details () {\n    return this._details || ''\n  }\n\n  set details (val) {\n    if (this._details === null) {\n      this._details = val\n      this.renderBanner()\n    }\n  }\n\n  renderBanner () {\n    this.shadow.innerHTML = this.getBannerContent()\n    if (this.trackClick !== false) {\n      this.addEventListener('click', () => {\n        const onClickUrl = this.details.onClick\n        if (onClickUrl) {\n          this.details.window ? window.open(onClickUrl, '_blank') : window.parent.location.href = onClickUrl\n        }\n        window.clevertap.renderNotificationClicked({ msgId: this.msgId, pivotId: this.pivotId })\n      })\n    }\n    window.clevertap.renderNotificationViewed({ msgId: this.msgId, pivotId: this.pivotId })\n  }\n\n  getBannerContent () {\n    return `\n      <style type=\"text/css\">\n        .banner {\n          position: relative;\n          cursor: ${this.details.onClick ? 'pointer' : ''}\n        }\n        img {\n          height: ${this.divHeight ? this.divHeight : 'auto'};\n          width: 100%;\n        }\n        .wrapper:is(.left, .right, .center) {\n          display: flex;\n          justify-content: center;\n          flex-direction: column;\n          align-items: center;\n          position: absolute;\n          width: 100%;\n          height: 100%;\n          overflow: auto;\n          top: 0;\n        }\n        ${this.details.css ? this.details.css : ''}\n      </style>\n      <div class=\"banner\">\n        <picture>\n          <source media=\"(min-width:480px)\" srcset=\"${this.details.desktopImageURL}\">\n          <source srcset=\"${this.details.mobileImageURL}\">\n          <img src=\"${this.details.desktopImageURL}\" alt=\"Please upload a picture\" style=\"width:100%;\" part=\"banner__img\">\n        </picture>\n        ${this.details.html ? this.details.html : ''}\n      </div>\n    `\n  }\n}\n","import { CTWebPersonalisationBanner } from './banner'\nexport class CTWebPersonalisationCarousel extends HTMLElement {\n  constructor () {\n    super()\n    this.shadow = this.attachShadow({ mode: 'open' })\n    if (customElements.get('ct-web-personalisation-banner') === undefined) {\n      customElements.define('ct-web-personalisation-banner', CTWebPersonalisationBanner)\n    }\n  }\n\n  _target = null\n  _carousel = null\n  shadow = null\n  slides = 0\n  previouslySelectedItem = -1\n  selectedItem = 1\n  autoSlide = null\n  stopAutoSlideTimeout = null\n\n  get target () {\n    return this._target || ''\n  }\n\n  set target (val) {\n    if (this._target === null) {\n      this._target = val\n      this.renderCarousel()\n    }\n  }\n\n  get details () {\n    return this.target.display.details\n  }\n\n  get display () {\n    return this.target.display\n  }\n\n  renderCarousel () {\n    this.slides = this.details.length\n    this.shadow.innerHTML = this.getStyles()\n    const carousel = this.getCarouselContent()\n    if (this.display.showNavBtns) {\n      carousel.insertAdjacentHTML('beforeend', this.display.navBtnsHtml)\n    }\n    if (this.display.showNavArrows) {\n      carousel.insertAdjacentHTML('beforeend', this.display.leftNavArrowHtml)\n      carousel.insertAdjacentHTML('beforeend', this.display.rightNavArrowHtml)\n    }\n    this._carousel = carousel\n    this.shadow.appendChild(carousel)\n    this.setupClick()\n    this.updateSelectedItem()\n    // TODO: enable conditionally\n    this.startAutoSlide()\n    this.setupOnHover()\n    window.clevertap.renderNotificationViewed({ msgId: this.target.wzrk_id, pivotId: this.target.wzrk_pivot })\n  }\n\n  setupClick () {\n    this._carousel.addEventListener('click', (event) => {\n      const eventID = event.target.id\n      if (eventID.startsWith('carousel__button')) {\n        const selected = +eventID.split('-')[1]\n        if (selected !== this.selectedItem) {\n          this.previouslySelectedItem = this.selectedItem\n          this.selectedItem = selected\n          this.updateSelectedItem()\n          this.startAutoSlide()\n        }\n      } else if (eventID.startsWith('carousel__arrow')) {\n        eventID.endsWith('right') ? this.goToNext() : this.goToPrev()\n        this.startAutoSlide()\n      } else if (eventID.indexOf('-') > -1) {\n        const item = +eventID.split('-')[1]\n        const index = item - 1\n        if (window.parent.clevertap) {\n          // console.log('Raise notification clicked event for ', item)\n          window.clevertap.renderNotificationClicked({ msgId: this.target.wzrk_id, pivotId: this.target.wzrk_pivot, wzrk_slideNo: item })\n        }\n        const url = this.details[index].onClick\n        if (url !== '') {\n          this.details[index].window ? window.open(url, '_blank') : window.location.href = url\n        }\n      }\n    })\n  }\n\n  setupOnHover () {\n    this._carousel.addEventListener('mouseenter', (event) => {\n      this.stopAutoSlideTimeout = setTimeout(() => {\n        this.autoSlide = clearInterval(this.autoSlide)\n      }, 500)\n    })\n\n    this._carousel.addEventListener('mouseleave', (event) => {\n      clearTimeout(this.stopAutoSlideTimeout)\n      if (this.autoSlide === undefined) {\n        this.startAutoSlide()\n      }\n    })\n  }\n\n  getCarouselContent () {\n    const carousel = document.createElement('div')\n    carousel.setAttribute('class', 'carousel')\n\n    this.details.forEach((detail, i) => {\n      const banner = document.createElement('ct-web-personalisation-banner')\n      banner.classList.add('carousel__item')\n      banner.trackClick = false\n      banner.setAttribute('id', `carousel__item-${i + 1}`)\n      banner.details = detail\n      carousel.appendChild(banner)\n    })\n\n    return carousel\n  }\n\n  getStyles () {\n    return `\n      <style>\n      .carousel {\n        position: relative;\n      }\n\n      .carousel__item {\n        display: none;\n        background-repeat: no-repeat;\n        background-size: cover;\n      }\n\n      ct-web-personalisation-banner::part(banner__img) {\n        height: ${this?.target?.display?.divHeight ? this.target.display.divHeight : 'auto'};\n        width: 100%;\n        transition: 2s;\n      }\n\n      .carousel__item--selected {\n        display: block;\n      }\n      ${this.display.navBtnsCss}\n      ${this.display.navArrowsCss}\n      </style>\n  `\n  }\n\n  updateSelectedItem () {\n    if (this.previouslySelectedItem !== -1) {\n      const prevItem = this.shadow.getElementById(`carousel__item-${this.previouslySelectedItem}`)\n      const prevButton = this.shadow.getElementById(`carousel__button-${this.previouslySelectedItem}`)\n      prevItem.classList.remove('carousel__item--selected')\n      if (prevButton) {\n        prevButton.classList.remove('carousel__button--selected')\n      }\n    }\n    const item = this.shadow.getElementById(`carousel__item-${this.selectedItem}`)\n    const button = this.shadow.getElementById(`carousel__button-${this.selectedItem}`)\n    item.classList.add('carousel__item--selected')\n    if (button) {\n      button.classList.add('carousel__button--selected')\n    }\n  }\n\n  startAutoSlide () {\n    clearInterval(this.autoSlide)\n    this.autoSlide = setInterval(() => {\n      this.goToNext()\n    }, this.display.sliderTime ? this.display.sliderTime * 1000 : 3000)\n  }\n\n  goToNext () {\n    this.goTo(this.selectedItem, (this.selectedItem + 1) % this.slides)\n  }\n\n  goToPrev () {\n    this.goTo(this.selectedItem, this.selectedItem - 1)\n  }\n\n  goTo (prev, cur) {\n    this.previouslySelectedItem = prev\n    this.selectedItem = cur\n    if (cur === 0) {\n      this.selectedItem = this.slides\n    }\n    this.updateSelectedItem()\n  }\n}\n","import {\n  getCampaignObject,\n  saveCampaignObject\n} from '../clevertap'\nimport { StorageManager } from '../storage'\n\nexport class CTWebPopupImageOnly extends HTMLElement {\n  constructor () {\n    super()\n    this.shadow = this.attachShadow({ mode: 'open' })\n  }\n\n    _target = null\n    _session = null\n    shadow = null\n    popup = null\n    container = null\n    resizeObserver = null\n\n    get target () {\n      return this._target || ''\n    }\n\n    set target (val) {\n      if (this._target === null) {\n        this._target = val\n        this.renderImageOnlyPopup()\n      }\n    }\n\n    get session () {\n      return this._session || ''\n    }\n\n    set session (val) {\n      this._session = val\n    }\n\n    get msgId () {\n      return this.target.wzrk_id\n    }\n\n    get pivotId () {\n      return this.target.wzrk_pivot\n    }\n\n    get onClickUrl () {\n      return this.target.display.onClickUrl\n    }\n\n    renderImageOnlyPopup () {\n      const campaignId = this.target.wzrk_id.split('_')[0]\n      const currentSessionId = this.session.sessionId\n\n      this.shadow.innerHTML = this.getImageOnlyPopupContent()\n      this.popup = this.shadowRoot.getElementById('imageOnlyPopup')\n      this.container = this.shadowRoot.getElementById('container')\n      this.closeIcon = this.shadowRoot.getElementById('close')\n\n      this.popup.addEventListener('load', this.updateImageAndContainerWidth())\n      this.resizeObserver = new ResizeObserver(() => this.handleResize(this.popup, this.container))\n      this.resizeObserver.observe(this.popup)\n\n      this.closeIcon.addEventListener('click', () => {\n        this.resizeObserver.unobserve(this.popup)\n        document.getElementById('wzrkImageOnlyDiv').style.display = 'none'\n        this.remove()\n        if (campaignId != null && campaignId !== '-1') {\n          if (StorageManager._isLocalStorageSupported()) {\n            const campaignObj = getCampaignObject()\n\n            let sessionCampaignObj = campaignObj.wp[currentSessionId]\n            if (sessionCampaignObj == null) {\n              sessionCampaignObj = {}\n              campaignObj[currentSessionId] = sessionCampaignObj\n            }\n            sessionCampaignObj[campaignId] = 'dnd'\n            saveCampaignObject(campaignObj)\n          }\n        }\n      })\n\n      window.clevertap.renderNotificationViewed({ msgId: this.msgId, pivotId: this.pivotId })\n\n      if (this.onClickUrl) {\n        this.popup.addEventListener('click', () => {\n          this.target.display.window ? window.open(this.onClickUrl, '_blank') : window.parent.location.href = this.onClickUrl\n          window.clevertap.renderNotificationClicked({ msgId: this.msgId, pivotId: this.pivotId })\n        })\n      }\n    }\n\n    handleResize (popup, container) {\n      const width = this.getRenderedImageWidth(popup)\n      container.style.setProperty('width', `${width}px`)\n    }\n\n    getImageOnlyPopupContent () {\n      return `\n        ${this.target.msgContent.css}\n        ${this.target.msgContent.html}\n      `\n    }\n\n    updateImageAndContainerWidth () {\n      return () => {\n        const width = this.getRenderedImageWidth(this.popup)\n        this.popup.style.setProperty('width', `${width}px`)\n        this.container.style.setProperty('width', `${width}px`)\n        this.container.style.setProperty('height', 'auto')\n        this.container.style.setProperty('position', 'fixed')\n        this.popup.style.setProperty('visibility', 'visible')\n        this.closeIcon.style.setProperty('visibility', 'visible')\n        document.getElementById('wzrkImageOnlyDiv').style.visibility = 'visible'\n      }\n    }\n\n    getRenderedImageWidth (img) {\n      const ratio = img.naturalWidth / img.naturalHeight\n      return img.height * ratio\n    }\n}\n","import { determineTimeStampText, greenTickSvg } from './helper'\nexport class Message extends HTMLElement {\n  constructor (config, message) {\n    super()\n    this.shadow = this.attachShadow({ mode: 'open' })\n    this.config = config\n    this.message = message\n    this.renderMessage(message)\n  }\n\n  wrapper = null\n  snackBar = null\n\n  get pivotId () {\n    return this.message.wzrk_pivot\n  }\n\n  get campaignId () {\n    return this.message.wzrk_id\n  }\n\n  createEl (type, id, part) {\n    const _el = document.createElement(type)\n    _el.setAttribute('id', id)\n    _el.setAttribute('part', part || id)\n    return _el\n  }\n\n  renderMessage (msg) {\n    this.wrapper = this.createEl('div', 'messageWrapper')\n\n    switch (msg.templateType) {\n      case 'text-only':\n      case 'text-with-icon':\n      case 'text-with-icon-and-image': {\n        const message = this.prepareBasicMessage(msg.msg[0])\n        this.wrapper.appendChild(message)\n      }\n    }\n\n    const timeStamp = this.createEl('div', 'timeStamp')\n    timeStamp.innerHTML = `<span>${determineTimeStampText(msg.id.split('_')[1])}<span>`\n    if (!msg.viewed) {\n      const unreadMarker = this.createEl('span', 'unreadMarker')\n      timeStamp.appendChild(unreadMarker)\n    }\n\n    this.wrapper.appendChild(timeStamp)\n    this.shadow.appendChild(this.wrapper)\n  }\n\n  prepareBasicMessage (msg) {\n    const message = this.createEl('div', 'message')\n\n    if (msg.imageUrl) {\n      const imageContainer = this.addImage(msg.imageUrl, 'mainImg')\n      message.appendChild(imageContainer)\n    }\n    const iconTitleDescWrapper = this.createEl('div', 'iconTitleDescWrapper')\n    if (msg.iconUrl) {\n      const iconContainer = this.addImage(msg.iconUrl, 'iconImg')\n      iconTitleDescWrapper.appendChild(iconContainer)\n    }\n    const titleDescWrapper = this.createEl('div', 'titleDescWrapper')\n    if (msg.title) {\n      const title = this.createEl('div', 'title')\n      title.innerText = msg.title\n      titleDescWrapper.appendChild(title)\n    }\n    if (msg.description) {\n      const description = this.createEl('div', 'description')\n      description.innerText = msg.description\n      titleDescWrapper.appendChild(description)\n    }\n    if (msg.title || msg.description) {\n      iconTitleDescWrapper.appendChild(titleDescWrapper)\n    }\n\n    if (msg.iconUrl || msg.title || msg.description) {\n      message.appendChild(iconTitleDescWrapper)\n    }\n    if (msg.buttons && msg.buttons.length) {\n      const buttonsContainer = this.addButtons(msg.buttons)\n      message.appendChild(buttonsContainer)\n    }\n    return message\n  }\n\n  addButtons (buttons = []) {\n    const buttonsContainer = this.createEl('div', 'buttonsContainer')\n    let hasCopyAction = false\n    buttons.forEach((b, i) => {\n      const button = this.createEl('button', `button-${i}`, 'button')\n      button.innerText = b.text\n      if (i > 0) {\n        button.style.cssText += 'margin-left: 2px;'\n      }\n      if (b.action === 'copy') {\n        hasCopyAction = true\n      }\n      buttonsContainer.appendChild(button)\n    })\n    if (hasCopyAction) {\n      this.addSnackbar(buttonsContainer)\n    }\n    return buttonsContainer\n  }\n\n  addSnackbar (buttonsContainer) {\n    this.snackBar = this.createEl('div', `snackbar-${this.campaignId}`, 'snackbar')\n    this.snackBar.innerHTML = greenTickSvg\n    const clipboardMsg = this.createEl('span', `snackbar-msg-${this.campaignId}`, 'snackbar-msg')\n    clipboardMsg.innerText = 'Copied to clipboard'\n    this.snackBar.appendChild(clipboardMsg)\n    buttonsContainer.appendChild(this.snackBar)\n  }\n\n  addImage (url, type) {\n    const imageContainer = this.createEl('div', `${type}Container`)\n    const image = this.createEl('img', type)\n    image.setAttribute('src', url)\n    // images will be fetched as and when the element comes into the viewport\n    image.setAttribute('loading', 'lazy')\n    imageContainer.appendChild(image)\n    return imageContainer\n  }\n\n  raiseClickedEvent (path, isPreview) {\n    switch (this.message.templateType) {\n      case 'text-only':\n      case 'text-with-icon':\n      case 'text-with-icon-and-image': {\n        this.raiseClickedForBasicTemplates(path, isPreview)\n      }\n    }\n  }\n\n  raiseClickedForBasicTemplates (path, isPreview) {\n    const msg = this.message.msg[0]\n    const payload = { msgId: this.campaignId, pivotId: this.pivotId }\n    if (path.tagName === 'BUTTON') {\n      const id = path.id.split('-')[1]\n      const button = msg.buttons[id]\n      payload.kv = {\n        wzrk_c2a: button.text\n      }\n      if (button.action === 'url') {\n        button.openUrlInNewTab ? window.open(button.url, '_blank') : (window.location = button.url)\n      } else if (button.action === 'copy') {\n        window.focus()\n        navigator.clipboard.writeText(button.clipboardText)\n        this.snackBar.style.setProperty('display', 'flex', 'important')\n        setTimeout(() => {\n          this.snackBar.style.setProperty('display', 'none', 'important')\n        }, 2000)\n      }\n    } else if (path.tagName === 'CT-INBOX-MESSAGE' && msg.onClickUrl) {\n      msg.openUrlInNewTab ? window.open(msg.onClickUrl, '_blank') : (window.location = msg.onClickUrl)\n    }\n    if (isPreview) {\n      console.log('Notifiction clicked event will be raised at run time with payload ::', payload)\n    } else {\n      window.clevertap.renderNotificationClicked(payload)\n    }\n  }\n}\n","export const messageStyles = ({ backgroundColor, borderColor, titleColor, descriptionColor, buttonColor, buttonTextColor, unreadMarkerColor }) => {\n  return `\n    <style id=\"messageStyles\">\n      ct-inbox-message::part(messageWrapper) {\n        margin-bottom: 16px; \n      }\n      ct-inbox-message::part(message) {\n        background-color: ${backgroundColor}; \n        border: 1px solid ${borderColor};\n        border-radius: 4px; \n        overflow: hidden;\n        min-height: 40px;\n      }\n      ct-inbox-message::part(message):hover {\n        box-shadow: 0px 4px 8px rgb(0 0 0 / 10%);\n        cursor: pointer;\n      }\n      ct-inbox-message::part(iconTitleDescWrapper) {\n        display: flex; \n        padding: 16px;\n      }\n      ct-inbox-message::part(titleDescWrapper) {\n        display: flex; \n        flex-direction: column;\n      }\n      ct-inbox-message::part(iconImgContainer) {\n        display: flex; \n        margin-right: 16px;\n      }\n      ct-inbox-message::part(mainImgContainer) {\n        line-height: 0;\n      }\n      ct-inbox-message::part(mainImg) {\n        width: 100%; \n        background: #b2b1ae;\n      }\n      ct-inbox-message::part(iconImg) {\n        height: 40px; \n        width: 40px;\n      }\n      ct-inbox-message::part(title) {\n        font-size: 14px !important; \n        line-height: 20px; \n        font-weight: 600; \n        color: ${titleColor}\n      }\n      ct-inbox-message::part(description) {\n        font-size: 14px !important; \n        line-height: 20px; \n        font-weight: 400; \n        color: ${descriptionColor}\n      }\n      ct-inbox-message::part(button) {\n        background-color: ${buttonColor}; \n        color: ${buttonTextColor}; \n        padding: 8px 16px; \n        font-size: 12px; \n        line-height: 16px; \n        font-weight: 600; \n        flex: 1; \n        border-radius: 0px; \n        text-transform: capitalize; \n        cursor: pointer; \n        border: none;\n      }\n      ct-inbox-message::part(buttonsContainer) {\n        display: flex;\n        position: relative;\n      }\n      ct-inbox-message::part(snackbar) {\n        position: absolute;\n        top: calc(-100% - 12px);\n        left: 50%;\n        transform: translate(-50%, 0px);\n        font-size: 14px;\n        font-weight: 400;\n        background: #FFFFFF;\n        border: 1px solid #ECEDF2;\n        box-shadow: 0px 4px 8px rgb(0 0 0 / 6%), 0px 0px 2px rgb(0 0 0 / 4%);\n        border-radius: 4px;\n        z-index: 2;\n        display: none;\n        width: max-content;\n        align-items: center;\n        padding: 8px 16px;\n        justify-content: center;\n      }\n\n      ct-inbox-message::part(snackbar-msg) {\n        color: black;\n        margin-left: 8px;\n      }\n\n      ct-inbox-message::part(timeStamp) {\n        display: flex; \n        justify-content: end; \n        align-items: center; \n        margin-top: 4px; \n        font-size: 12px !important; \n        line-height: 16px; \n        color: black;\n      }\n      ct-inbox-message::part(unreadMarker) {\n        height: 8px; \n        width: 8px; \n        border-radius: 50%; \n        background-color: ${unreadMarkerColor}; \n        margin-left: 8px;\n      }\n      @media only screen and (min-width: 420px) {\n        ct-inbox-message::part(mainImg) {\n          height: 180px;\n        }\n      }\n    </style>\n  `\n}\n\nexport const inboxContainerStyles = ({\n  panelBackgroundColor,\n  panelBorderColor,\n  headerBackgroundColor,\n  headerTitleColor,\n  closeIconColor,\n  categoriesTabColor,\n  categoriesTitleColor,\n  categoriesBorderColor,\n  selectedCategoryTabColor,\n  selectedCategoryTitleColor,\n  selectedCategoryBorderColor,\n  headerCategoryHeight\n}) => {\n  return `\n      <style id=\"webInboxStyles\">\n        #inbox {\n          width: 100%;\n          position: fixed;\n          background-color: #fff; \n          display: none; \n          box-shadow: 0px 2px 10px 0px #d7d7d791;\n          background-color: ${panelBackgroundColor}; \n          border: 1px solid ${panelBorderColor};\n          top: 0;\n          left: 0;\n          height: 100%;\n          overflow: auto;\n          z-index: 1;\n          box-sizing: content-box;\n          border-radius: 4px;\n        }\n  \n        #emptyInboxMsg {\n          display: block;\n          padding: 10px;\n          text-align: center;\n          color: black;\n        }\n  \n        #header {\n          height: 36px; \n          width: 100%; \n          display: flex; \n          justify-content: center; \n          align-items: center; \n          background-color: ${headerBackgroundColor}; \n          background-color: var(--card-bg, ${headerBackgroundColor});\n          color: ${headerTitleColor}\n        }\n  \n        #closeInbox {\n          font-size: 20px; \n          margin-right: 12px; \n          color: ${closeIconColor}; \n          cursor: pointer;\n        }\n  \n        #headerTitle {\n          font-size: 14px; \n          line-height: 20px; \n          flex-grow: 1; \n          font-weight: 700; \n          text-align: center;\n          flex-grow: 1;\n          text-align: center;\n        }\n  \n        #categoriesContainer {\n          padding: 16px 16px 0 16px; \n          height: 32px; \n          display: flex;\n          scroll-behavior: smooth;\n          position: relative;\n        }\n\n        #categoriesWrapper {\n          height: 32px; \n          overflow-x: scroll;\n          display: flex;\n          white-space: nowrap;\n          scrollbar-width: none;\n        }\n\n        #categoriesWrapper::-webkit-scrollbar {\n          display: none;\n        }\n  \n        #leftArrow, #rightArrow {\n          height: 32px;\n          align-items: center;\n          font-weight: 700;\n          position: absolute;\n          z-index: 2;\n          pointer-events: auto;\n          cursor: pointer;\n          display: none;\n        }\n\n        #leftArrow {\n          left: 0;\n          padding-left: 4px;\n          padding-right: 16px;\n          background: linear-gradient(90deg, ${panelBackgroundColor} 0%, ${panelBackgroundColor}99 80%, ${panelBackgroundColor}0d 100%);\n        }\n\n        #rightArrow {\n          right: 0;\n          padding-right: 4px;\n          padding-left: 16px;\n          background: linear-gradient(-90deg, ${panelBackgroundColor} 0%, ${panelBackgroundColor}99 80%, ${panelBackgroundColor}0d 100%);\n        }\n\n        [id^=\"category-\"] {\n          display: flex; \n          flex: 1 1 0; \n          justify-content: center; \n          align-items: center; \n          font-size: 14px; \n          line-height: 20px; \n          background-color: ${categoriesTabColor}; \n          color: ${categoriesTitleColor}; \n          cursor: pointer;\n          padding: 6px 24px;\n          margin: 0 3px;\n          border-radius: 16px;\n          border: ${categoriesBorderColor ? '1px solid ' + categoriesBorderColor : 'none'};\n        }\n\n        [id^=\"category-\"][selected=\"true\"] {\n          background-color: ${selectedCategoryTabColor}; \n          color: ${selectedCategoryTitleColor}; \n          border: ${selectedCategoryBorderColor ? '1px solid ' + selectedCategoryBorderColor : 'none'}\n        }\n  \n        #inboxCard {\n          padding: 0 16px 0 16px;\n          overflow-y: auto;\n          box-sizing: border-box;\n          margin-top: 16px;\n        }\n\n        @media only screen and (min-width: 480px) {\n          #inbox {\n            width: var(--inbox-width, 392px);\n            height: var(--inbox-height, 546px);\n            position: var(--inbox-position, fixed);\n            right: var(--inbox-right, unset);\n            bottom: var(--inbox-bottom, unset);\n            top: var(--inbox-top, unset);\n            left: var(--inbox-left, unset);\n          }\n  \n          #inboxCard {\n            height: calc(var(--inbox-height, 546px) - ${headerCategoryHeight}px); \n          }\n  \n        }\n      </style>\n      `\n}\n","import { StorageManager, $ct } from '../../util/storage'\nimport { Message } from './Message'\nimport { inboxContainerStyles, messageStyles } from './inboxStyles'\nimport { getInboxPosition, determineTimeStampText, arrowSvg, getInboxMessages, saveInboxMessages } from './helper'\nimport { WEBINBOX_CONFIG, MAX_INBOX_MSG } from '../../util/constants'\n\nexport class Inbox extends HTMLElement {\n  constructor (logger) {\n    super()\n    this.logger = logger\n    this.shadow = this.attachShadow({ mode: 'open' })\n  }\n\n  isInboxOpen = false\n  isInboxFromFlutter = false\n  selectedCategory = null\n  unviewedMessages = {}\n  unviewedCounter = 0\n  isPreview = false\n  inboxConfigForPreview = {}\n\n  // dom references\n  inboxSelector = null\n  inbox = null\n  emptyInboxMsg = null\n  inboxCard = null\n  unviewedBadge = null\n  observer = null\n  selectedCategoryRef = null\n\n  get incomingMessages () {\n    return []\n  }\n\n  set incomingMessages (msgs = []) {\n    if (msgs.length > 0 && this.inbox) {\n      this.updateInboxMessages(msgs)\n    }\n  }\n\n  get incomingMessagesForPreview () {\n    return []\n  }\n\n  set incomingMessagesForPreview (msgs = []) {\n    const previewMsgs = {}\n    if (msgs.length > 0 && this.inbox) {\n      this.isPreview = true\n      this.unviewedCounter = 0\n      msgs.forEach((m) => {\n        const key = `${m.wzrk_id.split('_')[0]}_${Date.now()}`\n        m.id = key\n        previewMsgs[key] = m\n        this.unviewedMessages[key] = m\n        this.unviewedCounter++\n      })\n      this.buildUIForMessages(previewMsgs)\n      this.updateUnviewedBadgeCounter()\n    }\n  }\n\n  connectedCallback () {\n    this.init()\n  }\n\n  init () {\n    this.config = this.isPreview ? this.inboxConfigForPreview : StorageManager.readFromLSorCookie(WEBINBOX_CONFIG) || {}\n    if (Object.keys(this.config).length === 0) {\n      return\n    }\n    this.inboxSelector = document.getElementById(this.config.inboxSelector)\n    if (this.inboxSelector === null) {\n      return\n    }\n\n    if (this.config.styles.notificationsBadge) {\n      this.addUnviewedBadge()\n    } else if (this.unviewedBadge) {\n      this.unviewedBadge.remove()\n    }\n\n    this.createinbox()\n\n    /**\n     * We need to remove the listener as there could be a scenario where init would be called when\n     * we get updated web inbox settings from LC after the inbox has been initialised.\n     * It can so happen that the inbox-selector would have changed.\n     */\n    document.removeEventListener('click', this.addClickListenerOnDocument)\n    document.addEventListener('click', this.addClickListenerOnDocument)\n    this.config.categories.length && this.updateActiveCategory(this.selectedCategoryRef.innerText)\n\n    this.shadow.innerHTML = this.getInboxStyles()\n    this.shadow.appendChild(this.inbox)\n  }\n\n  addMsgsToInboxFromLS () {\n    const messages = this.deleteExpiredAndGetUnexpiredMsgs(false)\n    const msgIds = messages ? Object.keys(messages) : []\n    if (msgIds.length === 0) {\n      return\n    }\n    msgIds.forEach((m) => {\n      if (!messages[m].viewed) {\n        this.unviewedMessages[m] = messages[m]\n        this.unviewedCounter++\n      }\n    })\n    this.buildUIForMessages(messages)\n    this.updateUnviewedBadgeCounter()\n  }\n\n  /**\n   * @param {*} deleteMsgsFromUI - If this param is true, then we'll have to check the UI and delete expired messages from the DOM\n   * It'll be false when you are building the inbox layout for the very first time.\n   *\n   * This method reads the inbox messages from LS,\n   * based on the deleteMsgsFromUI flag deletes the expired messages from UI and decrements the unviewed counter if the message was not viewed,\n   * sorts the messages based on the date,\n   * saves the unexpired messages to LS\n   * and returns the sorted unexpired messages\n   *\n   * Scenarios when we encounter expired messages -\n   * 1. building ui for the 1st time, no need to decrement the unviewed counter as the correct count will be set at the time of rendering\n   * 2. UI is already built (deleteMsgsFromUI = true) and you open the inbox\n   *    a. You'll find the expired msg in inbox\n   *    b. You'll not find the expired msg in inbox.\n   *       This happens when we receive new messages from LC, increment unviewed counter, save it in LS. (We build the UI only when the user opens inbox.)\n   *  In both the above scenarios, we'll still have to decrement the unviewed counter if the message was not viewed.\n   */\n  deleteExpiredAndGetUnexpiredMsgs (deleteMsgsFromUI = true) {\n    let messages = getInboxMessages()\n\n    const now = Math.floor(Date.now() / 1000)\n    for (const msg in messages) {\n      if (messages[msg].wzrk_ttl && messages[msg].wzrk_ttl > 0 && messages[msg].wzrk_ttl < now) {\n        if (deleteMsgsFromUI) {\n          const el = this.shadowRoot.getElementById(messages[msg].id)\n          el && el.remove()\n          if (!messages[msg].viewed) {\n            this.unviewedCounter--\n            this.updateUnviewedBadgeCounter()\n          }\n        }\n        delete messages[msg]\n      }\n    }\n    if (messages && messages.length > 0) {\n      messages = Object.values(messages).sort((a, b) => b.date - a.date).reduce((acc, m) => { acc[m.id] = m; return acc }, {})\n    }\n    saveInboxMessages(messages)\n    return messages\n  }\n\n  updateInboxMessages (msgs = []) {\n    const inboxMsgs = this.deleteExpiredAndGetUnexpiredMsgs()\n    const date = Date.now()\n    const incomingMsgs = {}\n    msgs.forEach((m, i) => {\n      const key = `${m.wzrk_id.split('_')[0]}_${Date.now()}`\n      m.id = key\n      // We are doing this to preserve the order of the messages\n      m.date = date - i\n      m.viewed = 0\n      inboxMsgs[key] = m\n      incomingMsgs[key] = m\n      this.unviewedMessages[key] = m\n      this.unviewedCounter++\n    })\n    saveInboxMessages(inboxMsgs)\n    this.buildUIForMessages(incomingMsgs)\n    this.updateUnviewedBadgeCounter()\n  }\n\n  createEl (type, id, part) {\n    const _el = document.createElement(type)\n    _el.setAttribute('id', id)\n    _el.setAttribute('part', part || id)\n    return _el\n  }\n\n  addUnviewedBadge () {\n    if (!this.unviewedBadge) {\n      this.unviewedBadge = this.createEl('div', 'unviewedBadge')\n      // As this unviewedBadge element will be directly added to the DOM, we are defining inline styles\n      this.unviewedBadge.style.cssText = `display: none; position: absolute; height: 16px; width: 26px; border-radius: 8px; background-color: ${this.config.styles.notificationsBadge.backgroundColor}; font-size: 12px; color: ${this.config.styles.notificationsBadge.textColor}; font-weight: bold; align-items: center; justify-content: center;`\n      document.body.appendChild(this.unviewedBadge)\n    }\n    this.updateUnviewedBadgePosition()\n\n    // called when user switches b/w portrait and landscape mode.\n    window.addEventListener('resize', () => {\n      this.updateUnviewedBadgePosition()\n    })\n  }\n\n  updateUnviewedBadgePosition () {\n    const { top, right } = this.inboxSelector.getBoundingClientRect()\n    this.unviewedBadge.style.top = `${top - 8}px`\n    this.unviewedBadge.style.left = `${right - 8}px`\n  }\n\n  createinbox () {\n    this.inbox = this.createEl('div', 'inbox')\n    const header = this.createEl('div', 'header')\n\n    const headerTitle = this.createEl('div', 'headerTitle')\n    headerTitle.innerText = this.config.title\n\n    const closeIcon = this.createEl('div', 'closeInbox')\n    closeIcon.innerHTML = '&times'\n\n    header.appendChild(headerTitle)\n    header.appendChild(closeIcon)\n    this.inbox.appendChild(header)\n    if (this.config.categories.length) {\n      const categories = this.createCategories()\n      this.inbox.appendChild(categories)\n    }\n    this.inboxCard = this.createEl('div', 'inboxCard')\n    this.inbox.appendChild(this.inboxCard)\n\n    this.emptyInboxMsg = this.createEl('div', 'emptyInboxMsg')\n    this.emptyInboxMsg.innerText = 'All messages will be displayed here.'\n    this.inboxCard.appendChild(this.emptyInboxMsg)\n\n    // Intersection observer for notification viewed\n    const options = {\n      root: this.inboxCard,\n      rootMargin: '0px',\n      threshold: 0.5\n    }\n    this.observer = new IntersectionObserver((entries, observer) => { this.handleMessageViewed(entries) }, options)\n\n    this.addMsgsToInboxFromLS()\n  }\n\n  createCategories () {\n    const categoriesContainer = this.createEl('div', 'categoriesContainer')\n\n    const leftArrow = this.createEl('div', 'leftArrow')\n    leftArrow.innerHTML = arrowSvg\n    leftArrow.children[0].style = 'transform: rotate(180deg)'\n    leftArrow.addEventListener('click', () => {\n      this.shadowRoot.getElementById('categoriesWrapper').scrollBy(-70, 0)\n    })\n    categoriesContainer.appendChild(leftArrow)\n\n    const categoriesWrapper = this.createEl('div', 'categoriesWrapper')\n    const _categories = ['All', ...this.config.categories]\n    _categories.forEach((c, i) => {\n      const category = this.createEl('div', `category-${i}`, 'category')\n      category.innerText = c\n      if (i === 0) {\n        this.selectedCategoryRef = category\n      }\n      categoriesWrapper.appendChild(category)\n    })\n    categoriesContainer.appendChild(categoriesWrapper)\n\n    const rightArrow = this.createEl('div', 'rightArrow')\n    rightArrow.innerHTML = arrowSvg\n    rightArrow.addEventListener('click', () => {\n      this.shadowRoot.getElementById('categoriesWrapper').scrollBy(70, 0)\n    })\n    categoriesContainer.appendChild(rightArrow)\n\n    const options = { root: categoriesContainer, threshold: 0.9 }\n    const firstCategory = categoriesWrapper.children[0]\n    const lastCategory = categoriesWrapper.children[this.config.categories.length]\n\n    const firstCategoryObserver = new IntersectionObserver((e) => {\n      this.categoryObserverCb(leftArrow, e[0].intersectionRatio >= 0.9)\n    }, options)\n    firstCategoryObserver.observe(firstCategory)\n\n    const lastCategoryObserver = new IntersectionObserver((e) => {\n      this.categoryObserverCb(rightArrow, e[0].intersectionRatio >= 0.9)\n    }, options)\n    lastCategoryObserver.observe(lastCategory)\n\n    return categoriesContainer\n  }\n\n  categoryObserverCb (el, hide) {\n    if (!el) {\n      return\n    }\n    el.style.display = hide ? 'none' : 'flex'\n  }\n\n  updateActiveCategory (activeCategory) {\n    this.selectedCategory = activeCategory\n\n    this.inboxCard.scrollTop = 0\n    let counter = 0\n\n    this.prevCategoryRef && this.prevCategoryRef.setAttribute('selected', 'false')\n    this.selectedCategoryRef.setAttribute('selected', 'true')\n\n    this.inboxCard.childNodes.forEach(c => {\n      if (c.getAttribute('id') !== 'emptyInboxMsg') {\n        c.style.display = (this.selectedCategory === 'All' || c.getAttribute('category') === this.selectedCategory) ? 'block' : 'none'\n        if (c.style.display === 'block') {\n          counter++\n        }\n      }\n    })\n    if (counter === 0) {\n      this.emptyInboxMsg.innerText = `${activeCategory} messages will be displayed here.`\n      this.emptyInboxMsg.style.display = 'block'\n    } else {\n      this.emptyInboxMsg.style.display = 'none'\n    }\n  }\n\n  buildUIForMessages (messages = {}) {\n    !this.isPreview && this.updateTSForRenderedMsgs()\n    this.inboxCard.scrollTop = 0\n    const maxMsgsInInbox = this.config.maxMsgsInInbox ?? MAX_INBOX_MSG\n    const firstChild = this.inboxCard.firstChild\n\n    const sortedMsgs = Object.values(messages).sort((a, b) => b.date - a.date).map((m) => m.id)\n    for (const m of sortedMsgs) {\n      const item = new Message(this.config, messages[m])\n      item.setAttribute('id', messages[m].id)\n      item.setAttribute('pivot', messages[m].wzrk_pivot)\n      item.setAttribute('part', 'ct-inbox-message')\n      if (this.config.categories.length > 0) {\n        item.setAttribute('category', messages[m].tags[0] || '')\n        item.style.display = (this.selectedCategory === 'All' || messages[m].category === this.selectedCategory) ? 'block' : 'none'\n      } else {\n        item.style.display = 'block'\n      }\n      this.inboxCard.insertBefore(item, firstChild)\n      this.observer.observe(item)\n    }\n\n    let msgTotalCount = this.inboxCard.querySelectorAll('ct-inbox-message').length\n    while (msgTotalCount > maxMsgsInInbox) {\n      const ctInboxMsgs = this.inboxCard.querySelectorAll('ct-inbox-message')\n      if (ctInboxMsgs.length > 0) { ctInboxMsgs[ctInboxMsgs.length - 1].remove() }\n      msgTotalCount--\n    }\n    const hasMessages = this.inboxCard.querySelectorAll('ct-inbox-message[style*=\"display: block\"]').length\n    this.emptyInboxMsg.style.display = hasMessages ? 'none' : 'block'\n  }\n\n  /**\n   * Adds a click listener on the document. For every click we check\n   * 1. if the click has happenned within the inbox\n   *    - on close button, we close the inbox\n   *    - on any of the category, we set that as the activeCategory\n   *    - on any of the message, we mark raise notification clicked event. To identify the clicks on a button, we have p.id.startsWith('button-')\n   * 2. if the user has clicked on the inboxSelector, we toggle inbox\n   * 3. if the click is anywhere else on the UI and the inbox is open, we simply close it\n   */\n\n  addClickListenerOnDocument = (() => {\n    return (e) => {\n      if (e.composedPath().includes(this.inbox)) {\n        // path is not supported on FF. So we fallback to e.composedPath\n        const path = e.path || (e.composedPath && e.composedPath())\n        if (path.length) {\n          const id = path[0].id\n          if (id === 'closeInbox') {\n            this.toggleInbox()\n          } else if (id.startsWith('category-')) {\n            this.prevCategoryRef = this.selectedCategoryRef\n            this.selectedCategoryRef = path[0]\n            this.updateActiveCategory(path[0].innerText)\n          } else {\n            const _path = path.filter((p) => p.id?.startsWith('button-') || p.tagName === 'CT-INBOX-MESSAGE')\n            if (_path.length) {\n              const messageEl = _path[_path.length - 1]\n              messageEl.raiseClickedEvent(_path[0], this.isPreview)\n            }\n          }\n        }\n      } else if (this.inboxSelector.contains(e.target) || this.isInboxOpen) {\n        if (this.isInboxFromFlutter) {\n          this.isInboxFromFlutter = false\n        } else {\n          this.toggleInbox(e)\n        }\n      }\n    }\n  })()\n\n  /**\n   * This function will be called every time when a message comes into the inbox viewport and it's visibility increases to 50% or drops below 50%\n   * If a msg is 50% visible in the UI, we need to mark the message as viewed in LS and raise notification viewed event\n   */\n  handleMessageViewed (entries) {\n    const raiseViewedEvent = !this.isPreview\n    if (this.isInboxOpen) {\n      entries.forEach((e) => {\n        if (e.isIntersecting && this.unviewedMessages.hasOwnProperty(e.target.id) && e.target.message.viewed === 0) {\n          e.target.message.viewed = 1\n          if (raiseViewedEvent) {\n            window.clevertap.renderNotificationViewed({ msgId: e.target.campaignId, pivotId: e.target.pivotId })\n            this.updateMessageInLS(e.target.id, { ...e.target.message, viewed: 1 })\n            setTimeout(() => {\n              e.target.shadowRoot.getElementById('unreadMarker').style.display = 'none'\n            }, 1000)\n          } else {\n            console.log('Notifiction viewed event will be raised at run time with payload ::', { msgId: e.target.campaignId, pivotId: e.target.pivotId })\n          }\n          this.unviewedCounter--\n          this.updateUnviewedBadgeCounter()\n          delete this.unviewedMessages[e.target.id]\n        }\n      })\n    }\n  }\n\n  updateMessageInLS (key, value) {\n    if (!this.isPreview) {\n      const messages = getInboxMessages()\n      messages[key] = value\n      saveInboxMessages(messages)\n    }\n  }\n\n  // create a separte fn fro refactoring\n  toggleInbox (e) {\n    this.isInboxOpen = !this.isInboxOpen\n    this.isInboxFromFlutter = !!e?.rect\n    if (this.isInboxOpen) {\n      this.inboxCard.scrollTop = 0\n      !this.isPreview && this.deleteExpiredAndGetUnexpiredMsgs()\n      this.inbox.style.display = 'block'\n      this.inbox.style.zIndex = '2147483647' // zIndex should be max for the inbox to be rendered on top of all elements\n      if (this.config.categories.length) {\n        this.selectedCategoryRef.setAttribute('selected', 'false')\n        this.selectedCategoryRef = this.shadowRoot.getElementById('category-0')\n        this.updateActiveCategory(this.selectedCategoryRef.innerText)\n        this.shadowRoot.getElementById('categoriesWrapper').scrollLeft -= this.shadowRoot.getElementById('categoriesWrapper').scrollWidth\n      }\n      this.setInboxPosition(e)\n    } else {\n      this.inbox.style.display = 'none'\n    }\n  }\n\n  setInboxPosition (e) {\n    const windowWidth = window.outerWidth\n    const customInboxStyles = getComputedStyle($ct.inbox)\n    const top = customInboxStyles.getPropertyValue('--inbox-top')\n    const bottom = customInboxStyles.getPropertyValue('--inbox-bottom')\n    const left = customInboxStyles.getPropertyValue('--inbox-left')\n    const right = customInboxStyles.getPropertyValue('--inbox-right')\n    const hasPositionDefined = top || bottom || left || right\n    if (windowWidth > 481 && !hasPositionDefined) {\n      const res = getInboxPosition(e, this.inbox.clientHeight, this.inbox.clientWidth)\n      const xPos = res.xPos\n      const yPos = res.yPos\n      this.inbox.style.top = yPos + 'px'\n      this.inbox.style.left = xPos + 'px'\n    }\n  }\n\n  /**\n   * Updates the UI with the number of unviewed messages\n   * If there are more than 9 unviewed messages, we show the count as 9+\n   */\n\n  setBadgeStyle = (msgCount) => {\n    if (this.unviewedBadge !== null) {\n      this.unviewedBadge.innerText = msgCount > 9 ? '9+' : msgCount\n      this.unviewedBadge.style.display = msgCount > 0 ? 'flex' : 'none'\n    }\n  }\n\n  updateUnviewedBadgeCounter () {\n    if (this.isPreview) {\n      this.setBadgeStyle(this.unviewedCounter)\n      return\n    }\n    let counter = 0\n    this.inboxCard.querySelectorAll('ct-inbox-message').forEach((m) => {\n      const messages = getInboxMessages()\n      if (messages[m.id] && messages[m.id].viewed === 0) {\n        counter++\n      }\n    })\n    this.setBadgeStyle(counter)\n  }\n\n  updateTSForRenderedMsgs () {\n    this.inboxCard.querySelectorAll('ct-inbox-message').forEach((m) => {\n      const ts = m.id.split('_')[1]\n      m.shadow.getElementById('timeStamp').firstChild.innerText = determineTimeStampText(ts)\n    })\n  }\n\n  getInboxStyles () {\n    const headerHeight = 36\n    const categoriesHeight = this.config.categories.length ? 64 : 16\n\n    const styles = {\n      panelBackgroundColor: this.config.styles.panelBackgroundColor,\n      panelBorderColor: this.config.styles.panelBorderColor,\n      headerBackgroundColor: this.config.styles.header.backgroundColor,\n      headerTitleColor: this.config.styles.header.titleColor,\n      closeIconColor: this.config.styles.closeIconColor,\n      categoriesTabColor: this.config.styles.categories.tabColor,\n      categoriesTitleColor: this.config.styles.categories.titleColor,\n      selectedCategoryTabColor: this.config.styles.categories.selectedTab.tabColor,\n      selectedCategoryTitleColor: this.config.styles.categories.selectedTab.titleColor,\n      headerCategoryHeight: headerHeight + categoriesHeight\n    }\n    if (this.config.styles.categories.borderColor) {\n      styles.categoriesBorderColor = this.config.styles.categories.borderColor\n    }\n    if (this.config.styles.categories.selectedTab.borderColor) {\n      styles.selectedCategoryBorderColor = this.config.styles.categories.selectedTab.borderColor\n    }\n\n    const inboxStyles = inboxContainerStyles(styles)\n\n    const cardStyles = this.config.styles.cards\n    const msgStyles = messageStyles({\n      backgroundColor: cardStyles.backgroundColor,\n      borderColor: cardStyles.borderColor,\n      titleColor: cardStyles.titleColor,\n      descriptionColor: cardStyles.descriptionColor,\n      buttonColor: cardStyles.buttonColor,\n      buttonTextColor: cardStyles.buttonTextColor,\n      unreadMarkerColor: cardStyles.unreadMarkerColor\n    })\n\n    return inboxStyles + msgStyles\n  }\n}\n","import { StorageManager, $ct } from '../../util/storage'\nimport { Inbox } from './WebInbox'\nimport { Message } from './Message'\nimport { WEBINBOX_CONFIG, GCOOKIE_NAME, WEBINBOX } from '../../util/constants'\nimport { isValueValid } from '../../util/datatypes'\n\nexport const processWebInboxSettings = (webInboxSetting, isPreview = false) => {\n  const _settings = StorageManager.readFromLSorCookie(WEBINBOX_CONFIG) || {}\n  if (isPreview) {\n    $ct.inbox.inboxConfigForPreview = webInboxSetting\n    $ct.inbox.isPreview = true\n    $ct.inbox && $ct.inbox.init()\n  } else if (JSON.stringify(_settings) !== JSON.stringify(webInboxSetting)) {\n    StorageManager.saveToLSorCookie(WEBINBOX_CONFIG, webInboxSetting)\n    $ct.inbox && $ct.inbox.init()\n  }\n}\n\nexport const processInboxNotifs = (msg) => {\n  if (msg.inbox_preview) {\n    $ct.inbox.incomingMessagesForPreview = msg.inbox_notifs\n  } else {\n    $ct.inbox.incomingMessages = msg\n  }\n}\n\nexport const processWebInboxResponse = (msg) => {\n  if (msg.webInboxSetting) {\n    processWebInboxSettings(msg.webInboxSetting, msg.inbox_preview)\n  }\n  if (msg.inbox_notifs != null) {\n    processInboxNotifs(msg)\n  }\n}\n\nexport const addWebInbox = (logger) => {\n  checkAndRegisterWebInboxElements()\n  $ct.inbox = new Inbox({ logger })\n  document.body.appendChild($ct.inbox)\n}\n\nconst getAndMigrateInboxMessages = (guid) => {\n  const messages = StorageManager.readFromLSorCookie(WEBINBOX) || {}\n  // Doing this to migrate message to guid level\n  if (Object.keys(messages).length > 0 && Object.keys(messages)[0].includes('_')) {\n    const gudInboxObj = {}\n    gudInboxObj[guid] = messages\n    StorageManager.saveToLSorCookie(WEBINBOX, gudInboxObj)\n    return gudInboxObj\n  }\n  return messages\n}\n\nexport const getInboxMessages = () => {\n  const guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n  if (!isValueValid(guid)) { return {} }\n  const messages = getAndMigrateInboxMessages(guid)\n\n  return messages.hasOwnProperty(guid) ? messages[guid] : {}\n}\n\nexport const saveInboxMessages = (messages) => {\n  const guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n  if (!isValueValid(guid)) { return }\n  const storedInboxObj = getAndMigrateInboxMessages(guid)\n\n  const newObj = { ...storedInboxObj, [guid]: messages }\n  StorageManager.saveToLSorCookie(WEBINBOX, newObj)\n}\n\nexport const initializeWebInbox = (logger) => {\n  return new Promise((resolve, reject) => {\n    if (document.readyState === 'complete') {\n      addWebInbox(logger)\n      resolve()\n    } else {\n      const config = StorageManager.readFromLSorCookie(WEBINBOX_CONFIG) || {}\n      const onLoaded = () => {\n        /**\n         * We need this null check here because $ct.inbox could be initialised via init method too on document load.\n         * In that case we don't need to call addWebInbox method\n         */\n        if ($ct.inbox === null) {\n          addWebInbox(logger)\n        }\n        resolve()\n      }\n      window.addEventListener('load', () => {\n        /**\n         * Scripts can be loaded layzily, we may not get element from dom as it may not be mounted yet\n         * We will to check element for 10 seconds and give up\n         */\n        if (document.getElementById(config.inboxSelector)) {\n          onLoaded()\n        } else {\n          // check for element for next 10 seconds\n          let count = 0\n          if (count < 20) {\n            const t = setInterval(() => {\n              if (document.getElementById(config.inboxSelector)) {\n                onLoaded()\n                clearInterval(t)\n                resolve()\n              } else if (count >= 20) {\n                clearInterval(t)\n                logger.debug('Failed to add inbox')\n              }\n              count++\n            }, 500)\n          }\n        }\n      })\n    }\n  })\n}\n\nexport const checkAndRegisterWebInboxElements = () => {\n  if (customElements.get('ct-web-inbox') === undefined) {\n    customElements.define('ct-web-inbox', Inbox)\n    customElements.define('ct-inbox-message', Message)\n  }\n}\n\nexport const getInboxPosition = (e, inboxHeight, inboxWidth) => {\n  const horizontalScroll = document.scrollingElement.scrollLeft\n  const verticalScroll = document.scrollingElement.scrollTop\n  const windowWidth = window.innerWidth + horizontalScroll\n  const windowHeight = window.innerHeight + verticalScroll\n  const selectorRect = e.rect || e.target.getBoundingClientRect()\n  const selectorX = selectorRect.x + horizontalScroll\n  const selectorY = selectorRect.y + verticalScroll\n  const selectorLeft = selectorRect.left + horizontalScroll\n  const selectorRight = selectorRect.right + horizontalScroll\n  const selectorTop = selectorRect.top + verticalScroll\n  // const selectorBottom = selectorRect.bottom + verticalScroll\n  const selectorBottom = selectorRect.bottom\n  const selectorHeight = selectorRect.height\n  const selectorWidth = selectorRect.width\n  const selectorCenter = {\n    x: selectorX + (selectorWidth / 2),\n    y: selectorY + (selectorHeight / 2)\n  }\n  const halfOfInboxHeight = (inboxHeight / 2)\n  const halfOfInboxWidth = (inboxWidth / 2)\n  let inboxOnSide = false\n\n  let xPos, yPos\n\n  const padding = 16\n\n  /**\n   * y co-ordinates:\n   * Try to push the card downwards\n   * if that's not possible, push it upwards\n   * if that too is not possible, then the card will be placed on the side. Add some padding.\n   *\n   * x co-ordinates:\n   * If the card is on the side,\n   *    try to place it to the right. If it's not possible,\n   *    place it to the left\n   * If the card is either on top/ bottom, set the x co-ordinate such that the selector center and the inbox card center become the same\n   * Now,\n   *  if the left of the inbox card is < 0,\n   *    try to get the left aligned to the selectorLeft.\n   *    if that's not possible, simply set left to 0\n   *  if the right of the inbox card > windowWidth,\n   *    try to get the right of rhe inbox card aligned with the selectorRight\n   *    if that's not possible, simply set the inbox right to the window Right\n   */\n  if (selectorBottom + inboxHeight <= windowHeight) { // try to place the card down\n    const availableHeight = windowHeight - (selectorBottom + inboxHeight)\n    yPos = availableHeight >= padding ? selectorBottom + padding : selectorBottom + availableHeight\n  } else if (selectorTop - inboxHeight >= verticalScroll) { // try to place the card up\n    const availableHeight = selectorTop - inboxHeight\n    yPos = availableHeight >= padding ? selectorTop - inboxHeight - padding : selectorTop - inboxHeight - availableHeight\n  } else {\n    inboxOnSide = true\n    yPos = selectorCenter.y - halfOfInboxHeight // with this the y co-ordinate of the selector center and the inbox card center become the same\n    if (yPos < verticalScroll) {\n      yPos = verticalScroll\n    } else if (yPos + inboxHeight > windowHeight) {\n      yPos = windowHeight - inboxHeight\n    }\n  }\n\n  if (inboxOnSide) {\n    // See if we can place the card to the right of the selector\n    const inboxRight = selectorRight + inboxWidth\n    if (inboxRight <= windowWidth) {\n      const availableWidth = inboxRight + padding <= windowWidth ? padding : windowWidth - inboxRight\n      xPos = selectorRight + availableWidth\n    } else {\n      const inboxLeft = selectorLeft - inboxWidth\n      const availableWidth = inboxLeft - padding >= horizontalScroll ? padding : inboxLeft - horizontalScroll\n      xPos = inboxLeft - availableWidth\n    }\n  } else {\n    xPos = selectorCenter.x - halfOfInboxWidth\n    if (xPos < horizontalScroll) {\n      if (selectorLeft + inboxWidth <= windowWidth) {\n        xPos = selectorLeft\n      } else {\n        xPos = horizontalScroll\n      }\n    } else if (xPos + inboxWidth > windowWidth) {\n      if (selectorRight - inboxWidth >= horizontalScroll) {\n        xPos = selectorRight - inboxWidth\n      } else {\n        xPos = windowWidth - inboxWidth\n      }\n    }\n  }\n\n  return { xPos, yPos }\n}\n\nexport const determineTimeStampText = (ts) => {\n  const now = Date.now()\n  let diff = Math.floor((now - ts) / 60000)\n  if (diff < 5) {\n    return 'Just now'\n  }\n  if (diff < 60) {\n    return `${diff} minute${diff > 1 ? 's' : ''} ago`\n  }\n  diff = Math.floor(diff / 60)\n  if (diff < 24) {\n    return `${diff} hour${diff > 1 ? 's' : ''} ago`\n  }\n  diff = Math.floor(diff / 24)\n  return `${diff} day${diff > 1 ? 's' : ''} ago`\n}\n\nexport const hasWebInboxSettingsInLS = () => {\n  return Object.keys(StorageManager.readFromLSorCookie(WEBINBOX_CONFIG) || {}).length > 0\n}\n\nexport const arrowSvg = `<svg width=\"6\" height=\"10\" viewBox=\"0 0 6 10\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M0.258435 9.74751C-0.0478584 9.44825 -0.081891 8.98373 0.156337 8.64775L0.258435 8.52836L3.87106 5L0.258435 1.47164C-0.0478588 1.17239 -0.0818914 0.707867 0.156337 0.371887L0.258435 0.252494C0.564728 -0.0467585 1.04018 -0.0800085 1.38407 0.152743L1.50627 0.252494L5.74156 4.39042C6.04786 4.68968 6.08189 5.1542 5.84366 5.49018L5.74156 5.60957L1.50627 9.74751C1.16169 10.0842 0.603015 10.0842 0.258435 9.74751Z\" fill=\"#63698F\"/>\n</svg>\n`\nexport const greenTickSvg = `<svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16C12.4183 16 16 12.4183 16 8ZM9.6839 5.93602C9.97083 5.55698 10.503 5.48833 10.8725 5.78269C11.2135 6.0544 11.2968 6.54044 11.0819 6.91173L11.0219 7.00198L8.09831 10.864C7.80581 11.2504 7.26654 11.3086 6.90323 11.0122L6.82822 10.9433L5.04597 9.10191C4.71635 8.76136 4.71826 8.21117 5.05023 7.87303C5.35666 7.5609 5.83722 7.53855 6.16859 7.80482L6.24814 7.87739L7.35133 9.01717L9.6839 5.93602Z\" fill=\"#03A387\"/>\n</svg>\n`\n","export const OVERLAY_PATH = 'https://web-native-display-campaign.clevertap.com/production/lib-overlay/overlay.js'\nexport const CSS_PATH = 'https://web-native-display-campaign.clevertap.com/production/lib-overlay/style.css'\nexport const WVE_CLASS = {\n  FLICKER_SHOW: 'wve-anti-flicker-show',\n  FLICKER_HIDE: 'wve-anti-flicker-hide',\n  FLICKER_ID: 'wve-flicker-style'\n}\n","export const updateFormData = (element, formStyle) => {\n  // Update the element style\n  if (formStyle.style !== undefined) {\n    Object.keys(formStyle.style).forEach((property) => {\n      element.style.setProperty(property, formStyle.style[property])\n    })\n  }\n\n  // Update underline for element\n  if (formStyle.underline !== undefined) {\n    const curTextDecoration = element.style.textDecoration\n    if (formStyle.underline) {\n      element.style.textDecoration = `${curTextDecoration} underline`.trim()\n    } else {\n      element.style.textDecoration = curTextDecoration.replace('underline', '').trim()\n    }\n  }\n\n  // Update element text\n  if (formStyle.text !== undefined) {\n    element.innerText = formStyle.text\n  }\n\n  // Handle element onClick\n  if (formStyle.clickDetails !== undefined) {\n    const url = formStyle.clickDetails.clickUrl\n    element.onclick = formStyle.clickDetails.newTab\n      ? () => window.open(url, '_blank').focus()\n      : () => { window.location.href = url }\n  }\n\n  // Set the image source\n  if (formStyle.imgURL !== undefined && element.tagName.toLowerCase() === 'img') {\n    element.src = formStyle.imgURL\n  }\n\n  // Handle elementCss\n  if (formStyle.elementCss !== undefined) {\n    const style = document.createElement('style')\n    style.innerHTML = formStyle.elementCss\n    document.head.appendChild(style)\n  }\n}\n","import { CSS_PATH, OVERLAY_PATH, WVE_CLASS } from './builder_constants'\nimport { updateFormData } from './dataUpdate'\n\nexport const checkBuilder = (logger, accountId) => {\n  const search = window.location.search\n  const parentWindow = window.opener\n\n  if (search === '?ctBuilder') {\n    // open in visual builder mode\n    logger.debug('open in visual builder mode')\n    window.addEventListener('message', handleMessageEvent, false)\n    if (parentWindow) {\n      parentWindow.postMessage({ message: 'builder', originUrl: window.location.href }, '*')\n    }\n    return\n  }\n  if (search === '?ctBuilderPreview') {\n    window.addEventListener('message', handleMessageEvent, false)\n    if (parentWindow) {\n      parentWindow.postMessage({ message: 'preview', originUrl: window.location.href }, '*')\n    }\n  }\n\n  if (search === '?ctBuilderSDKCheck') {\n    if (parentWindow) {\n      parentWindow.postMessage({\n        message: 'SDKVersion',\n        accountId,\n        originUrl: window.location.href,\n        sdkVersion: '$$PACKAGE_VERSION$$'\n      },\n      '*'\n      )\n    }\n  }\n}\n\nconst handleMessageEvent = (event) => {\n  if (event.data && isValidUrl(event.data.originUrl)) {\n    const msgOrigin = new URL(event.data.originUrl).origin\n    if (event.origin !== msgOrigin) {\n      return\n    }\n  } else {\n    return\n  }\n  if (event.data.message === 'Dashboard') {\n    initialiseCTBuilder(event.data.url, event.data.variant ?? null, event.data.details ?? {})\n  } else if (event.data.message === 'Overlay') {\n    renderVisualBuilder(event.data, true)\n  }\n}\n/**\n * Initializes the Clevertap builder.\n * @param {string} url - The URL to initialize the builder.\n * @param {string} variant - The variant of the builder.\n * @param {Object} details - The details object.\n */\nconst initialiseCTBuilder = (url, variant, details) => {\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', () => onContentLoad(url, variant, details))\n  } else {\n    onContentLoad(url, variant, details)\n  }\n}\n\nlet container\nlet contentLoaded = false\n/**\n * Handles content load for Clevertap builder.\n */\nfunction onContentLoad (url, variant, details) {\n  if (!contentLoaded) {\n    document.body.innerHTML = ''\n    container = document.createElement('div')\n    container.id = 'overlayDiv'\n    container.style.position = 'relative' // Ensure relative positioning for absolute positioning of form\n    container.style.display = 'flex'\n    document.body.appendChild(container)\n    const overlayPath = OVERLAY_PATH\n    loadOverlayScript(overlayPath, url, variant, details)\n      .then(() => {\n        console.log('Overlay script loaded successfully.')\n        contentLoaded = true\n      })\n      .catch((error) => {\n        console.error('Error loading overlay script:', error)\n      })\n    loadCSS()\n    loadTypeKit()\n  }\n}\n\n/**\n * Loads CSS file.\n */\nfunction loadCSS () {\n  var link = document.createElement('link')\n  link.rel = 'stylesheet'\n  link.type = 'text/css'\n  link.href = CSS_PATH\n  document.head.appendChild(link)\n}\n\n/**\n * Loads the overlay script.\n * @param {string} overlayPath - The path to overlay script.\n * @param {string} url - The URL.\n * @param {string} variant - The variant.\n * @param {Object} details - The details object.\n * @returns {Promise} A promise.\n */\nfunction loadOverlayScript (overlayPath, url, variant, details) {\n  return new Promise((resolve, reject) => {\n    var script = document.createElement('script')\n    script.type = 'module'\n    script.src = overlayPath\n    script.onload = function () {\n      if (typeof window.Overlay === 'function') {\n        window.Overlay({ id: '#overlayDiv', url, variant, details })\n        resolve()\n      } else {\n        reject(new Error('ContentLayout not found in overlay.js'))\n      }\n    }\n    script.onerror = function (error) {\n      reject(error)\n    }\n    document.head.appendChild(script)\n  })\n}\n\n/**\n * Loads TypeKit script.\n */\nfunction loadTypeKit () {\n  const config = {\n    kitId: 'eqj6nom',\n    scriptTimeout: 3000,\n    async: true\n  }\n\n  const docElement = document.documentElement\n  const timeoutId = setTimeout(function () {\n    docElement.className = docElement.className.replace(/\\bwf-loading\\b/g, '') + ' wf-inactive'\n  }, config.scriptTimeout)\n  const typeKitScript = document.createElement('script')\n  let scriptLoaded = false\n  const firstScript = document.getElementsByTagName('script')[0]\n  let scriptReadyState\n\n  docElement.className += ' wf-loading'\n  typeKitScript.src = 'https://use.typekit.net/' + config.kitId + '.js'\n  typeKitScript.async = true\n  typeKitScript.onload = typeKitScript.onreadystatechange = function () {\n    scriptReadyState = this.readyState\n    if (scriptLoaded || (scriptReadyState && scriptReadyState !== 'complete' && scriptReadyState !== 'loaded')) return\n    scriptLoaded = true\n    clearTimeout(timeoutId)\n    try {\n      // eslint-disable-next-line no-undef\n      Typekit.load(config)\n    } catch (e) {}\n  }\n\n  firstScript.parentNode.insertBefore(typeKitScript, firstScript)\n}\n\n/**\n * Renders the visual builder.\n * @param {Object} targetingMsgJson - The point and click campaign JSON object.\n * @param {boolean} isPreview - Indicates if it's a preview.\n */\nexport const renderVisualBuilder = (targetingMsgJson, isPreview) => {\n  const details = isPreview ? targetingMsgJson.details[0] : targetingMsgJson.display.details[0]\n  const siteUrl = Object.keys(details)[0]\n  const selectors = details[siteUrl]\n  let elementDisplayed = false\n\n  if (siteUrl !== window.location.href.split('?')[0]) return\n\n  const processElement = (element, selector) => {\n    if (selectors[selector].html) {\n      element.outerHTML = selectors[selector].html\n    } else if (selectors[selector].json) {\n      dispatchJsonData(targetingMsgJson, selectors[selector])\n    } else {\n      updateFormData(element, selectors[selector].form)\n    }\n  }\n\n  const tryFindingElement = (selector) => {\n    let count = 0\n    const intervalId = setInterval(() => {\n      const retryElement = document.querySelector(selector)\n      if (retryElement) {\n        processElement(retryElement, selector)\n        clearInterval(intervalId)\n      } else if (++count >= 20) {\n        console.log(`No element present on DOM with selector '${selector}'.`)\n        clearInterval(intervalId)\n      }\n    }, 500)\n  }\n\n  Object.keys(selectors).forEach(selector => {\n    const element = document.querySelector(selector)\n    if (element) {\n      processElement(element, selector)\n      elementDisplayed = true\n    } else {\n      tryFindingElement(selector)\n    }\n  })\n\n  if (elementDisplayed && !isPreview) {\n    window.clevertap.renderNotificationViewed({\n      msgId: targetingMsgJson.wzrk_id,\n      pivotId: targetingMsgJson.wzrk_pivot\n    })\n  }\n}\n\n/**\n * Dispatches JSON data.\n * @param {Object} targetingMsgJson - The point and click campaign JSON object.\n * @param {Object} selector - The selector object.\n */\nfunction dispatchJsonData (targetingMsgJson, selector) {\n  const inaObj = {}\n  inaObj.msgId = targetingMsgJson.wzrk_id\n  if (targetingMsgJson.wzrk_pivot) {\n    inaObj.pivotId = targetingMsgJson.wzrk_pivot\n  }\n  if (selector.json != null) {\n    inaObj.json = selector.json\n  }\n  const kvPairsEvent = new CustomEvent('CT_web_native_display_buider', { detail: inaObj })\n  document.dispatchEvent(kvPairsEvent)\n}\n\nfunction isValidUrl (string) {\n  try {\n    const url = new URL(string)\n    return Boolean(url)\n  } catch (_err) {\n    return false\n  }\n}\n\nexport function addAntiFlicker (antiFlicker) {\n  const { personalizedSelectors = [], delayTime = 2000 } = antiFlicker\n  const retryElements = {} // Track selectors that need retry\n  let retryCount = 0 // Counter for retries\n  let retryInterval\n  function isInViewport (element) {\n    const rect = element.getBoundingClientRect()\n    const { innerHeight: windowHeight, innerWidth: windowWidth } = window\n    return (\n      rect.bottom > 0 &&\n      rect.right > 0 &&\n      rect.top < windowHeight &&\n      rect.left < windowWidth\n    )\n  }\n  (function () {\n    const styleContent = `\n      .wve-anti-flicker-hide {\n        opacity: 0 !important\n      }\n      .wve-anti-flicker-show {\n        transition: opacity 0.5s, filter 0.5s !important\n      }\n    `\n    // Create and append the style element if it doesn't exist\n    const styleId = WVE_CLASS.FLICKER_ID\n    if (!document.getElementById(styleId)) {\n      const styleElement = document.createElement('style')\n      styleElement.id = styleId\n      styleElement.textContent = styleContent\n      document.head.appendChild(styleElement)\n    }\n  })()\n  function applyAntiFlicker (selectors) {\n    function processSelectors (selectorElements) {\n      const elements = []\n      selectorElements.forEach(selector => {\n        const matchedElements = document.querySelectorAll(selector)\n        if (matchedElements.length) {\n          matchedElements.forEach(el => {\n            if (isInViewport(el)) {\n              elements.push(el)\n            }\n          })\n          delete retryElements[selector] // Successfully processed, remove from retry list\n        } else {\n          retryElements[selector] = false // Add to retry list if not found\n        }\n      })\n      applyStyles(elements)\n    }\n    function retryProcessing () {\n      processSelectors(Object.keys(retryElements))\n      retryCount++\n      if (Object.keys(retryElements).length === 0 || retryCount > 20) {\n        retryCount = 0\n        clearInterval(retryInterval)\n      }\n    }\n    processSelectors(selectors)\n    if (Object.keys(retryElements).length) {\n      retryInterval = setInterval(retryProcessing, 100)\n    }\n  }\n  function applyStyles (elements) {\n    elements.forEach(el => el.classList.add(WVE_CLASS.FLICKER_HIDE))\n    setTimeout(() => {\n      elements.forEach(el => {\n        el.classList.remove(WVE_CLASS.FLICKER_HIDE)\n        el.classList.add(WVE_CLASS.FLICKER_SHOW)\n      })\n    }, delayTime) // Apply styles after maxRenderTime\n  }\n  function observeUrlChange () {\n    let previousHref = document.location.href\n    const observer = new MutationObserver(() => {\n      if (previousHref !== document.location.href) {\n        previousHref = document.location.href\n        applyAntiFlicker(personalizedSelectors)\n      }\n    })\n    observer.observe(document.body, { childList: true, subtree: true })\n  }\n  window.addEventListener('load', () => {\n    observeUrlChange()\n    applyAntiFlicker(personalizedSelectors)\n  })\n}\n","export const getBoxPromptStyles = (style) => {\n  return `\n    #pnWrapper {\n    }\n\n    #pnOverlay {\n      background-color: ${style.overlay.color || 'rgba(0, 0, 0, .15)'};\n      position: fixed;\n      left: 0;\n      right: 0;\n      top: 0;\n      bottom: 0;\n      z-index: 10000\n    }\n\n    #pnCard {\n      background-color: ${style.card.color};\n      border-radius: ${style.card.borderRadius}px;\n      padding: 16px;\n      width: 360px;\n      position: fixed;\n      z-index: 999999;\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n      ${style.card.borderEnabled ? `\n        border-width: ${style.card.border.borderWidth}px;\n        border-color: ${style.card.border.borderColor};\n        border-style: solid;\n      ` : ''}\n    }\n\n    #iconTitleDescWrapper {\n      display: flex;\n      align-items: center;\n      margin-bottom: 16px;\n      gap: 4px;\n    }\n\n    #iconContainer {\n      margin-right: 16px;\n    }\n\n    #imgElement {\n      width: 64px;\n      height: 64px;\n    }\n\n    #titleDescWrapper {\n      flex-grow: 1;\n    }\n\n    #title {\n      font-size: 18px;\n      font-weight: bold;\n      color: ${style.text.titleColor};\n      margin-bottom: 4px;\n    }\n\n    #description {\n      font-size: 14px;\n      color: ${style.text.descriptionColor};\n    }\n\n    #buttonsContainer {\n      display: flex;\n      justify-content: space-between;\n      height: 32px;\n      gap: 8px;\n    }\n\n    #primaryButton, #secondaryButton {\n      padding: 16px;\n      flex: 1;\n      cursor: pointer;\n      font-weight: bold;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n\n    #primaryButton {\n      background-color: ${style.buttons.primaryButton.buttonColor};\n      color: ${style.buttons.primaryButton.textColor};\n      border-radius: ${style.buttons.primaryButton.borderRadius}px;\n      ${style.buttons.primaryButton.borderEnabled ? `\n        border-width: ${style.buttons.primaryButton.border.borderWidth}px;\n        border-color: ${style.buttons.primaryButton.border.borderColor};\n        border-style: solid;\n      ` : ''}\n    }\n\n    #secondaryButton {\n      background-color: ${style.buttons.secondaryButton.buttonColor};\n      color: ${style.buttons.secondaryButton.textColor};\n      border-radius: ${style.buttons.secondaryButton.borderRadius}px;\n      ${style.buttons.secondaryButton.borderEnabled ? `\n        border-width: ${style.buttons.secondaryButton.border.borderWidth}px;\n        border-color: ${style.buttons.secondaryButton.border.borderColor};\n        border-style: solid;\n      ` : ''}\n    }\n\n    #primaryButton:hover, #secondaryButton:hover {\n      opacity: 0.9;\n    }\n  `\n}\n\nexport const getBellIconStyles = (style) => {\n  return `\n    #bell_wrapper {\n      position: fixed;\n      cursor: pointer;\n      background-color: ${style.card.backgroundColor};\n      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n      width: 48px;\n      height: 48px;\n      border-radius: 50%;\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n      z-index: 999999;\n    }\n\n    #bell_icon {\n      display: block;\n      width: 48px;\n      height: 48px;\n    }\n\n    #bell_wrapper:hover {\n      transform: scale(1.05);\n      transition: transform 0.2s ease-in-out;\n    }\n\n    #bell_tooltip {\n      display: none;\n      background-color: rgba(43, 46, 62, .9);\n      color: #fff;\n      border-radius: 4px;\n      padding: 4px;\n      white-space: nowrap;\n      pointer-events: none;\n      font-size: 14px;\n      line-height: 1.4;\n    }\n\n    #gif_modal {\n      display: none;\n      background-color: #ffffff;\n      padding: 4px;\n      width: 400px;\n      height: 256px;\n      border-radius: 4px;\n      position: relative;\n      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n      cursor: default;\n    }\n\n    #gif_image {\n      object-fit: contain;\n      width: 100%;\n      height: 100%;\n    }\n\n    #close_modal {\n      position: absolute;\n      width: 24px;\n      height: 24px;\n      top: 8px;\n      right: 8px;\n      background: rgba(238, 238, 238, 0.8);\n      text-align: center;\n      line-height: 20px;\n      border-radius: 4px;\n      color: #000000;\n      font-size: 22px;\n      cursor: pointer;\n    }\n  `\n}\n","import { StorageManager, $ct } from '../util/storage'\nimport { isObject } from '../util/datatypes'\nimport {\n  PUSH_SUBSCRIPTION_DATA\n} from '../util/constants'\nimport {\n  urlBase64ToUint8Array\n} from '../util/encoder'\nimport { enablePush } from './webPushPrompt/prompt'\n\nexport default class NotificationHandler extends Array {\n  #oldValues\n  #logger\n  #request\n  #account\n  #wizAlertJSPath\n  #fcmPublicKey\n\n  constructor ({\n    logger,\n    session,\n    request,\n    account\n  }, values) {\n    super()\n    this.#wizAlertJSPath = 'https://d2r1yp2w7bby2u.cloudfront.net/js/wzrk_dialog.min.js'\n    this.#fcmPublicKey = null\n    this.#oldValues = values\n    this.#logger = logger\n    this.#request = request\n    this.#account = account\n  }\n\n  push (...displayArgs) {\n    this.#setUpWebPush(displayArgs)\n    return 0\n  }\n\n  enable () {\n    enablePush(this.#logger, this.#account, this.#request)\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#setUpWebPush(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  #setUpWebPush (displayArgs) {\n    if ($ct.webPushEnabled && displayArgs.length > 0) {\n      this.#handleNotificationRegistration(displayArgs)\n    } else if ($ct.webPushEnabled == null && displayArgs.length > 0) {\n      $ct.notifApi.notifEnabledFromApi = true\n      $ct.notifApi.displayArgs = displayArgs.slice()\n    } else if ($ct.webPushEnabled === false && displayArgs.length > 0) {\n      this.#logger.error('Make sure push notifications are fully enabled and integrated')\n    }\n  }\n\n  setUpWebPushNotifications (subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsServiceUrl) {\n    if (navigator.userAgent.indexOf('Chrome') !== -1 || navigator.userAgent.indexOf('Firefox') !== -1) {\n      this.#setUpChromeFirefoxNotifications(subscriptionCallback, serviceWorkerPath)\n    } else if (navigator.userAgent.indexOf('Safari') !== -1) {\n      this.#setUpSafariNotifications(subscriptionCallback, apnsWebPushId, apnsServiceUrl)\n    }\n  }\n\n  setApplicationServerKey (applicationServerKey) {\n    this.#fcmPublicKey = applicationServerKey\n  }\n\n  #setUpSafariNotifications (subscriptionCallback, apnsWebPushId, apnsServiceUrl) {\n    // ensure that proper arguments are passed\n    if (typeof apnsWebPushId === 'undefined') {\n      this.#logger.error('Ensure that APNS Web Push ID is supplied')\n    }\n    if (typeof apnsServiceUrl === 'undefined') {\n      this.#logger.error('Ensure that APNS Web Push service path is supplied')\n    }\n    if ('safari' in window && 'pushNotification' in window.safari) {\n      window.safari.pushNotification.requestPermission(\n        apnsServiceUrl,\n        apnsWebPushId, {}, (subscription) => {\n          if (subscription.permission === 'granted') {\n            const subscriptionData = JSON.parse(JSON.stringify(subscription))\n            subscriptionData.endpoint = subscription.deviceToken\n            subscriptionData.browser = 'Safari'\n            StorageManager.saveToLSorCookie(PUSH_SUBSCRIPTION_DATA, subscriptionData)\n\n            this.#request.registerToken(subscriptionData)\n            this.#logger.info('Safari Web Push registered. Device Token: ' + subscription.deviceToken)\n          } else if (subscription.permission === 'denied') {\n            this.#logger.info('Error subscribing to Safari web push')\n          }\n        })\n    }\n  }\n\n  /**\n   * Sets up a service worker for WebPush(chrome/Firefox) push notifications and sends the data to LC\n   */\n  #setUpChromeFirefoxNotifications (subscriptionCallback, serviceWorkerPath) {\n    let registrationScope = ''\n\n    if ('serviceWorker' in navigator) {\n      navigator.serviceWorker.register(serviceWorkerPath).then((registration) => {\n        if (typeof __wzrk_account_id !== 'undefined') { // eslint-disable-line\n          // shopify accounts , since the service worker is not at root, serviceWorker.ready is never resolved.\n          // hence add a timeout and hope serviceWroker is ready within that time.\n          return new Promise(resolve => setTimeout(() => resolve(registration), 5000))\n        }\n        registrationScope = registration.scope\n\n        // IF SERVICE WORKER IS AT ROOT, RETURN THE READY PROMISE\n        // ELSE IF CHROME RETURN PROMISE AFTER 5 SECONDS\n        // OR getRegistrations PROMISE IF ITS FIREFOX\n        const rootDirRegex = /^(\\.?)(\\/?)([^/]*).js$/\n        const isServiceWorkerAtRoot = rootDirRegex.test(serviceWorkerPath)\n        if (isServiceWorkerAtRoot) {\n          return navigator.serviceWorker.ready\n        } else {\n          if (navigator.userAgent.indexOf('Chrome') !== -1) {\n            return new Promise(resolve => setTimeout(() => resolve(registration), 5000))\n          } else {\n            return navigator.serviceWorker.getRegistrations()\n          }\n        }\n      }).then((serviceWorkerRegistration) => {\n        // ITS AN ARRAY IN CASE OF FIREFOX, SO USE THE REGISTRATION WITH PROPER SCOPE\n        if (navigator.userAgent.indexOf('Firefox') !== -1 && Array.isArray(serviceWorkerRegistration)) {\n          serviceWorkerRegistration = serviceWorkerRegistration.filter((i) => i.scope === registrationScope)[0]\n        }\n        const subscribeObj = { userVisibleOnly: true }\n\n        if (this.#fcmPublicKey != null) {\n          subscribeObj.applicationServerKey = urlBase64ToUint8Array(this.#fcmPublicKey)\n        }\n\n        serviceWorkerRegistration.pushManager.subscribe(subscribeObj)\n          .then((subscription) => {\n            this.#logger.info('Service Worker registered. Endpoint: ' + subscription.endpoint)\n\n            // convert the subscription keys to strings; this sets it up nicely for pushing to LC\n            const subscriptionData = JSON.parse(JSON.stringify(subscription))\n\n            // remove the common chrome/firefox endpoint at the beginning of the token\n            if (navigator.userAgent.indexOf('Chrome') !== -1) {\n              subscriptionData.endpoint = subscriptionData.endpoint.split('/').pop()\n              subscriptionData.browser = 'Chrome'\n            } else if (navigator.userAgent.indexOf('Firefox') !== -1) {\n              subscriptionData.endpoint = subscriptionData.endpoint.split('/').pop()\n              subscriptionData.browser = 'Firefox'\n            }\n            StorageManager.saveToLSorCookie(PUSH_SUBSCRIPTION_DATA, subscriptionData)\n            this.#request.registerToken(subscriptionData)\n\n            if (typeof subscriptionCallback !== 'undefined' && typeof subscriptionCallback === 'function') {\n              subscriptionCallback()\n            }\n            const existingBellWrapper = document.getElementById('bell_wrapper')\n            if (existingBellWrapper) {\n              existingBellWrapper.parentNode.removeChild(existingBellWrapper)\n            }\n          }).catch((error) => {\n            this.#logger.error('Error subscribing: ' + error)\n            // unsubscribe from webpush if error\n            serviceWorkerRegistration.pushManager.getSubscription().then((subscription) => {\n              if (subscription !== null) {\n                subscription.unsubscribe().then((successful) => {\n                  // You've successfully unsubscribed\n                  this.#logger.info('Unsubscription successful')\n                }).catch((e) => {\n                  // Unsubscription failed\n                  this.#logger.error('Error unsubscribing: ' + e)\n                })\n              }\n            })\n          })\n      }).catch((err) => {\n        this.#logger.error('error registering service worker: ' + err)\n      })\n    }\n  }\n\n  #addWizAlertJS () {\n    const scriptTag = document.createElement('script')\n    scriptTag.setAttribute('type', 'text/javascript')\n    scriptTag.setAttribute('id', 'wzrk-alert-js')\n    scriptTag.setAttribute('src', this.#wizAlertJSPath)\n\n    // add the script tag to the end of the body\n    document.getElementsByTagName('body')[0].appendChild(scriptTag)\n\n    return scriptTag\n  }\n\n  #removeWizAlertJS () {\n    const scriptTag = document.getElementById('wzrk-alert-js')\n    scriptTag.parentNode.removeChild(scriptTag)\n  }\n\n  #handleNotificationRegistration (displayArgs) {\n    // make sure everything is specified\n    let titleText\n    let bodyText\n    let okButtonText\n    let rejectButtonText\n    let okButtonColor\n    let skipDialog\n    let askAgainTimeInSeconds\n    let okCallback\n    let rejectCallback\n    let subscriptionCallback\n    let serviceWorkerPath\n    let httpsPopupPath\n    let httpsIframePath\n    let apnsWebPushId\n    let apnsWebPushServiceUrl\n\n    if (displayArgs.length === 1) {\n      if (isObject(displayArgs[0])) {\n        const notifObj = displayArgs[0]\n        titleText = notifObj.titleText\n        bodyText = notifObj.bodyText\n        okButtonText = notifObj.okButtonText\n        rejectButtonText = notifObj.rejectButtonText\n        okButtonColor = notifObj.okButtonColor\n        skipDialog = notifObj.skipDialog\n        askAgainTimeInSeconds = notifObj.askAgainTimeInSeconds\n        okCallback = notifObj.okCallback\n        rejectCallback = notifObj.rejectCallback\n        subscriptionCallback = notifObj.subscriptionCallback\n        serviceWorkerPath = notifObj.serviceWorkerPath\n        httpsPopupPath = notifObj.httpsPopupPath\n        httpsIframePath = notifObj.httpsIframePath\n        apnsWebPushId = notifObj.apnsWebPushId\n        apnsWebPushServiceUrl = notifObj.apnsWebPushServiceUrl\n      }\n    } else {\n      titleText = displayArgs[0]\n      bodyText = displayArgs[1]\n      okButtonText = displayArgs[2]\n      rejectButtonText = displayArgs[3]\n      okButtonColor = displayArgs[4]\n      skipDialog = displayArgs[5]\n      askAgainTimeInSeconds = displayArgs[6]\n    }\n\n    if (skipDialog == null) {\n      skipDialog = false\n    }\n\n    if (serviceWorkerPath == null) {\n      serviceWorkerPath = '/clevertap_sw.js'\n    }\n\n    // ensure that the browser supports notifications\n    if (typeof navigator.serviceWorker === 'undefined') {\n      return\n    }\n\n    const isHTTP = httpsPopupPath != null && httpsIframePath != null\n\n    // make sure the site is on https for chrome notifications\n    if (window.location.protocol !== 'https:' && document.location.hostname !== 'localhost' && !isHTTP) {\n      this.#logger.error('Make sure you are https or localhost to register for notifications')\n      return\n    }\n\n    // right now, we only support Chrome V50 & higher & Firefox\n    if (navigator.userAgent.indexOf('Chrome') !== -1) {\n      const chromeAgent = navigator.userAgent.match(/Chrome\\/(\\d+)/)\n      if (chromeAgent == null || parseInt(chromeAgent[1], 10) < 50) { return }\n    } else if (navigator.userAgent.indexOf('Firefox') !== -1) {\n      const firefoxAgent = navigator.userAgent.match(/Firefox\\/(\\d+)/)\n      if (firefoxAgent == null || parseInt(firefoxAgent[1], 10) < 50) { return }\n    } else if (navigator.userAgent.indexOf('Safari') !== -1) {\n      const safariAgent = navigator.userAgent.match(/Safari\\/(\\d+)/)\n      if (safariAgent == null || parseInt(safariAgent[1], 10) < 50) { return }\n    } else {\n      return\n    }\n\n    // we check for the cookie in setUpChromeNotifications() the tokens may have changed\n\n    if (!isHTTP) {\n      if (Notification == null) {\n        return\n      }\n      // handle migrations from other services -> chrome notifications may have already been asked for before\n      if (Notification.permission === 'granted') {\n        // skip the dialog and register\n        this.setUpWebPushNotifications(subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsWebPushServiceUrl)\n        return\n      } else if (Notification.permission === 'denied') {\n        // we've lost this profile :'(\n        return\n      }\n\n      if (skipDialog) {\n        this.setUpWebPushNotifications(subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsWebPushServiceUrl)\n        return\n      }\n    }\n\n    // make sure the right parameters are passed\n    if (!titleText || !bodyText || !okButtonText || !rejectButtonText) {\n      this.#logger.error('Missing input parameters; please specify title, body, ok button and cancel button text')\n      return\n    }\n\n    // make sure okButtonColor is formatted properly\n    if (okButtonColor == null || !okButtonColor.match(/^#[a-f\\d]{6}$/i)) {\n      okButtonColor = '#f28046' // default color for positive button\n    }\n\n    // make sure the user isn't asked for notifications more than askAgainTimeInSeconds\n    const now = new Date().getTime() / 1000\n    if ((StorageManager.getMetaProp('notif_last_time')) == null) {\n      StorageManager.setMetaProp('notif_last_time', now)\n    } else {\n      if (askAgainTimeInSeconds == null) {\n        // 7 days by default\n        askAgainTimeInSeconds = 7 * 24 * 60 * 60\n      }\n\n      if (now - StorageManager.getMetaProp('notif_last_time') < askAgainTimeInSeconds) {\n        return\n      } else {\n        // continue asking\n        StorageManager.setMetaProp('notif_last_time', now)\n      }\n    }\n\n    if (isHTTP) {\n      // add the https iframe\n      const httpsIframe = document.createElement('iframe')\n      httpsIframe.setAttribute('style', 'display:none;')\n      httpsIframe.setAttribute('src', httpsIframePath)\n      document.body.appendChild(httpsIframe)\n      window.addEventListener('message', (event) => {\n        if (event.data != null) {\n          let obj = {}\n          try {\n            obj = JSON.parse(event.data)\n          } catch (e) {\n            // not a call from our iframe\n            return\n          }\n          if (obj.state != null) {\n            if (obj.from === 'ct' && obj.state === 'not') {\n              this.#addWizAlertJS().onload = () => {\n                // create our wizrocket popup\n                window.wzrkPermissionPopup.wizAlert({\n                  title: titleText,\n                  body: bodyText,\n                  confirmButtonText: okButtonText,\n                  confirmButtonColor: okButtonColor,\n                  rejectButtonText: rejectButtonText\n                }, (enabled) => { // callback function\n                  if (enabled) {\n                    // the user accepted on the dialog box\n                    if (typeof okCallback === 'function') {\n                      okCallback()\n                    }\n                    // redirect to popup.html\n                    window.open(httpsPopupPath)\n                  } else {\n                    if (typeof rejectCallback === 'function') {\n                      rejectCallback()\n                    }\n                  }\n                  this.#removeWizAlertJS()\n                })\n              }\n            }\n          }\n        }\n      }, false)\n    } else {\n      this.#addWizAlertJS().onload = () => {\n        // create our wizrocket popup\n        window.wzrkPermissionPopup.wizAlert({\n          title: titleText,\n          body: bodyText,\n          confirmButtonText: okButtonText,\n          confirmButtonColor: okButtonColor,\n          rejectButtonText: rejectButtonText\n        }, (enabled) => { // callback function\n          if (enabled) {\n            // the user accepted on the dialog box\n            if (typeof okCallback === 'function') {\n              okCallback()\n            }\n            this.setUpWebPushNotifications(subscriptionCallback, serviceWorkerPath, apnsWebPushId, apnsWebPushServiceUrl)\n          } else {\n            if (typeof rejectCallback === 'function') {\n              rejectCallback()\n            }\n          }\n          this.#removeWizAlertJS()\n        })\n      }\n    }\n  }\n\n  _enableWebPush (enabled, applicationServerKey) {\n    $ct.webPushEnabled = enabled\n    if (applicationServerKey != null) {\n      this.setApplicationServerKey(applicationServerKey)\n    }\n    if ($ct.webPushEnabled && $ct.notifApi.notifEnabledFromApi) {\n      this.#handleNotificationRegistration($ct.notifApi.displayArgs)\n    } else if (!$ct.webPushEnabled && $ct.notifApi.notifEnabledFromApi) {\n      this.#logger.error('Ensure that web push notifications are fully enabled and integrated before requesting them')\n    }\n  }\n}\n","import { getBellIconStyles, getBoxPromptStyles } from './promptStyles.js'\nimport { WEBPUSH_CONFIG } from '../../util/constants.js'\nimport { StorageManager, $ct } from '../../util/storage.js'\nimport NotificationHandler from '../notification.js'\n\nexport const processWebPushConfig = (webPushConfig, logger, request) => {\n  const _pushConfig = StorageManager.readFromLSorCookie(WEBPUSH_CONFIG) || {}\n  if (webPushConfig.isPreview) {\n    $ct.pushConfig = webPushConfig\n    enablePush(logger, null, request)\n  } else if (JSON.stringify(_pushConfig) !== JSON.stringify(webPushConfig)) {\n    $ct.pushConfig = webPushConfig\n    StorageManager.saveToLSorCookie(WEBPUSH_CONFIG, webPushConfig)\n  }\n}\n\nexport const enablePush = (logger, account, request) => {\n  const _pushConfig = StorageManager.readFromLSorCookie(WEBPUSH_CONFIG) || {}\n  $ct.pushConfig = _pushConfig\n  if (!$ct.pushConfig) {\n    logger.error('Web Push config data not present')\n    return\n  }\n\n  const notificationHandler = new NotificationHandler({ logger, session: {}, request, account })\n  const { showBox, boxType, showBellIcon } = $ct.pushConfig\n\n  if ($ct.pushConfig.isPreview) {\n    createNotificationBox($ct.pushConfig)\n  }\n  if (showBox && boxType === 'new') {\n    createNotificationBox($ct.pushConfig, notificationHandler)\n  }\n  if (showBellIcon) {\n    createBellIcon($ct.pushConfig, notificationHandler)\n  }\n}\n\nconst createElementWithAttributes = (tag, attributes = {}) => {\n  const element = document.createElement(tag)\n  Object.entries(attributes).forEach(([key, value]) => {\n    element[key] = value\n  })\n  return element\n}\n\nexport const createNotificationBox = (configData, notificationhandler) => {\n  if (document.getElementById('pnWrapper')) return\n\n  const { boxConfig } = configData\n  const { content, style } = boxConfig\n\n  // Create the wrapper div\n  const wrapper = createElementWithAttributes('div', { id: 'pnWrapper' })\n  const overlayDiv = createElementWithAttributes('div', { id: 'pnOverlay' })\n  const pnCard = createElementWithAttributes('div', { id: 'pnCard' })\n\n  const iconTitleDescWrapper = createElementWithAttributes('div', { id: 'iconTitleDescWrapper' })\n  const iconContainer = createElementWithAttributes('div', { id: 'iconContainer' })\n  const imgElement = createElementWithAttributes('img', {\n    id: 'imgElement',\n    src: content.icon.type === 'default' ? `data:image/svg+xml;base64,${promptBellBase64}` : content.icon.url\n  })\n\n  iconContainer.appendChild(imgElement)\n  iconTitleDescWrapper.appendChild(iconContainer)\n\n  const titleDescWrapper = createElementWithAttributes('div', { id: 'titleDescWrapper' })\n  titleDescWrapper.appendChild(createElementWithAttributes('div', { id: 'title', textContent: content.title }))\n  titleDescWrapper.appendChild(createElementWithAttributes('div', { id: 'description', textContent: content.description }))\n\n  iconTitleDescWrapper.appendChild(titleDescWrapper)\n\n  const buttonsContainer = createElementWithAttributes('div', { id: 'buttonsContainer' })\n\n  const primaryButton = createElementWithAttributes('button', {\n    id: 'primaryButton',\n    textContent: content.buttons.primaryButtonText\n  })\n  const secondaryButton = createElementWithAttributes('button', {\n    id: 'secondaryButton',\n    textContent: content.buttons.secondaryButtonText\n  })\n  buttonsContainer.appendChild(secondaryButton)\n  buttonsContainer.appendChild(primaryButton)\n\n  pnCard.appendChild(iconTitleDescWrapper)\n  pnCard.appendChild(buttonsContainer)\n\n  // Apply styles\n  const styleElement = createElementWithAttributes('style', { textContent: getBoxPromptStyles(style) })\n\n  wrapper.appendChild(styleElement)\n  wrapper.appendChild(pnCard)\n  wrapper.appendChild(overlayDiv)\n\n  setElementPosition(pnCard, style.card.position)\n\n  const now = new Date().getTime() / 1000\n  const lastNotifTime = StorageManager.getMetaProp('webpush_last_notif_time')\n  const popupFrequency = content.popupFrequency || 7 * 24 * 60 * 60\n\n  if (!lastNotifTime || now - lastNotifTime >= popupFrequency * 24 * 60 * 60) {\n    document.body.appendChild(wrapper)\n    if (!configData.isPreview) { addEventListeners(wrapper, notificationhandler) }\n  }\n}\n\nexport const createBellIcon = (configData, notificationhandler) => {\n  if (document.getElementById('bell_wrapper')) return\n\n  if (Notification.permission === 'granted') {\n    return\n  }\n  const { bellIconConfig } = configData\n  const { content, style } = bellIconConfig\n\n  const bellWrapper = createElementWithAttributes('div', { id: 'bell_wrapper' })\n  const bellIcon = createElementWithAttributes('img', {\n    id: 'bell_icon',\n    src: content.icon.type === 'default' ? `data:image/svg+xml;base64,${bellBase64}` : content.icon.url\n  })\n\n  // For playing gif\n  const gifModal = createElementWithAttributes('div', { id: 'gif_modal', style: 'display: none;' })\n  const gifImage = createElementWithAttributes('img', {\n    id: 'gif_image',\n    src: 'https://d2r1yp2w7bby2u.cloudfront.net/js/permission_grant.gif'\n  })\n  const closeModal = createElementWithAttributes('div', { id: 'close_modal', innerHTML: '&times;' })\n\n  gifModal.appendChild(gifImage)\n  gifModal.appendChild(closeModal)\n\n  bellWrapper.appendChild(bellIcon)\n  bellWrapper.appendChild(gifModal)\n  if (content.hoverText.enabled) {\n    const tooltip = createElementWithAttributes('div', {\n      id: 'bell_tooltip',\n      textContent: content.hoverText.text\n    })\n    bellWrapper.appendChild(tooltip)\n  }\n\n  setElementPosition(bellWrapper, bellIconConfig.style.card.position)\n  // Apply styles\n  const styleElement = createElementWithAttributes('style', { textContent: getBellIconStyles(style) })\n\n  document.head.appendChild(styleElement)\n  document.body.appendChild(bellWrapper)\n\n  addBellEventListeners(bellWrapper, notificationhandler)\n  return bellWrapper\n}\n\nlet appServerKey = null\nexport const setServerKey = (serverKey) => {\n  appServerKey = serverKey\n}\n\nexport const addEventListeners = (wrapper, notificationhandler) => {\n  const primaryButton = wrapper.querySelector('#primaryButton')\n  const secondaryButton = wrapper.querySelector('#secondaryButton')\n\n  const removeWrapper = () => wrapper.parentNode?.removeChild(wrapper)\n\n  primaryButton.addEventListener('click', () => {\n    removeWrapper()\n    notificationhandler.setApplicationServerKey(appServerKey)\n    notificationhandler.setUpWebPushNotifications(null, '/clevertap_sw.js', null, null)\n  })\n\n  secondaryButton.addEventListener('click', () => {\n    const now = new Date().getTime() / 1000\n    StorageManager.setMetaProp('webpush_last_notif_time', now)\n    removeWrapper()\n  })\n}\n\nexport const addBellEventListeners = (bellWrapper, notificationhandler) => {\n  const removeBellWrapper = () => bellWrapper.parentNode?.removeChild(bellWrapper)\n\n  const bellIcon = bellWrapper.querySelector('#bell_icon')\n  bellIcon.addEventListener('click', () => {\n    if (Notification.permission === 'denied') {\n      toggleGifModal(bellWrapper)\n    } else {\n      notificationhandler.setApplicationServerKey(appServerKey)\n      notificationhandler.setUpWebPushNotifications(null, '/clevertap_sw.js', null, null)\n      if (Notification.permission === 'granted') {\n        console.log('Granted')\n        removeBellWrapper()\n      }\n    }\n  })\n  bellIcon.addEventListener('mouseenter', () => displayTooltip(bellWrapper))\n  bellIcon.addEventListener('mouseleave', () => clearTooltip(bellWrapper))\n  bellWrapper.querySelector('#close_modal').addEventListener('click', () => toggleGifModal(bellWrapper))\n}\n\nexport const setElementPosition = (element, position) => {\n  Object.assign(element.style, {\n    inset: 'auto',\n    transform: 'none'\n  })\n\n  const positions = {\n    'Top Right': { inset: '16px 16px auto auto' },\n    'Top Left': { inset: '16px auto auto 16px' },\n    'Bottom Right': { inset: 'auto 16px 16px auto' },\n    'Bottom Left': { inset: 'auto auto 16px 16px' },\n    Center: { inset: '50%', transform: 'translate(-50%, -50%)' },\n    Top: { inset: '16px auto auto 50%', transform: 'translateX(-50%)' },\n    Bottom: { inset: 'auto auto 16px 50%', transform: 'translateX(-50%)' }\n  }\n\n  Object.assign(element.style, positions[position] || positions['top-right'])\n}\n\nconst displayTooltip = (bellWrapper) => {\n  const gifModal = bellWrapper.querySelector('#gif_modal')\n  if (gifModal.style.display === 'flex') {\n    return\n  }\n  const tooltip = bellWrapper.querySelector('#bell_tooltip')\n  if (tooltip) {\n    tooltip.style.display = 'flex'\n  }\n\n  const bellIcon = bellWrapper.querySelector('#bell_icon')\n  const bellRect = bellIcon.getBoundingClientRect()\n  var midX = window.innerWidth / 2\n  var midY = window.innerHeight / 2\n  bellWrapper.style['flex-direction'] = bellRect.y > midY ? 'column-reverse' : 'column'\n  bellWrapper.style['align-items'] = bellRect.x > midX ? 'flex-end' : 'flex-start'\n}\n\nconst clearTooltip = (bellWrapper) => {\n  const tooltip = bellWrapper.querySelector('#bell_tooltip')\n  if (tooltip) {\n    tooltip.style.display = 'none'\n  }\n}\n\nconst toggleGifModal = (bellWrapper) => {\n  clearTooltip(bellWrapper)\n  const gifModal = bellWrapper.querySelector('#gif_modal')\n  gifModal.style.display = gifModal.style.display === 'none' ? 'flex' : 'none'\n}\n\nexport const bellBase64 = 'PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgMCA0OCA0OCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMi40OTYyIDUuMjQzOTVDMTIuODM5MSA1LjAzMzE3IDEzLjI4NDcgNS4xNDY4OSAxMy40OTczIDUuNDg4NjdDMTMuNzIyMyA1Ljg1MDE4IDEzLjYwMDIgNi4zMjUxOCAxMy4yMzggNi41NDkwMkM3LjM5Mzk5IDEwLjE2MDYgMy41IDE2LjYyNTcgMy41IDI0LjAwMDNDMy41IDM1LjMyMjEgMTIuNjc4MiA0NC41MDAzIDI0IDQ0LjUwMDNDMjguMDA1NSA0NC41MDAzIDMxLjc0MjYgNDMuMzUxNSAzNC45IDQxLjM2NTVDMzUuMjYwOCA0MS4xMzg1IDM1Ljc0MTYgNDEuMjM4NiAzNS45NjY4IDQxLjYwMDZDMzYuMTc5MiA0MS45NDE5IDM2LjA4NSA0Mi4zOTExIDM1Ljc0NTIgNDIuNjA2QzMyLjM0NjggNDQuNzU1OSAyOC4zMTg3IDQ2LjAwMDMgMjQgNDYuMDAwM0MxMS44NDk3IDQ2LjAwMDMgMiAzNi4xNTA1IDIgMjQuMDAwM0MyIDE2LjA2NjkgNi4xOTkyMSA5LjExNDMyIDEyLjQ5NjIgNS4yNDM5NVpNMzguOCAzOS45MDAzQzM4LjggNDAuMzk3MyAzOC4zOTcxIDQwLjgwMDMgMzcuOSA0MC44MDAzQzM3LjQwMjkgNDAuODAwMyAzNyA0MC4zOTczIDM3IDM5LjkwMDNDMzcgMzkuNDAzMiAzNy40MDI5IDM5LjAwMDMgMzcuOSAzOS4wMDAzQzM4LjM5NzEgMzkuMDAwMyAzOC44IDM5LjQwMzIgMzguOCAzOS45MDAzWiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yNCAxMkMyMi44OTU0IDEyIDIyIDEyLjg5NTQgMjIgMTRWMTQuMjUyQzE4LjU0OTUgMTUuMTQwMSAxNiAxOC4yNzIzIDE2IDIyVjI5LjVIMTUuNDc2OUMxNC42NjEyIDI5LjUgMTQgMzAuMTYxMiAxNCAzMC45NzY5VjMxLjAyMzFDMTQgMzEuODM4OCAxNC42NjEyIDMyLjUgMTUuNDc2OSAzMi41SDMyLjUyMzFDMzMuMzM4OCAzMi41IDM0IDMxLjgzODggMzQgMzEuMDIzMVYzMC45NzY5QzM0IDMwLjE2MTIgMzMuMzM4OCAyOS41IDMyLjUyMzEgMjkuNUgzMlYyMkMzMiAxOC4yNzIzIDI5LjQ1MDUgMTUuMTQwMSAyNiAxNC4yNTJWMTRDMjYgMTIuODk1NCAyNS4xMDQ2IDEyIDI0IDEyWk0yNiAzNFYzMy41SDIyVjM0QzIyIDM1LjEwNDYgMjIuODk1NCAzNiAyNCAzNkMyNS4xMDQ2IDM2IDI2IDM1LjEwNDYgMjYgMzRaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K'\nexport const promptBellBase64 = 'PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiByeD0iMzIiIGZpbGw9IiMwMEFFQjkiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0zMS45OTg2IDIwQzMwLjkxOTggMjAgMzAuMDQyOCAyMC44NzQ2IDMwLjA0MjggMjEuOTUzNEwzMC4wNDI5IDIxLjk3MzRDMjYuNTQzNCAyMi41NTM1IDIzLjg3NSAyNS41OTQzIDIzLjg3NSAyOS4yNTgyVjM4LjA5OTVIMjMuODczNUMyMy4wNTg5IDM4LjA5OTUgMjIuMzk4NCAzOC43NiAyMi4zOTg0IDM5LjU3NDZDMjIuMzk4NCA0MC4zODkzIDIzLjA1ODkgNDEuMDQ5NyAyMy44NzM1IDQxLjA0OTdIMjkuNzgxMlY0MS43ODQyQzI5Ljc4MTIgNDMuMDA3NyAzMC43NzMxIDQzLjk5OTYgMzEuOTk2NiA0My45OTk2QzMzLjIyMDIgNDMuOTk5NiAzNC4yMTIgNDMuMDA3NyAzNC4yMTIgNDEuNzg0MlY0MS4wNDk3SDQwLjEyMzNDNDAuOTM4IDQxLjA0OTcgNDEuNTk4NCA0MC4zODkzIDQxLjU5ODQgMzkuNTc0NkM0MS41OTg0IDM4Ljc2IDQwLjkzOCAzOC4wOTk1IDQwLjEyMzMgMzguMDk5NUg0MC4xMjEyVjI5LjI1ODJDNDAuMTIxMiAyNS41OTQ2IDM3LjQ1MzMgMjIuNTU0MiAzMy45NTQzIDIxLjk3MzZMMzMuOTU0NCAyMS45NTM0QzMzLjk1NDQgMjAuODc0NiAzMy4wNzc1IDIwIDMxLjk5ODYgMjBaIiBmaWxsPSJ3aGl0ZSIvPgo8cmVjdCBvcGFjaXR5PSIwLjUiIHg9IjcuNSIgeT0iNy41IiB3aWR0aD0iNDkiIGhlaWdodD0iNDkiIHJ4PSIyNC41IiBzdHJva2U9IndoaXRlIi8+CjxyZWN0IG9wYWNpdHk9IjAuMyIgeD0iNC41IiB5PSI0LjUiIHdpZHRoPSI1NSIgaGVpZ2h0PSI1NSIgcng9IjI3LjUiIHN0cm9rZT0id2hpdGUiLz4KPHJlY3Qgb3BhY2l0eT0iMC44IiB4PSIxMC41IiB5PSIxMC41IiB3aWR0aD0iNDMiIGhlaWdodD0iNDMiIHJ4PSIyMS41IiBzdHJva2U9IndoaXRlIi8+Cjwvc3ZnPgo='\n","import {\n  addToLocalProfileMap,\n  arp,\n  getCampaignObject,\n  saveCampaignObject,\n  closeIframe\n} from './clevertap'\n\nimport {\n  CAMP_COOKIE_NAME,\n  DISPLAY,\n  GLOBAL,\n  EV_COOKIE,\n  NOTIFICATION_VIEWED,\n  NOTIFICATION_CLICKED,\n  WZRK_PREFIX,\n  WZRK_ID,\n  CAMP_COOKIE_G,\n  GCOOKIE_NAME\n} from './constants'\n\nimport {\n  getNow,\n  getToday\n} from './datetime'\n\nimport {\n  compressToBase64\n} from './encoder'\n\nimport { StorageManager, $ct } from './storage'\nimport RequestDispatcher from './requestDispatcher'\nimport { CTWebPersonalisationBanner } from './web-personalisation/banner'\nimport { CTWebPersonalisationCarousel } from './web-personalisation/carousel'\nimport { CTWebPopupImageOnly } from './web-popupImageonly/popupImageonly'\nimport { checkAndRegisterWebInboxElements, initializeWebInbox, processWebInboxSettings, hasWebInboxSettingsInLS, processInboxNotifs } from '../modules/web-inbox/helper'\nimport { renderVisualBuilder } from '../modules/visualBuilder/pageBuilder'\nimport { processWebPushConfig } from '../modules/webPushPrompt/prompt'\n\nconst _tr = (msg, {\n  device,\n  session,\n  request,\n  logger\n}) => {\n  const _device = device\n  const _session = session\n  const _request = request\n  const _logger = logger\n  let _wizCounter = 0\n  // Campaign House keeping\n  const doCampHouseKeeping = (targetingMsgJson) => {\n    const campaignId = targetingMsgJson.wzrk_id.split('_')[0]\n    const today = getToday()\n\n    const incrCount = (obj, campaignId, excludeFromFreqCaps) => {\n      let currentCount = 0\n      let totalCount = 0\n      if (obj[campaignId] != null) {\n        currentCount = obj[campaignId]\n      }\n      currentCount++\n      if (obj.tc != null) {\n        totalCount = obj.tc\n      }\n      // if exclude from caps then dont add to total counts\n      if (excludeFromFreqCaps < 0) {\n        totalCount++\n      }\n\n      obj.tc = totalCount\n      obj[campaignId] = currentCount\n    }\n\n    if (StorageManager._isLocalStorageSupported()) {\n      delete sessionStorage[CAMP_COOKIE_NAME]\n      var campTypeObj = {}\n      const campObj = getCampaignObject()\n      if (targetingMsgJson.display.wtarget_type === 3 && campObj.hasOwnProperty('wi')) {\n        campTypeObj = campObj.wi\n      } else if ((targetingMsgJson.display.wtarget_type === 0 || targetingMsgJson.display.wtarget_type === 1) && campObj.hasOwnProperty('wp')) {\n        campTypeObj = campObj.wp\n      } else {\n        campTypeObj = {}\n      }\n      if (campObj.hasOwnProperty('global')) {\n        campTypeObj.wp = campObj\n      }\n      // global session limit. default is 1\n      if (targetingMsgJson[DISPLAY].wmc == null) {\n        targetingMsgJson[DISPLAY].wmc = 1\n      }\n\n      // global session limit for web inbox. default is 1\n      if (targetingMsgJson[DISPLAY].wimc == null) {\n        targetingMsgJson[DISPLAY].wimc = 1\n      }\n\n      var excludeFromFreqCaps = -1 // efc - Exclude from frequency caps\n      let campaignSessionLimit = -1 // mdc - Once per session\n      let campaignDailyLimit = -1 // tdc - Once per day\n      let campaignTotalLimit = -1 // tlc - Once per user for the duration of campaign\n      let totalDailyLimit = -1\n      let totalSessionLimit = -1 // wmc - Web Popup Global Session Limit\n      let totalInboxSessionLimit = -1 // wimc - Web Inbox Global Session Limit\n\n      if (targetingMsgJson[DISPLAY].efc != null) { // exclude from frequency cap\n        excludeFromFreqCaps = parseInt(targetingMsgJson[DISPLAY].efc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].mdc != null) { // Campaign Session Limit\n        campaignSessionLimit = parseInt(targetingMsgJson[DISPLAY].mdc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].tdc != null) { // No of web popups in a day per campaign\n        campaignDailyLimit = parseInt(targetingMsgJson[DISPLAY].tdc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].tlc != null) { // Total lifetime count\n        campaignTotalLimit = parseInt(targetingMsgJson[DISPLAY].tlc, 10)\n      }\n      if (targetingMsgJson[DISPLAY].wmp != null) { // No of campaigns per day\n        totalDailyLimit = parseInt(targetingMsgJson[DISPLAY].wmp, 10)\n      }\n      if (targetingMsgJson[DISPLAY].wmc != null) { // No of campaigns per session\n        totalSessionLimit = parseInt(targetingMsgJson[DISPLAY].wmc, 10)\n      }\n\n      if (targetingMsgJson[DISPLAY].wimc != null) { // No of inbox campaigns per session\n        totalInboxSessionLimit = parseInt(targetingMsgJson[DISPLAY].wimc, 10)\n      }\n      // session level capping\n      var sessionObj = campTypeObj[_session.sessionId]\n      if (sessionObj) {\n        const campaignSessionCount = sessionObj[campaignId]\n        const totalSessionCount = sessionObj.tc\n        // dnd\n        if (campaignSessionCount === 'dnd' && !$ct.dismissSpamControl) {\n          return false\n        }\n\n        if (targetingMsgJson[DISPLAY].wtarget_type === 3) {\n          // Inbox session\n          if (totalInboxSessionLimit > 0 && totalSessionCount >= totalInboxSessionLimit && excludeFromFreqCaps < 0) {\n            return false\n          }\n        } else {\n          // session\n          if (totalSessionLimit > 0 && totalSessionCount >= totalSessionLimit && excludeFromFreqCaps < 0) {\n            return false\n          }\n        }\n\n        // campaign session\n        if (campaignSessionLimit > 0 && campaignSessionCount >= campaignSessionLimit) {\n          return false\n        }\n      } else {\n        sessionObj = {}\n        campTypeObj[_session.sessionId] = sessionObj\n      }\n\n      // daily level capping\n      var dailyObj = campTypeObj[today]\n      if (dailyObj != null) {\n        const campaignDailyCount = dailyObj[campaignId]\n        const totalDailyCount = dailyObj.tc\n        // daily\n        if (totalDailyLimit > 0 && totalDailyCount >= totalDailyLimit && excludeFromFreqCaps < 0) {\n          return false\n        }\n        // campaign daily\n        if (campaignDailyLimit > 0 && campaignDailyCount >= campaignDailyLimit) {\n          return false\n        }\n      } else {\n        dailyObj = {}\n        campTypeObj[today] = dailyObj\n      }\n\n      var globalObj = campTypeObj[GLOBAL]\n      if (globalObj != null) {\n        const campaignTotalCount = globalObj[campaignId]\n        // campaign total\n        if (campaignTotalLimit > 0 && campaignTotalCount >= campaignTotalLimit) {\n          return false\n        }\n      } else {\n        globalObj = {}\n        campTypeObj[GLOBAL] = globalObj\n      }\n    }\n    // delay\n    if (targetingMsgJson[DISPLAY].delay != null && targetingMsgJson[DISPLAY].delay > 0) {\n      const delay = targetingMsgJson[DISPLAY].delay\n      targetingMsgJson[DISPLAY].delay = 0\n      setTimeout(_tr, delay * 1000, msg, {\n        device: _device,\n        session: _session,\n        request: _request,\n        logger: _logger\n      })\n      return false\n    }\n\n    incrCount(sessionObj, campaignId, excludeFromFreqCaps)\n    incrCount(dailyObj, campaignId, excludeFromFreqCaps)\n    incrCount(globalObj, campaignId, excludeFromFreqCaps)\n\n    let campKey = 'wp'\n    if (targetingMsgJson[DISPLAY].wtarget_type === 3) {\n      campKey = 'wi'\n    }\n    // get ride of stale sessions and day entries\n    const newCampObj = {}\n    newCampObj[_session.sessionId] = sessionObj\n    newCampObj[today] = dailyObj\n    newCampObj[GLOBAL] = globalObj\n    saveCampaignObject({ [campKey]: newCampObj })\n  }\n\n  const getCookieParams = () => {\n    const gcookie = _device.getGuid()\n    const scookieObj = _session.getSessionCookieObject()\n    return '&t=wc&d=' + encodeURIComponent(compressToBase64(gcookie + '|' + scookieObj.p + '|' + scookieObj.s))\n  }\n\n  const setupClickEvent = (onClick, targetingMsgJson, contentDiv, divId, isLegacy) => {\n    if (onClick !== '' && onClick != null) {\n      let ctaElement\n      let jsCTAElements\n      if (isLegacy) {\n        ctaElement = contentDiv\n      } else if (contentDiv !== null) {\n        jsCTAElements = contentDiv.getElementsByClassName('jsCT_CTA')\n        if (jsCTAElements != null && jsCTAElements.length === 1) {\n          ctaElement = jsCTAElements[0]\n        }\n      }\n      const jsFunc = targetingMsgJson.display.jsFunc\n      const isPreview = targetingMsgJson.display.preview\n      if (isPreview == null) {\n        onClick += getCookieParams()\n      }\n\n      if (ctaElement != null) {\n        ctaElement.onclick = () => {\n          // invoke js function call\n          if (jsFunc != null) {\n            // track notification clicked event\n            if (isPreview == null) {\n              RequestDispatcher.fireRequest(onClick)\n            }\n            invokeExternalJs(jsFunc, targetingMsgJson)\n            // close iframe. using -1 for no campaignId\n            closeIframe('-1', divId, _session.sessionId)\n            return\n          }\n          // pass on the gcookie|page|scookieId for capturing the click event\n          if (targetingMsgJson.display.window === 1) {\n            window.open(onClick, '_blank')\n          } else {\n            window.location = onClick\n          }\n        }\n      }\n    }\n  }\n\n  const invokeExternalJs = (jsFunc, targetingMsgJson) => {\n    const func = window.parent[jsFunc]\n    if (typeof func === 'function') {\n      if (targetingMsgJson.display.kv != null) {\n        func(targetingMsgJson.display.kv)\n      } else {\n        func()\n      }\n    }\n  }\n\n  const setupClickUrl = (onClick, targetingMsgJson, contentDiv, divId, isLegacy) => {\n    incrementImpression(targetingMsgJson)\n    setupClickEvent(onClick, targetingMsgJson, contentDiv, divId, isLegacy)\n  }\n\n  const incrementImpression = (targetingMsgJson) => {\n    const data = {}\n    data.type = 'event'\n    data.evtName = NOTIFICATION_VIEWED\n    data.evtData = { [WZRK_ID]: targetingMsgJson.wzrk_id }\n    if (targetingMsgJson.wzrk_pivot) {\n      data.evtData = { ...data.evtData, wzrk_pivot: targetingMsgJson.wzrk_pivot }\n    }\n    _request.processEvent(data)\n  }\n\n  const renderPersonalisationBanner = (targetingMsgJson) => {\n    if (customElements.get('ct-web-personalisation-banner') === undefined) {\n      customElements.define('ct-web-personalisation-banner', CTWebPersonalisationBanner)\n    }\n    const divId = targetingMsgJson.display.divId ?? targetingMsgJson.display.divSelector\n    const bannerEl = document.createElement('ct-web-personalisation-banner')\n    bannerEl.msgId = targetingMsgJson.wzrk_id\n    bannerEl.pivotId = targetingMsgJson.wzrk_pivot\n    bannerEl.divHeight = targetingMsgJson.display.divHeight\n    bannerEl.details = targetingMsgJson.display.details[0]\n    const containerEl = targetingMsgJson.display.divId ? document.getElementById(divId) : document.querySelector(divId)\n    containerEl.innerHTML = ''\n    containerEl.appendChild(bannerEl)\n  }\n\n  const renderPersonalisationCarousel = (targetingMsgJson) => {\n    if (customElements.get('ct-web-personalisation-carousel') === undefined) {\n      customElements.define('ct-web-personalisation-carousel', CTWebPersonalisationCarousel)\n    }\n    const divId = targetingMsgJson.display.divId ?? targetingMsgJson.display.divSelector\n    const carousel = document.createElement('ct-web-personalisation-carousel')\n    carousel.target = targetingMsgJson\n    const container = targetingMsgJson.display.divId ? document.getElementById(divId) : document.querySelector(divId)\n    container.innerHTML = ''\n    container.appendChild(carousel)\n  }\n\n  const renderPopUpImageOnly = (targetingMsgJson) => {\n    const divId = 'wzrkImageOnlyDiv'\n    const popupImageOnly = document.createElement('ct-web-popup-imageonly')\n    popupImageOnly.session = _session\n    popupImageOnly.target = targetingMsgJson\n    const containerEl = document.getElementById(divId)\n    containerEl.innerHTML = ''\n    containerEl.style.visibility = 'hidden'\n    containerEl.appendChild(popupImageOnly)\n  }\n\n  const renderFooterNotification = (targetingMsgJson) => {\n    const campaignId = targetingMsgJson.wzrk_id.split('_')[0]\n    const displayObj = targetingMsgJson.display\n\n    if (displayObj.wtarget_type === 2) { // Handling Web Native display\n      // Logic for kv pair data\n      if (targetingMsgJson.msgContent.type === 1) {\n        const inaObj = {}\n\n        inaObj.msgId = targetingMsgJson.wzrk_id\n        if (targetingMsgJson.wzrk_pivot) {\n          inaObj.pivotId = targetingMsgJson.wzrk_pivot\n        }\n        if (targetingMsgJson.msgContent.kv != null) {\n          inaObj.kv = targetingMsgJson.msgContent.kv\n        }\n        const kvPairsEvent = new CustomEvent('CT_web_native_display', { detail: inaObj })\n        document.dispatchEvent(kvPairsEvent)\n        return\n      }\n    }\n    if (displayObj.layout === 1) { // Handling Web Exit Intent\n      return showExitIntent(undefined, targetingMsgJson)\n    }\n    if (displayObj.layout === 3) { // Handling Web Popup Image Only\n      const divId = 'wzrkImageOnlyDiv'\n      if (doCampHouseKeeping(targetingMsgJson) === false) {\n        return\n      }\n      if ($ct.dismissSpamControl && document.getElementById(divId) != null) {\n        const element = document.getElementById(divId)\n        element.remove()\n      }\n      // ImageOnly campaign and Interstitial/Exit Intent shouldn't coexist\n      if (document.getElementById(divId) != null || document.getElementById('intentPreview') != null) {\n        return\n      }\n      const msgDiv = document.createElement('div')\n      msgDiv.id = divId\n      document.body.appendChild(msgDiv)\n      if (customElements.get('ct-web-popup-imageonly') === undefined) {\n        customElements.define('ct-web-popup-imageonly', CTWebPopupImageOnly)\n      }\n      return renderPopUpImageOnly(targetingMsgJson)\n    }\n\n    if (doCampHouseKeeping(targetingMsgJson) === false) {\n      return\n    }\n\n    const divId = 'wizParDiv' + displayObj.layout\n\n    if ($ct.dismissSpamControl && document.getElementById(divId) != null) {\n      const element = document.getElementById(divId)\n      element.remove()\n    }\n    if (document.getElementById(divId) != null) {\n      return\n    }\n\n    $ct.campaignDivMap[campaignId] = divId\n    const isBanner = displayObj.layout === 2\n    const msgDiv = document.createElement('div')\n    msgDiv.id = divId\n    const viewHeight = window.innerHeight\n    const viewWidth = window.innerWidth\n    let legacy = false\n\n    if (!isBanner) {\n      const marginBottom = viewHeight * 5 / 100\n      var contentHeight = 10\n      let right = viewWidth * 5 / 100\n      let bottomPosition = contentHeight + marginBottom\n      let width = viewWidth * 30 / 100 + 20\n      let widthPerct = 'width:30%;'\n      // for small devices  - mobile phones\n      if ((/mobile/i.test(navigator.userAgent) || (/mini/i.test(navigator.userAgent))) && /iPad/i.test(navigator.userAgent) === false) {\n        width = viewWidth * 85 / 100 + 20\n        right = viewWidth * 5 / 100\n        bottomPosition = viewHeight * 5 / 100\n        widthPerct = 'width:80%;'\n        // medium devices - tablets\n      } else if ('ontouchstart' in window || (/tablet/i.test(navigator.userAgent))) {\n        width = viewWidth * 50 / 100 + 20\n        right = viewWidth * 5 / 100\n        bottomPosition = viewHeight * 5 / 100\n        widthPerct = 'width:50%;'\n      }\n      // legacy footer notif\n      if (displayObj.proto == null) {\n        legacy = true\n        msgDiv.setAttribute('style', 'display:block;overflow:hidden; bottom:' + bottomPosition + 'px !important;width:' + width + 'px !important;right:' + right + 'px !important;position:fixed;z-index:2147483647;')\n      } else {\n        msgDiv.setAttribute('style', widthPerct + displayObj.iFrameStyle)\n      }\n    } else {\n      msgDiv.setAttribute('style', displayObj.iFrameStyle)\n    }\n    document.body.appendChild(msgDiv)\n    const iframe = document.createElement('iframe')\n\n    const borderRadius = displayObj.br === false ? '0' : '8'\n\n    iframe.frameborder = '0px'\n    iframe.marginheight = '0px'\n    iframe.marginwidth = '0px'\n    iframe.scrolling = 'no'\n    iframe.id = 'wiz-iframe'\n    const onClick = targetingMsgJson.display.onClick\n    let pointerCss = ''\n    if (onClick !== '' && onClick != null) {\n      pointerCss = 'cursor:pointer;'\n    }\n    if (displayObj.preview && displayObj['custom-editor']) {\n      iframe.sandbox = 'allow-scripts allow-popups allow-popups-to-escape-sandbox'\n    }\n\n    let html\n    // direct html\n    if (targetingMsgJson.msgContent.type === 1) {\n      html = targetingMsgJson.msgContent.html\n      html = html.replace(/##campaignId##/g, campaignId)\n      html = html.replace(/##campaignId_batchId##/g, targetingMsgJson.wzrk_id)\n    } else {\n      const css = '' +\n        '<style type=\"text/css\">' +\n        'body{margin:0;padding:0;}' +\n        '#contentDiv.wzrk{overflow:hidden;padding:0;text-align:center;' + pointerCss + '}' +\n        '#contentDiv.wzrk td{padding:15px 10px;}' +\n        '.wzrkPPtitle{font-weight: bold;font-size: 16px;font-family:arial;padding-bottom:10px;word-break: break-word;}' +\n        '.wzrkPPdscr{font-size: 14px;font-family:arial;line-height:16px;word-break: break-word;display:inline-block;}' +\n        '.PL15{padding-left:15px;}' +\n        '.wzrkPPwarp{margin:20px 20px 0 5px;padding:0px;border-radius: ' + borderRadius + 'px;box-shadow: 1px 1px 5px #888888;}' +\n        'a.wzrkClose{cursor:pointer;position: absolute;top: 11px;right: 11px;z-index: 2147483647;font-size:19px;font-family:arial;font-weight:bold;text-decoration: none;width: 25px;/*height: 25px;*/text-align: center; -webkit-appearance: none; line-height: 25px;' +\n        'background: #353535;border: #fff 2px solid;border-radius: 100%;box-shadow: #777 2px 2px 2px;color:#fff;}' +\n        'a:hover.wzrkClose{background-color:#d1914a !important;color:#fff !important; -webkit-appearance: none;}' +\n        'td{vertical-align:top;}' +\n        'td.imgTd{border-top-left-radius:8px;border-bottom-left-radius:8px;}' +\n        '</style>'\n\n      let bgColor, textColor, btnBg, leftTd, btColor\n      if (targetingMsgJson.display.theme === 'dark') {\n        bgColor = '#2d2d2e'\n        textColor = '#eaeaea'\n        btnBg = '#353535'\n        leftTd = '#353535'\n        btColor = '#ffffff'\n      } else {\n        bgColor = '#ffffff'\n        textColor = '#000000'\n        leftTd = '#f4f4f4'\n        btnBg = '#a5a6a6'\n        btColor = '#ffffff'\n      }\n      const titleText = targetingMsgJson.msgContent.title\n      const descriptionText = targetingMsgJson.msgContent.description\n      let imageTd = ''\n      if (targetingMsgJson.msgContent.imageUrl != null && targetingMsgJson.msgContent.imageUrl !== '') {\n        imageTd = \"<td class='imgTd' style='background-color:\" + leftTd + \"'><img src='\" + targetingMsgJson.msgContent.imageUrl + \"' height='60' width='60'></td>\"\n      }\n      const onClickStr = 'parent.$WZRK_WR.closeIframe(' + campaignId + \",'\" + divId + \"');\"\n      const title = \"<div class='wzrkPPwarp' style='color:\" + textColor + ';background-color:' + bgColor + \";'>\" +\n        \"<a href='javascript:void(0);' onclick=\" + onClickStr + \" class='wzrkClose' style='background-color:\" + btnBg + ';color:' + btColor + \"'>&times;</a>\" +\n        \"<div id='contentDiv' class='wzrk'>\" +\n        \"<table cellpadding='0' cellspacing='0' border='0'>\" +\n        // \"<tr><td colspan='2'></td></tr>\"+\n        '<tr>' + imageTd + \"<td style='vertical-align:top;'>\" +\n        \"<div class='wzrkPPtitle' style='color:\" + textColor + \"'>\" + titleText + '</div>'\n      const body = \"<div class='wzrkPPdscr' style='color:\" + textColor + \"'>\" + descriptionText + '<div></td></tr></table></div>'\n      html = css + title + body\n    }\n\n    iframe.setAttribute('style', 'z-index: 2147483647; display:block; width: 100% !important; border:0px !important; border-color:none !important;')\n    msgDiv.appendChild(iframe)\n\n    // Dispatch event for popup box/banner close\n    const closeCampaign = new Event('CT_campaign_rendered')\n    document.dispatchEvent(closeCampaign)\n\n    if (displayObj['custom-editor']) {\n      html = appendScriptForCustomEvent(targetingMsgJson, html)\n    }\n    iframe.srcdoc = html\n\n    const adjustIFrameHeight = () => {\n      // adjust iframe and body height of html inside correctly\n      contentHeight = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv').scrollHeight\n      if (displayObj['custom-editor'] !== true && !isBanner) {\n        contentHeight += 25\n      }\n      document.getElementById('wiz-iframe').contentDocument.body.style.margin = '0px'\n      document.getElementById('wiz-iframe').style.height = contentHeight + 'px'\n    }\n\n    const ua = navigator.userAgent.toLowerCase()\n    if (ua.indexOf('safari') !== -1) {\n      if (ua.indexOf('chrome') > -1) {\n        iframe.onload = () => {\n          adjustIFrameHeight()\n          const contentDiv = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv')\n          setupClickUrl(onClick, targetingMsgJson, contentDiv, divId, legacy)\n        }\n      } else {\n        let inDoc = iframe.contentDocument || iframe.contentWindow\n        if (inDoc.document) inDoc = inDoc.document\n        // safari iphone 7+ needs this.\n        const _timer = setInterval(() => {\n          if (inDoc.readyState === 'complete') {\n            clearInterval(_timer)\n            // adjust iframe and body height of html inside correctly\n            adjustIFrameHeight()\n            const contentDiv = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv')\n            setupClickUrl(onClick, targetingMsgJson, contentDiv, divId, legacy)\n          }\n        }, 300)\n      }\n    } else {\n      iframe.onload = () => {\n        // adjust iframe and body height of html inside correctly\n        adjustIFrameHeight()\n        const contentDiv = document.getElementById('wiz-iframe').contentDocument.getElementById('contentDiv')\n        setupClickUrl(onClick, targetingMsgJson, contentDiv, divId, legacy)\n      }\n    }\n  }\n\n  const appendScriptForCustomEvent = (targetingMsgJson, html) => {\n    const script = `<script>\n      const ct__camapignId = '${targetingMsgJson.wzrk_id}';\n      const ct__formatVal = (v) => {\n          return v && v.trim().substring(0, 20);\n      }\n      const ct__parentOrigin =  window.parent.origin;\n      document.body.addEventListener('click', (event) => {\n        const elem = event.target.closest?.('a[wzrk_c2a], button[wzrk_c2a]');\n        if (elem) {\n            const {innerText, id, name, value, href} = elem;\n            const clickAttr = elem.getAttribute('onclick') || elem.getAttribute('click');\n            const onclickURL = clickAttr?.match(/(window.open)[(\\](\\\"|')(.*)(\\\"|',)/)?.[3] || clickAttr?.match(/(location.href *= *)(\\\"|')(.*)(\\\"|')/)?.[3];\n            const props = {innerText, id, name, value};\n            let msgCTkv = Object.keys(props).reduce((acc, c) => {\n                const formattedVal = ct__formatVal(props[c]);\n                formattedVal && (acc['wzrk_click_' + c] = formattedVal);\n                return acc;\n            }, {});\n            if(onclickURL) { msgCTkv['wzrk_click_' + 'url'] = onclickURL; }\n            if(href) { msgCTkv['wzrk_click_' + 'c2a'] = href; }\n            const notifData = { msgId: ct__camapignId, msgCTkv, pivotId: '${targetingMsgJson.wzrk_pivot}' };\n            window.parent.clevertap.renderNotificationClicked(notifData);\n        }\n      });\n      </script>\n    `\n    return html.replace(/(<\\s*\\/\\s*body)/, `${script}\\n$1`)\n  }\n\n  let _callBackCalled = false\n\n  const showFooterNotification = (targetingMsgJson) => {\n    let onClick = targetingMsgJson.display.onClick\n\n    // TODO: Needs wizrocket as a global variable\n    if (window.clevertap.hasOwnProperty('notificationCallback') &&\n      typeof window.clevertap.notificationCallback !== 'undefined' &&\n      typeof window.clevertap.notificationCallback === 'function') {\n      const notificationCallback = window.clevertap.notificationCallback\n\n      if (!_callBackCalled) {\n        const inaObj = {}\n        inaObj.msgContent = targetingMsgJson.msgContent\n        inaObj.msgId = targetingMsgJson.wzrk_id\n        if (targetingMsgJson.wzrk_pivot) {\n          inaObj.pivotId = targetingMsgJson.wzrk_pivot\n        }\n        if (targetingMsgJson.display.kv != null) {\n          inaObj.kv = targetingMsgJson.display.kv\n        }\n\n        window.clevertap.raiseNotificationClicked = () => {\n          if (onClick !== '' && onClick != null) {\n            const jsFunc = targetingMsgJson.display.jsFunc\n            onClick += getCookieParams()\n\n            // invoke js function call\n            if (jsFunc != null) {\n              // track notification clicked event\n              RequestDispatcher.fireRequest(onClick)\n              invokeExternalJs(jsFunc, targetingMsgJson)\n              return\n            }\n            // pass on the gcookie|page|scookieId for capturing the click event\n            if (targetingMsgJson.display.window === 1) {\n              window.open(onClick, '_blank')\n            } else {\n              window.location = onClick\n            }\n          }\n        }\n        window.clevertap.raiseNotificationViewed = () => {\n          incrementImpression(targetingMsgJson)\n        }\n        notificationCallback(inaObj)\n        _callBackCalled = true\n      }\n    } else {\n      window.clevertap.popupCurrentWzrkId = targetingMsgJson.wzrk_id\n      renderFooterNotification(targetingMsgJson)\n\n      if (window.clevertap.hasOwnProperty('popupCallbacks') &&\n        typeof window.clevertap.popupCallbacks !== 'undefined' &&\n        typeof window.clevertap.popupCallbacks[targetingMsgJson.wzrk_id] === 'function') {\n        const popupCallback = window.clevertap.popupCallbacks[targetingMsgJson.wzrk_id]\n\n        const inaObj = {}\n        inaObj.msgContent = targetingMsgJson.msgContent\n        inaObj.msgId = targetingMsgJson.wzrk_id\n\n        if (targetingMsgJson.wzrk_pivot) {\n          inaObj.pivotId = targetingMsgJson.wzrk_pivot\n        }\n\n        var msgCTkv = []\n        for (var wzrkPrefixKey in targetingMsgJson) {\n          // ADD WZRK PREFIX KEY VALUE PAIRS\n          if (wzrkPrefixKey.startsWith(WZRK_PREFIX) && wzrkPrefixKey !== WZRK_ID) {\n            const wzrkJson = { [wzrkPrefixKey]: targetingMsgJson[wzrkPrefixKey] }\n            msgCTkv.push(wzrkJson)\n          }\n        }\n\n        if (msgCTkv.length > 0) {\n          inaObj.msgCTkv = msgCTkv\n        }\n        if (targetingMsgJson.display.kv != null) {\n          inaObj.kv = targetingMsgJson.display.kv\n        }\n\n        // PUBLIC API TO RECORD CLICKED EVENT\n        window.clevertap.raisePopupNotificationClicked = (notificationData) => {\n          if (!notificationData || !notificationData.msgId) { return }\n\n          const eventData = {}\n          eventData.type = 'event'\n          eventData.evtName = NOTIFICATION_CLICKED\n          eventData.evtData = { [WZRK_ID]: notificationData.msgId }\n          if (targetingMsgJson.wzrk_pivot) {\n            eventData.evtData = { ...eventData.evtData, wzrk_pivot: notificationData.pivotId }\n          }\n\n          // WZRK PREFIX KEY VALUE PAIRS\n          if (notificationData.msgCTkv) {\n            for (var wzrkPrefixObj of notificationData.msgCTkv) {\n              eventData.evtData = { ...eventData.evtData, ...wzrkPrefixObj }\n            }\n          }\n\n          _request.processEvent(eventData)\n        }\n        popupCallback(inaObj)\n      }\n    }\n  }\n\n  let exitintentObj\n  const showExitIntent = (event, targetObj) => {\n    let targetingMsgJson\n    if (event != null && event.clientY > 0) {\n      return\n    }\n    if (targetObj == null) {\n      targetingMsgJson = exitintentObj\n    } else {\n      targetingMsgJson = targetObj\n    }\n\n    if ($ct.dismissSpamControl && targetingMsgJson.display.wtarget_type === 0 && document.getElementById('intentPreview') != null && document.getElementById('intentOpacityDiv') != null) {\n      const element = document.getElementById('intentPreview')\n      element.remove()\n      document.getElementById('intentOpacityDiv').remove()\n    }\n    // ImageOnly campaign and Interstitial/Exit Intent shouldn't coexist\n    if (document.getElementById('intentPreview') != null || document.getElementById('wzrkImageOnlyDiv') != null) {\n      return\n    }\n    // dont show exit intent on tablet/mobile - only on desktop\n    if (targetingMsgJson.display.layout == null &&\n      ((/mobile/i.test(navigator.userAgent)) || (/mini/i.test(navigator.userAgent)) || (/iPad/i.test(navigator.userAgent)) ||\n        ('ontouchstart' in window) || (/tablet/i.test(navigator.userAgent)))) {\n      return\n    }\n\n    if (doCampHouseKeeping(targetingMsgJson) === false) {\n      return\n    }\n\n    const campaignId = targetingMsgJson.wzrk_id.split('_')[0]\n    $ct.campaignDivMap[campaignId] = 'intentPreview'\n    let legacy = false\n    const opacityDiv = document.createElement('div')\n    opacityDiv.id = 'intentOpacityDiv'\n    const opacity = targetingMsgJson.display.opacity || 0.7\n    const rgbaColor = `rgba(0,0,0,${opacity})`\n    opacityDiv.setAttribute('style', `position: fixed;top: 0;bottom: 0;left: 0;width: 100%;height: 100%;z-index: 2147483646;background: ${rgbaColor};`)\n    document.body.appendChild(opacityDiv)\n\n    const msgDiv = document.createElement('div')\n    msgDiv.id = 'intentPreview'\n\n    if (targetingMsgJson.display.proto == null) {\n      legacy = true\n      msgDiv.setAttribute('style', 'display:block;overflow:hidden;top:55% !important;left:50% !important;position:fixed;z-index:2147483647;width:600px !important;height:600px !important;margin:-300px 0 0 -300px !important;')\n    } else {\n      msgDiv.setAttribute('style', targetingMsgJson.display.iFrameStyle)\n    }\n    document.body.appendChild(msgDiv)\n    const iframe = document.createElement('iframe')\n    const borderRadius = targetingMsgJson.display.br === false ? '0' : '8'\n    iframe.frameborder = '0px'\n    iframe.marginheight = '0px'\n    iframe.marginwidth = '0px'\n    iframe.scrolling = 'no'\n    iframe.id = 'wiz-iframe-intent'\n    const onClick = targetingMsgJson.display.onClick\n    let pointerCss = ''\n    if (onClick !== '' && onClick != null) {\n      pointerCss = 'cursor:pointer;'\n    }\n    if (targetingMsgJson.display.preview && targetingMsgJson.display['custom-editor']) {\n      iframe.sandbox = 'allow-scripts allow-popups allow-popups-to-escape-sandbox'\n    }\n    let html\n    // direct html\n    if (targetingMsgJson.msgContent.type === 1) {\n      html = targetingMsgJson.msgContent.html\n      html = html.replace(/##campaignId##/g, campaignId)\n      html = html.replace(/##campaignId_batchId##/g, targetingMsgJson.wzrk_id)\n    } else {\n      const css = '' +\n        '<style type=\"text/css\">' +\n        'body{margin:0;padding:0;}' +\n        '#contentDiv.wzrk{overflow:hidden;padding:0 0 20px 0;text-align:center;' + pointerCss + '}' +\n        '#contentDiv.wzrk td{padding:15px 10px;}' +\n        '.wzrkPPtitle{font-weight: bold;font-size: 24px;font-family:arial;word-break: break-word;padding-top:20px;}' +\n        '.wzrkPPdscr{font-size: 14px;font-family:arial;line-height:16px;word-break: break-word;display:inline-block;padding:20px 20px 0 20px;line-height:20px;}' +\n        '.PL15{padding-left:15px;}' +\n        '.wzrkPPwarp{margin:20px 20px 0 5px;padding:0px;border-radius: ' + borderRadius + 'px;box-shadow: 1px 1px 5px #888888;}' +\n        'a.wzrkClose{cursor:pointer;position: absolute;top: 11px;right: 11px;z-index: 2147483647;font-size:19px;font-family:arial;font-weight:bold;text-decoration: none;width: 25px;/*height: 25px;*/text-align: center; -webkit-appearance: none; line-height: 25px;' +\n        'background: #353535;border: #fff 2px solid;border-radius: 100%;box-shadow: #777 2px 2px 2px;color:#fff;}' +\n        'a:hover.wzrkClose{background-color:#d1914a !important;color:#fff !important; -webkit-appearance: none;}' +\n        '#contentDiv .button{padding-top:20px;}' +\n        '#contentDiv .button a{font-size: 14px;font-weight:bold;font-family:arial;text-align:center;display:inline-block;text-decoration:none;padding:0 30px;height:40px;line-height:40px;background:#ea693b;color:#fff;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;}' +\n        '</style>'\n\n      let bgColor, textColor, btnBg, btColor\n      if (targetingMsgJson.display.theme === 'dark') {\n        bgColor = '#2d2d2e'\n        textColor = '#eaeaea'\n        btnBg = '#353535'\n        btColor = '#ffffff'\n      } else {\n        bgColor = '#ffffff'\n        textColor = '#000000'\n        btnBg = '#a5a6a6'\n        btColor = '#ffffff'\n      }\n      const titleText = targetingMsgJson.msgContent.title\n      const descriptionText = targetingMsgJson.msgContent.description\n      let ctaText = ''\n      if (targetingMsgJson.msgContent.ctaText != null && targetingMsgJson.msgContent.ctaText !== '') {\n        ctaText = \"<div class='button'><a href='#'>\" + targetingMsgJson.msgContent.ctaText + '</a></div>'\n      }\n\n      let imageTd = ''\n      if (targetingMsgJson.msgContent.imageUrl != null && targetingMsgJson.msgContent.imageUrl !== '') {\n        imageTd = \"<div style='padding-top:20px;'><img src='\" + targetingMsgJson.msgContent.imageUrl + \"' width='500' alt=\" + titleText + ' /></div>'\n      }\n      const onClickStr = 'parent.$WZRK_WR.closeIframe(' + campaignId + \",'intentPreview');\"\n      const title = \"<div class='wzrkPPwarp' style='color:\" + textColor + ';background-color:' + bgColor + \";'>\" +\n        \"<a href='javascript:void(0);' onclick=\" + onClickStr + \" class='wzrkClose' style='background-color:\" + btnBg + ';color:' + btColor + \"'>&times;</a>\" +\n        \"<div id='contentDiv' class='wzrk'>\" +\n        \"<div class='wzrkPPtitle' style='color:\" + textColor + \"'>\" + titleText + '</div>'\n      const body = \"<div class='wzrkPPdscr' style='color:\" + textColor + \"'>\" + descriptionText + '</div>' + imageTd + ctaText +\n        '</div></div>'\n      html = css + title + body\n    }\n    iframe.setAttribute('style', 'z-index: 2147483647; display:block; height: 100% !important; width: 100% !important;min-height:80px !important;border:0px !important; border-color:none !important;')\n    msgDiv.appendChild(iframe)\n\n    // Dispatch event for interstitial/exit intent close\n    const closeCampaign = new Event('CT_campaign_rendered')\n    document.dispatchEvent(closeCampaign)\n\n    if (targetingMsgJson.display['custom-editor']) {\n      html = appendScriptForCustomEvent(targetingMsgJson, html)\n    }\n    iframe.srcdoc = html\n\n    iframe.onload = () => {\n      const contentDiv = document.getElementById('wiz-iframe-intent').contentDocument.getElementById('contentDiv')\n      setupClickUrl(onClick, targetingMsgJson, contentDiv, 'intentPreview', legacy)\n    }\n  }\n\n  if (!document.body) {\n    if (_wizCounter < 6) {\n      _wizCounter++\n      setTimeout(_tr, 1000, msg, {\n        device: _device,\n        session: _session,\n        request: _request,\n        logger: _logger\n      })\n    }\n    return\n  }\n  const processNativeDisplayArr = (arrInAppNotifs) => {\n    Object.keys(arrInAppNotifs).map(key => {\n      var elementId, id\n      if (arrInAppNotifs[key].display.divId) {\n        elementId = arrInAppNotifs[key].display.divId\n        id = document.getElementById(elementId)\n      } else {\n        elementId = arrInAppNotifs[key].display.divSelector\n        id = document.querySelector(elementId)\n      }\n      if (id !== null) {\n        arrInAppNotifs[key].msgContent.type === 2 ? renderPersonalisationBanner(arrInAppNotifs[key]) : renderPersonalisationCarousel(arrInAppNotifs[key])\n        delete arrInAppNotifs[key]\n      }\n    })\n  }\n\n  const addLoadListener = (arrInAppNotifs) => {\n    window.addEventListener('load', () => {\n      let count = 0\n      if (count < 20) {\n        const t = setInterval(() => {\n          processNativeDisplayArr(arrInAppNotifs)\n          if (Object.keys(arrInAppNotifs).length === 0 || count === 20) {\n            clearInterval(t)\n            arrInAppNotifs = {}\n          }\n          count++\n        }, 500)\n      }\n    })\n  }\n\n  if (msg.inapp_notifs != null) {\n    const arrInAppNotifs = {}\n    for (let index = 0; index < msg.inapp_notifs.length; index++) {\n      const targetNotif = msg.inapp_notifs[index]\n      if (targetNotif.display.wtarget_type == null || targetNotif.display.wtarget_type === 0) {\n        showFooterNotification(targetNotif)\n      } else if (targetNotif.display.wtarget_type === 1) { // if display['wtarget_type']==1 then exit intent\n        exitintentObj = targetNotif\n        window.document.body.onmouseleave = showExitIntent\n      } else if (targetNotif.display.wtarget_type === 2) { // if display['wtarget_type']==2 then web native display\n        if (targetNotif.msgContent.type === 2 || targetNotif.msgContent.type === 3) { // Check for banner and carousel\n          const element = targetNotif.display.divId ? document.getElementById(targetNotif.display.divId) : document.querySelector(targetNotif.display.divSelector)\n          if (element !== null) {\n            targetNotif.msgContent.type === 2 ? renderPersonalisationBanner(targetNotif) : renderPersonalisationCarousel(targetNotif)\n          } else {\n            arrInAppNotifs[targetNotif.wzrk_id.split('_')[0]] = targetNotif // Add targetNotif to object\n          }\n        } else if (targetNotif.msgContent.type === 4) {\n          renderVisualBuilder(targetNotif, false)\n        } else {\n          showFooterNotification(targetNotif)\n        }\n      }\n    }\n    // Process banner or carousel campaign array\n    if (Object.keys(arrInAppNotifs).length) {\n      if (document.readyState === 'complete') {\n        processNativeDisplayArr(arrInAppNotifs)\n      } else {\n        addLoadListener(arrInAppNotifs)\n      }\n    }\n  }\n\n  const mergeEventMap = (newEvtMap) => {\n    if ($ct.globalEventsMap == null) {\n      $ct.globalEventsMap = StorageManager.readFromLSorCookie(EV_COOKIE)\n      if ($ct.globalEventsMap == null) {\n        $ct.globalEventsMap = newEvtMap\n        return\n      }\n    }\n    for (const key in newEvtMap) {\n      if (newEvtMap.hasOwnProperty(key)) {\n        const oldEvtObj = $ct.globalEventsMap[key]\n        const newEvtObj = newEvtMap[key]\n        if ($ct.globalEventsMap[key] != null) {\n          if (newEvtObj[0] != null && newEvtObj[0] > oldEvtObj[0]) {\n            $ct.globalEventsMap[key] = newEvtObj\n          }\n        } else {\n          $ct.globalEventsMap[key] = newEvtObj\n        }\n      }\n    }\n  }\n\n  const handleInboxNotifications = () => {\n    if (msg.inbox_preview) {\n      processInboxNotifs(msg)\n      return\n    }\n    if (msg.inbox_notifs) {\n      const msgArr = []\n      for (let index = 0; index < msg.inbox_notifs.length; index++) {\n        if (doCampHouseKeeping(msg.inbox_notifs[index]) !== false) {\n          msgArr.push(msg.inbox_notifs[index])\n        }\n      }\n      processInboxNotifs(msgArr)\n    }\n  }\n\n  if (msg.webInboxSetting || msg.inbox_notifs != null) {\n    /**\n     * When the user visits a website for the 1st time after web inbox channel is setup,\n     * we need to initialise the inbox here because the initializeWebInbox method within init will not be executed\n     * as we would not have any entry related to webInboxSettings in the LS\n     */\n    if (hasWebInboxSettingsInLS()) {\n      checkAndRegisterWebInboxElements()\n    }\n    if ($ct.inbox === null) {\n      msg.webInboxSetting && processWebInboxSettings(msg.webInboxSetting)\n      initializeWebInbox(_logger)\n        .then(() => {\n          handleInboxNotifications()\n        })\n        .catch(e => {})\n    } else {\n      handleInboxNotifications()\n    }\n  }\n\n  if (msg.webPushConfig) {\n    processWebPushConfig(msg.webPushConfig, logger, request)\n  }\n\n  if (msg.vars) {\n    $ct.variableStore.mergeVariables(msg.vars)\n    return\n  }\n\n  const staleDataUpdate = (staledata, campType) => {\n    const campObj = getCampaignObject()\n    const globalObj = campObj[campType].global\n    if (globalObj != null && campType) {\n      for (const idx in staledata) {\n        if (staledata.hasOwnProperty(idx)) {\n          delete globalObj[staledata[idx]]\n          if (StorageManager.read(CAMP_COOKIE_G)) {\n            const guidCampObj = JSON.parse(decodeURIComponent(StorageManager.read(CAMP_COOKIE_G)))\n            const guid = JSON.parse(decodeURIComponent(StorageManager.read(GCOOKIE_NAME)))\n            if (guidCampObj[guid] && guidCampObj[guid][campType] && guidCampObj[guid][campType][staledata[idx]]) {\n              delete guidCampObj[guid][campType][staledata[idx]]\n              StorageManager.save(CAMP_COOKIE_G, encodeURIComponent(JSON.stringify(guidCampObj)))\n            }\n          }\n        }\n      }\n    }\n    saveCampaignObject(campObj)\n  }\n\n  if (StorageManager._isLocalStorageSupported()) {\n    try {\n      if (msg.evpr != null) {\n        const eventsMap = msg.evpr.events\n        const profileMap = msg.evpr.profile\n        const syncExpiry = msg.evpr.expires_in\n        const now = getNow()\n        StorageManager.setMetaProp('lsTime', now)\n        StorageManager.setMetaProp('exTs', syncExpiry)\n        mergeEventMap(eventsMap)\n        StorageManager.saveToLSorCookie(EV_COOKIE, $ct.globalEventsMap)\n        if ($ct.globalProfileMap == null) {\n          addToLocalProfileMap(profileMap, true)\n        } else {\n          addToLocalProfileMap(profileMap, false)\n        }\n      }\n      if (msg.arp != null) {\n        arp(msg.arp)\n      }\n      if (msg.inapp_stale != null && msg.inapp_stale.length > 0) {\n        // web popup stale\n        staleDataUpdate(msg.inapp_stale, 'wp')\n      }\n      if (msg.inbox_stale != null && msg.inbox_stale.length > 0) {\n        // web inbox stale\n        staleDataUpdate(msg.inbox_stale, 'wi')\n      }\n    } catch (e) {\n      _logger.error('Unable to persist evrp/arp: ' + e)\n    }\n  }\n}\n\nexport default _tr\n","import {\n  StorageManager\n} from '../util/storage'\nexport default class User {\n  #isPersonalisationActive\n\n  constructor ({\n    isPersonalisationActive\n  }) {\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  getTotalVisits () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    let visitCount = StorageManager.getMetaProp('sc')\n    if (visitCount == null) {\n      visitCount = 1\n    }\n    return visitCount\n  }\n\n  getLastVisit () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    const prevSession = StorageManager.getMetaProp('ps')\n    if (prevSession != null) {\n      return new Date(prevSession * 1000)\n    }\n  }\n}\n","import {\n  CLEVERTAP_ERROR_PREFIX\n} from '../util/messages'\n\nexport const logLevels = {\n  DISABLE: 0,\n  ERROR: 1,\n  INFO: 2,\n  DEBUG: 3,\n  DEBUG_PE: 4\n}\n\nexport class Logger {\n  #logLevel\n  wzrkError = {}\n  constructor (logLevel) {\n    this.#logLevel = logLevel == null ? logLevel : logLevels.INFO\n    this.wzrkError = {}\n  }\n\n  get logLevel () {\n    return this.#logLevel\n  }\n\n  set logLevel (logLevel) {\n    this.#logLevel = logLevel\n  }\n\n  error (message) {\n    if (this.#logLevel >= logLevels.ERROR) {\n      this.#log('error', message)\n    }\n  }\n\n  info (message) {\n    if (this.#logLevel >= logLevels.INFO) {\n      this.#log('log', message)\n    }\n  }\n\n  debug (message) {\n    if (this.#logLevel >= logLevels.DEBUG || this.#isLegacyDebug) {\n      this.#log('debug', message)\n    }\n  }\n\n  debugPE (message) {\n    if (this.#logLevel >= logLevels.DEBUG_PE) {\n      this.#log('debug_pe', message)\n    }\n  }\n\n  reportError (code, description) {\n    this.wzrkError.c = code\n    this.wzrkError.d = description\n    this.error(`${CLEVERTAP_ERROR_PREFIX} ${code}: ${description}`)\n  }\n\n  #log (level, message) {\n    if (window.console) {\n      try {\n        const ts = new Date().getTime()\n        console[level](`CleverTap [${ts}]: ${message}`)\n      } catch (e) {}\n    }\n  }\n\n  get #isLegacyDebug () {\n    return (typeof sessionStorage !== 'undefined' && sessionStorage.WZRK_D === '')\n  }\n}\n\nexport default {\n  Logger,\n  logLevels\n}\n","import { singleQuoteRegex, SCOOKIE_EXP_TIME_IN_SECS } from '../util/constants'\nimport { isObject } from '../util/datatypes'\nimport { getNow } from '../util/datetime'\nimport { StorageManager } from '../util/storage'\nimport { getHostName } from '../util/url'\n\nexport default class SessionManager {\n  #logger\n  #sessionId\n  #isPersonalisationActive\n  cookieName // SCOOKIE_NAME\n  scookieObj\n\n  constructor ({\n    logger,\n    isPersonalisationActive\n  }) {\n    this.sessionId = StorageManager.getMetaProp('cs')\n    this.#logger = logger\n    this.#isPersonalisationActive = isPersonalisationActive\n  }\n\n  get sessionId () {\n    return this.#sessionId\n  }\n\n  set sessionId (sessionId) {\n    this.#sessionId = sessionId\n  }\n\n  getSessionCookieObject () {\n    let scookieStr = StorageManager.readCookie(this.cookieName)\n    let obj = {}\n\n    if (scookieStr != null) {\n      // converting back single quotes to double for JSON parsing - http://www.iandevlin.com/blog/2012/04/html5/cookies-json-localstorage-and-opera\n      scookieStr = scookieStr.replace(singleQuoteRegex, '\"')\n\n      obj = JSON.parse(scookieStr)\n      if (!isObject(obj)) {\n        obj = {}\n      } else {\n        if (typeof obj.t !== 'undefined') { // check time elapsed since last request\n          const lastTime = obj.t\n          const now = getNow()\n          if ((now - lastTime) > (SCOOKIE_EXP_TIME_IN_SECS + 60)) {\n            // adding 60 seconds to compensate for in-journey requests\n            // ideally the cookie should've died after SCOOKIE_EXP_TIME_IN_SECS but it's still around as we can read\n            // hence we shouldn't use it.\n            obj = {}\n          }\n        }\n      }\n    }\n    this.scookieObj = obj\n    return obj\n  }\n\n  setSessionCookieObject (obj) {\n    const objStr = JSON.stringify(obj)\n    StorageManager.createBroadCookie(this.cookieName, objStr, SCOOKIE_EXP_TIME_IN_SECS, getHostName())\n  }\n\n  manageSession (session) {\n    // first time. check if current session id in localstorage is same\n    // if not same then prev = current and current = this new session\n    if (typeof this.sessionId === 'undefined' || this.sessionId !== session) {\n      const currentSessionInLS = StorageManager.getMetaProp('cs')\n      // if sessionId in meta is undefined - set current to both\n      if (typeof currentSessionInLS === 'undefined') {\n        StorageManager.setMetaProp('ps', session)\n        StorageManager.setMetaProp('cs', session)\n        StorageManager.setMetaProp('sc', 1)\n      } else if (currentSessionInLS !== session) {\n        // not same as session in local storage. new session\n        StorageManager.setMetaProp('ps', currentSessionInLS)\n        StorageManager.setMetaProp('cs', session)\n        let sessionCount = StorageManager.getMetaProp('sc')\n        if (typeof sessionCount === 'undefined') {\n          sessionCount = 0\n        }\n        StorageManager.setMetaProp('sc', sessionCount + 1)\n      }\n      this.sessionId = session\n    }\n  }\n\n  getTimeElapsed () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n    if (this.scookieObj != null) { // TODO: check logic?\n      this.scookieObj = this.getSessionCookieObject()\n    }\n    const sessionStart = this.scookieObj.s\n    if (sessionStart != null) {\n      const ts = getNow()\n      return Math.floor(ts - sessionStart)\n    }\n  }\n\n  getPageCount () {\n    if (!this.#isPersonalisationActive()) {\n      return\n    }\n\n    if (this.scookieObj != null) { // TODO: check logic\n      this.scookieObj = this.getSessionCookieObject()\n    }\n    return this.scookieObj.p\n  }\n}\n","import { CAMP_COOKIE_NAME, CLEAR, EVT_PUSH, EV_COOKIE, FIRE_PUSH_UNREGISTERED, LCOOKIE_NAME, PUSH_SUBSCRIPTION_DATA, WEBPUSH_LS_KEY } from '../util/constants'\nimport { isObjectEmpty, isValueValid, removeUnsupportedChars } from '../util/datatypes'\nimport { getNow } from '../util/datetime'\nimport { compressData } from '../util/encoder'\nimport RequestDispatcher from '../util/requestDispatcher'\nimport { StorageManager, $ct } from '../util/storage'\nimport { addToURL } from '../util/url'\nimport { getCampaignObjForLc } from '../util/clevertap'\n\nlet seqNo = 0\nlet requestTime = 0\n\nexport default class RequestManager {\n  #logger\n  #account\n  #device\n  #session\n  #isPersonalisationActive\n  #clearCookie = false\n  processingBackup = false\n\n  constructor ({ logger, account, device, session, isPersonalisationActive }) {\n    this.#logger = logger\n    this.#account = account\n    this.#device = device\n    this.#session = session\n    this.#isPersonalisationActive = isPersonalisationActive\n\n    RequestDispatcher.logger = logger\n    RequestDispatcher.device = device\n    RequestDispatcher.account = account\n  }\n\n  processBackupEvents () {\n    const backupMap = StorageManager.readFromLSorCookie(LCOOKIE_NAME)\n    if (typeof backupMap === 'undefined' || backupMap === null) {\n      return\n    }\n    this.processingBackup = true\n    for (const idx in backupMap) {\n      if (backupMap.hasOwnProperty(idx)) {\n        const backupEvent = backupMap[idx]\n        if (typeof backupEvent.fired === 'undefined') {\n          this.#logger.debug('Processing backup event : ' + backupEvent.q)\n          if (typeof backupEvent.q !== 'undefined') {\n            RequestDispatcher.fireRequest(backupEvent.q)\n          }\n          backupEvent.fired = true\n        }\n      }\n    }\n    StorageManager.saveToLSorCookie(LCOOKIE_NAME, backupMap)\n    this.processingBackup = false\n  }\n\n  addSystemDataToObject (dataObject, ignoreTrim) {\n    // ignore trim for chrome notifications; undefined everywhere else\n    if (typeof ignoreTrim === 'undefined') {\n      dataObject = removeUnsupportedChars(dataObject, this.#logger)\n    }\n\n    if (!isObjectEmpty(this.#logger.wzrkError)) {\n      dataObject.wzrk_error = this.#logger.wzrkError\n      this.#logger.wzrkError = {}\n    }\n\n    dataObject.id = this.#account.id\n\n    if (isValueValid(this.#device.gcookie)) {\n      dataObject.g = this.#device.gcookie\n    }\n\n    const obj = this.#session.getSessionCookieObject()\n    dataObject.s = obj.s // session cookie\n    dataObject.pg = (typeof obj.p === 'undefined') ? 1 : obj.p // Page count\n    let proto = document.location.protocol\n    proto = proto.replace(':', '')\n    dataObject.af = { ...dataObject.af, lib: 'web-sdk-v$$PACKAGE_VERSION$$', protocol: proto, ...$ct.flutterVersion } // app fields\n    if (sessionStorage.hasOwnProperty('WZRK_D')) { dataObject.debug = true }\n\n    return dataObject\n  }\n\n  addFlags (data) {\n    // check if cookie should be cleared.\n    this.#clearCookie = StorageManager.getAndClearMetaProp(CLEAR)\n    if (this.#clearCookie !== undefined && this.#clearCookie) {\n      data.rc = true\n      this.#logger.debug('reset cookie sent in request and cleared from meta for future requests.')\n    }\n    if (this.#isPersonalisationActive()) {\n      const lastSyncTime = StorageManager.getMetaProp('lsTime')\n      const expirySeconds = StorageManager.getMetaProp('exTs')\n\n      // dsync not found in local storage - get data from server\n      if (typeof lastSyncTime === 'undefined' || typeof expirySeconds === 'undefined') {\n        data.dsync = true\n        return\n      }\n      const now = getNow()\n      // last sync time has expired - get fresh data from server\n      if (lastSyncTime + expirySeconds < now) {\n        data.dsync = true\n      }\n    }\n  }\n\n  // saves url to backup cache and fires the request\n  /**\n   *\n   * @param {string} url\n   * @param {boolean} override whether the request can go through or not\n   * @param {Boolean} sendOULFlag - true in case of a On User Login request\n   */\n  saveAndFireRequest (url, override, sendOULFlag, evtName) {\n    const now = getNow()\n    url = addToURL(url, 'rn', ++$ct.globalCache.REQ_N)\n    const data = url + '&i=' + now + '&sn=' + seqNo\n    StorageManager.backupEvent(data, $ct.globalCache.REQ_N, this.#logger)\n\n    // if offline is set to true, save the request in backup and return\n    if ($ct.offline) return\n    // if there is no override\n    // and an OUL request is not in progress\n    // then process the request as it is\n    // else block the request\n    // note - $ct.blockRequest should ideally be used for override\n    if ((!override || (this.#clearCookie !== undefined && this.#clearCookie)) && !window.isOULInProgress) {\n      if (now === requestTime) {\n        seqNo++\n      } else {\n        requestTime = now\n        seqNo = 0\n      }\n      window.oulReqN = $ct.globalCache.REQ_N\n      RequestDispatcher.fireRequest(data, false, sendOULFlag, evtName)\n    } else {\n      this.#logger.debug(`Not fired due to override - ${$ct.blockRequest} or clearCookie - ${this.#clearCookie} or OUL request in progress - ${window.isOULInProgress}`)\n    }\n  }\n\n  unregisterTokenForGuid (givenGUID) {\n    const payload = StorageManager.readFromLSorCookie(PUSH_SUBSCRIPTION_DATA)\n    // Send unregister event only when token is available\n    if (payload) {\n      const data = {}\n      data.type = 'data'\n      if (isValueValid(givenGUID)) {\n        data.g = givenGUID\n      }\n      data.action = 'unregister'\n      data.id = this.#account.id\n\n      const obj = this.#session.getSessionCookieObject()\n\n      data.s = obj.s // session cookie\n      const compressedData = compressData(JSON.stringify(data), this.#logger)\n\n      let pageLoadUrl = this.#account.dataPostURL\n      pageLoadUrl = addToURL(pageLoadUrl, 'type', 'data')\n      pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n      RequestDispatcher.fireRequest(pageLoadUrl, true)\n      StorageManager.saveToLSorCookie(FIRE_PUSH_UNREGISTERED, false)\n    }\n    // REGISTER TOKEN\n    this.registerToken(payload)\n  }\n\n  registerToken (payload) {\n    if (!payload) return\n    // add gcookie etc to the payload\n    payload = this.addSystemDataToObject(payload, true)\n    payload = JSON.stringify(payload)\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', 'data')\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(payload, this.#logger))\n    RequestDispatcher.fireRequest(pageLoadUrl)\n    // set in localstorage\n    StorageManager.save(WEBPUSH_LS_KEY, 'ok')\n  }\n\n  processEvent (data) {\n    this.#addToLocalEventMap(data.evtName)\n    data = this.addSystemDataToObject(data, undefined)\n    this.addFlags(data)\n    data[CAMP_COOKIE_NAME] = getCampaignObjForLc()\n    const compressedData = compressData(JSON.stringify(data), this.#logger)\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n    this.saveAndFireRequest(pageLoadUrl, $ct.blockRequest, false, data.evtName)\n  }\n\n  #addToLocalEventMap (evtName) {\n    if (StorageManager._isLocalStorageSupported()) {\n      if (typeof $ct.globalEventsMap === 'undefined') {\n        $ct.globalEventsMap = StorageManager.readFromLSorCookie(EV_COOKIE)\n        if (typeof $ct.globalEventsMap === 'undefined') {\n          $ct.globalEventsMap = {}\n        }\n      }\n\n      const nowTs = getNow()\n      let evtDetail = $ct.globalEventsMap[evtName]\n      if (typeof evtDetail !== 'undefined') {\n        evtDetail[2] = nowTs\n        evtDetail[0]++\n      } else {\n        evtDetail = []\n        evtDetail.push(1)\n        evtDetail.push(nowTs)\n        evtDetail.push(nowTs)\n      }\n      $ct.globalEventsMap[evtName] = evtDetail\n      StorageManager.saveToLSorCookie(EV_COOKIE, $ct.globalEventsMap)\n    }\n  }\n\n  post (url, body) {\n    return fetch(url, {\n      method: 'post',\n      headers: { 'Content-Type': 'application/json' },\n      body: body\n    })\n      .then((response) => {\n        if (response.ok) {\n          return response.json()\n        }\n        throw response\n      })\n      .then((data) => {\n        this.#logger.debug('Sync data successful', data)\n        return data\n      })\n      .catch((e) => {\n        this.#logger.debug('Error in syncing variables', e)\n        throw e\n      })\n  }\n}\n","import {\n  isObjectEmpty\n} from '../util/datatypes'\nimport {\n  EVT_PUSH,\n  USEIP_KEY,\n  OPTOUT_KEY,\n  CT_OPTOUT_KEY\n} from '../util/constants'\nimport {\n  StorageManager,\n  $ct\n} from '../util/storage'\nimport {\n  compressData\n} from '../util/encoder'\nimport {\n  addToURL\n} from '../util/url'\n\nexport default class Privacy extends Array {\n  #request\n  #account\n  #oldValues\n  #logger\n\n  constructor ({\n    request,\n    account,\n    logger\n  },\n  values) {\n    super()\n    this.#logger = logger\n    this.#request = request\n    this.#account = account\n    this.#oldValues = values\n  }\n\n  push (...privacyArr) {\n    if ($ct.isPrivacyArrPushed) {\n      this.#processPrivacyArray($ct.privacyArray.length > 0 ? $ct.privacyArray : privacyArr)\n    } else {\n      $ct.privacyArray.push(...privacyArr)\n    }\n    return 0\n  }\n\n  _processOldValues () {\n    if (this.#oldValues) {\n      this.#processPrivacyArray(this.#oldValues)\n    }\n    this.#oldValues = null\n  }\n\n  #processPrivacyArray (privacyArr) {\n    if (Array.isArray(privacyArr) && privacyArr.length > 0) {\n      const privacyObj = privacyArr.reduce((prev, curr) => ({ ...prev, ...curr }), {})\n      let data = {}\n      const profileObj = {}\n      var optOut = false\n\n      if (privacyObj.hasOwnProperty(OPTOUT_KEY)) {\n        optOut = privacyObj[OPTOUT_KEY]\n        if (typeof optOut === 'boolean') {\n          profileObj[CT_OPTOUT_KEY] = optOut\n          // should be true when user wants to opt in\n          $ct.isOptInRequest = !optOut\n        }\n      }\n      if (privacyObj.hasOwnProperty(USEIP_KEY)) {\n        const useIP = privacyObj[USEIP_KEY]\n        const shouldUseIP = (typeof useIP === 'boolean') ? useIP : false\n        StorageManager.setMetaProp(USEIP_KEY, shouldUseIP)\n      }\n      if (!isObjectEmpty(profileObj)) {\n        data.type = 'profile'\n        data.profile = profileObj\n        data = this.#request.addSystemDataToObject(data, undefined)\n        const compressedData = compressData(JSON.stringify(data), this.#logger)\n        let pageLoadUrl = this.#account.dataPostURL\n        pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n        pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n        pageLoadUrl = addToURL(pageLoadUrl, OPTOUT_KEY, optOut ? 'true' : 'false')\n        this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n        privacyArr.splice(0, privacyArr.length)\n      }\n    }\n  }\n}\n","export class Variable {\n  #variableStore\n\n  /**\n   * Creates an instance of the Variable class.\n   *\n   * @constructor\n   * @param {VariableStore} options.variableStore - The VariableStore instance for registration.\n   * @param {string|null} options.name - The name of the variable.\n   * @param {*} options.defaultValue - The default value of the variable.\n   * @param {*} options.value - The current value of the variable.\n   * @param {string|null} options.type - The type of the variable (string, number, boolean).\n   * @param {boolean} options.hadStarted - A flag indicating whether the variable has started (used internally).\n   * @param {Function[]} options.valueChangedCallbacks - Array to store callbacks to be executed when the variable value changes.\n   */\n  constructor ({ variableStore }) {\n    this.name = null\n    this.defaultValue = null\n    this.value = null\n    this.type = null\n    this.hadStarted = false\n    this.valueChangedCallbacks = []\n    this.#variableStore = variableStore\n  }\n\n  getValue () {\n    return this.value\n  }\n\n  getdefaultValue () {\n    return this.defaultValue\n  }\n\n  /**\n   * Defines a new variable with the provided name, default value, and variable store.\n   * @static\n   * @param {string} name - The name of the variable.\n   * @param {*} defaultValue - The default value of the variable.\n   * @param {VariableStore} variableStore - The VariableStore instance for registration.\n   * @returns {Variable|null} - The created Variable instance or null if invalid parameters are provided.\n   */\n  static define (name, defaultValue, variableStore) {\n    if (!name || typeof name !== 'string') {\n      console.error('Empty or invalid name parameter provided.')\n      return null\n    }\n    if (name.startsWith('.') || name.endsWith('.')) {\n      console.error('Variable name starts or ends with a `.` which is not allowed: ' + name)\n      return null\n    }\n\n    const typeOfDefaultValue = typeof defaultValue\n    if (typeOfDefaultValue !== 'string' && typeOfDefaultValue !== 'number' && typeOfDefaultValue !== 'boolean') {\n      console.error('Only primitive types (string, number, boolean) are accepted as value')\n      return null\n    }\n\n    const existing = variableStore.getVariable(name)\n    if (existing) {\n      return existing\n    }\n\n    const varInstance = new Variable({ variableStore })\n    try {\n      varInstance.name = name\n      varInstance.defaultValue = defaultValue\n      varInstance.value = defaultValue\n      varInstance.type = typeOfDefaultValue\n      variableStore.registerVariable(varInstance)\n      varInstance.update(defaultValue)\n    } catch (error) {\n      console.error(error)\n    }\n    return varInstance\n  }\n\n  /**\n   * Updates the variable's value, triggering callbacks if hasVarsRequestCompleted is returned true.\n   * @param {*} newValue - The new value to be assigned to the variable.\n   */\n  update (newValue) {\n    const oldValue = this.value\n    this.value = newValue\n    if (newValue === null && oldValue === null) {\n      return\n    }\n    if (newValue !== null && newValue === oldValue && this.hadStarted) {\n      return\n    }\n    if (this.#variableStore.hasVarsRequestCompleted()) {\n      this.hadStarted = true\n      this.triggerValueChanged()\n    }\n  }\n\n  /**\n   * Invokes all registered callbacks when the variable value changes.\n   */\n  triggerValueChanged () {\n    this.valueChangedCallbacks.forEach((onValueChanged) => {\n      onValueChanged(this)\n    })\n  }\n\n  /**\n   * Adds a callback function to the array and triggers it immediately if variable requests have completed.\n   * @param {Function} onValueChanged - The callback function to be added.\n   */\n  addValueChangedCallback (onValueChanged) {\n    if (!onValueChanged) {\n      console.log('Invalid callback parameter provided.')\n      return\n    }\n    this.valueChangedCallbacks.push(onValueChanged)\n\n    if (this.#variableStore.hasVarsRequestCompleted()) {\n      onValueChanged(this)\n    }\n  }\n\n  /**\n   * Removes a callback function from the array.\n   * @param {Function} onValueChanged - The callback function to be removed.\n   */\n  removeValueChangedCallback (onValueChanged) {\n    const index = this.valueChangedCallbacks.indexOf(onValueChanged)\n    if (index !== -1) {\n      this.valueChangedCallbacks.splice(index, 1)\n    }\n  }\n\n  /**\n   * Resets the `hadStarted` flag to false.\n   */\n  clearStartFlag () {\n    this.hadStarted = false\n  }\n}\n","import { VARIABLES, WZRK_FETCH } from '../../util/constants'\nimport { StorageManager, $ct } from '../../util/storage'\nclass VariableStore {\n  #logger\n  #account\n  #request\n  #event\n\n  #variables\n  #remoteVariables\n  #fetchCallback\n  #variablesChangedCallbacks\n  #oneTimeVariablesChangedCallbacks\n  #hasVarsRequestCompleted = false\n\n  constructor ({ logger, request, account, event }) {\n    this.#logger = logger\n    this.#account = account\n    this.#request = request\n    this.#event = event\n\n    this.#variables = {}\n    this.#remoteVariables = {}\n    this.#variablesChangedCallbacks = []\n    this.#oneTimeVariablesChangedCallbacks = []\n\n    $ct.variableStore = this\n  }\n\n  /**\n   * Registers a variable instance in the store.\n   * @param {Object} varInstance - The variable instance to be registered.\n   */\n  registerVariable (varInstance) {\n    const { name } = varInstance\n    this.#variables[name] = varInstance\n    console.log('registerVariable', this.#variables)\n  }\n\n  /**\n   * Retrieves a variable by its name.\n   * @param {string} name - The name of the variable to retrieve.\n   * @returns {Object} - The variable instance.\n   */\n  getVariable (name) {\n    return this.#variables[name]\n  }\n\n  hasVarsRequestCompleted () {\n    return this.#hasVarsRequestCompleted\n  }\n\n  /**\n   * Synchronizes variables with the server.\n   * @param {Function} onSyncSuccess - Callback function on successful synchronization.\n   * @param {Function} onSyncFailure - Callback function on synchronization failure.\n   * @throws Will throw an error if the account token is missing.\n   * @returns {Promise} - The result of the synchronization request.\n   */\n  syncVariables (onSyncSuccess, onSyncFailure) {\n    if (!this.#account.token) {\n      const m = 'Account token is missing.'\n      this.#logger.error(m)\n      return Promise.reject(new Error(m))\n    }\n\n    const payload = {\n      type: 'varsPayload',\n      vars: {}\n    }\n\n    for (const name in this.#variables) {\n      payload.vars[name] = {\n        defaultValue: this.#variables[name].defaultValue,\n        type: this.#variables[name].type\n      }\n    }\n\n    // Check if payload.vars is empty\n    if (Object.keys(payload.vars).length === 0) {\n      const m = 'No variables are defined.'\n      this.#logger.error(m)\n      return Promise.reject(new Error(m))\n    }\n\n    let meta = {}\n    meta = this.#request.addSystemDataToObject(meta, undefined)\n    meta.tk = this.#account.token\n\n    meta.type = 'meta'\n    const body = JSON.stringify([meta, payload])\n    const url = this.#account.dataPostPEURL\n\n    return this.#request.post(url, body)\n      .then((r) => {\n        if (onSyncSuccess && typeof onSyncSuccess === 'function') {\n          onSyncSuccess(r)\n        }\n        return r\n      })\n      .catch((e) => {\n        if (onSyncFailure && typeof onSyncFailure === 'function') {\n          onSyncFailure(e)\n        }\n        if (e.status === 400) {\n          this.#logger.error('Invalid sync payload or clear the existing draft')\n        } else if (e.status === 401) {\n          this.#logger.error('This is not a test profile')\n        } else {\n          this.#logger.error('Sync variable failed')\n        }\n        throw e\n      })\n  }\n\n  /**\n   * Fetches variables from the server.\n   * @param {Function} onFetchCallback - Callback function on fetch completion.\n   */\n  fetchVariables (onFetchCallback) {\n    this.#event.push(WZRK_FETCH, { t: 4 })\n    if (onFetchCallback && typeof onFetchCallback === 'function') {\n      this.#fetchCallback = onFetchCallback\n    }\n  }\n\n  mergeVariables (vars) {\n    console.log('msg vars is ', vars)\n    this.#hasVarsRequestCompleted = true\n\n    StorageManager.saveToLSorCookie(VARIABLES, vars)\n    this.#remoteVariables = vars\n\n    for (const name in this.#variables) {\n      if (vars.hasOwnProperty(name)) {\n        this.#variables[name].update(vars[name])\n      }\n    }\n\n    if (this.#fetchCallback) {\n      this.#fetchCallback()\n    }\n\n    this.#runVariablesChangedCallback()\n  }\n\n  addVariablesChangedCallback (callback) {\n    if (callback && typeof callback === 'function') {\n      this.#variablesChangedCallbacks.push(callback)\n\n      if (this.hasVarsRequestCompleted()) {\n        callback()\n      }\n    } else {\n      this.#logger.error('callback is not a function')\n    }\n  }\n\n  addOneTimeVariablesChangedCallback (callback) {\n    if (callback && typeof callback === 'function') {\n      if (this.hasVarsRequestCompleted()) {\n        callback()\n      } else {\n        this.#oneTimeVariablesChangedCallbacks.push(callback)\n      }\n    }\n  }\n\n  removeVariablesChangedCallback (callback) {\n    const index = this.#variablesChangedCallbacks.indexOf(callback)\n    if (index !== -1) {\n      this.#variablesChangedCallbacks.splice(index, 1)\n    }\n  }\n\n  removeOneTimeVariablesChangedCallback (callback) {\n    const index = this.#oneTimeVariablesChangedCallbacks.indexOf(callback)\n    if (index !== -1) {\n      this.#oneTimeVariablesChangedCallbacks.splice(index, 1)\n    }\n  }\n\n  #runVariablesChangedCallback () {\n    for (var callback of this.#variablesChangedCallbacks) {\n      callback()\n    }\n    for (var callBack of this.#oneTimeVariablesChangedCallbacks) {\n      callBack()\n    }\n    this.#oneTimeVariablesChangedCallbacks.length = 0\n  }\n}\n\nexport default VariableStore\n","import Account from './modules/account'\nimport CleverTapAPI from './modules/api'\nimport DeviceManager from './modules/device'\nimport EventHandler from './modules/event'\nimport ProfileHandler from './modules/profile'\nimport UserLoginHandler from './modules/userLogin'\nimport _tr from './util/tr'\nimport User from './modules/user'\nimport { Logger, logLevels } from './modules/logger'\nimport SessionManager from './modules/session'\nimport ReqestManager from './modules/request'\nimport {\n  CAMP_COOKIE_NAME,\n  SCOOKIE_PREFIX,\n  NOTIFICATION_VIEWED,\n  NOTIFICATION_CLICKED,\n  EVT_PING,\n  FIRST_PING_FREQ_IN_MILLIS,\n  CONTINUOUS_PING_FREQ_IN_MILLIS,\n  GROUP_SUBSCRIPTION_REQUEST_ID,\n  WZRK_ID,\n  WZRK_PREFIX,\n  categoryLongKey,\n  COMMAND_INCREMENT,\n  COMMAND_DECREMENT,\n  COMMAND_SET,\n  COMMAND_ADD,\n  COMMAND_REMOVE,\n  COMMAND_DELETE,\n  EVT_PUSH,\n  WZRK_FETCH\n} from './util/constants'\nimport { EMBED_ERROR } from './util/messages'\nimport { StorageManager, $ct } from './util/storage'\nimport { addToURL, getDomain, getURLParams } from './util/url'\nimport { getCampaignObjForLc, setEnum, handleEmailSubscription, closeIframe } from './util/clevertap'\nimport { compressData } from './util/encoder'\nimport Privacy from './modules/privacy'\nimport NotificationHandler from './modules/notification'\nimport { hasWebInboxSettingsInLS, checkAndRegisterWebInboxElements, initializeWebInbox, getInboxMessages, saveInboxMessages } from './modules/web-inbox/helper'\nimport { Variable } from './modules/variables/variable'\nimport VariableStore from './modules/variables/variableStore'\nimport { checkBuilder, addAntiFlicker } from './modules/visualBuilder/pageBuilder'\nimport { setServerKey } from './modules/webPushPrompt/prompt'\n\nexport default class CleverTap {\n  #logger\n  #api\n  #onloadcalled\n  #device\n  #session\n  #account\n  #request\n  #variableStore\n  #isSpa\n  #previousUrl\n  #boundCheckPageChanged = this.#checkPageChanged.bind(this)\n  #dismissSpamControl\n  enablePersonalization\n\n  get spa () {\n    return this.#isSpa\n  }\n\n  set spa (value) {\n    const isSpa = value === true\n    if (this.#isSpa !== isSpa && this.#onloadcalled === 1) {\n      // if clevertap.spa is changed after init has been called then update the click listeners\n      if (isSpa) {\n        document.addEventListener('click', this.#boundCheckPageChanged)\n      } else {\n        document.removeEventListener('click', this.#boundCheckPageChanged)\n      }\n    }\n    this.#isSpa = isSpa\n  }\n\n  get dismissSpamControl () {\n    return this.#dismissSpamControl\n  }\n\n  set dismissSpamControl (value) {\n    const dismissSpamControl = value === true\n    this.#dismissSpamControl = dismissSpamControl\n    $ct.dismissSpamControl = dismissSpamControl\n  }\n\n  constructor (clevertap = {}) {\n    this.#onloadcalled = 0\n    this._isPersonalisationActive = this._isPersonalisationActive.bind(this)\n    this.raiseNotificationClicked = () => { }\n    this.#logger = new Logger(logLevels.INFO)\n    this.#account = new Account(clevertap.account?.[0], clevertap.region || clevertap.account?.[1], clevertap.targetDomain || clevertap.account?.[2], clevertap.token || clevertap.account?.[3])\n    this.#device = new DeviceManager({ logger: this.#logger })\n    this.#dismissSpamControl = clevertap.dismissSpamControl || false\n    this.shpfyProxyPath = clevertap.shpfyProxyPath || ''\n    this.#session = new SessionManager({\n      logger: this.#logger,\n      isPersonalisationActive: this._isPersonalisationActive\n    })\n    this.#request = new ReqestManager({\n      logger: this.#logger,\n      account: this.#account,\n      device: this.#device,\n      session: this.#session,\n      isPersonalisationActive: this._isPersonalisationActive\n    })\n    this.enablePersonalization = clevertap.enablePersonalization || false\n    this.event = new EventHandler({\n      logger: this.#logger,\n      request: this.#request,\n      isPersonalisationActive: this._isPersonalisationActive\n    }, clevertap.event)\n\n    this.profile = new ProfileHandler({\n      logger: this.#logger,\n      request: this.#request,\n      account: this.#account,\n      isPersonalisationActive: this._isPersonalisationActive\n    }, clevertap.profile)\n\n    this.onUserLogin = new UserLoginHandler({\n      request: this.#request,\n      account: this.#account,\n      session: this.#session,\n      logger: this.#logger,\n      device: this.#device\n    }, clevertap.onUserLogin)\n\n    this.privacy = new Privacy({\n      request: this.#request,\n      account: this.#account,\n      logger: this.#logger\n    }, clevertap.privacy)\n\n    this.notifications = new NotificationHandler({\n      logger: this.#logger,\n      request: this.#request,\n      account: this.#account\n    }, clevertap.notifications)\n\n    this.#variableStore = new VariableStore({\n      logger: this.#logger,\n      request: this.#request,\n      account: this.#account,\n      event: this.event\n    })\n\n    this.#api = new CleverTapAPI({\n      logger: this.#logger,\n      request: this.#request,\n      device: this.#device,\n      session: this.#session\n    })\n\n    this.spa = clevertap.spa\n    this.dismissSpamControl = clevertap.dismissSpamControl\n\n    this.user = new User({\n      isPersonalisationActive: this._isPersonalisationActive\n    })\n\n    this.session = {\n      getTimeElapsed: () => {\n        return this.#session.getTimeElapsed()\n      },\n      getPageCount: () => {\n        return this.#session.getPageCount()\n      }\n    }\n\n    this.logout = () => {\n      this.#logger.debug('logout called')\n      StorageManager.setInstantDeleteFlagInK()\n    }\n\n    this.clear = () => {\n      this.onUserLogin.clear()\n    }\n\n    this.getCleverTapID = () => {\n      return this.#device.getGuid()\n    }\n\n    this.getAccountID = () => {\n      return this.#account.id\n    }\n\n    this.getSCDomain = () => {\n      return this.#account.finalTargetDomain\n    }\n\n    this.setLibrary = (libName, libVersion) => {\n      $ct.flutterVersion = { [libName]: libVersion }\n    }\n\n    // Set the Signed Call sdk version and fire request\n    this.setSCSDKVersion = (ver) => {\n      this.#account.scSDKVersion = ver\n      const data = {}\n      data.af = { scv: 'sc-sdk-v' + this.#account.scSDKVersion }\n      let pageLoadUrl = this.#account.dataPostURL\n      pageLoadUrl = addToURL(pageLoadUrl, 'type', 'page')\n      pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n      this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n    }\n\n    if (hasWebInboxSettingsInLS()) {\n      checkAndRegisterWebInboxElements()\n      initializeWebInbox(this.#logger)\n    }\n\n    // Get Inbox Message Count\n    this.getInboxMessageCount = () => {\n      const msgCount = getInboxMessages()\n      return Object.keys(msgCount).length\n    }\n\n    // Get Inbox Unread Message Count\n    this.getInboxMessageUnreadCount = () => {\n      if ($ct.inbox) {\n        return $ct.inbox.unviewedCounter\n      } else {\n        this.#logger.debug('No unread messages')\n      }\n    }\n\n    // Get All Inbox messages\n    this.getAllInboxMessages = () => {\n      return getInboxMessages()\n    }\n\n    // Get only Unread messages\n    this.getUnreadInboxMessages = () => {\n      if ($ct.inbox) {\n        return $ct.inbox.unviewedMessages\n      } else {\n        this.#logger.debug('No unread messages')\n      }\n    }\n\n    // Get message object belonging to the given message id only. Message id should be a String\n    this.getInboxMessageForId = (messageId) => {\n      const messages = getInboxMessages()\n      if ((messageId !== null || messageId !== '') && messages.hasOwnProperty(messageId)) {\n        return messages[messageId]\n      } else {\n        this.#logger.error('No message available for message Id ' + messageId)\n      }\n    }\n\n    // Delete message from the Inbox. Message id should be a String\n    // If the message to be deleted is unviewed then decrement the badge count, delete the message from unviewedMessages list\n    // Then remove the message from local storage and update cookie\n    this.deleteInboxMessage = (messageId) => {\n      const messages = getInboxMessages()\n      if ((messageId !== null || messageId !== '') && messages.hasOwnProperty(messageId)) {\n        const el = document.querySelector('ct-web-inbox').shadowRoot.getElementById(messageId)\n        if (messages[messageId].viewed === 0) {\n          $ct.inbox.unviewedCounter--\n          delete $ct.inbox.unviewedMessages[messageId]\n          document.getElementById('unviewedBadge').innerText = $ct.inbox.unviewedCounter\n          document.getElementById('unviewedBadge').style.display = $ct.inbox.unviewedCounter > 0 ? 'flex' : 'none'\n        }\n        el && el.remove()\n        delete messages[messageId]\n        saveInboxMessages(messages)\n      } else {\n        this.#logger.error('No message available for message Id ' + messageId)\n      }\n    }\n\n    /* Mark Message as Read. Message id should be a String\n     - Check if the message Id exist in the unread message list\n     - Remove the unread marker, update the viewed flag, decrement the bage Count\n     - renderNotificationViewed */\n    this.markReadInboxMessage = (messageId) => {\n      const unreadMsg = $ct.inbox.unviewedMessages\n      const messages = getInboxMessages()\n      if ((messageId !== null || messageId !== '') && unreadMsg.hasOwnProperty(messageId)) {\n        const el = document.querySelector('ct-web-inbox').shadowRoot.getElementById(messageId)\n        if (el !== null) { el.shadowRoot.getElementById('unreadMarker').style.display = 'none' }\n        messages[messageId].viewed = 1\n        if (document.getElementById('unviewedBadge')) {\n          var counter = parseInt(document.getElementById('unviewedBadge').innerText) - 1\n          document.getElementById('unviewedBadge').innerText = counter\n          document.getElementById('unviewedBadge').style.display = counter > 0 ? 'flex' : 'none'\n        }\n        window.clevertap.renderNotificationViewed({ msgId: messages[messageId].wzrk_id, pivotId: messages[messageId].pivotId })\n        $ct.inbox.unviewedCounter--\n        delete $ct.inbox.unviewedMessages[messageId]\n        saveInboxMessages(messages)\n      } else {\n        this.#logger.error('No message available for message Id ' + messageId)\n      }\n    }\n\n    /* Mark Message as Read. messageIds should be a an array of string */\n    this.markReadInboxMessagesForIds = (messageIds) => {\n      if (Array.isArray(messageIds)) {\n        for (var id = 0; id < messageIds.length; id++) {\n          this.markReadInboxMessage(messageIds[id])\n        }\n      }\n    }\n\n    /* Mark all messages as read\n      - Get the count of unread messages, update unread marker style\n      - renderNotificationViewed, update the badge count and style\n    */\n    this.markReadAllInboxMessage = () => {\n      const unreadMsg = $ct.inbox.unviewedMessages\n      const messages = getInboxMessages()\n      if (Object.keys(unreadMsg).length > 0) {\n        const msgIds = Object.keys(unreadMsg)\n        msgIds.forEach(key => {\n          const el = document.querySelector('ct-web-inbox').shadowRoot.getElementById(key)\n          if (el !== null) { el.shadowRoot.getElementById('unreadMarker').style.display = 'none' }\n          messages[key].viewed = 1\n          window.clevertap.renderNotificationViewed({ msgId: messages[key].wzrk_id, pivotId: messages[key].wzrk_pivot })\n        })\n        document.getElementById('unviewedBadge').innerText = 0\n        document.getElementById('unviewedBadge').style.display = 'none'\n        saveInboxMessages(messages)\n        $ct.inbox.unviewedCounter = 0\n        $ct.inbox.unviewedMessages = {}\n      } else {\n        this.#logger.debug('All messages are already read')\n      }\n    }\n\n    this.toggleInbox = (e) => $ct.inbox?.toggleInbox(e)\n\n    // method for notification viewed\n    this.renderNotificationViewed = (detail) => {\n      processNotificationEvent(NOTIFICATION_VIEWED, detail)\n    }\n\n    // method for notification clicked\n    this.renderNotificationClicked = (detail) => {\n      processNotificationEvent(NOTIFICATION_CLICKED, detail)\n    }\n\n    const processNotificationEvent = (eventName, eventDetail) => {\n      if (!eventDetail || !eventDetail.msgId) { return }\n      const data = {}\n      data.type = 'event'\n      data.evtName = eventName\n      data.evtData = { [WZRK_ID]: eventDetail.msgId }\n\n      if (eventDetail.pivotId) {\n        data.evtData = { ...data.evtData, wzrk_pivot: eventDetail.pivotId }\n      }\n\n      if (eventDetail.wzrk_slideNo) {\n        data.evtData = { ...data.evtData, wzrk_slideNo: eventDetail.wzrk_slideNo }\n      }\n\n      // Adding kv pair to event data\n      if (eventDetail.kv && eventDetail.kv !== null && eventDetail.kv !== undefined) {\n        for (const key in eventDetail.kv) {\n          if (key.startsWith(WZRK_PREFIX)) {\n            data.evtData = { ...data.evtData, [key]: eventDetail.kv[key] }\n          }\n        }\n      }\n\n      // Adding msgCTkv to event data\n      if (eventDetail.msgCTkv && eventDetail.msgCTkv !== null && eventDetail.msgCTkv !== undefined) {\n        for (const key in eventDetail.msgCTkv) {\n          if (key.startsWith(WZRK_PREFIX)) {\n            data.evtData = { ...data.evtData, [key]: eventDetail.msgCTkv[key] }\n          }\n        }\n      }\n      this.#request.processEvent(data)\n    }\n\n    this.setLogLevel = (l) => {\n      this.#logger.logLevel = Number(l)\n      if (l === 3) {\n        sessionStorage.WZRK_D = ''\n      } else {\n        delete sessionStorage.WZRK_D\n      }\n    }\n    /**\n * @param {} key\n * @param {*} value\n */\n    this.handleIncrementValue = (key, value) => {\n      this.profile._handleIncrementDecrementValue(key, value, COMMAND_INCREMENT)\n    }\n\n    this.handleDecrementValue = (key, value) => {\n      this.profile._handleIncrementDecrementValue(key, value, COMMAND_DECREMENT)\n    }\n\n    this.setMultiValuesForKey = (key, value) => {\n      if (Array.isArray(value)) {\n        this.profile._handleMultiValueSet(key, value, COMMAND_SET)\n      } else {\n        console.error('setMultiValuesForKey should be called with a value of type array')\n      }\n    }\n\n    this.addMultiValueForKey = (key, value) => {\n      if (typeof value === 'string' || typeof value === 'number') {\n        this.profile._handleMultiValueAdd(key, value, COMMAND_ADD)\n      } else {\n        console.error('addMultiValueForKey should be called with a value of type string or number.')\n      }\n    }\n\n    this.addMultiValuesForKey = (key, value) => {\n      if (Array.isArray(value)) {\n        this.profile._handleMultiValueAdd(key, value, COMMAND_ADD)\n      } else {\n        console.error('addMultiValuesForKey should be called with a value of type array.')\n      }\n    }\n\n    this.removeMultiValueForKey = (key, value) => {\n      if (typeof value === 'string' || typeof value === 'number') {\n        this.profile._handleMultiValueRemove(key, value, COMMAND_REMOVE)\n      } else {\n        console.error('removeMultiValueForKey should be called with a value of type string or number.')\n      }\n    }\n\n    this.removeMultiValuesForKey = (key, value) => {\n      if (Array.isArray(value)) {\n        this.profile._handleMultiValueRemove(key, value, COMMAND_REMOVE)\n      } else {\n        console.error('removeMultiValuesForKey should be called with a value of type array.')\n      }\n    }\n\n    this.removeValueForKey = (key) => {\n      this.profile._handleMultiValueDelete(key, COMMAND_DELETE)\n    }\n\n    const _handleEmailSubscription = (subscription, reEncoded, fetchGroups) => {\n      handleEmailSubscription(subscription, reEncoded, fetchGroups, this.#account, this.#logger)\n    }\n\n    /**\n     *\n     * @param {number} lat\n     * @param {number} lng\n     * @param {callback function} handleCoordinates\n     * @returns\n    */\n    this.getLocation = function (lat, lng) {\n      // latitude and longitude should be number type\n      if ((lat && typeof lat !== 'number') || (lng && typeof lng !== 'number')) {\n        console.log('Latitude and Longitude must be of number type')\n        return\n      }\n      if (lat && lng) {\n        // valid latitude ranges bw +-90\n        if (lat <= -90 || lat > 90) {\n          console.log('A vaid latitude must range between -90 and 90')\n          return\n        }\n        // valid longitude ranges bw +-180\n        if (lng <= -180 || lng > 180) {\n          console.log('A valid longitude must range between -180 and 180')\n          return\n        }\n        $ct.location = { Latitude: lat, Longitude: lng }\n        this.#sendLocationData({ Latitude: lat, Longitude: lng })\n      } else {\n        if (navigator.geolocation) {\n          navigator.geolocation.getCurrentPosition(showPosition.bind(this), showError)\n        } else {\n          console.log('Geolocation is not supported by this browser.')\n        }\n      }\n    }\n\n    function showPosition (position) {\n      var lat = position.coords.latitude\n      var lng = position.coords.longitude\n      $ct.location = { Latitude: lat, Longitude: lng }\n      this.#sendLocationData({ Latitude: lat, Longitude: lng })\n    }\n\n    function showError (error) {\n      switch (error.code) {\n        case error.PERMISSION_DENIED:\n          console.log('User denied the request for Geolocation.')\n          break\n        case error.POSITION_UNAVAILABLE:\n          console.log('Location information is unavailable.')\n          break\n        case error.TIMEOUT:\n          console.log('The request to get user location timed out.')\n          break\n        case error.UNKNOWN_ERROR:\n          console.log('An unknown error occurred.')\n          break\n      }\n    }\n\n    const api = this.#api\n    api.logout = this.logout\n    api.clear = this.clear\n    api.closeIframe = (campaignId, divIdIgnored) => {\n      closeIframe(campaignId, divIdIgnored, this.#session.sessionId)\n    }\n    api.enableWebPush = (enabled, applicationServerKey) => {\n      setServerKey(applicationServerKey)\n      this.notifications._enableWebPush(enabled, applicationServerKey)\n    }\n    api.tr = (msg) => {\n      _tr(msg, {\n        device: this.#device,\n        session: this.#session,\n        request: this.#request,\n        logger: this.#logger\n      })\n    }\n    api.setEnum = (enumVal) => {\n      setEnum(enumVal, this.#logger)\n    }\n    api.is_onloadcalled = () => {\n      return (this.#onloadcalled === 1)\n    }\n    api.subEmail = (reEncoded) => {\n      _handleEmailSubscription('1', reEncoded)\n    }\n    api.getEmail = (reEncoded, withGroups) => {\n      _handleEmailSubscription('-1', reEncoded, withGroups)\n    }\n    api.unSubEmail = (reEncoded) => {\n      _handleEmailSubscription('0', reEncoded)\n    }\n    api.unsubEmailGroups = (reEncoded) => {\n      $ct.unsubGroups = []\n      const elements = document.getElementsByClassName('ct-unsub-group-input-item')\n\n      for (let i = 0; i < elements.length; i++) {\n        const element = elements[i]\n        if (element.name) {\n          const data = { name: element.name, isUnsubscribed: element.checked }\n          $ct.unsubGroups.push(data)\n        }\n      }\n\n      _handleEmailSubscription(GROUP_SUBSCRIPTION_REQUEST_ID, reEncoded)\n    }\n    api.setSubscriptionGroups = (value) => {\n      $ct.unsubGroups = value\n    }\n    api.getSubscriptionGroups = () => {\n      return $ct.unsubGroups\n    }\n    api.changeSubscriptionGroups = (reEncoded, updatedGroups) => {\n      api.setSubscriptionGroups(updatedGroups)\n      _handleEmailSubscription(GROUP_SUBSCRIPTION_REQUEST_ID, reEncoded)\n    }\n    api.isGlobalUnsubscribe = () => {\n      return $ct.globalUnsubscribe\n    }\n    api.setIsGlobalUnsubscribe = (value) => {\n      $ct.globalUnsubscribe = value\n    }\n    api.setUpdatedCategoryLong = (profile) => {\n      if (profile[categoryLongKey]) {\n        $ct.updatedCategoryLong = profile[categoryLongKey]\n      }\n    }\n    window.$CLTP_WR = window.$WZRK_WR = api\n\n    if (clevertap.account?.[0].id) {\n      // The accountId is present so can init with empty values.\n      // Needed to maintain backward compatability with legacy implementations.\n      // Npm imports/require will need to call init explictly with accountId\n      this.init()\n    }\n  }\n\n  // starts here\n  init (accountId, region, targetDomain, token, antiFlicker = {}) {\n    if (Object.keys(antiFlicker).length > 0) {\n      addAntiFlicker(antiFlicker)\n    }\n    if (this.#onloadcalled === 1) {\n      // already initailsed\n      return\n    }\n    checkBuilder(this.#logger, accountId)\n    StorageManager.removeCookie('WZRK_P', window.location.hostname)\n    if (!this.#account.id) {\n      if (!accountId) {\n        this.#logger.error(EMBED_ERROR)\n        return\n      }\n      this.#account.id = accountId\n    }\n    this.#session.cookieName = SCOOKIE_PREFIX + '_' + this.#account.id\n\n    if (region) {\n      this.#account.region = region\n    }\n    if (targetDomain) {\n      this.#account.targetDomain = targetDomain\n    }\n    if (token) {\n      this.#account.token = token\n    }\n\n    const currLocation = location.href\n    const urlParams = getURLParams(currLocation.toLowerCase())\n\n    // eslint-disable-next-line eqeqeq\n    if (typeof urlParams.e !== 'undefined' && urlParams.wzrk_ex == '0') {\n      return\n    }\n\n    $ct.isPrivacyArrPushed = true\n    if ($ct.privacyArray.length > 0) {\n      this.privacy.push($ct.privacyArray)\n    }\n\n    this.#processOldValues()\n    this.pageChanged()\n    const backupInterval = setInterval(() => {\n      if (this.#device.gcookie) {\n        clearInterval(backupInterval)\n        this.#request.processBackupEvents()\n      }\n    }, 3000)\n    if (this.#isSpa) {\n      // listen to click on the document and check if URL has changed.\n      document.addEventListener('click', this.#boundCheckPageChanged)\n    } else {\n      // remove existing click listeners if any\n      document.removeEventListener('click', this.#boundCheckPageChanged)\n    }\n    this.#onloadcalled = 1\n  }\n\n  // process the option array provided to the clevertap object\n  // after its been initialized\n  #processOldValues () {\n    this.onUserLogin._processOldValues()\n    this.privacy._processOldValues()\n    this.event._processOldValues()\n    this.profile._processOldValues()\n    this.notifications._processOldValues()\n  }\n\n  #debounce (func, delay = 300) {\n    let timeout\n    return function () {\n      clearTimeout(timeout)\n      timeout = setTimeout(func, delay)\n    }\n  }\n\n  #checkPageChanged () {\n    const debouncedPageChanged = this.#debounce(() => {\n      if (this.#previousUrl !== location.href) {\n        this.pageChanged()\n      }\n    })\n    debouncedPageChanged()\n  }\n\n  pageChanged () {\n    const currLocation = window.location.href\n    const urlParams = getURLParams(currLocation.toLowerCase())\n    // -- update page count\n    const obj = this.#session.getSessionCookieObject()\n    let pgCount = (typeof obj.p === 'undefined') ? 0 : obj.p\n    obj.p = ++pgCount\n    this.#session.setSessionCookieObject(obj)\n    // -- update page count\n\n    let data = {}\n    let referrerDomain = getDomain(document.referrer)\n\n    if (window.location.hostname !== referrerDomain) {\n      const maxLen = 120\n      if (referrerDomain !== '') {\n        referrerDomain = referrerDomain.length > maxLen ? referrerDomain.substring(0, maxLen) : referrerDomain\n        data.referrer = referrerDomain\n      }\n\n      let utmSource = urlParams.utm_source || urlParams.wzrk_source\n      if (typeof utmSource !== 'undefined') {\n        utmSource = utmSource.length > maxLen ? utmSource.substring(0, maxLen) : utmSource\n        data.us = utmSource // utm_source\n      }\n\n      let utmMedium = urlParams.utm_medium || urlParams.wzrk_medium\n      if (typeof utmMedium !== 'undefined') {\n        utmMedium = utmMedium.length > maxLen ? utmMedium.substring(0, maxLen) : utmMedium\n        data.um = utmMedium // utm_medium\n      }\n\n      let utmCampaign = urlParams.utm_campaign || urlParams.wzrk_campaign\n      if (typeof utmCampaign !== 'undefined') {\n        utmCampaign = utmCampaign.length > maxLen ? utmCampaign.substring(0, maxLen) : utmCampaign\n        data.uc = utmCampaign // utm_campaign\n      }\n\n      // also independently send wzrk_medium to the backend\n      if (typeof urlParams.wzrk_medium !== 'undefined') {\n        const wm = urlParams.wzrk_medium\n        if (wm.match(/^email$|^social$|^search$/)) {\n          data.wm = wm // wzrk_medium\n        }\n      }\n    }\n\n    data = this.#request.addSystemDataToObject(data, undefined)\n    data.cpg = currLocation\n\n    data[CAMP_COOKIE_NAME] = getCampaignObjForLc()\n    let pageLoadUrl = this.#account.dataPostURL\n    this.#request.addFlags(data)\n    // send dsync flag when page = 1\n    if (parseInt(data.pg) === 1) {\n      this.#overrideDSyncFlag(data)\n    }\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', 'page')\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n\n    this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n\n    if (parseInt(data.pg) === 1) {\n      this.event.push(WZRK_FETCH, { t: 4 })\n    }\n\n    this.#previousUrl = currLocation\n    setTimeout(() => {\n      if (pgCount <= 3) {\n        // send ping for up to 3 pages\n        this.#pingRequest()\n      }\n\n      if (this.#isPingContinuous()) {\n        setInterval(() => {\n          this.#pingRequest()\n        }, CONTINUOUS_PING_FREQ_IN_MILLIS)\n      }\n    }, FIRST_PING_FREQ_IN_MILLIS)\n  }\n\n  #pingRequest () {\n    let pageLoadUrl = this.#account.dataPostURL\n    let data = {}\n    data = this.#request.addSystemDataToObject(data, undefined)\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PING)\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressData(JSON.stringify(data), this.#logger))\n\n    this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n  }\n\n  #isPingContinuous () {\n    return (typeof window.wzrk_d !== 'undefined' && window.wzrk_d.ping === 'continuous')\n  }\n\n  _isPersonalisationActive () {\n    return StorageManager._isLocalStorageSupported() && this.enablePersonalization\n  }\n\n  #overrideDSyncFlag (data) {\n    if (this._isPersonalisationActive()) {\n      data.dsync = true\n    }\n  }\n\n  popupCallbacks = {};\n  popupCurrentWzrkId = '';\n\n  // eslint-disable-next-line accessor-pairs\n  set popupCallback (callback) {\n    this.popupCallbacks[this.popupCurrentWzrkId] = callback\n  }\n\n  /**\n   *\n   * @param {object} payload\n   */\n  #sendLocationData (payload) {\n    // Send the updated value to LC\n    let data = {}\n    data.af = {}\n    const profileObj = {}\n    data.type = 'profile'\n    if (profileObj.tz == null) {\n      profileObj.tz = new Date().toString().match(/([A-Z]+[\\+-][0-9]+)/)[1]\n    }\n    data.profile = profileObj\n    if (payload) {\n      const keys = Object.keys(payload)\n      keys.forEach(key => {\n        data.af[key] = payload[key]\n      })\n    }\n    if ($ct.location) {\n      data.af = { ...data.af, ...$ct.location }\n    }\n    data = this.#request.addSystemDataToObject(data, true)\n    this.#request.addFlags(data)\n    const compressedData = compressData(JSON.stringify(data), this.#logger)\n    let pageLoadUrl = this.#account.dataPostURL\n    pageLoadUrl = addToURL(pageLoadUrl, 'type', EVT_PUSH)\n    pageLoadUrl = addToURL(pageLoadUrl, 'd', compressedData)\n\n    this.#request.saveAndFireRequest(pageLoadUrl, $ct.blockRequest)\n  }\n\n  // offline mode\n  /**\n   * events will be recorded and queued locally when passed with true\n   * but will not be sent to the server until offline is disabled by passing false\n   * @param {boolean} arg\n   */\n\n  setOffline (arg) {\n    if (typeof arg !== 'boolean') {\n      console.error('setOffline should be called with a value of type boolean')\n      return\n    }\n    $ct.offline = arg\n    // if offline is disabled\n    // process events from cache\n    if (!arg) {\n      this.#request.processBackupEvents()\n    }\n  }\n\n  getSDKVersion () {\n    return 'web-sdk-v$$PACKAGE_VERSION$$'\n  }\n\n  defineVariable (name, defaultValue) {\n    return Variable.define(name, defaultValue, this.#variableStore)\n  }\n\n  // enableWebPushNotifications () {\n  //   enablePush(this.#logger, this.#account, this.#request)\n  // }\n\n  syncVariables (onSyncSuccess, onSyncFailure) {\n    if (this.#logger.logLevel === 4) {\n      return this.#variableStore.syncVariables(onSyncSuccess, onSyncFailure)\n    } else {\n      const m = 'App log level is not set to 4'\n      this.#logger.error(m)\n      return Promise.reject(new Error(m))\n    }\n  }\n\n  fetchVariables (onFetchCallback) {\n    this.#variableStore.fetchVariables(onFetchCallback)\n  }\n\n  addVariablesChangedCallback (callback) {\n    this.#variableStore.addVariablesChangedCallback(callback)\n  }\n\n  addOneTimeVariablesChangedCallback (callback) {\n    this.#variableStore.addOneTimeVariablesChangedCallback(callback)\n  }\n}\n","import Clevertap from './clevertap'\n\nconst clevertap = new Clevertap(window.clevertap)\n\nwindow.clevertap = window.wizrocket = clevertap\n\nexport default clevertap\n"],"names":["TARGET_DOMAIN","TARGET_PROTOCOL","DEFAULT_REGION","Account","constructor","id","region","targetDomain","token","accountId","dcSDKVersion","finalTargetDomain","dataPostPEURL","dataPostURL","recorderURL","emailURL","unsupportedKeyCharRegex","RegExp","unsupportedValueCharRegex","singleQuoteRegex","CLEAR","CHARGED_ID","CHARGEDID_COOKIE_NAME","GCOOKIE_NAME","KCOOKIE_NAME","CAMP_COOKIE_NAME","CAMP_COOKIE_G","SCOOKIE_PREFIX","SCOOKIE_EXP_TIME_IN_SECS","EV_COOKIE","META_COOKIE","PR_COOKIE","ARP_COOKIE","LCOOKIE_NAME","GLOBAL","DISPLAY","WEBPUSH_LS_KEY","OPTOUT_KEY","CT_OPTOUT_KEY","OPTOUT_COOKIE_ENDSWITH","USEIP_KEY","LRU_CACHE","LRU_CACHE_SIZE","IS_OUL","EVT_PUSH","EVT_PING","COOKIE_EXPIRY","MAX_TRIES","FIRST_PING_FREQ_IN_MILLIS","CONTINUOUS_PING_FREQ_IN_MILLIS","GROUP_SUBSCRIPTION_REQUEST_ID","categoryLongKey","WZRK_PREFIX","WZRK_ID","NOTIFICATION_VIEWED","NOTIFICATION_CLICKED","FIRE_PUSH_UNREGISTERED","PUSH_SUBSCRIPTION_DATA","COMMAND_INCREMENT","COMMAND_DECREMENT","COMMAND_SET","COMMAND_ADD","COMMAND_REMOVE","COMMAND_DELETE","WEBINBOX_CONFIG","WEBINBOX","MAX_INBOX_MSG","VARIABLES","PUSH_DELAY_MS","MAX_DELAY_FREQUENCY","WZRK_FETCH","WEBPUSH_CONFIG","SYSTEM_EVENTS","isString","input","String","isObject","Object","prototype","toString","call","isDateObject","Date","isObjectEmpty","obj","prop","hasOwnProperty","isConvertibleToNumber","n","isNaN","parseFloat","isFinite","isNumber","test","isValueValid","value","undefined","removeUnsupportedChars","o","logger","key","sanitizedVal","sanitizedKey","sanitize","length","substring","reportError","val","regex","replace","getToday","today","getFullYear","getMonth","getDay","getNow","Math","floor","getTime","convertToWZRKDate","dateObj","round","setDate","dt","isDateValid","date","matches","exec","d","m","y","composedDate","getDate","StorageManager","save","_isLocalStorageSupported","localStorage","setItem","JSON","stringify","read","data","getItem","parse","e","remove","removeItem","removeCookie","name","domain","cookieStr","document","cookie","createCookie","seconds","expires","domainStr","setTime","toGMTString","encodeURIComponent","readCookie","nameEQ","ca","split","idx","c","charAt","indexOf","decodeURIComponent","window","saveToLSorCookie","property","location","hostname","$ct","globalCache","readFromLSorCookie","trim","err","createBroadCookie","broadDomain","domainParts","testBroadDomain","testCookieName","tempCookie","getMetaProp","metaObj","setMetaProp","wzrkMetaObj","getAndClearMetaProp","setInstantDeleteFlagInK","k","flag","backupEvent","reqNo","backupArr","q","debug","removeBackup","respNo","backupMap","gcookie","REQ_N","RESP_N","globalProfileMap","globalEventsMap","blockRequest","isOptInRequest","webPushEnabled","campaignDivMap","currentSessionId","wiz_counter","notifApi","notifEnabledFromApi","unsubGroups","updatedCategoryLong","inbox","isPrivacyArrPushed","privacyArray","offline","dismissSpamControl","globalUnsubscribe","flutterVersion","variableStore","pushConfig","LRUCache","max","lruCache","tempLruCache","cache","entry","push","get","item","saveCacheToLS","set","allKeys","objToArray","index","temp","getKey","getSecondLastKey","keysArr","getLastKey","keysLength","newCache","indexToDelete","splice","CleverTapAPI","request","device","session","s","global","resume","respNumber","optOutResponse","oulReq","newGuid","isOULInProgress","oulReqN","sessionObj","getSessionCookieObject","kIdFromLS","guidFromLRUCache","lastK","lastGUID","unregisterTokenForGuid","manageSession","t","setSessionCookieObject","processingBackup","processBackupEvents","DeviceManager","getGuid","guid","error","DATA_NOT_SENT_TEXT","CLEVERTAP_ERROR_PREFIX","EMBED_ERROR","EVENT_ERROR","GENDER_ERROR","EMPLOYED_ERROR","MARRIED_ERROR","EDUCATION_ERROR","AGE_ERROR","DOB_ERROR","ENUM_FORMAT_ERROR","PHONE_FORMAT_ERROR","_globalChargedId","isEventStructureFlat","eventObj","Array","isArray","isChargedEventStructureValid","chargedObj","itemKey","chargedId","EventHandler","values","isPersonalisationActive","eventsArr","_processOldValues","getDetails","evtName","evtObj","respObj","firstTime","lastTime","count","eventName","shift","includes","type","unshift","evtData","processEvent","getURLParams","url","urlParams","uri","match","pl","search","decode","replacement","getDomain","a","createElement","href","addToURL","v","getHostName","urlBase64ToUint8Array","base64String","padding","repeat","base64","rawData","atob","processedData","i","charCodeAt","Uint8Array","compressData","dataObject","compressToBase64","compress","uncompressed","context_dictionary","context_dictionaryToCreate","context_c","context_wc","context_w","context_enlargeIn","context_dictSize","context_numBits","context_data_string","context_data_val","context_data_position","ii","f","fromCharCode","pow","getKeyStr","_keyStr","output","chr1","chr2","chr3","enc1","enc2","enc3","enc4","NaN","RequestDispatcher","networkRetryCount","minDelayFrequency","fireRequest","skipARP","sendOULFlag","getDelayFrequency","account","randomDelay","random","skipResARP","_arp","pageLoadUrl","useIP","slice","tries","setTimeout","clevertap","wizrocket","plugin","ctCbScripts","getElementsByClassName","parentNode","removeChild","setAttribute","async","getElementsByTagName","appendChild","getCampaignObject","finalcampObj","campObj","wp","saveCampaignObject","campaignObj","newObj","setCampaignObjectForGuid","guidCampObj","finalCampObj","keys","forEach","campKeyObj","globalObj","dailyObj","campaignIdArray","resultObj","dailyC","totalC","campaignId","console","getCampaignObjForLc","storageValue","decodedValue","parsedValue","resultObjWP","resultObjWI","wi","todayCwp","todayCwi","tc","wmp","wimp","tlc","witlc","isProfileValid","profileObj","valid","profileKey","profileVal","Age","Phone","processFBUserObj","user","profileData","Name","FBID","gender","Gender","getHighestEducation","eduArr","college","highschool","edu","relationship_status","Married","education","Education","work","Employed","email","Email","birthday","mmddyy","DOB","processGPlusUserObj","displayName","GPID","image","isDefault","Photo","emails","emailIdx","emailObj","organizations","orgObj","yyyymmdd","relationshipStatus","addToLocalProfileMap","override","_custom","closeIframe","divIdIgnored","sessionCampaignObj","divId","getElementById","style","display","arp","jsonMap","isOULARP","arpFromStorage","setEnum","enumVal","handleEmailSubscription","subscription","reEncoded","fetchGroups","urlParamsAsIs","encodedEmailId","encodedProfileProps","p","pageType","page_type","ProfileHandler","profilesArr","getAttribute","propName","_handleIncrementDecrementValue","command","tz","profile","addSystemDataToObject","addFlags","compressedData","saveAndFireRequest","_handleMultiValueSet","arrayVal","array","toLowerCase","sendMultiValueData","_handleMultiValueAdd","propKey","propVal","existingValue","addValue","normalizedValue","_handleMultiValueRemove","removeValue","_handleMultiValueDelete","profileArr","outerObj","Site","Facebook","FbProfileObj","GPlusProfileObj","UserLoginHandler","clear","addToK","ids","g","kId","anonymousUser","foundInCache","gFromCache","Identity","cookieName","loginArr","pop","processProfile","CTWebPersonalisationBanner","HTMLElement","_details","shadow","attachShadow","mode","details","renderBanner","innerHTML","getBannerContent","trackClick","addEventListener","onClickUrl","onClick","open","parent","renderNotificationClicked","msgId","pivotId","renderNotificationViewed","divHeight","css","desktopImageURL","mobileImageURL","html","CTWebPersonalisationCarousel","_target","_carousel","slides","previouslySelectedItem","selectedItem","autoSlide","stopAutoSlideTimeout","customElements","define","target","renderCarousel","getStyles","carousel","getCarouselContent","showNavBtns","insertAdjacentHTML","navBtnsHtml","showNavArrows","leftNavArrowHtml","rightNavArrowHtml","setupClick","updateSelectedItem","startAutoSlide","setupOnHover","wzrk_id","wzrk_pivot","event","eventID","startsWith","selected","endsWith","goToNext","goToPrev","wzrk_slideNo","clearInterval","clearTimeout","detail","banner","classList","add","navBtnsCss","navArrowsCss","prevItem","prevButton","button","setInterval","sliderTime","goTo","prev","cur","CTWebPopupImageOnly","_session","popup","container","resizeObserver","renderImageOnlyPopup","sessionId","getImageOnlyPopupContent","shadowRoot","closeIcon","updateImageAndContainerWidth","ResizeObserver","handleResize","observe","unobserve","width","getRenderedImageWidth","setProperty","msgContent","visibility","img","ratio","naturalWidth","naturalHeight","height","Message","config","message","wrapper","snackBar","renderMessage","createEl","part","_el","msg","templateType","prepareBasicMessage","timeStamp","determineTimeStampText","viewed","unreadMarker","imageUrl","imageContainer","addImage","iconTitleDescWrapper","iconUrl","iconContainer","titleDescWrapper","title","innerText","description","buttons","buttonsContainer","addButtons","hasCopyAction","b","text","cssText","action","addSnackbar","greenTickSvg","clipboardMsg","raiseClickedEvent","path","isPreview","raiseClickedForBasicTemplates","payload","tagName","kv","wzrk_c2a","openUrlInNewTab","focus","navigator","clipboard","writeText","clipboardText","log","messageStyles","backgroundColor","borderColor","titleColor","descriptionColor","buttonColor","buttonTextColor","unreadMarkerColor","inboxContainerStyles","panelBackgroundColor","panelBorderColor","headerBackgroundColor","headerTitleColor","closeIconColor","categoriesTabColor","categoriesTitleColor","categoriesBorderColor","selectedCategoryTabColor","selectedCategoryTitleColor","selectedCategoryBorderColor","headerCategoryHeight","Inbox","isInboxOpen","isInboxFromFlutter","selectedCategory","unviewedMessages","unviewedCounter","inboxConfigForPreview","inboxSelector","emptyInboxMsg","inboxCard","unviewedBadge","observer","selectedCategoryRef","addClickListenerOnDocument","composedPath","toggleInbox","prevCategoryRef","updateActiveCategory","_path","filter","messageEl","contains","setBadgeStyle","msgCount","incomingMessages","msgs","updateInboxMessages","incomingMessagesForPreview","previewMsgs","now","buildUIForMessages","updateUnviewedBadgeCounter","connectedCallback","init","styles","notificationsBadge","addUnviewedBadge","createinbox","removeEventListener","categories","getInboxStyles","addMsgsToInboxFromLS","messages","deleteExpiredAndGetUnexpiredMsgs","msgIds","deleteMsgsFromUI","getInboxMessages","wzrk_ttl","el","sort","reduce","acc","saveInboxMessages","inboxMsgs","incomingMsgs","textColor","body","updateUnviewedBadgePosition","top","right","getBoundingClientRect","left","header","headerTitle","createCategories","options","root","rootMargin","threshold","IntersectionObserver","entries","handleMessageViewed","categoriesContainer","leftArrow","arrowSvg","children","scrollBy","categoriesWrapper","_categories","category","rightArrow","firstCategory","lastCategory","firstCategoryObserver","categoryObserverCb","intersectionRatio","lastCategoryObserver","hide","activeCategory","scrollTop","counter","childNodes","updateTSForRenderedMsgs","maxMsgsInInbox","firstChild","sortedMsgs","map","tags","insertBefore","msgTotalCount","querySelectorAll","ctInboxMsgs","hasMessages","raiseViewedEvent","isIntersecting","updateMessageInLS","rect","zIndex","scrollLeft","scrollWidth","setInboxPosition","windowWidth","outerWidth","customInboxStyles","getComputedStyle","getPropertyValue","bottom","hasPositionDefined","res","getInboxPosition","clientHeight","clientWidth","xPos","yPos","ts","headerHeight","categoriesHeight","tabColor","selectedTab","inboxStyles","cardStyles","cards","msgStyles","processWebInboxSettings","webInboxSetting","_settings","processInboxNotifs","inbox_preview","inbox_notifs","addWebInbox","checkAndRegisterWebInboxElements","getAndMigrateInboxMessages","gudInboxObj","storedInboxObj","initializeWebInbox","Promise","resolve","reject","readyState","onLoaded","inboxHeight","inboxWidth","horizontalScroll","scrollingElement","verticalScroll","innerWidth","windowHeight","innerHeight","selectorRect","selectorX","x","selectorY","selectorLeft","selectorRight","selectorTop","selectorBottom","selectorHeight","selectorWidth","selectorCenter","halfOfInboxHeight","halfOfInboxWidth","inboxOnSide","availableHeight","inboxRight","availableWidth","inboxLeft","diff","hasWebInboxSettingsInLS","OVERLAY_PATH","CSS_PATH","WVE_CLASS","FLICKER_SHOW","FLICKER_HIDE","FLICKER_ID","updateFormData","element","formStyle","underline","curTextDecoration","textDecoration","clickDetails","clickUrl","onclick","newTab","imgURL","src","elementCss","head","checkBuilder","parentWindow","opener","handleMessageEvent","postMessage","originUrl","sdkVersion","isValidUrl","msgOrigin","URL","origin","initialiseCTBuilder","variant","renderVisualBuilder","onContentLoad","contentLoaded","position","overlayPath","loadOverlayScript","then","catch","loadCSS","loadTypeKit","link","rel","script","onload","Overlay","Error","onerror","kitId","scriptTimeout","docElement","documentElement","timeoutId","className","typeKitScript","scriptLoaded","firstScript","scriptReadyState","onreadystatechange","Typekit","load","targetingMsgJson","siteUrl","selectors","elementDisplayed","processElement","selector","outerHTML","json","dispatchJsonData","form","tryFindingElement","intervalId","retryElement","querySelector","inaObj","kvPairsEvent","CustomEvent","dispatchEvent","string","Boolean","_err","addAntiFlicker","antiFlicker","personalizedSelectors","delayTime","retryElements","retryCount","retryInterval","isInViewport","styleContent","styleId","styleElement","textContent","applyAntiFlicker","processSelectors","selectorElements","elements","matchedElements","applyStyles","retryProcessing","observeUrlChange","previousHref","MutationObserver","childList","subtree","getBoxPromptStyles","overlay","color","card","borderRadius","borderEnabled","border","borderWidth","primaryButton","secondaryButton","getBellIconStyles","NotificationHandler","displayArgs","enable","enablePush","setUpWebPushNotifications","subscriptionCallback","serviceWorkerPath","apnsWebPushId","apnsServiceUrl","userAgent","setApplicationServerKey","applicationServerKey","_enableWebPush","enabled","safari","pushNotification","requestPermission","permission","subscriptionData","endpoint","deviceToken","browser","registerToken","info","registrationScope","serviceWorker","register","registration","__wzrk_account_id","scope","rootDirRegex","isServiceWorkerAtRoot","ready","getRegistrations","serviceWorkerRegistration","subscribeObj","userVisibleOnly","pushManager","subscribe","existingBellWrapper","getSubscription","unsubscribe","successful","scriptTag","titleText","bodyText","okButtonText","rejectButtonText","okButtonColor","skipDialog","askAgainTimeInSeconds","okCallback","rejectCallback","httpsPopupPath","httpsIframePath","apnsWebPushServiceUrl","notifObj","isHTTP","protocol","chromeAgent","parseInt","firefoxAgent","safariAgent","Notification","httpsIframe","state","from","wzrkPermissionPopup","wizAlert","confirmButtonText","confirmButtonColor","processWebPushConfig","webPushConfig","_pushConfig","notificationHandler","showBox","boxType","showBellIcon","createNotificationBox","createBellIcon","createElementWithAttributes","tag","attributes","configData","notificationhandler","boxConfig","content","overlayDiv","pnCard","imgElement","icon","promptBellBase64","primaryButtonText","secondaryButtonText","setElementPosition","lastNotifTime","popupFrequency","addEventListeners","bellIconConfig","bellWrapper","bellIcon","bellBase64","gifModal","gifImage","closeModal","hoverText","tooltip","addBellEventListeners","appServerKey","setServerKey","serverKey","removeWrapper","removeBellWrapper","toggleGifModal","displayTooltip","clearTooltip","assign","inset","transform","positions","Center","Top","Bottom","bellRect","midX","midY","_tr","_device","_request","_logger","_wizCounter","doCampHouseKeeping","incrCount","excludeFromFreqCaps","currentCount","totalCount","sessionStorage","campTypeObj","wtarget_type","wmc","wimc","campaignSessionLimit","campaignDailyLimit","campaignTotalLimit","totalDailyLimit","totalSessionLimit","totalInboxSessionLimit","efc","mdc","tdc","campaignSessionCount","totalSessionCount","campaignDailyCount","totalDailyCount","campaignTotalCount","delay","campKey","newCampObj","getCookieParams","scookieObj","setupClickEvent","contentDiv","isLegacy","ctaElement","jsCTAElements","jsFunc","preview","invokeExternalJs","func","setupClickUrl","incrementImpression","renderPersonalisationBanner","divSelector","bannerEl","containerEl","renderPersonalisationCarousel","renderPopUpImageOnly","popupImageOnly","renderFooterNotification","displayObj","layout","showExitIntent","msgDiv","isBanner","viewHeight","viewWidth","legacy","marginBottom","contentHeight","bottomPosition","widthPerct","proto","iFrameStyle","iframe","br","frameborder","marginheight","marginwidth","scrolling","pointerCss","sandbox","bgColor","btnBg","leftTd","btColor","theme","descriptionText","imageTd","onClickStr","closeCampaign","Event","appendScriptForCustomEvent","srcdoc","adjustIFrameHeight","contentDocument","scrollHeight","margin","ua","inDoc","contentWindow","_timer","_callBackCalled","showFooterNotification","notificationCallback","raiseNotificationClicked","raiseNotificationViewed","popupCurrentWzrkId","popupCallbacks","popupCallback","msgCTkv","wzrkPrefixKey","wzrkJson","raisePopupNotificationClicked","notificationData","eventData","wzrkPrefixObj","exitintentObj","targetObj","clientY","opacityDiv","opacity","rgbaColor","ctaText","processNativeDisplayArr","arrInAppNotifs","elementId","addLoadListener","inapp_notifs","targetNotif","onmouseleave","mergeEventMap","newEvtMap","oldEvtObj","newEvtObj","handleInboxNotifications","msgArr","vars","mergeVariables","staleDataUpdate","staledata","campType","evpr","eventsMap","events","profileMap","syncExpiry","expires_in","inapp_stale","inbox_stale","User","getTotalVisits","visitCount","getLastVisit","prevSession","logLevels","DISABLE","ERROR","INFO","DEBUG","DEBUG_PE","Logger","logLevel","wzrkError","debugPE","code","level","WZRK_D","SessionManager","scookieStr","objStr","currentSessionInLS","sessionCount","getTimeElapsed","sessionStart","getPageCount","seqNo","requestTime","RequestManager","fired","ignoreTrim","wzrk_error","pg","af","lib","rc","lastSyncTime","expirySeconds","dsync","givenGUID","post","fetch","method","headers","response","ok","nowTs","evtDetail","Privacy","privacyArr","privacyObj","curr","optOut","shouldUseIP","Variable","defaultValue","hadStarted","valueChangedCallbacks","getValue","getdefaultValue","typeOfDefaultValue","existing","getVariable","varInstance","registerVariable","update","newValue","oldValue","hasVarsRequestCompleted","triggerValueChanged","onValueChanged","addValueChangedCallback","removeValueChangedCallback","clearStartFlag","VariableStore","syncVariables","onSyncSuccess","onSyncFailure","meta","tk","r","status","fetchVariables","onFetchCallback","addVariablesChangedCallback","callback","addOneTimeVariablesChangedCallback","removeVariablesChangedCallback","removeOneTimeVariablesChangedCallback","callBack","CleverTap","spa","isSpa","bind","enablePersonalization","_isPersonalisationActive","shpfyProxyPath","ReqestManager","onUserLogin","privacy","notifications","logout","getCleverTapID","getAccountID","getSCDomain","setLibrary","libName","libVersion","setSCSDKVersion","ver","scSDKVersion","scv","getInboxMessageCount","getInboxMessageUnreadCount","getAllInboxMessages","getUnreadInboxMessages","getInboxMessageForId","messageId","deleteInboxMessage","markReadInboxMessage","unreadMsg","markReadInboxMessagesForIds","messageIds","markReadAllInboxMessage","processNotificationEvent","eventDetail","setLogLevel","l","Number","handleIncrementValue","handleDecrementValue","setMultiValuesForKey","addMultiValueForKey","addMultiValuesForKey","removeMultiValueForKey","removeMultiValuesForKey","removeValueForKey","_handleEmailSubscription","getLocation","lat","lng","Latitude","Longitude","geolocation","getCurrentPosition","showPosition","showError","coords","latitude","longitude","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","UNKNOWN_ERROR","api","enableWebPush","tr","is_onloadcalled","subEmail","getEmail","withGroups","unSubEmail","unsubEmailGroups","isUnsubscribed","checked","setSubscriptionGroups","getSubscriptionGroups","changeSubscriptionGroups","updatedGroups","isGlobalUnsubscribe","setIsGlobalUnsubscribe","setUpdatedCategoryLong","$CLTP_WR","$WZRK_WR","currLocation","wzrk_ex","pageChanged","backupInterval","pgCount","referrerDomain","referrer","maxLen","utmSource","utm_source","wzrk_source","us","utmMedium","utm_medium","wzrk_medium","um","utmCampaign","utm_campaign","wzrk_campaign","uc","wm","cpg","setOffline","arg","getSDKVersion","defineVariable","timeout","debouncedPageChanged","wzrk_d","ping","Clevertap"],"mappings":"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"}