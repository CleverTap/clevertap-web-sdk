var clevertapShopify=function(){"use strict";function e(e,t,r,o,i,a,n){try{var s=e[a](n),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(o,i)}function t(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var n=t.apply(r,o);function s(t){e(n,i,a,s,l,"next",t)}function l(t){e(n,i,a,s,l,"throw",t)}s(void 0)}))}}function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function i(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){r(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var a=0;function n(e){return"__private_"+a+++"_"+e}function s(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var l="clevertap-prod.com",c="https:",d=n("mode"),u=n("browser");var h=new class{constructor(){Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:void 0})}set mode(e){s(this,d)[d]=e}get mode(){return s(this,d)[d]}set browser(e){s(this,u)[u]=e}get browser(){return s(this,u)[u]}},v=n("accountId"),g=n("region"),f=n("targetDomain"),p=n("dcSdkversion"),y=n("token");class b{constructor(){var{id:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";Object.defineProperty(this,v,{writable:!0,value:void 0}),Object.defineProperty(this,g,{writable:!0,value:""}),Object.defineProperty(this,f,{writable:!0,value:l}),Object.defineProperty(this,p,{writable:!0,value:""}),Object.defineProperty(this,y,{writable:!0,value:""}),this.id=e,t&&(this.region=t),r&&(this.targetDomain=r),o&&(this.token=o)}get id(){return s(this,v)[v]}set id(e){s(this,v)[v]=e}get region(){return s(this,g)[g]}set region(e){s(this,g)[g]=e}get dcSDKVersion(){return s(this,p)[p]}set dcSDKVersion(e){s(this,p)[p]=e}get targetDomain(){return s(this,f)[f]}set targetDomain(e){s(this,f)[f]=e}get token(){return s(this,y)[y]}set token(e){s(this,y)[y]=e}get finalTargetDomain(){return this.region?"".concat(this.region,".").concat(this.targetDomain):this.targetDomain===l?"".concat("eu1",".").concat(this.targetDomain):this.targetDomain}get endpoint(){return"SHOPIFY"===h.mode?"shopifyAppPixel":"a"}get dataPostPEURL(){return"".concat(c,"//").concat(this.finalTargetDomain,"/defineVars")}get dataPostURL(){return"".concat(c,"//").concat(this.finalTargetDomain,"/").concat(this.endpoint,"?t=96")}get recorderURL(){return"".concat(c,"//").concat(this.finalTargetDomain,"/r?r=1")}get emailURL(){return"".concat(c,"//").concat(this.finalTargetDomain,"/e?r=1")}}var m=new RegExp("^\\s+|\\.|:|\\$|'|\"|\\\\|\\s+$","g"),k=new RegExp("^\\s+|'|\"|\\\\|\\s+$","g"),S=new RegExp("'","g"),O="clear",w="Charged ID",P="WZRK_CHARGED_ID",C="WZRK_G",L="WZRK_K",R="WZRK_CAMP",D="WZRK_EV",j="WZRK_META",E="WZRK_PR",A="WZRK_ARP",_="WZRK_L",N="WZRK_WPR",T="useIP",q="WZRK_X",U="push",I=31536e3,M="WZRK_FPU",F=1e3,B="WZRK_BLOCK",G=["Stayed","UTM Visited","App Launched","Notification Sent","Notification Viewed","Notification Clicked"],K=e=>"string"==typeof e||e instanceof String,W=e=>"[object Object]"===Object.prototype.toString.call(e),J=e=>"object"==typeof e&&e instanceof Date,x=e=>{for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},Z=e=>!isNaN(parseFloat(e))&&isFinite(e),H=e=>null!=e&&"undefined"!==e,z=(e,t)=>{var r;if("object"!=typeof e)return K(e)?(r=V(e,k)).length>1024&&(r=r.substring(0,1024),t.reportError(521,r+"... length exceeded 1024 chars. Trimmed.")):r=e,r;for(var o in e)if(e.hasOwnProperty(o)){var i=z(e[o],t),a=void 0;(a=V(o,m)).length>1024&&(a=a.substring(0,1024),t.reportError(520,a+"... length exceeded 1024 chars. Trimmed.")),delete e[o],e[a]=i}return e},V=(e,t)=>e.replace(t,"");var $=(e,t,r)=>e+"&"+t+"="+encodeURIComponent(r),Y=()=>"SHOPIFY"===h.mode?h.browser.document.location.hostname:window.location.hostname;class Q extends class{static saveAsync(e,r){return t((function*(){if(!e||!r)return!1;try{return yield h.browser.localStorage.setItem(e,"string"==typeof r?r:JSON.stringify(r)),!0}catch(e){return!1}}))()}static readAsync(e){return t((function*(){if(!e)return!1;var t=null;try{t=yield h.browser.localStorage.getItem(e)}catch(e){}if(null!=t)try{t=JSON.parse(t)}catch(e){}return t}))()}static removeAsync(e){return t((function*(){if(!e)return!1;try{return yield h.browser.localStorage.removeItem(e),!0}catch(e){return!1}}))()}static createCookieAsync(e,r,o,i){return t((function*(){var t="",a="";if(o){var n=new Date;n.setTime(n.getTime()+1e3*o),t="; expires="+n.toGMTString()}i&&(a="; domain="+i),r=encodeURIComponent(r);try{return yield h.browser.cookie.set(e,r+t+a+"; path=/"),!0}catch(e){return!1}}))()}static readCookieAsync(e){return t((function*(){var t;try{t=yield h.browser.cookie.get(e)}catch(e){t=null}return""===t?null:decodeURIComponent(t)}))()}static removeCookieAsync(e,r){return t((function*(){var t=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;";r&&(t=t+" domain="+r+"; path=/");try{return yield h.browser.cookie.set(t),!0}catch(e){return!1}}))()}}{static save(e,t){return!(!e||!t)&&(this._isLocalStorageSupported()?(localStorage.setItem(e,"string"==typeof t?t:JSON.stringify(t)),!0):void 0)}static read(e){if(!e)return!1;var t=null;if(this._isLocalStorageSupported()&&(t=localStorage.getItem(e)),null!=t)try{t=JSON.parse(t)}catch(e){}return t}static remove(e){return!!e&&(this._isLocalStorageSupported()?(localStorage.removeItem(e),!0):void 0)}static removeCookie(e,t){var r=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;";t&&(r=r+" domain="+t+"; path=/"),document.cookie=r}static createCookie(e,t,r,o){var i="",a="";if(r){var n=new Date;n.setTime(n.getTime()+1e3*r),i="; expires="+n.toGMTString()}o&&(a="; domain="+o),t=encodeURIComponent(t),document.cookie=e+"="+t+i+a+"; path=/"}static readCookie(e){for(var t=e+"=",r=document.cookie.split(";"),o=0;o<r.length;o++){for(var i=r[o];" "===i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return null}static _isLocalStorageSupported(){return"SHOPIFY"===h.mode||"localStorage"in window&&null!==window.localStorage&&"function"==typeof window.localStorage.setItem}static saveToLSorCookie(e,r){var o=this;return t((function*(){if(null!=r)try{o._isLocalStorageSupported()?yield o.addData("localStorage",e,encodeURIComponent(JSON.stringify(r))):e===C?yield o.addData("cookie",e,encodeURIComponent(r),0,Y()):yield o.addData("cookie",e,encodeURIComponent(JSON.stringify(r)),0,Y()),X.globalCache[e]=r}catch(e){}}))()}static readFromLSorCookie(e){var r=this;return t((function*(){var t;if(X.globalCache.hasOwnProperty(e))return X.globalCache[e];if(null!=(t=r._isLocalStorageSupported()?yield r.retrieveData("localStorage",e):yield r.retrieveData("cookie",e))&&("function"!=typeof t.trim||""!==t.trim())){var o;try{o=JSON.parse(decodeURIComponent(t))}catch(e){o=decodeURIComponent(t)}return X.globalCache[e]=o,o}}))()}static createBroadCookie(e,r,o,i){var a=this;return t((function*(){if(!!(yield a.retrieveData("localStorage","WZRK_ISOLATE_SD")))return X.broadDomain&&(yield a.deleteData("cookie",e,X.broadDomain)),void(yield a.addData("cookie",e,r,o,i));if(i){var t=X.broadDomain;if(null==t)for(var n=i.split("."),s="",l=n.length-1;l>=0;l--){if(s=0===l?n[l]+s:"."+n[l]+s,yield a.retrieveData("cookie",e)){var c="test_"+e+l;if(yield a.addData("cookie",c,r,10,s),!(yield a.retrieveData("cookie",c)))continue;yield a.deleteData("cookie",c,s)}if(yield a.addData("cookie",e,r,o,s),(yield a.retrieveData("cookie",e))==r){t=s,X.broadDomain=t;break}}else yield a.addData("cookie",e,r,o,t)}else yield a.addData("cookie",e,r,o,i)}))()}static getMetaProp(e){var r=this;return t((function*(){var t=yield r.readFromLSorCookie(j);if(null!=t)return t[e]}))()}static setMetaProp(e,r){var o=this;return t((function*(){if(o._isLocalStorageSupported()){var t=yield o.readFromLSorCookie(j);null==t&&(t={}),void 0===r?delete t[e]:t[e]=r,yield o.saveToLSorCookie(j,t)}}))()}static getAndClearMetaProp(e){var r=this;return t((function*(){var t=yield r.getMetaProp(e);return yield r.setMetaProp(e,void 0),t}))()}static setInstantDeleteFlagInK(){var e=this;return t((function*(){var t=yield e.readFromLSorCookie(L);null==t&&(t={}),t.flag=!0,yield e.saveToLSorCookie(L,t)}))()}static backupEvent(e,r,o){var i=this;return t((function*(){var t=yield i.readFromLSorCookie(_);void 0===t&&(t={}),t[r]={q:e},yield i.saveToLSorCookie(_,t),o.debug("stored in ".concat(_," reqNo : ").concat(r," -> ").concat(e))}))()}static markBackupAsOUL(e){var t=this.getMetaProp("OUL_REQUESTS")||[];t.includes(e)||(t.push(e),this.setMetaProp("OUL_REQUESTS",t))}static isBackupOUL(e){return(this.getMetaProp("OUL_REQUESTS")||[]).includes(e)}static removeBackup(e,r){var o=this;return t((function*(){var t=yield o.readFromLSorCookie(_);null!=t&&void 0!==t[e]&&(r.debug("del event: ".concat(e," data-> ").concat(t[e].q)),delete t[e],yield o.saveToLSorCookie(_,t))}))()}static retrieveData(e,r){var o=this;return t((function*(){var t;switch(e){case"cookie":t="WEB"===h.mode?o.readCookie(r):yield o.readCookieAsync(r);break;case"localStorage":t="WEB"===h.mode?o.read(r):yield o.readAsync(r)}return t}))()}static addData(e,r,o,i,a){var n=this;return t((function*(){switch(e){case"cookie":"WEB"===h.mode?n.createCookie(r,o,i,a):yield n.createCookieAsync(r,o,i,a);break;case"localStorage":"WEB"===h.mode?n.save(r,o):yield n.saveAsync(r,o)}}))()}static deleteData(e,r,o){var i=this;return t((function*(){switch(e){case"cookie":"WEB"===h.mode?i.removeCookie(r):yield i.removeCookieAsync(r,o);break;case"localStorage":"WEB"===h.mode?i.remove(r):yield i.removeAsync(r)}}))()}}var X={globalCache:{gcookie:null,REQ_N:0,RESP_N:0},LRU_CACHE:null,globalProfileMap:void 0,globalEventsMap:void 0,get blockRequest(){return!0===Q.readFromLSorCookie(B)},set blockRequest(e){Q.saveToLSorCookie(B,e)},isOptInRequest:!1,broadDomain:null,webPushEnabled:null,campaignDivMap:{},currentSessionId:null,wiz_counter:0,notifApi:{notifEnabledFromApi:!1},unsubGroups:[],updatedCategoryLong:null,inbox:null,isPrivacyArrPushed:!1,privacyArray:[],offline:!1,location:null,dismissSpamControl:!0,globalUnsubscribe:!0,flutterVersion:null,variableStore:{},pushConfig:null,delayEvents:!1,intervalArray:[]},ee=n("logger");class te{constructor(e){var{logger:t,customId:r}=e;Object.defineProperty(this,ee,{writable:!0,value:void 0}),this.gcookie=void 0,s(this,ee)[ee]=t,this.gcookie=this.getGuid()||r}getGuid(){var e=this;return t((function*(){var t=null;if(H(e.gcookie))return e.gcookie;if(Q._isLocalStorageSupported()){var r=yield Q.retrieveData("localStorage",C);if(H(r)){try{t=JSON.parse(decodeURIComponent(r))}catch(o){s(e,ee)[ee].debug("Cannot parse Gcookie from localstorage - must be encoded "+r),32===r.length?(t=r,yield Q.saveToLSorCookie(C,r)):s(e,ee)[ee].error("Illegal guid "+r)}H(t)&&(yield Q.createBroadCookie(C,t,I,Y()))}}return H(t)||(t=yield Q.retrieveData("cookie",C),!H(t)||0!==t.indexOf("%")&&0!==t.indexOf("'")&&0!==t.indexOf('"')||(t=null),H(t)&&(yield Q.saveToLSorCookie(C,t))),t}))()}}var re=()=>Math.floor((new Date).getTime()/1e3),oe=e=>"$D_"+Math.round(e.getTime()/1e3),ie=e=>{if(ae(e))return"$D_"+e},ae=e=>{var t=/^(\d{4})(\d{2})(\d{2})$/.exec(e);if(null==t)return!1;var r=t[3],o=t[2]-1,i=t[1],a=new Date(i,o,r);return a.getDate()==r&&a.getMonth()==o&&a.getFullYear()==i},ne=n("logger"),se=n("sessionId"),le=n("isPersonalisationActive");class ce{constructor(e){var{logger:t,isPersonalisationActive:r}=e;Object.defineProperty(this,ne,{writable:!0,value:void 0}),Object.defineProperty(this,se,{writable:!0,value:void 0}),Object.defineProperty(this,le,{writable:!0,value:void 0}),this.cookieName=void 0,this.scookieObj=void 0,this.sessionId=Q.getMetaProp("cs"),s(this,ne)[ne]=t,s(this,le)[le]=r}get sessionId(){return s(this,se)[se]}set sessionId(e){s(this,se)[se]=e}getSessionCookieObject(){var e=this;return t((function*(){var t=yield Q.retrieveData("cookie",e.cookieName),r={};if(null!=t)if(t=t.replace(S,'"'),r=JSON.parse(t),W(r)){if(void 0!==r.t){var o=r.t;re()-o>1260&&(r={})}}else r={};return e.scookieObj=r,r}))()}setSessionCookieObject(e){var r=this;return t((function*(){var t=JSON.stringify(e);yield Q.createBroadCookie(r.cookieName,t,1200,Y())}))()}manageSession(e){var r=this;return t((function*(){if(void 0===r.sessionId||r.sessionId!==e){var t=Q.getMetaProp("cs");if(void 0===t)yield Q.setMetaProp("ps",e),yield Q.setMetaProp("cs",e),yield Q.setMetaProp("sc",1);else if(t!==e){yield Q.setMetaProp("ps",t),yield Q.setMetaProp("cs",e);var o=Q.getMetaProp("sc");void 0===o&&(o=0),yield Q.setMetaProp("sc",o+1)}r.sessionId=e}}))()}getTimeElapsed(){var e=this;return t((function*(){if(s(e,le)[le]()){null!=e.scookieObj&&(e.scookieObj=yield e.getSessionCookieObject());var t=e.scookieObj.s;if(null!=t){var r=re();return Math.floor(r-t)}}}))()}getPageCount(){var e=this;return t((function*(){if(s(e,le)[le]())return null!=e.scookieObj&&(e.scookieObj=yield e.getSessionCookieObject()),e.scookieObj.p}))()}}var de=(e,t)=>(t&&"function"==typeof t.debug&&t.debug("dobj:"+e),he(e)),ue=(()=>{var e="",t=0;for(t=0;t<=25;t++)e+=String.fromCharCode(t+65);for(t=0;t<=25;t++)e+=String.fromCharCode(t+97);for(t=0;t<10;t++)e+=t;return e+"+/="})(),he=e=>{if(null==e)return"";var t,r,o,i,a,n,s,l="",c=0;for(e=(e=>{if(null==e)return"";var t,r,o,i={},a={},n="",s="",l="",c=2,d=3,u=2,h="",v=0,g=0,f=String.fromCharCode;for(o=0;o<e.length;o+=1)if(n=e.charAt(o),Object.prototype.hasOwnProperty.call(i,n)||(i[n]=d++,a[n]=!0),s=l+n,Object.prototype.hasOwnProperty.call(i,s))l=s;else{if(Object.prototype.hasOwnProperty.call(a,l)){if(l.charCodeAt(0)<256){for(t=0;t<u;t++)v<<=1,15==g?(g=0,h+=f(v),v=0):g++;for(r=l.charCodeAt(0),t=0;t<8;t++)v=v<<1|1&r,15==g?(g=0,h+=f(v),v=0):g++,r>>=1}else{for(r=1,t=0;t<u;t++)v=v<<1|r,15==g?(g=0,h+=f(v),v=0):g++,r=0;for(r=l.charCodeAt(0),t=0;t<16;t++)v=v<<1|1&r,15==g?(g=0,h+=f(v),v=0):g++,r>>=1}0==--c&&(c=Math.pow(2,u),u++),delete a[l]}else for(r=i[l],t=0;t<u;t++)v=v<<1|1&r,15==g?(g=0,h+=f(v),v=0):g++,r>>=1;0==--c&&(c=Math.pow(2,u),u++),i[s]=d++,l=String(n)}if(""!==l){if(Object.prototype.hasOwnProperty.call(a,l)){if(l.charCodeAt(0)<256){for(t=0;t<u;t++)v<<=1,15==g?(g=0,h+=f(v),v=0):g++;for(r=l.charCodeAt(0),t=0;t<8;t++)v=v<<1|1&r,15==g?(g=0,h+=f(v),v=0):g++,r>>=1}else{for(r=1,t=0;t<u;t++)v=v<<1|r,15==g?(g=0,h+=f(v),v=0):g++,r=0;for(r=l.charCodeAt(0),t=0;t<16;t++)v=v<<1|1&r,15==g?(g=0,h+=f(v),v=0):g++,r>>=1}0==--c&&(c=Math.pow(2,u),u++),delete a[l]}else for(r=i[l],t=0;t<u;t++)v=v<<1|1&r,15==g?(g=0,h+=f(v),v=0):g++,r>>=1;0==--c&&(c=Math.pow(2,u),u++)}for(r=2,t=0;t<u;t++)v=v<<1|1&r,15==g?(g=0,h+=f(v),v=0):g++,r>>=1;for(;;){if(v<<=1,15==g){h+=f(v);break}g++}return h})(e);c<2*e.length;)c%2==0?(t=e.charCodeAt(c/2)>>8,r=255&e.charCodeAt(c/2),o=c/2+1<e.length?e.charCodeAt(c/2+1)>>8:NaN):(t=255&e.charCodeAt((c-1)/2),(c+1)/2<e.length?(r=e.charCodeAt((c+1)/2)>>8,o=255&e.charCodeAt((c+1)/2)):r=o=NaN),c+=3,i=t>>2,a=(3&t)<<4|r>>4,n=(15&r)<<2|o>>6,s=63&o,isNaN(r)?n=s=64:isNaN(o)&&(s=64),l=l+ue.charAt(i)+ue.charAt(a)+ue.charAt(n)+ue.charAt(s);return l},ve=n("keyOrder"),ge=n("deleteFromObject");class fe{constructor(e){Object.defineProperty(this,ge,{value:pe}),Object.defineProperty(this,ve,{writable:!0,value:void 0}),this.max=e}init(){var e=this;return t((function*(){var t=yield Q.readFromLSorCookie(q);if(t){var r={};for(var o in s(e,ve)[ve]=[],t=t.cache)t.hasOwnProperty(o)&&(r[t[o][0]]=t[o][1],s(e,ve)[ve].push(t[o][0]));e.cache=r}else e.cache={},s(e,ve)[ve]=[]}))()}get(e){var r=this;return t((function*(){var t=r.cache[e];return t&&(r.cache=s(r,ge)[ge](e,r.cache),r.cache[e]=t,s(r,ve)[ve].push(e)),yield r.saveCacheToLS(r.cache),t}))()}set(e,r){var o=this;return t((function*(){var t=o.cache[e],i=s(o,ve)[ve];null!=t?o.cache=s(o,ge)[ge](e,o.cache):i.length===o.max&&(o.cache=s(o,ge)[ge](i[0],o.cache)),o.cache[e]=r,s(o,ve)[ve][s(o,ve)[ve]-1]!==e&&s(o,ve)[ve].push(e),yield o.saveCacheToLS(o.cache)}))()}saveCacheToLS(e){var r=this;return t((function*(){var t=[],o=s(r,ve)[ve];for(var i in o)if(o.hasOwnProperty(i)){var a=[];a.push(o[i]),a.push(e[o[i]]),t.push(a)}yield Q.saveToLSorCookie(q,{cache:t})}))()}getKey(e){if(null===e)return null;var t=s(this,ve)[ve];for(var r in t)if(t.hasOwnProperty(r)&&this.cache[t[r]]===e)return t[r];return null}getSecondLastKey(){var e=s(this,ve)[ve];return null!=e&&e.length>1?e[e.length-2]:-1}getLastKey(){var e=s(this,ve)[ve].length;if(e)return s(this,ve)[ve][e-1]}}var pe=function(e,t){var r,o=JSON.parse(JSON.stringify(s(this,ve)[ve])),i={};for(var a in o)o.hasOwnProperty(a)&&(o[a]!==e?i[o[a]]=t[o[a]]:r=a);return o.splice(r,1),s(this,ve)[ve]=JSON.parse(JSON.stringify(o)),i},ye=n("isOULInProgress"),be=n("oulReqN");var me=new class{constructor(){Object.defineProperty(this,ye,{writable:!0,value:void 0}),Object.defineProperty(this,be,{writable:!0,value:void 0})}get isOULInProgress(){return"WEB"===h.mode?window.isOULInProgress:s(this,ye)[ye]}set isOULInProgress(e){"WEB"!==h.mode?s(this,ye)[ye]=e:window.isOULInProgress=e}get oulReqN(){return"WEB"===h.mode?window.oulReqN:s(this,be)[be]}set oulReqN(e){"WEB"!==h.mode?s(this,be)[be]=e:window.oulReqN=e}},ke=n("logger"),Se=n("request"),Oe=n("device"),we=n("session");var Pe=new class{constructor(e){Object.defineProperty(this,ke,{writable:!0,value:void 0}),Object.defineProperty(this,Se,{writable:!0,value:void 0}),Object.defineProperty(this,Oe,{writable:!0,value:void 0}),Object.defineProperty(this,we,{writable:!0,value:void 0}),this.setPrivateProperties(e)}setPrivateProperties(e){var{logger:t,request:r,device:o,session:i}=e;s(this,ke)[ke]=t,s(this,Se)[Se]=r,s(this,Oe)[Oe]=o,s(this,we)[we]=i}s(e,r,o,i,a){var n=this;return t((function*(){var t=!1,l=!1;if(me.isOULInProgress&&(o||"undefined"!==i&&Number(i)===me.oulReqN)&&(me.isOULInProgress=!1,t=!0),void 0===i&&(i=0),yield Q.removeBackup(Number(i),s(n,ke)[ke]),!(Number(i)>X.globalCache.REQ_N)){if(H(s(n,Oe)[Oe].gcookie)||e&&(l=!0),!H(s(n,Oe)[Oe].gcookie)||o||"boolean"==typeof a){var c=yield s(n,we)[we].getSessionCookieObject();if(me.isOULInProgress||c.s&&r<c.s)return;if(s(n,ke)[ke].debug("Cookie was ".concat(s(n,Oe)[Oe].gcookie," set to ").concat(e)),s(n,Oe)[Oe].gcookie=e,H(s(n,Oe)[Oe].gcookie)||(yield Q.getAndClearMetaProp(T)),e&&Q._isLocalStorageSupported()){null==X.LRU_CACHE&&(X.LRU_CACHE=new fe(100),yield X.LRU_CACHE.init());var d,u=yield Q.readFromLSorCookie(L);null!=u&&u.id&&(d=X.LRU_CACHE.cache[u.id],o&&(d||(yield Q.saveToLSorCookie(M,!0),X.LRU_CACHE.set(u.id,e)))),yield Q.saveToLSorCookie(C,e);var h=X.LRU_CACHE.getSecondLastKey();if((yield Q.readFromLSorCookie(M))&&-1!==h){var v=X.LRU_CACHE.cache[h];s(n,Se)[Se].unregisterTokenForGuid(v)}}yield Q.createBroadCookie(C,e,I,Y()),yield Q.saveToLSorCookie(C,e)}Q._isLocalStorageSupported()&&(yield s(n,we)[we].manageSession(r));var g=yield s(n,we)[we].getSessionCookieObject();(void 0===g.s||g.s<=r)&&(g.s=r,g.t=re(),s(n,we)[we].setSessionCookieObject(g)),H(s(n,Oe)[Oe].gcookie)&&(X.blockRequest=!1),!t&&!l||s(n,Se)[Se].processingBackup||s(n,Se)[Se].processBackupEvents(),X.globalCache.RESP_N=Number(i)}}))()}}({logger:"",request:"",device:"",session:""}),Ce="This property has been ignored.",Le="CleverTap error:",Re="".concat(Le," Event structure not valid. ").concat(Ce),De="".concat(Le," Gender value should one of the following: m,f,o,u,male,female,unknown,others (case insensitive). ").concat(Ce),je="".concat(Le," Employed value should be either Y or N. ").concat(Ce),Ee="".concat(Le," Married value should be either Y or N. ").concat(Ce),Ae="".concat(Le," Education value should be either School, College or Graduate. ").concat(Ce),_e="".concat(Le," Age value should be a number. ").concat(Ce),Ne="".concat(Le," DOB value should be a Date Object"),Te="".concat(Le," Phone number should be formatted as +[country code][number]"),qe=()=>{var e=JSON.parse(decodeURIComponent(Q.read(C))),t={};if(Q._isLocalStorageSupported()){var r,o,a,n,s,l,c,d,u,h,v,g;t=(()=>{var e={};if(Q._isLocalStorageSupported()){var t=Q.read(R);e=null!=t?t=JSON.parse(decodeURIComponent(t).replace(S,'"')):{}}return e})();var f=Q.read("WZRK_CAMP_G"),p=f?decodeURIComponent(f):null,y=p?JSON.parse(p):null,b=e&&null!=f&&y&&y[e]&&y[e].wi?Object.values(y[e].wi):[],m={wsc:null!==(r=null===(o=t)||void 0===o?void 0:o.wsc)&&void 0!==r?r:0,wfc:null!==(a=null===(n=t)||void 0===n?void 0:n.wfc)&&void 0!==a?a:{},woc:null!==(s=null===(l=t)||void 0===l?void 0:l.woc)&&void 0!==s?s:{}},k={wndsc:null!==(c=null===(d=t)||void 0===d?void 0:d.wndsc)&&void 0!==c?c:0,wndfc:null!==(u=null===(h=t)||void 0===h?void 0:h.wndfc)&&void 0!==u?u:{},wndoc:null!==(v=null===(g=t)||void 0===g?void 0:g.wndoc)&&void 0!==v?v:{}},O=(()=>{var e=new Date;return e.getFullYear()+""+e.getMonth()+e.getDay()})(),w=0;return t.wi&&t.wi[O]&&"undefined"!==t.wi[O].tc&&(w=t.wi[O].tc),i(i({wimp:w,witlc:b},m),k)}},Ue=(e,t)=>{var{logger:r}=t,o=!1;if(W(e))for(var i in e)if(e.hasOwnProperty(i)){o=!0;var a=e[i];if(null==a){delete e[i];continue}"Gender"!==i||a.match(/\b(?:[mM](?:ale)?|[fF](?:emale)?|[oO](?:thers)?|[uU](?:nknown)?)\b/)||(o=!1,r.error(De)),"Employed"!==i||a.match(/^Y$|^N$/)||(o=!1,r.error(je)),"Married"!==i||a.match(/^Y$|^N$/)||(o=!1,r.error(Ee)),"Education"!==i||a.match(/^School$|^College$|^Graduate$/)||(o=!1,r.error(Ae)),"Age"===i&&null!=a&&(Z(a)?e.Age=+a:(o=!1,r.error(_e))),"DOB"===i?(/^\$D_/.test(a)&&11===(a+"").length||J(a)||(o=!1,r.error(Ne)),J(a)&&(e[i]=oe(a))):J(a)&&(e[i]=oe(a)),"Phone"!==i||x(a)||(a.length>8&&"+"===a.charAt(0)?(a=a.substring(1,a.length),Z(a)?e.Phone=+a:(o=!1,r.error(Te+". Removed."))):(o=!1,r.error(Te+". Removed."))),o||delete e[i]}return o},Ie=e=>{var t={};t.Name=e.name,null!=e.id&&(t.FBID=e.id+""),"male"===e.gender?t.Gender="M":"female"===e.gender?t.Gender="F":t.Gender="O";null!=e.relationship_status&&(t.Married="N","Married"===e.relationship_status&&(t.Married="Y"));var r=function(e){if(null!=e){for(var t="",r="",o=0;o<e.length;o++){var i=e[o];if(null!=i.type){var a=i.type;if("Graduate School"===a)return"Graduate";"College"===a?t="1":"High School"===a&&(r="1")}}if("1"===t)return"College";if("1"===r)return"School"}}(e.education);null!=r&&(t.Education=r);var o=null!=e.work?e.work.length:0;if(t.Employed=o>0?"Y":"N",null!=e.email&&(t.Email=e.email),null!=e.birthday){var i=e.birthday.split("/");t.DOB=ie(i[2]+i[0]+i[1])}return t},Me=(e,t)=>{var{logger:r}=t,o={};if(null!=e.displayName&&(o.Name=e.displayName),null!=e.id&&(o.GPID=e.id+""),null!=e.gender&&("male"===e.gender?o.Gender="M":"female"===e.gender?o.Gender="F":"other"===e.gender&&(o.Gender="O")),null!=e.image&&!1===e.image.isDefault&&(o.Photo=e.image.url.split("?sz")[0]),null!=e.emails)for(var i=0;i<e.emails.length;i++){var a=e.emails[i];"account"===a.type&&(o.Email=a.value)}if(null!=e.organizations){o.Employed="N";for(var n=0;n<e.organizations.length;n++){"work"===e.organizations[n].type&&(o.Employed="Y")}}if(null!=e.birthday){var s=e.birthday.split("-");o.DOB=ie(s[0]+s[1]+s[2])}return null!=e.relationshipStatus&&(o.Married="N","married"===e.relationshipStatus&&(o.Married="Y")),r.debug("gplus usr profile "+JSON.stringify(o)),o},Fe=function(){var e=t((function*(e,t){if(Q._isLocalStorageSupported()){if(null==X.globalProfileMap&&(X.globalProfileMap=yield Q.readFromLSorCookie(E),null==X.globalProfileMap&&(X.globalProfileMap={})),null!=e._custom){var r=e._custom;for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);delete e._custom}for(var i in e)if(e.hasOwnProperty(i)){if(X.globalProfileMap.hasOwnProperty(i)&&!t)continue;X.globalProfileMap[i]=e[i]}null!=X.globalProfileMap._custom&&delete X.globalProfileMap._custom,yield Q.saveToLSorCookie(E,X.globalProfileMap)}}));return function(t,r){return e.apply(this,arguments)}}(),Be=function(){var e=t((function*(e){if(null!=e.skipResARP&&e.skipResARP)return console.debug("Update ARP Request rejected",e),null;var t=!0===e.isOUL;if(Q._isLocalStorageSupported())try{var r=yield Q.readFromLSorCookie(A);if(null==r||t){for(var o in r={},e)e.hasOwnProperty(o)&&(-1===e[o]?delete r[o]:r[o]=e[o]);yield Q.saveToLSorCookie(A,r)}}catch(e){console.error("Unable to parse ARP JSON: "+e)}}));return function(t){return e.apply(this,arguments)}}(),Ge=n("fireRequest"),Ke=n("dropRequestDueToOptOut"),We=n("addUseIPToRequest"),Je=n("addARPToRequest");class xe{constructor(){this.networkRetryCount=0,this.minDelayFrequency=0}static fireRequest(e,r,o,i){var a=this;return t((function*(){yield s(a,Ge)[Ge](e,1,r,o,i)}))()}getDelayFrequency(){if(this.logger.debug("Network retry #"+this.networkRetryCount),this.networkRetryCount<10)return this.logger.debug(this.account.id,"Failure count is "+this.networkRetryCount+". Setting delay frequency to 1s"),this.minDelayFrequency=F,this.minDelayFrequency;if(null==this.account.region)return this.logger.debug(this.account.id,"Setting delay frequency to 1s"),F;var e=1e3*(Math.floor(10*Math.random())+1);return this.minDelayFrequency+=e,this.minDelayFrequency<6e5?(this.logger.debug(this.account.id,"Setting delay frequency to "+this.minDelayFrequency),this.minDelayFrequency):(this.minDelayFrequency=F,this.logger.debug(this.account.id,"Setting delay frequency to "+this.minDelayFrequency),this.minDelayFrequency)}}var Ze=function(){var e=t((function*(e,t){if(!0===t){var r={skipResARP:!0};return $(e,"arp",de(JSON.stringify(r),this.logger))}var o=yield Q.readFromLSorCookie(A);return null!=o?$(e,"arp",de(JSON.stringify(o),this.logger)):e}));return function(t,r){return e.apply(this,arguments)}}(),He=function(){var e=t((function*(e){var t=yield Q.getMetaProp(T);return"boolean"!=typeof t&&(t=!1),$(e,T,t?"true":"false")}));return function(t){return e.apply(this,arguments)}}(),ze=function(){var e=t((function*(e,r,o,i,a){var n=this;if(s(this,Ke)[Ke]())this.logger.debug("req dropped due to optout cookie: "+this.device.gcookie);else if(H(this.device.gcookie)||(X.blockRequest=!0),a&&"wzrk_fetch"===a)!H(this.device.gcookie)&&X.globalCache.RESP_N<X.globalCache.REQ_N-1&&setTimeout((()=>{this.logger.debug("retrying fire request for url: ".concat(e,", tries: ").concat(this.networkRetryCount)),s(this,Ge)[Ge](e,void 0,o,i)}),this.getDelayFrequency());else{var l,c,d,u,v;if(!H(this.device.gcookie)&&X.globalCache.RESP_N<X.globalCache.REQ_N-1&&r<200)return void setTimeout(t((function*(){n.logger.debug("retrying fire request for url: ".concat(e,", tries: ").concat(r)),yield s(n,Ge)[Ge](e,r+1,o,i)})),50);if(i?me.isOULInProgress=!0:(H(this.device.gcookie)&&(e=$(e,"gc",this.device.gcookie)),e=yield s(this,Je)[Je](e,o)),e=$(e,"tries",r),e=$(e,"origin",null!==(l=null===(c=window)||void 0===c||null===(d=c.location)||void 0===d?void 0:d.origin)&&void 0!==l?l:null===(u=window)||void 0===u||null===(v=u.location)||void 0===v?void 0:v.href),e=yield s(this,We)[We](e),-1!==(e=$(e,"r",(new Date).getTime())).indexOf("chrome-extension:")&&(e=e.replace("chrome-extension:","https:")),"WEB"===h.mode){var g,f;if((null===(g=window.clevertap)||void 0===g?void 0:g.hasOwnProperty("plugin"))||(null===(f=window.wizrocket)||void 0===f?void 0:f.hasOwnProperty("plugin"))){var p=window.clevertap.plugin||window.wizrocket.plugin;e=$(e,"ct_pl",p)}for(var y=document.getElementsByClassName("ct-jp-cb");y[0]&&y[0].parentNode;)y[0].parentNode.removeChild(y[0]);var b=document.createElement("script");b.setAttribute("type","text/javascript"),b.setAttribute("src",e),b.setAttribute("class","ct-jp-cb"),b.setAttribute("rel","nofollow"),b.async=!0,document.getElementsByTagName("head")[0].appendChild(b)}else fetch(e,{headers:{accept:"application/json"}}).then((e=>e.json())).then(t((function*(){response.arp&&(yield Be(response.arp)),response.meta&&(yield Pe.s(response.meta.g,response.meta.sid,response.meta.rf,response.meta.rn))})));this.logger.debug("req snt -> url: "+e)}}));return function(t,r,o,i,a){return e.apply(this,arguments)}}();xe.logger=void 0,xe.device=void 0,xe.mode=void 0,xe.api=void 0,xe.account=void 0,Object.defineProperty(xe,Ge,{value:ze}),Object.defineProperty(xe,Ke,{value:function(){return!X.isOptInRequest&&H(this.device.gcookie)&&K(this.device.gcookie)?":OO"===this.device.gcookie.slice(-3):(X.isOptInRequest=!1,!1)}}),Object.defineProperty(xe,We,{value:He}),Object.defineProperty(xe,Je,{value:Ze});var Ve=0,$e=0,Ye=n("logger"),Qe=n("account"),Xe=n("device"),et=n("session"),tt=n("isPersonalisationActive"),rt=n("clearCookie"),ot=n("getNextAvailableReqN"),it=n("addToLocalEventMap");class at{constructor(e){var{logger:t,account:r,device:o,session:i,isPersonalisationActive:a}=e;Object.defineProperty(this,it,{value:lt}),Object.defineProperty(this,ot,{value:st}),Object.defineProperty(this,Ye,{writable:!0,value:void 0}),Object.defineProperty(this,Qe,{writable:!0,value:void 0}),Object.defineProperty(this,Xe,{writable:!0,value:void 0}),Object.defineProperty(this,et,{writable:!0,value:void 0}),Object.defineProperty(this,tt,{writable:!0,value:void 0}),Object.defineProperty(this,rt,{writable:!0,value:!1}),this.processingBackup=!1,s(this,Ye)[Ye]=t,s(this,Qe)[Qe]=r,s(this,Xe)[Xe]=o,s(this,et)[et]=i,s(this,tt)[tt]=a,xe.logger=t,xe.device=o,xe.account=r}processBackupEvents(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Q.readFromLSorCookie(_);if(null!=t){for(var r in this.processingBackup=!0,t)if(t.hasOwnProperty(r)){var o=t[r];if(void 0!==o.fired)continue;var i=Q.isBackupOUL(parseInt(r));if(!e||i){if(s(this,Ye)[Ye].debug("Processing ".concat(i?"OUL":"regular"," backup event : ").concat(o.q)),void 0!==o.q){var a=JSON.parse(Q.readCookie("WZRK_S_"+s(this,Qe)[Qe].id));(null==a?void 0:a.s)&&(o.q=o.q+"&s="+a.s),xe.fireRequest(o.q)}o.fired=!0}}Q.saveToLSorCookie(_,t),this.processingBackup=!1}}addSystemDataToObject(e,r){var o=this;return t((function*(){void 0===r&&(e=z(e,s(o,Ye)[Ye])),x(s(o,Ye)[Ye].wzrkError)||(e.wzrk_error=s(o,Ye)[Ye].wzrkError,s(o,Ye)[Ye].wzrkError={}),e.id=s(o,Qe)[Qe].id,H(s(o,Xe)[Xe].gcookie)&&(e.g=s(o,Xe)[Xe].gcookie);var t=yield s(o,et)[et].getSessionCookieObject();return e.s=t.s,e.pg=void 0===t.p?1:t.p,"object"==typeof sessionStorage&&sessionStorage.hasOwnProperty("WZRK_D")&&(e.debug=!0),e}))()}addSystemDataToProfileObject(e,r){var o=this;return t((function*(){var t;x(s(o,Ye)[Ye].wzrkError)||(e.wzrk_error=s(o,Ye)[Ye].wzrkError,s(o,Ye)[Ye].wzrkError={}),e.id=s(o,Qe)[Qe].id,H(s(o,Xe)[Xe].gcookie)&&(e.g=s(o,Xe)[Xe].gcookie);var r=yield s(o,et)[et].getSessionCookieObject();return e.s=r.s,e.pg=void 0===r.p?1:r.p,(null===(t=sessionStorage)||void 0===t?void 0:t.hasOwnProperty("WZRK_D"))&&(e.debug=!0),e}))()}addFlags(e){var r=this;return t((function*(){if(s(r,rt)[rt]=yield Q.getAndClearMetaProp(O),void 0!==s(r,rt)[rt]&&s(r,rt)[rt]&&(e.rc=!0,s(r,Ye)[Ye].debug("reset cookie sent in request and cleared from meta for future requests.")),s(r,tt)[tt]()){var t=yield Q.getMetaProp("lsTime"),o=yield Q.getMetaProp("exTs");if(void 0===t||void 0===o)return void(e.dsync=!0);t+o<re()&&(e.dsync=!0)}}))()}saveAndFireRequest(e,r,o,i){var a=this;return t((function*(){var t=re(),n=yield s(a,ot)[ot]();X.globalCache.REQ_N=n;var l=(e=$(e,"rn",n))+"&i="+t+"&sn="+Ve;r&&(void 0===s(a,rt)[rt]||!s(a,rt)[rt])||me.isOULInProgress?s(a,Ye)[Ye].debug("Not fired due to override - ".concat(X.blockRequest," or clearCookie - ").concat(s(a,rt)[rt]," or OUL request in progress - ").concat(me.isOULInProgress)):(t===$e?Ve++:($e=t,Ve=0),me.oulReqN=X.globalCache.REQ_N,yield xe.fireRequest(l,!1,o,i))}))()}unregisterTokenForGuid(e){var r=this;return t((function*(){var t=yield Q.readFromLSorCookie("WZRK_PSD");if(t){var o={type:"data"};H(e)&&(o.g=e),o.action="unregister",o.id=s(r,Qe)[Qe].id;var i=yield s(r,et)[et].getSessionCookieObject();o.s=i.s;var a=de(JSON.stringify(o),s(r,Ye)[Ye]),n=s(r,Qe)[Qe].dataPostURL;n=$(n,"type","data"),n=$(n,"d",a),yield xe.fireRequest(n,!0),yield Q.saveToLSorCookie(M,!1)}yield r.registerToken(t)}))()}registerToken(e){var r=this;return t((function*(){if(e){e=yield r.addSystemDataToObject(e,!0),e=JSON.stringify(e);var t=s(r,Qe)[Qe].dataPostURL;t=$(t,"type","data"),t=$(t,"d",de(e,s(r,Ye)[Ye])),yield xe.fireRequest(t),Q.addData("localStorage",N,"ok")}}))()}processEvent(e){var r=this;return t((function*(){yield s(r,it)[it](e.evtName),e=r.addSystemDataToObject(e,void 0),r.addFlags(e),e[R]=qe();var t=de(JSON.stringify(e),s(r,Ye)[Ye]),o=s(r,Qe)[Qe].dataPostURL;o=$(o,"type",U),o=$(o,"d",t),yield r.saveAndFireRequest(o,X.blockRequest,!1,e.evtName)}))()}registerToken(e){if(e){e=this.addSystemDataToObject(e,!0),e=JSON.stringify(e);var t=s(this,Qe)[Qe].dataPostURL;t=$(t,"type","data"),t=$(t,"d",de(e,s(this,Ye)[Ye])),xe.fireRequest(t),Q.save(N,"ok")}}processEvent(e){s(this,it)[it](e.evtName),e=this.addSystemDataToObject(e,void 0),this.addFlags(e),e[R]=qe();var t=de(JSON.stringify(e),s(this,Ye)[Ye]),r=s(this,Qe)[Qe].dataPostURL;r=$(r,"type",U),r=$(r,"d",t),this.saveAndFireRequest(r,X.blockRequest,!1,e.evtName)}post(e,t){return fetch(e,{method:"post",headers:{"Content-Type":"application/json"},body:t}).then((e=>{if(e.ok)return e.json();throw e})).then((e=>(s(this,Ye)[Ye].debug("Sync data successful",e),e))).catch((e=>{throw s(this,Ye)[Ye].debug("Error in syncing variables",e),e}))}}var nt,st=function(){var e=t((function*(){var e=yield Q.readFromLSorCookie(_),t=X.globalCache.REQ_N+1;if(!e||"object"!=typeof e)return t;for(;e.hasOwnProperty(t.toString());)t++,s(this,Ye)[Ye].debug("Request number ".concat(t-1," already exists in backup, trying ").concat(t));return s(this,Ye)[Ye].debug("Using request number: ".concat(t)),t}));return function(){return e.apply(this,arguments)}}(),lt=function(){var e=t((function*(e){if(Q._isLocalStorageSupported()){void 0===X.globalEventsMap&&(X.globalEventsMap=yield Q.readFromLSorCookie(D),void 0===X.globalEventsMap&&(X.globalEventsMap={}));var t=re(),r=X.globalEventsMap[e];void 0!==r?(r[2]=t,r[0]++):((r=[]).push(1),r.push(t),r.push(t)),X.globalEventsMap[e]=r,yield Q.saveToLSorCookie(D,X.globalEventsMap)}}));return function(t){return e.apply(this,arguments)}}(),ct=e=>{if(W(e)){for(var t in e)if(e.hasOwnProperty(t)){if(W(e[t])||Array.isArray(e[t]))return!1;J(e[t])&&(e[t]=oe(e[t]))}return!0}return!1},dt=function(){var e=t((function*(e,t){if(W(e)){for(var r in e)if(e.hasOwnProperty(r))if("Items"===r){if(!Array.isArray(e[r]))return!1;for(var o in e[r].length>50&&t.reportError(522,"Charged Items exceed 50 limit. Actual count: "+e[r].length),e[r])if(e[r].hasOwnProperty(o)&&(!W(e[r][o])||!ct(e[r][o])))return!1}else{if(W(e[r])||Array.isArray(e[r]))return!1;J(e[r])&&(e[r]=oe(e[r]))}if(K(e[w])||(a=e[w],/^-?[\d.]+(?:e-?\d+)?$/.test(a)&&"number"==typeof a)){var i=e[w]+"";if(void 0===nt&&(nt=yield Q.readFromLSorCookie(P)),void 0!==nt&&nt.trim()===i.trim())return t.error("Duplicate charged Id - Dropped"+e),!1;nt=i,yield Q.saveToLSorCookie(P,i)}return!0}var a;return!1}));return function(t,r){return e.apply(this,arguments)}}(),ut=n("logger"),ht=n("oldValues"),vt=n("request"),gt=n("isPersonalisationActive"),ft=n("processEventArray");class pt extends Array{constructor(e,t){var{logger:r,request:o,isPersonalisationActive:i}=e;super(),Object.defineProperty(this,ft,{value:yt}),Object.defineProperty(this,ut,{writable:!0,value:void 0}),Object.defineProperty(this,ht,{writable:!0,value:void 0}),Object.defineProperty(this,vt,{writable:!0,value:void 0}),Object.defineProperty(this,gt,{writable:!0,value:void 0}),s(this,ut)[ut]=r,s(this,ht)[ht]=t,s(this,vt)[vt]=o,s(this,gt)[gt]=i}push(){if(Q.readFromLSorCookie("WZRK_ACCOUNT_ID")){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return s(this,ft)[ft](t),0}s(this,ut)[ut].error("Account ID is not set")}_processOldValues(){s(this,ht)[ht]&&s(this,ft)[ft](s(this,ht)[ht]),s(this,ht)[ht]=null}getDetails(e){if(s(this,gt)[gt]()&&(void 0===X.globalEventsMap&&(X.globalEventsMap=Q.readFromLSorCookie(D)),void 0!==X.globalEventsMap)){var t=X.globalEventsMap[e],r={};return void 0!==t?(r.firstTime=new Date(1e3*t[1]),r.lastTime=new Date(1e3*t[2]),r.count=t[0],r):void 0}}}var yt=function(){var e=t((function*(e){if(Array.isArray(e))for(;e.length>0;){var t=e.shift();if(K(t))if(t.length>1024&&(t=t.substring(0,1024),s(this,ut)[ut].reportError(510,t+"... length exceeded 1024 chars. Trimmed.")),G.includes(t))s(this,ut)[ut].reportError(513,t+" is a restricted system event. It cannot be used as an event name.");else{var r={type:"event"};if(r.evtName=V(t,m),0!==e.length){var o=e.shift();if(W(o)){if("Charged"===t){if(!(yield dt(o,s(this,ut)[ut]))){s(this,ut)[ut].reportError(511,"Charged event structure invalid. Not sent.");continue}}else if(!ct(o)){s(this,ut)[ut].reportError(512,t+" event structure invalid. Not sent.");continue}r.evtData=o}else e.unshift(o)}yield s(this,vt)[vt].processEvent(r)}else s(this,ut)[ut].error(Re)}}));return function(t){return e.apply(this,arguments)}}(),bt=n("request"),mt=n("logger"),kt=n("account"),St=n("session"),Ot=n("oldValues"),wt=n("device"),Pt=n("processOUL"),Ct=n("handleCookieFromCache"),Lt=n("deleteUser"),Rt=n("processLoginArray");class Dt extends Array{constructor(e,t){var{request:r,account:o,session:i,logger:a,device:n}=e;super(),Object.defineProperty(this,Rt,{value:_t}),Object.defineProperty(this,Lt,{value:At}),Object.defineProperty(this,Ct,{value:Et}),Object.defineProperty(this,Pt,{value:jt}),Object.defineProperty(this,bt,{writable:!0,value:void 0}),Object.defineProperty(this,mt,{writable:!0,value:void 0}),Object.defineProperty(this,kt,{writable:!0,value:void 0}),Object.defineProperty(this,St,{writable:!0,value:void 0}),Object.defineProperty(this,Ot,{writable:!0,value:void 0}),Object.defineProperty(this,wt,{writable:!0,value:void 0}),s(this,bt)[bt]=r,s(this,kt)[kt]=o,s(this,St)[St]=i,s(this,mt)[mt]=a,s(this,Ot)[Ot]=t,s(this,wt)[wt]=n}clear(){var e=this;return t((function*(){s(e,mt)[mt].debug("clear called. Reset flag has been set."),yield s(e,Lt)[Lt](),yield Q.setMetaProp(O,!0)}))()}push(){var e=arguments,r=this;return t((function*(){for(var t=e.length,o=new Array(t),i=0;i<t;i++)o[i]=e[i];return yield s(r,Rt)[Rt](o),0}))()}_processOldValues(){s(this,Ot)[Ot]&&s(this,Rt)[Rt](s(this,Ot)[Ot]),s(this,Ot)[Ot]=null}}var jt=function(){var e=t((function*(e){var r=this,o=!0;yield Q.saveToLSorCookie(M,o);var i=function(){var e=t((function*(e){var t,i=yield Q.readFromLSorCookie(L),a=yield Q.readFromLSorCookie(C);if(null==i)i={},t=e;else{var n=!1,l=!1;if(null==(t=i.id)&&(t=e[0],n=!0),null==X.LRU_CACHE&&Q._isLocalStorageSupported()&&(X.LRU_CACHE=new fe(100),yield X.LRU_CACHE.init()),n)null!=a&&(X.LRU_CACHE.set(t,a),X.blockRequest=!1);else for(var c in e)if(e.hasOwnProperty(c)){var d=e[c];if(X.LRU_CACHE.cache[d]){t=d,l=!0;break}}if(l){t!==X.LRU_CACHE.getLastKey()?yield s(r,Ct)[Ct]():(o=!1,yield Q.saveToLSorCookie(M,o));var u=yield X.LRU_CACHE.get(t);yield X.LRU_CACHE.set(t,u),yield Q.saveToLSorCookie(C,u),s(r,wt)[wt].gcookie=u;var h=X.LRU_CACHE.getSecondLastKey();if((yield Q.readFromLSorCookie(M))&&-1!==h){var v=X.LRU_CACHE.cache[h];yield s(r,bt)[bt].unregisterTokenForGuid(v)}}else n?null!=a&&(s(r,wt)[wt].gcookie=a,yield Q.saveToLSorCookie(C,a),o=!1):yield r.clear(),yield Q.saveToLSorCookie(M,!1),t=e[0]}i.id=t,yield Q.saveToLSorCookie(L,i)}));return function(t){return e.apply(this,arguments)}}();if(Array.isArray(e)&&e.length>0)for(var a in e)if(e.hasOwnProperty(a)){var n=e[a],l={},c=void 0;if(null!=n.Site){if(c=n.Site,x(c)||!Ue(c,{logger:s(this,mt)[mt]}))return}else if(null!=n.Facebook){var d=n.Facebook;x(d)||d.error||(c=Ie(d))}else if(null!=n["Google Plus"]){var u=n["Google Plus"];x(u)&&!u.error&&(c=Me(u,{logger:s(this,mt)[mt]}))}if(null!=c&&!x(c)){l.type="profile",null==c.tz&&(c.tz=(new Date).toString().match(/([A-Z]+[\+-][0-9]+)/)[1]),l.profile=c;var h=[];Q._isLocalStorageSupported()&&(c.Identity&&h.push(c.Identity),c.Email&&h.push(c.Email),c.GPID&&h.push("GP:"+c.GPID),c.FBID&&h.push("FB:"+c.FBID),h.length>0&&(yield i(h))),yield Fe(c,!0),l=yield s(this,bt)[bt].addSystemDataToObject(l,void 0),yield s(this,bt)[bt].addFlags(l),o&&(l.isOUL=!0);var v=de(JSON.stringify(l),s(this,mt)[mt]),g=s(this,kt)[kt].dataPostURL;g=$(g,"type",U),g=$(g,"d",v),yield s(this,bt)[bt].saveAndFireRequest(g,X.blockRequest,o)}}}));return function(t){return e.apply(this,arguments)}}(),Et=function(){var e=t((function*(){X.blockRequest=!1,console.debug("Block request is false"),Q._isLocalStorageSupported()&&[E,D,j,A,R,P].forEach(function(){var e=t((function*(e){yield Q.deleteData("localStorage",e)}));return function(t){return e.apply(this,arguments)}}()),yield Q.deleteData("cookie",R,Y()),yield Q.deleteData("cookie",s(this,St)[St].cookieName,X.broadDomain),yield Q.deleteData("cookie",A,X.broadDomain),yield s(this,St)[St].setSessionCookieObject("")}));return function(){return e.apply(this,arguments)}}(),At=function(){var e=t((function*(){X.blockRequest=!0,s(this,mt)[mt].debug("Block request is true"),X.globalCache={gcookie:null,REQ_N:0,RESP_N:0},Q._isLocalStorageSupported()&&[C,L,E,D,j,A,R,P].forEach(function(){var e=t((function*(e){yield Q.deleteData("localStorage",e)}));return function(t){return e.apply(this,arguments)}}()),yield Q.retrieveData("cookie",C,X.broadDomain),yield Q.retrieveData("cookie",R,Y()),yield Q.retrieveData("cookie",L,Y()),yield Q.retrieveData("cookie",s(this,St)[St].cookieName,X.broadDomain),yield Q.retrieveData("cookie",A,X.broadDomain),s(this,wt)[wt].gcookie=null,yield s(this,St)[St].setSessionCookieObject("")}));return function(){return e.apply(this,arguments)}}(),_t=function(){var e=t((function*(e){if(Array.isArray(e)&&e.length>0){var t=e.pop();if(null!=t&&W(t)&&(null!=t.Site&&Object.keys(t.Site).length>0||null!=t.Facebook&&Object.keys(t.Facebook).length>0||null!=t["Google Plus"]&&Object.keys(t["Google Plus"]).length>0)){yield Q.setInstantDeleteFlagInK();try{yield s(this,Pt)[Pt]([t])}catch(e){s(this,mt)[mt].debug(e)}}else s(this,mt)[mt].error("Profile object is in incorrect format")}}));return function(t){return e.apply(this,arguments)}}(),Nt=1,Tt=2,qt=3,Ut=4,It=n("logLevel"),Mt=n("log"),Ft=n("isLegacyDebug");class Bt{constructor(e){if(Object.defineProperty(this,Ft,{get:Kt,set:void 0}),Object.defineProperty(this,Mt,{value:Gt}),Object.defineProperty(this,It,{writable:!0,value:void 0}),this.wzrkError={},Bt.instance)return Bt.instance;s(this,It)[It]=null==e?Tt:e,this.wzrkError={},Bt.instance=this}static getInstance(e){return Bt.instance||(Bt.instance=new Bt(e)),Bt.instance}get logLevelValue(){return this.logLevel}set logLevelValue(e){this.logLevel=e}error(e){this.logLevelValue>=Nt&&s(this,Mt)[Mt]("error",e)}info(e){this.logLevelValue>=Tt&&s(this,Mt)[Mt]("log",e)}debug(e){(this.logLevelValue>=qt||s(this,Ft)[Ft])&&s(this,Mt)[Mt]("debug",e)}debugShopify(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"web";(this.logLevelValue>=qt||s(this,Ft)[Ft])&&s(this,Mt)[Mt]("debug",e,t)}debugPE(e){s(this,It)[It]>=Ut&&s(this,Mt)[Mt]("debug_pe",e)}reportError(e,t){this.wzrkError.c=e,this.wzrkError.d=t,this.error("".concat(Le," ").concat(e,": ").concat(t))}}var Gt=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"web";try{var o=(new Date).getTime();"shopify_standard_event"===r?(console.log("CleverTap [".concat(o,"]: ")),console.log(JSON.parse(t))):console.log("CleverTap [".concat(o,"]: ").concat(t))}catch(e){}},Kt=function(){return"undefined"!=typeof sessionStorage&&""===sessionStorage.WZRK_D},Wt=n("account"),Jt=n("logger"),xt=n("device"),Zt=n("session"),Ht=n("request");return class{constructor(e){var{browser:t,accountId:r,region:o,targetDomain:i}=e;Object.defineProperty(this,Wt,{writable:!0,value:void 0}),Object.defineProperty(this,Jt,{writable:!0,value:void 0}),Object.defineProperty(this,xt,{writable:!0,value:void 0}),Object.defineProperty(this,Zt,{writable:!0,value:void 0}),Object.defineProperty(this,Ht,{writable:!0,value:void 0}),h.browser=t,h.mode="SHOPIFY",s(this,Jt)[Jt]=new Bt(Tt),s(this,Wt)[Wt]=new b({id:r},o,i),s(this,xt)[xt]=new te({logger:s(this,Jt)[Jt]}),s(this,Zt)[Zt]=new ce({logger:s(this,Jt)[Jt],isPersonalisationActive:()=>!1}),s(this,Ht)[Ht]=new at({logger:s(this,Jt)[Jt],account:s(this,Wt)[Wt],device:s(this,xt)[xt],session:s(this,Zt)[Zt],isPersonalisationActive:()=>!1}),this.event=new pt({logger:s(this,Jt)[Jt],request:s(this,Ht)[Ht],isPersonalisationActive:()=>!1}),this.onUserLogin=new Dt({request:s(this,Ht)[Ht],account:s(this,Wt)[Wt],session:s(this,Zt)[Zt],logger:s(this,Jt)[Jt],device:s(this,xt)[xt]}),Pe.setPrivateProperties({logger:s(this,Jt)[Jt],request:s(this,Ht)[Ht],session:s(this,Zt)[Zt],device:s(this,xt)[xt]})}init(){var e=this;return t((function*(){if(s(e,Jt)[Jt].debug("init called"),s(e,xt)[xt].gcookie=yield s(e,xt)[xt].getGuid(),yield Q.removeCookieAsync("WZRK_P",Y()),!s(e,Wt)[Wt].id)return!1;s(e,Zt)[Zt].cookieName="WZRK_S_"+s(e,Wt)[Wt].id;var t=yield Q.retrieveData("localStorage","WZRK_LOG_LEVEL");t&&(s(e,Jt)[Jt].logLevelValue=t),yield e.pageChanged()}))()}logShopifyEvents(e,t){s(this,Jt)[Jt].debugShopify(e,t)}pageChanged(){var e=this;return t((function*(){var t=h.browser.document.location.href,r=yield s(e,Zt)[Zt].getSessionCookieObject(),o=void 0===r.p?0:r.p;r.p=++o,yield s(e,Zt)[Zt].setSessionCookieObject(r);var i={};(i=yield s(e,Ht)[Ht].addSystemDataToObject(i,void 0)).cpg=t;var a=s(e,Wt)[Wt].dataPostURL,{protocol:n}=h.browser.document.location;n=n.replace(":",""),i.af={protocol:n},a=$(a,"type","page"),a=$(a,"d",de(JSON.stringify(i),s(e,Jt)[Jt])),yield s(e,Ht)[Ht].addFlags(i),yield s(e,Ht)[Ht].saveAndFireRequest(a,X.blockRequest)}))()}}}();
