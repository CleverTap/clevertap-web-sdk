var clevertapShopify=function(){"use strict";function e(e,t,r,o,i,a,n){try{var s=e[a](n),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(o,i)}function t(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var n=t.apply(r,o);function s(t){e(n,i,a,s,l,"next",t)}function l(t){e(n,i,a,s,l,"throw",t)}s(void 0)}))}}var r=0;function o(e){return"__private_"+r+++"_"+e}function i(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var a="clevertap-prod.com",n="https:",s=o("mode"),l=o("browser");var c=new class{constructor(){Object.defineProperty(this,s,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0})}set mode(e){i(this,s)[s]=e}get mode(){return i(this,s)[s]}set browser(e){i(this,l)[l]=e}get browser(){return i(this,l)[l]}},d=o("accountId"),u=o("region"),v=o("targetDomain"),h=o("dcSdkversion");class g{constructor(){var{id:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a;Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:""}),Object.defineProperty(this,v,{writable:!0,value:a}),Object.defineProperty(this,h,{writable:!0,value:""}),this.id=e,t&&(this.region=t),r&&(this.targetDomain=r)}get id(){return i(this,d)[d]}set id(e){i(this,d)[d]=e}get region(){return i(this,u)[u]}set region(e){i(this,u)[u]=e}get dcSDKVersion(){return i(this,h)[h]}set dcSDKVersion(e){i(this,h)[h]=e}get targetDomain(){return i(this,v)[v]}set targetDomain(e){i(this,v)[v]=e}get finalTargetDomain(){return this.region?"".concat(this.region,".").concat(this.targetDomain):this.targetDomain===a?"".concat("eu1",".").concat(this.targetDomain):this.targetDomain}get endpoint(){return"SHOPIFY"===c.mode?"shopifyAppPixel":"a"}get dataPostURL(){return"".concat(n,"//").concat(this.finalTargetDomain,"/").concat(this.endpoint,"?t=96")}get recorderURL(){return"".concat(n,"//").concat(this.finalTargetDomain,"/r?r=1")}get emailURL(){return"".concat(n,"//").concat(this.finalTargetDomain,"/e?r=1")}}var p=new RegExp("^\\s+|\\.|:|\\$|'|\"|\\\\|\\s+$","g"),f=new RegExp("^\\s+|'|\"|\\\\|\\s+$","g"),y=new RegExp("'","g"),b="clear",m="Charged ID",k="WZRK_CHARGED_ID",S="WZRK_G",C="WZRK_K",O="WZRK_CAMP",P="WZRK_EV",w="WZRK_META",L="WZRK_PR",R="WZRK_ARP",A="WZRK_L",E="useIP",j="WZRK_X",D="push",_=31536e3,N="WZRK_FPU",T=["Stayed","UTM Visited","App Launched","Notification Sent","Notification Viewed","Notification Clicked"],M=e=>"string"==typeof e||e instanceof String,I=e=>"[object Object]"===Object.prototype.toString.call(e),U=e=>"object"==typeof e&&e instanceof Date,q=e=>{for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},F=e=>!isNaN(parseFloat(e))&&isFinite(e),B=e=>null!=e&&"undefined"!==e,G=(e,t)=>{var r;if("object"!=typeof e)return M(e)?(r=W(e,f)).length>1024&&(r=r.substring(0,1024),t.reportError(521,r+"... length exceeded 1024 chars. Trimmed.")):r=e,r;for(var o in e)if(e.hasOwnProperty(o)){var i=G(e[o],t),a=void 0;(a=W(o,p)).length>1024&&(a=a.substring(0,1024),t.reportError(520,a+"... length exceeded 1024 chars. Trimmed.")),delete e[o],e[a]=i}return e},W=(e,t)=>e.replace(t,"");var K=(e,t,r)=>e+"&"+t+"="+encodeURIComponent(r),x=()=>"SHOPIFY"===c.mode?c.browser.document.location.hostname:window.location.hostname;class J extends class{static saveAsync(e,r){return t((function*(){if(!e||!r)return!1;try{return yield c.browser.localStorage.setItem(e,"string"==typeof r?r:JSON.stringify(r)),!0}catch(e){return!1}}))()}static readAsync(e){return t((function*(){if(!e)return!1;var t=null;try{t=yield c.browser.localStorage.getItem(e)}catch(e){}if(null!=t)try{t=JSON.parse(t)}catch(e){}return t}))()}static removeAsync(e){return t((function*(){if(!e)return!1;try{return yield c.browser.localStorage.removeItem(e),!0}catch(e){return!1}}))()}static createCookieAsync(e,r,o,i){return t((function*(){var t="",a="";if(o){var n=new Date;n.setTime(n.getTime()+1e3*o),t="; expires="+n.toGMTString()}i&&(a="; domain="+i),r=encodeURIComponent(r);try{return yield c.browser.cookie.set(e,r+t+a+"; path=/"),!0}catch(e){return!1}}))()}static readCookieAsync(e){return t((function*(){var t;try{t=yield c.browser.cookie.get(e)}catch(e){t=null}return""===t?null:decodeURIComponent(t)}))()}static removeCookieAsync(e,r){return t((function*(){var t=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;";r&&(t=t+" domain="+r+"; path=/");try{return yield c.browser.cookie.set(t),!0}catch(e){return!1}}))()}}{static save(e,t){return!(!e||!t)&&(this._isLocalStorageSupported()?(localStorage.setItem(e,"string"==typeof t?t:JSON.stringify(t)),!0):void 0)}static read(e){if(!e)return!1;var t=null;if(this._isLocalStorageSupported()&&(t=localStorage.getItem(e)),null!=t)try{t=JSON.parse(t)}catch(e){}return t}static remove(e){return!!e&&(this._isLocalStorageSupported()?(localStorage.removeItem(e),!0):void 0)}static removeCookie(e,t){var r=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;";t&&(r=r+" domain="+t+"; path=/"),document.cookie=r}static createCookie(e,t,r,o){var i="",a="";if(r){var n=new Date;n.setTime(n.getTime()+1e3*r),i="; expires="+n.toGMTString()}o&&(a="; domain="+o),t=encodeURIComponent(t),document.cookie=e+"="+t+i+a+"; path=/"}static readCookie(e){for(var t=e+"=",r=document.cookie.split(";"),o=0;o<r.length;o++){for(var i=r[o];" "===i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return null}static _isLocalStorageSupported(){return"SHOPIFY"===c.mode||"localStorage"in window&&null!==window.localStorage&&"function"==typeof window.localStorage.setItem}static saveToLSorCookie(e,r){var o=this;return t((function*(){if(null!=r)try{o._isLocalStorageSupported()?yield o.addData("localStorage",e,encodeURIComponent(JSON.stringify(r))):e===S?yield o.addData("cookie",e,encodeURIComponent(r),0,x()):yield o.addData("cookie",e,encodeURIComponent(JSON.stringify(r)),0,x()),H.globalCache[e]=r}catch(e){}}))()}static readFromLSorCookie(e){var r=this;return t((function*(){var t;if(H.globalCache.hasOwnProperty(e))return H.globalCache[e];if(null!=(t=r._isLocalStorageSupported()?yield r.retrieveData("localStorage",e):yield r.retrieveData("cookie",e))&&("function"!=typeof t.trim||""!==t.trim())){var o;try{o=JSON.parse(decodeURIComponent(t))}catch(e){o=decodeURIComponent(t)}return H.globalCache[e]=o,o}}))()}static createBroadCookie(e,r,o,i){var a=this;return t((function*(){if(i){var t=H.broadDomain;if(null==t)for(var n=i.split("."),s="",l=n.length-1;l>=0;l--){if(s=0===l?n[l]+s:"."+n[l]+s,yield a.retrieveData("cookie",e)){var c="test_"+e+l;if(yield a.addData("cookie",c,r,10,s),!(yield a.retrieveData("cookie",c)))continue;yield a.deleteData("cookie",c,s)}if(yield a.addData("cookie",e,r,o,s),(yield a.retrieveData("cookie",e))==r){t=s,H.broadDomain=t;break}}else yield a.addData("cookie",e,r,o,t)}else yield a.addData("cookie",e,r,o,i)}))()}static getMetaProp(e){var r=this;return t((function*(){var t=yield r.readFromLSorCookie(w);if(null!=t)return t[e]}))()}static setMetaProp(e,r){var o=this;return t((function*(){if(o._isLocalStorageSupported()){var t=yield o.readFromLSorCookie(w);null==t&&(t={}),void 0===r?delete t[e]:t[e]=r,yield o.saveToLSorCookie(w,t)}}))()}static getAndClearMetaProp(e){var r=this;return t((function*(){var t=yield r.getMetaProp(e);return yield r.setMetaProp(e,void 0),t}))()}static setInstantDeleteFlagInK(){var e=this;return t((function*(){var t=yield e.readFromLSorCookie(C);null==t&&(t={}),t.flag=!0,yield e.saveToLSorCookie(C,t)}))()}static backupEvent(e,r,o){var i=this;return t((function*(){var t=yield i.readFromLSorCookie(A);void 0===t&&(t={}),t[r]={q:e},yield i.saveToLSorCookie(A,t),o.debug("stored in ".concat(A," reqNo : ").concat(r," -> ").concat(e))}))()}static removeBackup(e,r){var o=this;return t((function*(){var t=yield o.readFromLSorCookie(A);null!=t&&void 0!==t[e]&&(r.debug("del event: ".concat(e," data-> ").concat(t[e].q)),delete t[e],yield o.saveToLSorCookie(A,t))}))()}static retrieveData(e,r){var o=this;return t((function*(){var t;switch(e){case"cookie":t="WEB"===c.mode?o.readCookie(r):yield o.readCookieAsync(r);break;case"localStorage":t="WEB"===c.mode?o.read(r):yield o.readAsync(r)}return t}))()}static addData(e,r,o,i,a){var n=this;return t((function*(){switch(e){case"cookie":"WEB"===c.mode?n.createCookie(r,o,i,a):yield n.createCookieAsync(r,o,i,a);break;case"localStorage":"WEB"===c.mode?n.save(r,o):yield n.saveAsync(r,o)}}))()}static deleteData(e,r,o){var i=this;return t((function*(){switch(e){case"cookie":"WEB"===c.mode?i.removeCookie(r):yield i.removeCookieAsync(r,o);break;case"localStorage":"WEB"===c.mode?i.remove(r):yield i.removeAsync(r)}}))()}}var H={globalCache:{gcookie:null,REQ_N:0,RESP_N:0},LRU_CACHE:null,globalProfileMap:void 0,globalEventsMap:void 0,blockRequest:!1,isOptInRequest:!1,broadDomain:null,webPushEnabled:null,campaignDivMap:{},currentSessionId:null,wiz_counter:0,notifApi:{notifEnabledFromApi:!1},unsubGroups:[],updatedCategoryLong:null,inbox:null,isPrivacyArrPushed:!1,privacyArray:[],offline:!1,location:null,dismissSpamControl:!1,globalUnsubscribe:!0,flutterVersion:null},z=o("logger");class Z{constructor(e){var{logger:t}=e;Object.defineProperty(this,z,{writable:!0,value:void 0}),this.gcookie=void 0,i(this,z)[z]=t}getGuid(){var e=this;return t((function*(){var t=null;if(B(e.gcookie))return e.gcookie;if(J._isLocalStorageSupported()){var r=yield J.retrieveData("localStorage",S);if(B(r)){try{t=JSON.parse(decodeURIComponent(r))}catch(o){i(e,z)[z].debug("Cannot parse Gcookie from localstorage - must be encoded "+r),32===r.length?(t=r,yield J.saveToLSorCookie(S,r)):i(e,z)[z].error("Illegal guid "+r)}B(t)&&(yield J.createBroadCookie(S,t,_,x()))}}return B(t)||(t=yield J.retrieveData("cookie",S),!B(t)||0!==t.indexOf("%")&&0!==t.indexOf("'")&&0!==t.indexOf('"')||(t=null),B(t)&&(yield J.saveToLSorCookie(S,t))),t}))()}}var V=()=>Math.floor((new Date).getTime()/1e3),$=e=>"$D_"+Math.round(e.getTime()/1e3),Y=e=>{if(Q(e))return"$D_"+e},Q=e=>{var t=/^(\d{4})(\d{2})(\d{2})$/.exec(e);if(null==t)return!1;var r=t[3],o=t[2]-1,i=t[1],a=new Date(i,o,r);return a.getDate()==r&&a.getMonth()==o&&a.getFullYear()==i},X=o("logger"),ee=o("sessionId"),te=o("isPersonalisationActive");class re{constructor(e){var{logger:t,isPersonalisationActive:r}=e;Object.defineProperty(this,X,{writable:!0,value:void 0}),Object.defineProperty(this,ee,{writable:!0,value:void 0}),Object.defineProperty(this,te,{writable:!0,value:void 0}),this.cookieName=void 0,this.scookieObj=void 0,this.sessionId=J.getMetaProp("cs"),i(this,X)[X]=t,i(this,te)[te]=r}get sessionId(){return i(this,ee)[ee]}set sessionId(e){i(this,ee)[ee]=e}getSessionCookieObject(){var e=this;return t((function*(){var t=yield J.retrieveData("cookie",e.cookieName),r={};if(null!=t)if(t=t.replace(y,'"'),r=JSON.parse(t),I(r)){if(void 0!==r.t){var o=r.t;V()-o>1260&&(r={})}}else r={};return e.scookieObj=r,r}))()}setSessionCookieObject(e){var r=this;return t((function*(){var t=JSON.stringify(e);yield J.createBroadCookie(r.cookieName,t,1200,x())}))()}manageSession(e){var r=this;return t((function*(){if(void 0===r.sessionId||r.sessionId!==e){var t=J.getMetaProp("cs");if(void 0===t)yield J.setMetaProp("ps",e),yield J.setMetaProp("cs",e),yield J.setMetaProp("sc",1);else if(t!==e){yield J.setMetaProp("ps",t),yield J.setMetaProp("cs",e);var o=J.getMetaProp("sc");void 0===o&&(o=0),yield J.setMetaProp("sc",o+1)}r.sessionId=e}}))()}getTimeElapsed(){var e=this;return t((function*(){if(i(e,te)[te]()){null!=e.scookieObj&&(e.scookieObj=yield e.getSessionCookieObject());var t=e.scookieObj.s;if(null!=t){var r=V();return Math.floor(r-t)}}}))()}getPageCount(){var e=this;return t((function*(){if(i(e,te)[te]())return null!=e.scookieObj&&(e.scookieObj=yield e.getSessionCookieObject()),e.scookieObj.p}))()}}var oe=(e,t)=>(t&&"function"==typeof t.debug&&t.debug("dobj:"+e),ae(e)),ie=(()=>{var e="",t=0;for(t=0;t<=25;t++)e+=String.fromCharCode(t+65);for(t=0;t<=25;t++)e+=String.fromCharCode(t+97);for(t=0;t<10;t++)e+=t;return e+"+/="})(),ae=e=>{if(null==e)return"";var t,r,o,i,a,n,s,l="",c=0;for(e=(e=>{if(null==e)return"";var t,r,o,i={},a={},n="",s="",l="",c=2,d=3,u=2,v="",h=0,g=0,p=String.fromCharCode;for(o=0;o<e.length;o+=1)if(n=e.charAt(o),Object.prototype.hasOwnProperty.call(i,n)||(i[n]=d++,a[n]=!0),s=l+n,Object.prototype.hasOwnProperty.call(i,s))l=s;else{if(Object.prototype.hasOwnProperty.call(a,l)){if(l.charCodeAt(0)<256){for(t=0;t<u;t++)h<<=1,15==g?(g=0,v+=p(h),h=0):g++;for(r=l.charCodeAt(0),t=0;t<8;t++)h=h<<1|1&r,15==g?(g=0,v+=p(h),h=0):g++,r>>=1}else{for(r=1,t=0;t<u;t++)h=h<<1|r,15==g?(g=0,v+=p(h),h=0):g++,r=0;for(r=l.charCodeAt(0),t=0;t<16;t++)h=h<<1|1&r,15==g?(g=0,v+=p(h),h=0):g++,r>>=1}0==--c&&(c=Math.pow(2,u),u++),delete a[l]}else for(r=i[l],t=0;t<u;t++)h=h<<1|1&r,15==g?(g=0,v+=p(h),h=0):g++,r>>=1;0==--c&&(c=Math.pow(2,u),u++),i[s]=d++,l=String(n)}if(""!==l){if(Object.prototype.hasOwnProperty.call(a,l)){if(l.charCodeAt(0)<256){for(t=0;t<u;t++)h<<=1,15==g?(g=0,v+=p(h),h=0):g++;for(r=l.charCodeAt(0),t=0;t<8;t++)h=h<<1|1&r,15==g?(g=0,v+=p(h),h=0):g++,r>>=1}else{for(r=1,t=0;t<u;t++)h=h<<1|r,15==g?(g=0,v+=p(h),h=0):g++,r=0;for(r=l.charCodeAt(0),t=0;t<16;t++)h=h<<1|1&r,15==g?(g=0,v+=p(h),h=0):g++,r>>=1}0==--c&&(c=Math.pow(2,u),u++),delete a[l]}else for(r=i[l],t=0;t<u;t++)h=h<<1|1&r,15==g?(g=0,v+=p(h),h=0):g++,r>>=1;0==--c&&(c=Math.pow(2,u),u++)}for(r=2,t=0;t<u;t++)h=h<<1|1&r,15==g?(g=0,v+=p(h),h=0):g++,r>>=1;for(;;){if(h<<=1,15==g){v+=p(h);break}g++}return v})(e);c<2*e.length;)c%2==0?(t=e.charCodeAt(c/2)>>8,r=255&e.charCodeAt(c/2),o=c/2+1<e.length?e.charCodeAt(c/2+1)>>8:NaN):(t=255&e.charCodeAt((c-1)/2),(c+1)/2<e.length?(r=e.charCodeAt((c+1)/2)>>8,o=255&e.charCodeAt((c+1)/2)):r=o=NaN),c+=3,i=t>>2,a=(3&t)<<4|r>>4,n=(15&r)<<2|o>>6,s=63&o,isNaN(r)?n=s=64:isNaN(o)&&(s=64),l=l+ie.charAt(i)+ie.charAt(a)+ie.charAt(n)+ie.charAt(s);return l},ne=o("keyOrder"),se=o("deleteFromObject");class le{constructor(e){Object.defineProperty(this,se,{value:ce}),Object.defineProperty(this,ne,{writable:!0,value:void 0}),this.max=e}init(){var e=this;return t((function*(){var t=yield J.readFromLSorCookie(j);if(t){var r={};for(var o in i(e,ne)[ne]=[],t=t.cache)t.hasOwnProperty(o)&&(r[t[o][0]]=t[o][1],i(e,ne)[ne].push(t[o][0]));e.cache=r}else e.cache={},i(e,ne)[ne]=[]}))()}get(e){var r=this;return t((function*(){var t=r.cache[e];return t&&(r.cache=i(r,se)[se](e,r.cache),r.cache[e]=t,i(r,ne)[ne].push(e)),yield r.saveCacheToLS(r.cache),t}))()}set(e,r){var o=this;return t((function*(){var t=o.cache[e],a=i(o,ne)[ne];null!=t?o.cache=i(o,se)[se](e,o.cache):a.length===o.max&&(o.cache=i(o,se)[se](a[0],o.cache)),o.cache[e]=r,i(o,ne)[ne][i(o,ne)[ne]-1]!==e&&i(o,ne)[ne].push(e),yield o.saveCacheToLS(o.cache)}))()}saveCacheToLS(e){var r=this;return t((function*(){var t=[],o=i(r,ne)[ne];for(var a in o)if(o.hasOwnProperty(a)){var n=[];n.push(o[a]),n.push(e[o[a]]),t.push(n)}yield J.saveToLSorCookie(j,{cache:t})}))()}getKey(e){if(null===e)return null;var t=i(this,ne)[ne];for(var r in t)if(t.hasOwnProperty(r)&&this.cache[t[r]]===e)return t[r];return null}getSecondLastKey(){var e=i(this,ne)[ne];return null!=e&&e.length>1?e[e.length-2]:-1}getLastKey(){var e=i(this,ne)[ne].length;if(e)return i(this,ne)[ne][e-1]}}var ce=function(e,t){var r,o=JSON.parse(JSON.stringify(i(this,ne)[ne])),a={};for(var n in o)o.hasOwnProperty(n)&&(o[n]!==e?a[o[n]]=t[o[n]]:r=n);return o.splice(r,1),i(this,ne)[ne]=JSON.parse(JSON.stringify(o)),a},de=o("isOULInProgress"),ue=o("oulReqN");var ve=new class{constructor(){Object.defineProperty(this,de,{writable:!0,value:void 0}),Object.defineProperty(this,ue,{writable:!0,value:void 0})}get isOULInProgress(){return"WEB"===c.mode?window.isOULInProgress:i(this,de)[de]}set isOULInProgress(e){"WEB"!==c.mode?i(this,de)[de]=e:window.isOULInProgress=e}get oulReqN(){return"WEB"===c.mode?window.oulReqN:i(this,ue)[ue]}set oulReqN(e){"WEB"!==c.mode?i(this,ue)[ue]=e:window.oulReqN=e}},he=o("logger"),ge=o("request"),pe=o("device"),fe=o("session");var ye=new class{constructor(e){Object.defineProperty(this,he,{writable:!0,value:void 0}),Object.defineProperty(this,ge,{writable:!0,value:void 0}),Object.defineProperty(this,pe,{writable:!0,value:void 0}),Object.defineProperty(this,fe,{writable:!0,value:void 0}),this.setPrivateProperties(e)}setPrivateProperties(e){var{logger:t,request:r,device:o,session:a}=e;i(this,he)[he]=t,i(this,ge)[ge]=r,i(this,pe)[pe]=o,i(this,fe)[fe]=a}s(e,r,o,a,n){var s=this;return t((function*(){var t=!1,l=!1;if(ve.isOULInProgress&&(o||"undefined"!==a&&Number(a)===ve.oulReqN)&&(ve.isOULInProgress=!1,t=!0),void 0===a&&(a=0),yield J.removeBackup(Number(a),i(s,he)[he]),!(Number(a)>H.globalCache.REQ_N)){if(B(i(s,pe)[pe].gcookie)||e&&(l=!0),!B(i(s,pe)[pe].gcookie)||o||"boolean"==typeof n){var c=yield i(s,fe)[fe].getSessionCookieObject();if(ve.isOULInProgress||c.s&&r<c.s)return;if(i(s,he)[he].debug("Cookie was ".concat(i(s,pe)[pe].gcookie," set to ").concat(e)),i(s,pe)[pe].gcookie=e,B(i(s,pe)[pe].gcookie)||(yield J.getAndClearMetaProp(E)),e&&J._isLocalStorageSupported()){null==H.LRU_CACHE&&(H.LRU_CACHE=new le(100),yield H.LRU_CACHE.init());var d,u=yield J.readFromLSorCookie(C);null!=u&&u.id&&(d=H.LRU_CACHE.cache[u.id],o&&(d||(yield J.saveToLSorCookie(N,!0),H.LRU_CACHE.set(u.id,e)))),yield J.saveToLSorCookie(S,e);var v=H.LRU_CACHE.getSecondLastKey();if((yield J.readFromLSorCookie(N))&&-1!==v){var h=H.LRU_CACHE.cache[v];i(s,ge)[ge].unregisterTokenForGuid(h)}}yield J.createBroadCookie(S,e,_,x()),yield J.saveToLSorCookie(S,e)}J._isLocalStorageSupported()&&(yield i(s,fe)[fe].manageSession(r));var g=yield i(s,fe)[fe].getSessionCookieObject();(void 0===g.s||g.s<=r)&&(g.s=r,g.t=V(),i(s,fe)[fe].setSessionCookieObject(g)),B(i(s,pe)[pe].gcookie)&&(H.blockRequest=!1),!t&&!l||i(s,ge)[ge].processingBackup||i(s,ge)[ge].processBackupEvents(),H.globalCache.RESP_N=Number(a)}}))()}}({logger:"",request:"",device:"",session:""}),be="This property has been ignored.",me="CleverTap error:",ke="".concat(me," Event structure not valid. ").concat(be),Se="".concat(me," Gender value should be either M or F. ").concat(be),Ce="".concat(me," Employed value should be either Y or N. ").concat(be),Oe="".concat(me," Married value should be either Y or N. ").concat(be),Pe="".concat(me," Education value should be either School, College or Graduate. ").concat(be),we="".concat(me," Age value should be a number. ").concat(be),Le="".concat(me," DOB value should be a Date Object"),Re="".concat(me," Phone number should be formatted as +[country code][number]"),Ae=()=>{var e=JSON.parse(decodeURIComponent(J.read(S))),t={};if(J._isLocalStorageSupported()){t=(()=>{var e={};if(J._isLocalStorageSupported()){var t=J.read(O);null!=t?(t=JSON.parse(decodeURIComponent(t).replace(y,'"'))).hasOwnProperty("global")?e.wp=t:e=t:e={}}return e})();var r=J.read("WZRK_CAMP_G"),o=r?decodeURIComponent(r):null,i=o?JSON.parse(o):null,a=e&&null!=r&&i&&i[e]&&i[e].wp?Object.values(i[e].wp):[],n=e&&null!=r&&i&&i[e]&&i[e].wi?Object.values(i[e].wi):[],s=(()=>{var e=new Date;return e.getFullYear()+""+e.getMonth()+e.getDay()})(),l=0,c=0;return t.wp&&t.wp[s]&&"undefined"!==t.wp[s].tc&&(l=t.wp[s].tc),t.wi&&t.wi[s]&&"undefined"!==t.wi[s].tc&&(c=t.wi[s].tc),{wmp:l,wimp:c,tlc:a,witlc:n}}},Ee=(e,t)=>{var{logger:r}=t,o=!1;if(I(e))for(var i in e)if(e.hasOwnProperty(i)){o=!0;var a=e[i];if(null==a){delete e[i];continue}"Gender"!==i||a.match(/^M$|^F$/)||(o=!1,r.error(Se)),"Employed"!==i||a.match(/^Y$|^N$/)||(o=!1,r.error(Ce)),"Married"!==i||a.match(/^Y$|^N$/)||(o=!1,r.error(Oe)),"Education"!==i||a.match(/^School$|^College$|^Graduate$/)||(o=!1,r.error(Pe)),"Age"===i&&null!=a&&(F(a)?e.Age=+a:(o=!1,r.error(we))),"DOB"===i?(/^\$D_/.test(a)&&11===(a+"").length||U(a)||(o=!1,r.error(Le)),U(a)&&(e[i]=$(a))):U(a)&&(e[i]=$(a)),"Phone"!==i||q(a)||(a.length>8&&"+"===a.charAt(0)?(a=a.substring(1,a.length),F(a)?e.Phone=+a:(o=!1,r.error(Re+". Removed."))):(o=!1,r.error(Re+". Removed."))),o||delete e[i]}return o},je=e=>{var t={};t.Name=e.name,null!=e.id&&(t.FBID=e.id+""),"male"===e.gender?t.Gender="M":"female"===e.gender?t.Gender="F":t.Gender="O";null!=e.relationship_status&&(t.Married="N","Married"===e.relationship_status&&(t.Married="Y"));var r=function(e){if(null!=e){for(var t="",r="",o=0;o<e.length;o++){var i=e[o];if(null!=i.type){var a=i.type;if("Graduate School"===a)return"Graduate";"College"===a?t="1":"High School"===a&&(r="1")}}if("1"===t)return"College";if("1"===r)return"School"}}(e.education);null!=r&&(t.Education=r);var o=null!=e.work?e.work.length:0;if(t.Employed=o>0?"Y":"N",null!=e.email&&(t.Email=e.email),null!=e.birthday){var i=e.birthday.split("/");t.DOB=Y(i[2]+i[0]+i[1])}return t},De=(e,t)=>{var{logger:r}=t,o={};if(null!=e.displayName&&(o.Name=e.displayName),null!=e.id&&(o.GPID=e.id+""),null!=e.gender&&("male"===e.gender?o.Gender="M":"female"===e.gender?o.Gender="F":"other"===e.gender&&(o.Gender="O")),null!=e.image&&!1===e.image.isDefault&&(o.Photo=e.image.url.split("?sz")[0]),null!=e.emails)for(var i=0;i<e.emails.length;i++){var a=e.emails[i];"account"===a.type&&(o.Email=a.value)}if(null!=e.organizations){o.Employed="N";for(var n=0;n<e.organizations.length;n++){"work"===e.organizations[n].type&&(o.Employed="Y")}}if(null!=e.birthday){var s=e.birthday.split("-");o.DOB=Y(s[0]+s[1]+s[2])}return null!=e.relationshipStatus&&(o.Married="N","married"===e.relationshipStatus&&(o.Married="Y")),r.debug("gplus usr profile "+JSON.stringify(o)),o},_e=function(){var e=t((function*(e,t){if(J._isLocalStorageSupported()){if(null==H.globalProfileMap&&(H.globalProfileMap=yield J.readFromLSorCookie(L),null==H.globalProfileMap&&(H.globalProfileMap={})),null!=e._custom){var r=e._custom;for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);delete e._custom}for(var i in e)if(e.hasOwnProperty(i)){if(H.globalProfileMap.hasOwnProperty(i)&&!t)continue;H.globalProfileMap[i]=e[i]}null!=H.globalProfileMap._custom&&delete H.globalProfileMap._custom,yield J.saveToLSorCookie(L,H.globalProfileMap)}}));return function(t,r){return e.apply(this,arguments)}}(),Ne=function(){var e=t((function*(e){if(null!=e.skipResARP&&e.skipResARP)return console.debug("Update ARP Request rejected",e),null;var t=!0===e.isOUL;if(J._isLocalStorageSupported())try{var r=yield J.readFromLSorCookie(R);if(null==r||t){for(var o in r={},e)e.hasOwnProperty(o)&&(-1===e[o]?delete r[o]:r[o]=e[o]);yield J.saveToLSorCookie(R,r)}}catch(e){console.error("Unable to parse ARP JSON: "+e)}}));return function(t){return e.apply(this,arguments)}}(),Te=o("fireRequest"),Me=o("dropRequestDueToOptOut"),Ie=o("addUseIPToRequest"),Ue=o("addARPToRequest");class qe{static processResponse(e){return t((function*(){e.arp&&(yield Ne(e.arp)),e.meta&&(yield ye.s(e.meta.g,e.meta.sid,e.meta.rf,e.meta.rn))}))()}static fireRequest(e,r,o){var a=this;return t((function*(){yield i(a,Te)[Te](e,1,r,o)}))()}}var Fe=function(){var e=t((function*(e,t){if(!0===t){var r={skipResARP:!0};return K(e,"arp",oe(JSON.stringify(r),this.logger))}var o=yield J.readFromLSorCookie(R);return null!=o?K(e,"arp",oe(JSON.stringify(o),this.logger)):e}));return function(t,r){return e.apply(this,arguments)}}(),Be=function(){var e=t((function*(e){var t=yield J.getMetaProp(E);return"boolean"!=typeof t&&(t=!1),K(e,E,t?"true":"false")}));return function(t){return e.apply(this,arguments)}}(),Ge=function(){var e=t((function*(e,r,o,a){var n=this;if(i(this,Me)[Me]())this.logger.debug("req dropped due to optout cookie: "+this.device.gcookie);else if(B(this.device.gcookie)||(H.blockRequest=!0),!B(this.device.gcookie)&&H.globalCache.RESP_N<H.globalCache.REQ_N-1&&r<200)setTimeout(t((function*(){n.logger.debug("retrying fire request for url: ".concat(e,", tries: ").concat(r)),yield i(n,Te)[Te](e,r+1,o,a)})),50);else{if(a?ve.isOULInProgress=!0:(B(this.device.gcookie)&&(e=K(e,"gc",this.device.gcookie)),e=yield i(this,Ue)[Ue](e,o)),e=K(e,"tries",r),e=yield i(this,Ie)[Ie](e),-1!==(e=K(e,"r",(new Date).getTime())).indexOf("chrome-extension:")&&(e=e.replace("chrome-extension:","https:")),"WEB"===c.mode){var s,l;if((null===(s=window.clevertap)||void 0===s?void 0:s.hasOwnProperty("plugin"))||(null===(l=window.wizrocket)||void 0===l?void 0:l.hasOwnProperty("plugin"))){var d=window.clevertap.plugin||window.wizrocket.plugin;e=K(e,"ct_pl",d)}for(var u=document.getElementsByClassName("ct-jp-cb");u[0]&&u[0].parentNode;)u[0].parentNode.removeChild(u[0]);var v=document.createElement("script");v.setAttribute("type","text/javascript"),v.setAttribute("src",e),v.setAttribute("class","ct-jp-cb"),v.setAttribute("rel","nofollow"),v.async=!0,document.getElementsByTagName("head")[0].appendChild(v)}else fetch(e,{headers:{accept:"application/json"}}).then((e=>e.json())).then(this.processResponse);this.logger.debug("req snt -> url: "+e)}}));return function(t,r,o,i){return e.apply(this,arguments)}}();qe.logger=void 0,qe.device=void 0,qe.mode=void 0,qe.api=void 0,Object.defineProperty(qe,Te,{value:Ge}),Object.defineProperty(qe,Me,{value:function(){return!H.isOptInRequest&&B(this.device.gcookie)&&M(this.device.gcookie)?":OO"===this.device.gcookie.slice(-3):(H.isOptInRequest=!1,!1)}}),Object.defineProperty(qe,Ie,{value:Be}),Object.defineProperty(qe,Ue,{value:Fe});var We=0,Ke=0,xe=o("logger"),Je=o("account"),He=o("device"),ze=o("session"),Ze=o("isPersonalisationActive"),Ve=o("clearCookie"),$e=o("addToLocalEventMap");class Ye{constructor(e){var{logger:t,account:r,device:o,session:a,isPersonalisationActive:n}=e;Object.defineProperty(this,$e,{value:Xe}),Object.defineProperty(this,xe,{writable:!0,value:void 0}),Object.defineProperty(this,Je,{writable:!0,value:void 0}),Object.defineProperty(this,He,{writable:!0,value:void 0}),Object.defineProperty(this,ze,{writable:!0,value:void 0}),Object.defineProperty(this,Ze,{writable:!0,value:void 0}),Object.defineProperty(this,Ve,{writable:!0,value:!1}),this.processingBackup=!1,i(this,xe)[xe]=t,i(this,Je)[Je]=r,i(this,He)[He]=o,i(this,ze)[ze]=a,i(this,Ze)[Ze]=n,qe.logger=t,qe.device=o}processBackupEvents(){var e=J.readFromLSorCookie(A);if(null!=e){for(var t in this.processingBackup=!0,e)if(e.hasOwnProperty(t)){var r=e[t];void 0===r.fired&&(i(this,xe)[xe].debug("Processing backup event : "+r.q),void 0!==r.q&&qe.fireRequest(r.q),r.fired=!0)}J.saveToLSorCookie(A,e),this.processingBackup=!1}}addSystemDataToObject(e,r){var o=this;return t((function*(){void 0===r&&(e=G(e,i(o,xe)[xe])),q(i(o,xe)[xe].wzrkError)||(e.wzrk_error=i(o,xe)[xe].wzrkError,i(o,xe)[xe].wzrkError={}),e.id=i(o,Je)[Je].id,B(i(o,He)[He].gcookie)&&(e.g=i(o,He)[He].gcookie);var t=yield i(o,ze)[ze].getSessionCookieObject();return e.s=t.s,e.pg=void 0===t.p?1:t.p,"object"==typeof sessionStorage&&sessionStorage.hasOwnProperty("WZRK_D")&&(e.debug=!0),e}))()}addSystemDataToProfileObject(e,r){var o=this;return t((function*(){var t;q(i(o,xe)[xe].wzrkError)||(e.wzrk_error=i(o,xe)[xe].wzrkError,i(o,xe)[xe].wzrkError={}),e.id=i(o,Je)[Je].id,B(i(o,He)[He].gcookie)&&(e.g=i(o,He)[He].gcookie);var r=yield i(o,ze)[ze].getSessionCookieObject();return e.s=r.s,e.pg=void 0===r.p?1:r.p,(null===(t=sessionStorage)||void 0===t?void 0:t.hasOwnProperty("WZRK_D"))&&(e.debug=!0),e}))()}addFlags(e){var r=this;return t((function*(){if(i(r,Ve)[Ve]=yield J.getAndClearMetaProp(b),void 0!==i(r,Ve)[Ve]&&i(r,Ve)[Ve]&&(e.rc=!0,i(r,xe)[xe].debug("reset cookie sent in request and cleared from meta for future requests.")),i(r,Ze)[Ze]()){var t=yield J.getMetaProp("lsTime"),o=yield J.getMetaProp("exTs");if(void 0===t||void 0===o)return void(e.dsync=!0);t+o<V()&&(e.dsync=!0)}}))()}saveAndFireRequest(e,r,o){var a=this;return t((function*(){var t=V(),n=(e=K(e,"rn",++H.globalCache.REQ_N))+"&i="+t+"&sn="+We;r&&(void 0===i(a,Ve)[Ve]||!i(a,Ve)[Ve])||ve.isOULInProgress?i(a,xe)[xe].debug("Not fired due to override - ".concat(H.blockRequest," or clearCookie - ").concat(i(a,Ve)[Ve]," or OUL request in progress - ").concat(ve.isOULInProgress)):(t===Ke?We++:(Ke=t,We=0),ve.oulReqN=H.globalCache.REQ_N,yield qe.fireRequest(n,!1,o))}))()}unregisterTokenForGuid(e){var r=this;return t((function*(){var t=yield J.readFromLSorCookie("WZRK_PSD");if(t){var o={type:"data"};B(e)&&(o.g=e),o.action="unregister",o.id=i(r,Je)[Je].id;var a=yield i(r,ze)[ze].getSessionCookieObject();o.s=a.s;var n=oe(JSON.stringify(o),i(r,xe)[xe]),s=i(r,Je)[Je].dataPostURL;s=K(s,"type","data"),s=K(s,"d",n),yield qe.fireRequest(s,!0),yield J.saveToLSorCookie(N,!1)}yield r.registerToken(t)}))()}registerToken(e){var r=this;return t((function*(){if(e){e=yield r.addSystemDataToObject(e,!0),e=JSON.stringify(e);var t=i(r,Je)[Je].dataPostURL;t=K(t,"type","data"),t=K(t,"d",oe(e,i(r,xe)[xe])),yield qe.fireRequest(t),J.addData("localStorage","WZRK_WPR","ok")}}))()}processEvent(e){var r=this;return t((function*(){yield i(r,$e)[$e](e.evtName),e=r.addSystemDataToObject(e,void 0),r.addFlags(e),e[O]=Ae();var t=oe(JSON.stringify(e),i(r,xe)[xe]),o=i(r,Je)[Je].dataPostURL;o=K(o,"type",D),o=K(o,"d",t),yield r.saveAndFireRequest(o,H.blockRequest)}))()}}var Qe,Xe=function(){var e=t((function*(e){if(J._isLocalStorageSupported()){void 0===H.globalEventsMap&&(H.globalEventsMap=yield J.readFromLSorCookie(P),void 0===H.globalEventsMap&&(H.globalEventsMap={}));var t=V(),r=H.globalEventsMap[e];void 0!==r?(r[2]=t,r[0]++):((r=[]).push(1),r.push(t),r.push(t)),H.globalEventsMap[e]=r,yield J.saveToLSorCookie(P,H.globalEventsMap)}}));return function(t){return e.apply(this,arguments)}}(),et=e=>{if(I(e)){for(var t in e)if(e.hasOwnProperty(t)){if(I(e[t])||Array.isArray(e[t]))return!1;U(e[t])&&(e[t]=$(e[t]))}return!0}return!1},tt=function(){var e=t((function*(e,t){if(I(e)){for(var r in e)if(e.hasOwnProperty(r))if("Items"===r){if(!Array.isArray(e[r]))return!1;for(var o in e[r].length>50&&t.reportError(522,"Charged Items exceed 50 limit. Actual count: "+e[r].length),e[r])if(e[r].hasOwnProperty(o)&&(!I(e[r][o])||!et(e[r][o])))return!1}else{if(I(e[r])||Array.isArray(e[r]))return!1;U(e[r])&&(e[r]=$(e[r]))}if(M(e[m])||(a=e[m],/^-?[\d.]+(?:e-?\d+)?$/.test(a)&&"number"==typeof a)){var i=e[m]+"";if(void 0===Qe&&(Qe=yield J.readFromLSorCookie(k)),void 0!==Qe&&Qe.trim()===i.trim())return t.error("Duplicate charged Id - Dropped"+e),!1;Qe=i,yield J.saveToLSorCookie(k,i)}return!0}var a;return!1}));return function(t,r){return e.apply(this,arguments)}}(),rt=o("logger"),ot=o("oldValues"),it=o("request"),at=o("isPersonalisationActive"),nt=o("processEventArray");class st extends Array{constructor(e,t){var{logger:r,request:o,isPersonalisationActive:a}=e;super(),Object.defineProperty(this,nt,{value:lt}),Object.defineProperty(this,rt,{writable:!0,value:void 0}),Object.defineProperty(this,ot,{writable:!0,value:void 0}),Object.defineProperty(this,it,{writable:!0,value:void 0}),Object.defineProperty(this,at,{writable:!0,value:void 0}),i(this,rt)[rt]=r,i(this,ot)[ot]=t,i(this,it)[it]=o,i(this,at)[at]=a}push(){var e=arguments,r=this;return t((function*(){for(var t=e.length,o=new Array(t),a=0;a<t;a++)o[a]=e[a];return yield i(r,nt)[nt](o),0}))()}_processOldValues(){i(this,ot)[ot]&&i(this,nt)[nt](i(this,ot)[ot]),i(this,ot)[ot]=null}getDetails(e){if(i(this,at)[at]()&&(void 0===H.globalEventsMap&&(H.globalEventsMap=J.readFromLSorCookie(P)),void 0!==H.globalEventsMap)){var t=H.globalEventsMap[e],r={};return void 0!==t?(r.firstTime=new Date(1e3*t[1]),r.lastTime=new Date(1e3*t[2]),r.count=t[0],r):void 0}}}var lt=function(){var e=t((function*(e){if(Array.isArray(e))for(;e.length>0;){var t=e.shift();if(M(t))if(t.length>1024&&(t=t.substring(0,1024),i(this,rt)[rt].reportError(510,t+"... length exceeded 1024 chars. Trimmed.")),T.includes(t))i(this,rt)[rt].reportError(513,t+" is a restricted system event. It cannot be used as an event name.");else{var r={type:"event"};if(r.evtName=W(t,p),0!==e.length){var o=e.shift();if(I(o)){if("Charged"===t){if(!(yield tt(o,i(this,rt)[rt]))){i(this,rt)[rt].reportError(511,"Charged event structure invalid. Not sent.");continue}}else if(!et(o)){i(this,rt)[rt].reportError(512,t+" event structure invalid. Not sent.");continue}r.evtData=o}else e.unshift(o)}yield i(this,it)[it].processEvent(r)}else i(this,rt)[rt].error(ke)}}));return function(t){return e.apply(this,arguments)}}(),ct=o("request"),dt=o("logger"),ut=o("account"),vt=o("session"),ht=o("oldValues"),gt=o("device"),pt=o("processOUL"),ft=o("handleCookieFromCache"),yt=o("deleteUser"),bt=o("processLoginArray");class mt extends Array{constructor(e,t){var{request:r,account:o,session:a,logger:n,device:s}=e;super(),Object.defineProperty(this,bt,{value:Ot}),Object.defineProperty(this,yt,{value:Ct}),Object.defineProperty(this,ft,{value:St}),Object.defineProperty(this,pt,{value:kt}),Object.defineProperty(this,ct,{writable:!0,value:void 0}),Object.defineProperty(this,dt,{writable:!0,value:void 0}),Object.defineProperty(this,ut,{writable:!0,value:void 0}),Object.defineProperty(this,vt,{writable:!0,value:void 0}),Object.defineProperty(this,ht,{writable:!0,value:void 0}),Object.defineProperty(this,gt,{writable:!0,value:void 0}),i(this,ct)[ct]=r,i(this,ut)[ut]=o,i(this,vt)[vt]=a,i(this,dt)[dt]=n,i(this,ht)[ht]=t,i(this,gt)[gt]=s}clear(){var e=this;return t((function*(){i(e,dt)[dt].debug("clear called. Reset flag has been set."),yield i(e,yt)[yt](),yield J.setMetaProp(b,!0)}))()}push(){var e=arguments,r=this;return t((function*(){for(var t=e.length,o=new Array(t),a=0;a<t;a++)o[a]=e[a];return yield i(r,bt)[bt](o),0}))()}_processOldValues(){i(this,ht)[ht]&&i(this,bt)[bt](i(this,ht)[ht]),i(this,ht)[ht]=null}}var kt=function(){var e=t((function*(e){var r=this,o=!0;yield J.saveToLSorCookie(N,o);var a=function(){var e=t((function*(e){var t,a=yield J.readFromLSorCookie(C),n=yield J.readFromLSorCookie(S);if(null==a)a={},t=e;else{var s=!1,l=!1;if(null==(t=a.id)&&(t=e[0],s=!0),null==H.LRU_CACHE&&J._isLocalStorageSupported()&&(H.LRU_CACHE=new le(100),yield H.LRU_CACHE.init()),s)null!=n&&(H.LRU_CACHE.set(t,n),H.blockRequest=!1);else for(var c in e)if(e.hasOwnProperty(c)){var d=e[c];if(H.LRU_CACHE.cache[d]){t=d,l=!0;break}}if(l){t!==H.LRU_CACHE.getLastKey()?yield i(r,ft)[ft]():(o=!1,yield J.saveToLSorCookie(N,o));var u=yield H.LRU_CACHE.get(t);yield H.LRU_CACHE.set(t,u),yield J.saveToLSorCookie(S,u),i(r,gt)[gt].gcookie=u;var v=H.LRU_CACHE.getSecondLastKey();if((yield J.readFromLSorCookie(N))&&-1!==v){var h=H.LRU_CACHE.cache[v];yield i(r,ct)[ct].unregisterTokenForGuid(h)}}else s?null!=n&&(i(r,gt)[gt].gcookie=n,yield J.saveToLSorCookie(S,n),o=!1):yield r.clear(),yield J.saveToLSorCookie(N,!1),t=e[0]}a.id=t,yield J.saveToLSorCookie(C,a)}));return function(t){return e.apply(this,arguments)}}();if(Array.isArray(e)&&e.length>0)for(var n in e)if(e.hasOwnProperty(n)){var s=e[n],l={},c=void 0;if(null!=s.Site){if(c=s.Site,q(c)||!Ee(c,{logger:i(this,dt)[dt]}))return}else if(null!=s.Facebook){var d=s.Facebook;q(d)||d.error||(c=je(d))}else if(null!=s["Google Plus"]){var u=s["Google Plus"];q(u)&&!u.error&&(c=De(u,{logger:i(this,dt)[dt]}))}if(null!=c&&!q(c)){l.type="profile",null==c.tz&&(c.tz=(new Date).toString().match(/([A-Z]+[\+-][0-9]+)/)[1]),l.profile=c;var v=[];J._isLocalStorageSupported()&&(c.Identity&&v.push(c.Identity),c.Email&&v.push(c.Email),c.GPID&&v.push("GP:"+c.GPID),c.FBID&&v.push("FB:"+c.FBID),v.length>0&&(yield a(v))),yield _e(c,!0),l=yield i(this,ct)[ct].addSystemDataToObject(l,void 0),yield i(this,ct)[ct].addFlags(l),o&&(l.isOUL=!0);var h=oe(JSON.stringify(l),i(this,dt)[dt]),g=i(this,ut)[ut].dataPostURL;g=K(g,"type",D),g=K(g,"d",h),yield i(this,ct)[ct].saveAndFireRequest(g,H.blockRequest,o)}}}));return function(t){return e.apply(this,arguments)}}(),St=function(){var e=t((function*(){H.blockRequest=!1,console.debug("Block request is false"),J._isLocalStorageSupported()&&[L,P,w,R,O,k].forEach(function(){var e=t((function*(e){yield J.deleteData("localStorage",e)}));return function(t){return e.apply(this,arguments)}}()),yield J.deleteData("cookie",O,x()),yield J.deleteData("cookie",i(this,vt)[vt].cookieName,H.broadDomain),yield J.deleteData("cookie",R,H.broadDomain),yield i(this,vt)[vt].setSessionCookieObject("")}));return function(){return e.apply(this,arguments)}}(),Ct=function(){var e=t((function*(){H.blockRequest=!0,i(this,dt)[dt].debug("Block request is true"),H.globalCache={gcookie:null,REQ_N:0,RESP_N:0},J._isLocalStorageSupported()&&[S,C,L,P,w,R,O,k].forEach(function(){var e=t((function*(e){yield J.deleteData("localStorage",e)}));return function(t){return e.apply(this,arguments)}}()),yield J.retrieveData("cookie",S,H.broadDomain),yield J.retrieveData("cookie",O,x()),yield J.retrieveData("cookie",C,x()),yield J.retrieveData("cookie",i(this,vt)[vt].cookieName,H.broadDomain),yield J.retrieveData("cookie",R,H.broadDomain),i(this,gt)[gt].gcookie=null,yield i(this,vt)[vt].setSessionCookieObject("")}));return function(){return e.apply(this,arguments)}}(),Ot=function(){var e=t((function*(e){if(Array.isArray(e)&&e.length>0){var t=e.pop();if(null!=t&&I(t)&&(null!=t.Site&&Object.keys(t.Site).length>0||null!=t.Facebook&&Object.keys(t.Facebook).length>0||null!=t["Google Plus"]&&Object.keys(t["Google Plus"]).length>0)){yield J.setInstantDeleteFlagInK();try{yield i(this,pt)[pt]([t])}catch(e){i(this,dt)[dt].debug(e)}}else i(this,dt)[dt].error("Profile object is in incorrect format")}}));return function(t){return e.apply(this,arguments)}}(),Pt=1,wt=2,Lt=3,Rt=o("log"),At=o("isLegacyDebug");class Et{constructor(e){Object.defineProperty(this,At,{get:Dt,set:void 0}),Object.defineProperty(this,Rt,{value:jt}),this.logLevel=void 0,this.wzrkError={},this.logLevel=null!=e?e:wt,this.wzrkError={}}get logLevelValue(){return this.logLevel}set logLevelValue(e){this.logLevel=e}error(e){this.logLevelValue>=Pt&&i(this,Rt)[Rt]("error",e)}info(e){this.logLevelValue>=wt&&i(this,Rt)[Rt]("log",e)}debug(e){(this.logLevelValue>=Lt||i(this,At)[At])&&i(this,Rt)[Rt]("debug",e)}debugShopify(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"web";(this.logLevelValue>=Lt||i(this,At)[At])&&i(this,Rt)[Rt]("debug",e,t)}reportError(e,t){this.wzrkError.c=e,this.wzrkError.d=t,this.error("".concat(me," ").concat(e,": ").concat(t))}}var jt=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"web";try{var o=(new Date).getTime();"shopify_standard_event"===r?(console.log("CleverTap [".concat(o,"]: ")),console.log(JSON.parse(t))):console.log("CleverTap [".concat(o,"]: ").concat(t))}catch(e){}},Dt=function(){return"undefined"!=typeof sessionStorage&&""===sessionStorage.WZRK_D},_t=o("account"),Nt=o("logger"),Tt=o("device"),Mt=o("session"),It=o("request");return class{constructor(e){var{browser:t,accountId:r,region:o,targetDomain:a}=e;Object.defineProperty(this,_t,{writable:!0,value:void 0}),Object.defineProperty(this,Nt,{writable:!0,value:void 0}),Object.defineProperty(this,Tt,{writable:!0,value:void 0}),Object.defineProperty(this,Mt,{writable:!0,value:void 0}),Object.defineProperty(this,It,{writable:!0,value:void 0}),c.browser=t,c.mode="SHOPIFY",i(this,Nt)[Nt]=new Et(wt),i(this,_t)[_t]=new g({id:r},o,a),i(this,Tt)[Tt]=new Z({logger:i(this,Nt)[Nt]}),i(this,Mt)[Mt]=new re({logger:i(this,Nt)[Nt],isPersonalisationActive:()=>!1}),i(this,It)[It]=new Ye({logger:i(this,Nt)[Nt],account:i(this,_t)[_t],device:i(this,Tt)[Tt],session:i(this,Mt)[Mt],isPersonalisationActive:()=>!1}),this.event=new st({logger:i(this,Nt)[Nt],request:i(this,It)[It],isPersonalisationActive:()=>!1}),this.onUserLogin=new mt({request:i(this,It)[It],account:i(this,_t)[_t],session:i(this,Mt)[Mt],logger:i(this,Nt)[Nt],device:i(this,Tt)[Tt]}),ye.setPrivateProperties({logger:i(this,Nt)[Nt],request:i(this,It)[It],session:i(this,Mt)[Mt],device:i(this,Tt)[Tt]})}init(){var e=this;return t((function*(){if(i(e,Nt)[Nt].debug("init called"),i(e,Tt)[Tt].gcookie=yield i(e,Tt)[Tt].getGuid(),yield J.removeCookieAsync("WZRK_P",x()),!i(e,_t)[_t].id)return!1;i(e,Mt)[Mt].cookieName="WZRK_S_"+i(e,_t)[_t].id;var t=yield J.retrieveData("localStorage","WZRK_LOG_LEVEL");t&&(i(e,Nt)[Nt].logLevelValue=t),yield e.pageChanged()}))()}logShopifyEvents(e,t){i(this,Nt)[Nt].debugShopify(e,t)}pageChanged(){var e=this;return t((function*(){var t=c.browser.document.location.href,r=yield i(e,Mt)[Mt].getSessionCookieObject(),o=void 0===r.p?0:r.p;r.p=++o,yield i(e,Mt)[Mt].setSessionCookieObject(r);var a={};(a=yield i(e,It)[It].addSystemDataToObject(a,void 0)).cpg=t;var n=i(e,_t)[_t].dataPostURL,{protocol:s}=c.browser.document.location;s=s.replace(":",""),a.af={protocol:s},n=K(n,"type","page"),n=K(n,"d",oe(JSON.stringify(a),i(e,Nt)[Nt])),yield i(e,It)[It].addFlags(a),yield i(e,It)[It].saveAndFireRequest(n,H.blockRequest)}))()}}}();
